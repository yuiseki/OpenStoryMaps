(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))f(_);new MutationObserver(_=>{for(const w of _)if(w.type==="childList")for(const I of w.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&f(I)}).observe(document,{childList:!0,subtree:!0});function u(_){const w={};return _.integrity&&(w.integrity=_.integrity),_.referrerpolicy&&(w.referrerPolicy=_.referrerpolicy),_.crossorigin==="use-credentials"?w.credentials="include":_.crossorigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function f(_){if(_.ep)return;_.ep=!0;const w=u(_);fetch(_.href,w)}})();var Rh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ev(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Uu={},nw={get exports(){return Uu},set exports(n){Uu=n}},_d={},pt={},rw={get exports(){return pt},set exports(n){pt=n}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oc=Symbol.for("react.element"),iw=Symbol.for("react.portal"),ow=Symbol.for("react.fragment"),sw=Symbol.for("react.strict_mode"),aw=Symbol.for("react.profiler"),lw=Symbol.for("react.provider"),uw=Symbol.for("react.context"),cw=Symbol.for("react.forward_ref"),hw=Symbol.for("react.suspense"),dw=Symbol.for("react.memo"),pw=Symbol.for("react.lazy"),Py=Symbol.iterator;function fw(n){return n===null||typeof n!="object"?null:(n=Py&&n[Py]||n["@@iterator"],typeof n=="function"?n:null)}var tv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nv=Object.assign,rv={};function vl(n,o,u){this.props=n,this.context=o,this.refs=rv,this.updater=u||tv}vl.prototype.isReactComponent={};vl.prototype.setState=function(n,o){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,o,"setState")};vl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function iv(){}iv.prototype=vl.prototype;function fm(n,o,u){this.props=n,this.context=o,this.refs=rv,this.updater=u||tv}var mm=fm.prototype=new iv;mm.constructor=fm;nv(mm,vl.prototype);mm.isPureReactComponent=!0;var My=Array.isArray,ov=Object.prototype.hasOwnProperty,gm={current:null},sv={key:!0,ref:!0,__self:!0,__source:!0};function av(n,o,u){var f,_={},w=null,I=null;if(o!=null)for(f in o.ref!==void 0&&(I=o.ref),o.key!==void 0&&(w=""+o.key),o)ov.call(o,f)&&!sv.hasOwnProperty(f)&&(_[f]=o[f]);var l=arguments.length-2;if(l===1)_.children=u;else if(1<l){for(var N=Array(l),j=0;j<l;j++)N[j]=arguments[j+2];_.children=N}if(n&&n.defaultProps)for(f in l=n.defaultProps,l)_[f]===void 0&&(_[f]=l[f]);return{$$typeof:oc,type:n,key:w,ref:I,props:_,_owner:gm.current}}function mw(n,o){return{$$typeof:oc,type:n.type,key:o,ref:n.ref,props:n.props,_owner:n._owner}}function ym(n){return typeof n=="object"&&n!==null&&n.$$typeof===oc}function gw(n){var o={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(u){return o[u]})}var Dy=/\/+/g;function Np(n,o){return typeof n=="object"&&n!==null&&n.key!=null?gw(""+n.key):o.toString(36)}function Bh(n,o,u,f,_){var w=typeof n;(w==="undefined"||w==="boolean")&&(n=null);var I=!1;if(n===null)I=!0;else switch(w){case"string":case"number":I=!0;break;case"object":switch(n.$$typeof){case oc:case iw:I=!0}}if(I)return I=n,_=_(I),n=f===""?"."+Np(I,0):f,My(_)?(u="",n!=null&&(u=n.replace(Dy,"$&/")+"/"),Bh(_,o,u,"",function(j){return j})):_!=null&&(ym(_)&&(_=mw(_,u+(!_.key||I&&I.key===_.key?"":(""+_.key).replace(Dy,"$&/")+"/")+n)),o.push(_)),1;if(I=0,f=f===""?".":f+":",My(n))for(var l=0;l<n.length;l++){w=n[l];var N=f+Np(w,l);I+=Bh(w,o,u,N,_)}else if(N=fw(n),typeof N=="function")for(n=N.call(n),l=0;!(w=n.next()).done;)w=w.value,N=f+Np(w,l++),I+=Bh(w,o,u,N,_);else if(w==="object")throw o=String(n),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return I}function _h(n,o,u){if(n==null)return n;var f=[],_=0;return Bh(n,f,"","",function(w){return o.call(u,w,_++)}),f}function yw(n){if(n._status===-1){var o=n._result;o=o(),o.then(function(u){(n._status===0||n._status===-1)&&(n._status=1,n._result=u)},function(u){(n._status===0||n._status===-1)&&(n._status=2,n._result=u)}),n._status===-1&&(n._status=0,n._result=o)}if(n._status===1)return n._result.default;throw n._result}var kr={current:null},Fh={transition:null},_w={ReactCurrentDispatcher:kr,ReactCurrentBatchConfig:Fh,ReactCurrentOwner:gm};Pt.Children={map:_h,forEach:function(n,o,u){_h(n,function(){o.apply(this,arguments)},u)},count:function(n){var o=0;return _h(n,function(){o++}),o},toArray:function(n){return _h(n,function(o){return o})||[]},only:function(n){if(!ym(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Pt.Component=vl;Pt.Fragment=ow;Pt.Profiler=aw;Pt.PureComponent=fm;Pt.StrictMode=sw;Pt.Suspense=hw;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_w;Pt.cloneElement=function(n,o,u){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var f=nv({},n.props),_=n.key,w=n.ref,I=n._owner;if(o!=null){if(o.ref!==void 0&&(w=o.ref,I=gm.current),o.key!==void 0&&(_=""+o.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(N in o)ov.call(o,N)&&!sv.hasOwnProperty(N)&&(f[N]=o[N]===void 0&&l!==void 0?l[N]:o[N])}var N=arguments.length-2;if(N===1)f.children=u;else if(1<N){l=Array(N);for(var j=0;j<N;j++)l[j]=arguments[j+2];f.children=l}return{$$typeof:oc,type:n.type,key:_,ref:w,props:f,_owner:I}};Pt.createContext=function(n){return n={$$typeof:uw,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:lw,_context:n},n.Consumer=n};Pt.createElement=av;Pt.createFactory=function(n){var o=av.bind(null,n);return o.type=n,o};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(n){return{$$typeof:cw,render:n}};Pt.isValidElement=ym;Pt.lazy=function(n){return{$$typeof:pw,_payload:{_status:-1,_result:n},_init:yw}};Pt.memo=function(n,o){return{$$typeof:dw,type:n,compare:o===void 0?null:o}};Pt.startTransition=function(n){var o=Fh.transition;Fh.transition={};try{n()}finally{Fh.transition=o}};Pt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Pt.useCallback=function(n,o){return kr.current.useCallback(n,o)};Pt.useContext=function(n){return kr.current.useContext(n)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(n){return kr.current.useDeferredValue(n)};Pt.useEffect=function(n,o){return kr.current.useEffect(n,o)};Pt.useId=function(){return kr.current.useId()};Pt.useImperativeHandle=function(n,o,u){return kr.current.useImperativeHandle(n,o,u)};Pt.useInsertionEffect=function(n,o){return kr.current.useInsertionEffect(n,o)};Pt.useLayoutEffect=function(n,o){return kr.current.useLayoutEffect(n,o)};Pt.useMemo=function(n,o){return kr.current.useMemo(n,o)};Pt.useReducer=function(n,o,u){return kr.current.useReducer(n,o,u)};Pt.useRef=function(n){return kr.current.useRef(n)};Pt.useState=function(n){return kr.current.useState(n)};Pt.useSyncExternalStore=function(n,o,u){return kr.current.useSyncExternalStore(n,o,u)};Pt.useTransition=function(){return kr.current.useTransition()};Pt.version="18.2.0";(function(n){n.exports=Pt})(rw);const vw=ev(pt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xw=pt,ww=Symbol.for("react.element"),bw=Symbol.for("react.fragment"),Sw=Object.prototype.hasOwnProperty,Ew=xw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Tw={key:!0,ref:!0,__self:!0,__source:!0};function lv(n,o,u){var f,_={},w=null,I=null;u!==void 0&&(w=""+u),o.key!==void 0&&(w=""+o.key),o.ref!==void 0&&(I=o.ref);for(f in o)Sw.call(o,f)&&!Tw.hasOwnProperty(f)&&(_[f]=o[f]);if(n&&n.defaultProps)for(f in o=n.defaultProps,o)_[f]===void 0&&(_[f]=o[f]);return{$$typeof:ww,type:n,key:w,ref:I,props:_,_owner:Ew.current}}_d.Fragment=bw;_d.jsx=lv;_d.jsxs=lv;(function(n){n.exports=_d})(nw);const uv=Uu.Fragment,Tt=Uu.jsx,ui=Uu.jsxs;var Vu={},kw={get exports(){return Vu},set exports(n){Vu=n}},Jr={},vf={},Cw={get exports(){return vf},set exports(n){vf=n}},cv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function o(We,lt){var ct=We.length;We.push(lt);e:for(;0<ct;){var Vt=ct-1>>>1,Xt=We[Vt];if(0<_(Xt,lt))We[Vt]=lt,We[ct]=Xt,ct=Vt;else break e}}function u(We){return We.length===0?null:We[0]}function f(We){if(We.length===0)return null;var lt=We[0],ct=We.pop();if(ct!==lt){We[0]=ct;e:for(var Vt=0,Xt=We.length,Ur=Xt>>>1;Vt<Ur;){var Qn=2*(Vt+1)-1,er=We[Qn],On=Qn+1,dr=We[On];if(0>_(er,ct))On<Xt&&0>_(dr,er)?(We[Vt]=dr,We[On]=ct,Vt=On):(We[Vt]=er,We[Qn]=ct,Vt=Qn);else if(On<Xt&&0>_(dr,ct))We[Vt]=dr,We[On]=ct,Vt=On;else break e}}return lt}function _(We,lt){var ct=We.sortIndex-lt.sortIndex;return ct!==0?ct:We.id-lt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var w=performance;n.unstable_now=function(){return w.now()}}else{var I=Date,l=I.now();n.unstable_now=function(){return I.now()-l}}var N=[],j=[],ae=1,ne=null,q=3,Ae=!1,Te=!1,Ie=!1,bt=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(We){for(var lt=u(j);lt!==null;){if(lt.callback===null)f(j);else if(lt.startTime<=We)f(j),lt.sortIndex=lt.expirationTime,o(N,lt);else break;lt=u(j)}}function we(We){if(Ie=!1,re(We),!Te)if(u(N)!==null)Te=!0,at(ze);else{var lt=u(j);lt!==null&&hr(we,lt.startTime-We)}}function ze(We,lt){Te=!1,Ie&&(Ie=!1,ee(Fe),Fe=-1),Ae=!0;var ct=q;try{for(re(lt),ne=u(N);ne!==null&&(!(ne.expirationTime>lt)||We&&!nn());){var Vt=ne.callback;if(typeof Vt=="function"){ne.callback=null,q=ne.priorityLevel;var Xt=Vt(ne.expirationTime<=lt);lt=n.unstable_now(),typeof Xt=="function"?ne.callback=Xt:ne===u(N)&&f(N),re(lt)}else f(N);ne=u(N)}if(ne!==null)var Ur=!0;else{var Qn=u(j);Qn!==null&&hr(we,Qn.startTime-lt),Ur=!1}return Ur}finally{ne=null,q=ct,Ae=!1}}var He=!1,De=null,Fe=-1,Mt=5,st=-1;function nn(){return!(n.unstable_now()-st<Mt)}function Mn(){if(De!==null){var We=n.unstable_now();st=We;var lt=!0;try{lt=De(!0,We)}finally{lt?Ir():(He=!1,De=null)}}else He=!1}var Ir;if(typeof H=="function")Ir=function(){H(Mn)};else if(typeof MessageChannel<"u"){var Nr=new MessageChannel,ei=Nr.port2;Nr.port1.onmessage=Mn,Ir=function(){ei.postMessage(null)}}else Ir=function(){bt(Mn,0)};function at(We){De=We,He||(He=!0,Ir())}function hr(We,lt){Fe=bt(function(){We(n.unstable_now())},lt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(We){We.callback=null},n.unstable_continueExecution=function(){Te||Ae||(Te=!0,at(ze))},n.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Mt=0<We?Math.floor(1e3/We):5},n.unstable_getCurrentPriorityLevel=function(){return q},n.unstable_getFirstCallbackNode=function(){return u(N)},n.unstable_next=function(We){switch(q){case 1:case 2:case 3:var lt=3;break;default:lt=q}var ct=q;q=lt;try{return We()}finally{q=ct}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(We,lt){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var ct=q;q=We;try{return lt()}finally{q=ct}},n.unstable_scheduleCallback=function(We,lt,ct){var Vt=n.unstable_now();switch(typeof ct=="object"&&ct!==null?(ct=ct.delay,ct=typeof ct=="number"&&0<ct?Vt+ct:Vt):ct=Vt,We){case 1:var Xt=-1;break;case 2:Xt=250;break;case 5:Xt=1073741823;break;case 4:Xt=1e4;break;default:Xt=5e3}return Xt=ct+Xt,We={id:ae++,callback:lt,priorityLevel:We,startTime:ct,expirationTime:Xt,sortIndex:-1},ct>Vt?(We.sortIndex=ct,o(j,We),u(N)===null&&We===u(j)&&(Ie?(ee(Fe),Fe=-1):Ie=!0,hr(we,ct-Vt))):(We.sortIndex=Xt,o(N,We),Te||Ae||(Te=!0,at(ze))),We},n.unstable_shouldYield=nn,n.unstable_wrapCallback=function(We){var lt=q;return function(){var ct=q;q=lt;try{return We.apply(this,arguments)}finally{q=ct}}}})(cv);(function(n){n.exports=cv})(Cw);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hv=pt,Yr=vf;function Pe(n){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+n,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dv=new Set,$u={};function pa(n,o){hl(n,o),hl(n+"Capture",o)}function hl(n,o){for($u[n]=o,n=0;n<o.length;n++)dv.add(o[n])}var To=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xf=Object.prototype.hasOwnProperty,Iw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ly={},Ry={};function zw(n){return xf.call(Ry,n)?!0:xf.call(Ly,n)?!1:Iw.test(n)?Ry[n]=!0:(Ly[n]=!0,!1)}function Aw(n,o,u,f){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Pw(n,o,u,f){if(o===null||typeof o>"u"||Aw(n,o,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Cr(n,o,u,f,_,w,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=n,this.type=o,this.sanitizeURL=w,this.removeEmptyString=I}var Jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Jn[n]=new Cr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var o=n[0];Jn[o]=new Cr(o,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Jn[n]=new Cr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Jn[n]=new Cr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Jn[n]=new Cr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Jn[n]=new Cr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Jn[n]=new Cr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Jn[n]=new Cr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Jn[n]=new Cr(n,5,!1,n.toLowerCase(),null,!1,!1)});var _m=/[\-:]([a-z])/g;function vm(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var o=n.replace(_m,vm);Jn[o]=new Cr(o,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var o=n.replace(_m,vm);Jn[o]=new Cr(o,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var o=n.replace(_m,vm);Jn[o]=new Cr(o,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Jn[n]=new Cr(n,1,!1,n.toLowerCase(),null,!1,!1)});Jn.xlinkHref=new Cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Jn[n]=new Cr(n,1,!1,n.toLowerCase(),null,!0,!0)});function xm(n,o,u,f){var _=Jn.hasOwnProperty(o)?Jn[o]:null;(_!==null?_.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(Pw(o,u,_,f)&&(u=null),f||_===null?zw(o)&&(u===null?n.removeAttribute(o):n.setAttribute(o,""+u)):_.mustUseProperty?n[_.propertyName]=u===null?_.type===3?!1:"":u:(o=_.attributeName,f=_.attributeNamespace,u===null?n.removeAttribute(o):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,f?n.setAttributeNS(f,o,u):n.setAttribute(o,u))))}var zo=hv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vh=Symbol.for("react.element"),Ha=Symbol.for("react.portal"),Wa=Symbol.for("react.fragment"),wm=Symbol.for("react.strict_mode"),wf=Symbol.for("react.profiler"),pv=Symbol.for("react.provider"),fv=Symbol.for("react.context"),bm=Symbol.for("react.forward_ref"),bf=Symbol.for("react.suspense"),Sf=Symbol.for("react.suspense_list"),Sm=Symbol.for("react.memo"),ns=Symbol.for("react.lazy"),mv=Symbol.for("react.offscreen"),By=Symbol.iterator;function vu(n){return n===null||typeof n!="object"?null:(n=By&&n[By]||n["@@iterator"],typeof n=="function"?n:null)}var fn=Object.assign,Up;function Cu(n){if(Up===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Up=o&&o[1]||""}return`
`+Up+n}var Vp=!1;function $p(n,o){if(!n||Vp)return"";Vp=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(j){var f=j}Reflect.construct(n,[],o)}else{try{o.call()}catch(j){f=j}n.call(o.prototype)}else{try{throw Error()}catch(j){f=j}n()}}catch(j){if(j&&f&&typeof j.stack=="string"){for(var _=j.stack.split(`
`),w=f.stack.split(`
`),I=_.length-1,l=w.length-1;1<=I&&0<=l&&_[I]!==w[l];)l--;for(;1<=I&&0<=l;I--,l--)if(_[I]!==w[l]){if(I!==1||l!==1)do if(I--,l--,0>l||_[I]!==w[l]){var N=`
`+_[I].replace(" at new "," at ");return n.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",n.displayName)),N}while(1<=I&&0<=l);break}}}finally{Vp=!1,Error.prepareStackTrace=u}return(n=n?n.displayName||n.name:"")?Cu(n):""}function Mw(n){switch(n.tag){case 5:return Cu(n.type);case 16:return Cu("Lazy");case 13:return Cu("Suspense");case 19:return Cu("SuspenseList");case 0:case 2:case 15:return n=$p(n.type,!1),n;case 11:return n=$p(n.type.render,!1),n;case 1:return n=$p(n.type,!0),n;default:return""}}function Ef(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Wa:return"Fragment";case Ha:return"Portal";case wf:return"Profiler";case wm:return"StrictMode";case bf:return"Suspense";case Sf:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case fv:return(n.displayName||"Context")+".Consumer";case pv:return(n._context.displayName||"Context")+".Provider";case bm:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Sm:return o=n.displayName||null,o!==null?o:Ef(n.type)||"Memo";case ns:o=n._payload,n=n._init;try{return Ef(n(o))}catch{}}return null}function Dw(n){var o=n.type;switch(n.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=o.render,n=n.displayName||n.name||"",o.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ef(o);case 8:return o===wm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ys(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function gv(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Lw(n){var o=gv(n)?"checked":"value",u=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),f=""+n[o];if(!n.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,w=u.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return _.call(this)},set:function(I){f=""+I,w.call(this,I)}}),Object.defineProperty(n,o,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function xh(n){n._valueTracker||(n._valueTracker=Lw(n))}function yv(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return n&&(f=gv(n)?n.checked?"true":"false":n.value),n=f,n!==u?(o.setValue(n),!0):!1}function Wh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Tf(n,o){var u=o.checked;return fn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??n._wrapperState.initialChecked})}function Fy(n,o){var u=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;u=ys(o.value!=null?o.value:u),n._wrapperState={initialChecked:f,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function _v(n,o){o=o.checked,o!=null&&xm(n,"checked",o,!1)}function kf(n,o){_v(n,o);var u=ys(o.value),f=o.type;if(u!=null)f==="number"?(u===0&&n.value===""||n.value!=u)&&(n.value=""+u):n.value!==""+u&&(n.value=""+u);else if(f==="submit"||f==="reset"){n.removeAttribute("value");return}o.hasOwnProperty("value")?Cf(n,o.type,u):o.hasOwnProperty("defaultValue")&&Cf(n,o.type,ys(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(n.defaultChecked=!!o.defaultChecked)}function Oy(n,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+n._wrapperState.initialValue,u||o===n.value||(n.value=o),n.defaultValue=o}u=n.name,u!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,u!==""&&(n.name=u)}function Cf(n,o,u){(o!=="number"||Wh(n.ownerDocument)!==n)&&(u==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+u&&(n.defaultValue=""+u))}var Iu=Array.isArray;function ol(n,o,u,f){if(n=n.options,o){o={};for(var _=0;_<u.length;_++)o["$"+u[_]]=!0;for(u=0;u<n.length;u++)_=o.hasOwnProperty("$"+n[u].value),n[u].selected!==_&&(n[u].selected=_),_&&f&&(n[u].defaultSelected=!0)}else{for(u=""+ys(u),o=null,_=0;_<n.length;_++){if(n[_].value===u){n[_].selected=!0,f&&(n[_].defaultSelected=!0);return}o!==null||n[_].disabled||(o=n[_])}o!==null&&(o.selected=!0)}}function If(n,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return fn({},o,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ny(n,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(Pe(92));if(Iu(u)){if(1<u.length)throw Error(Pe(93));u=u[0]}o=u}o==null&&(o=""),u=o}n._wrapperState={initialValue:ys(u)}}function vv(n,o){var u=ys(o.value),f=ys(o.defaultValue);u!=null&&(u=""+u,u!==n.value&&(n.value=u),o.defaultValue==null&&n.defaultValue!==u&&(n.defaultValue=u)),f!=null&&(n.defaultValue=""+f)}function Uy(n){var o=n.textContent;o===n._wrapperState.initialValue&&o!==""&&o!==null&&(n.value=o)}function xv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zf(n,o){return n==null||n==="http://www.w3.org/1999/xhtml"?xv(o):n==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var wh,wv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,f,_){MSApp.execUnsafeLocalFunction(function(){return n(o,u,f,_)})}:n}(function(n,o){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=o;else{for(wh=wh||document.createElement("div"),wh.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=wh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;o.firstChild;)n.appendChild(o.firstChild)}});function ju(n,o){if(o){var u=n.firstChild;if(u&&u===n.lastChild&&u.nodeType===3){u.nodeValue=o;return}}n.textContent=o}var Pu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rw=["Webkit","ms","Moz","O"];Object.keys(Pu).forEach(function(n){Rw.forEach(function(o){o=o+n.charAt(0).toUpperCase()+n.substring(1),Pu[o]=Pu[n]})});function bv(n,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||Pu.hasOwnProperty(n)&&Pu[n]?(""+o).trim():o+"px"}function Sv(n,o){n=n.style;for(var u in o)if(o.hasOwnProperty(u)){var f=u.indexOf("--")===0,_=bv(u,o[u],f);u==="float"&&(u="cssFloat"),f?n.setProperty(u,_):n[u]=_}}var Bw=fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Af(n,o){if(o){if(Bw[n]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Pe(137,n));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Pe(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Pe(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Pe(62))}}function Pf(n,o){if(n.indexOf("-")===-1)return typeof o.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mf=null;function Em(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Df=null,sl=null,al=null;function Vy(n){if(n=lc(n)){if(typeof Df!="function")throw Error(Pe(280));var o=n.stateNode;o&&(o=Sd(o),Df(n.stateNode,n.type,o))}}function Ev(n){sl?al?al.push(n):al=[n]:sl=n}function Tv(){if(sl){var n=sl,o=al;if(al=sl=null,Vy(n),o)for(n=0;n<o.length;n++)Vy(o[n])}}function kv(n,o){return n(o)}function Cv(){}var jp=!1;function Iv(n,o,u){if(jp)return n(o,u);jp=!0;try{return kv(n,o,u)}finally{jp=!1,(sl!==null||al!==null)&&(Cv(),Tv())}}function Gu(n,o){var u=n.stateNode;if(u===null)return null;var f=Sd(u);if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(u&&typeof u!="function")throw Error(Pe(231,o,typeof u));return u}var Lf=!1;if(To)try{var xu={};Object.defineProperty(xu,"passive",{get:function(){Lf=!0}}),window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch{Lf=!1}function Fw(n,o,u,f,_,w,I,l,N){var j=Array.prototype.slice.call(arguments,3);try{o.apply(u,j)}catch(ae){this.onError(ae)}}var Mu=!1,Xh=null,Kh=!1,Rf=null,Ow={onError:function(n){Mu=!0,Xh=n}};function Nw(n,o,u,f,_,w,I,l,N){Mu=!1,Xh=null,Fw.apply(Ow,arguments)}function Uw(n,o,u,f,_,w,I,l,N){if(Nw.apply(this,arguments),Mu){if(Mu){var j=Xh;Mu=!1,Xh=null}else throw Error(Pe(198));Kh||(Kh=!0,Rf=j)}}function fa(n){var o=n,u=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,o.flags&4098&&(u=o.return),n=o.return;while(n)}return o.tag===3?u:null}function zv(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function $y(n){if(fa(n)!==n)throw Error(Pe(188))}function Vw(n){var o=n.alternate;if(!o){if(o=fa(n),o===null)throw Error(Pe(188));return o!==n?null:n}for(var u=n,f=o;;){var _=u.return;if(_===null)break;var w=_.alternate;if(w===null){if(f=_.return,f!==null){u=f;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===u)return $y(_),n;if(w===f)return $y(_),o;w=w.sibling}throw Error(Pe(188))}if(u.return!==f.return)u=_,f=w;else{for(var I=!1,l=_.child;l;){if(l===u){I=!0,u=_,f=w;break}if(l===f){I=!0,f=_,u=w;break}l=l.sibling}if(!I){for(l=w.child;l;){if(l===u){I=!0,u=w,f=_;break}if(l===f){I=!0,f=w,u=_;break}l=l.sibling}if(!I)throw Error(Pe(189))}}if(u.alternate!==f)throw Error(Pe(190))}if(u.tag!==3)throw Error(Pe(188));return u.stateNode.current===u?n:o}function Av(n){return n=Vw(n),n!==null?Pv(n):null}function Pv(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var o=Pv(n);if(o!==null)return o;n=n.sibling}return null}var Mv=Yr.unstable_scheduleCallback,jy=Yr.unstable_cancelCallback,$w=Yr.unstable_shouldYield,jw=Yr.unstable_requestPaint,Sn=Yr.unstable_now,Gw=Yr.unstable_getCurrentPriorityLevel,Tm=Yr.unstable_ImmediatePriority,Dv=Yr.unstable_UserBlockingPriority,Yh=Yr.unstable_NormalPriority,qw=Yr.unstable_LowPriority,Lv=Yr.unstable_IdlePriority,vd=null,Qi=null;function Zw(n){if(Qi&&typeof Qi.onCommitFiberRoot=="function")try{Qi.onCommitFiberRoot(vd,n,void 0,(n.current.flags&128)===128)}catch{}}var Mi=Math.clz32?Math.clz32:Xw,Hw=Math.log,Ww=Math.LN2;function Xw(n){return n>>>=0,n===0?32:31-(Hw(n)/Ww|0)|0}var bh=64,Sh=4194304;function zu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Jh(n,o){var u=n.pendingLanes;if(u===0)return 0;var f=0,_=n.suspendedLanes,w=n.pingedLanes,I=u&268435455;if(I!==0){var l=I&~_;l!==0?f=zu(l):(w&=I,w!==0&&(f=zu(w)))}else I=u&~_,I!==0?f=zu(I):w!==0&&(f=zu(w));if(f===0)return 0;if(o!==0&&o!==f&&!(o&_)&&(_=f&-f,w=o&-o,_>=w||_===16&&(w&4194240)!==0))return o;if(f&4&&(f|=u&16),o=n.entangledLanes,o!==0)for(n=n.entanglements,o&=f;0<o;)u=31-Mi(o),_=1<<u,f|=n[u],o&=~_;return f}function Kw(n,o){switch(n){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yw(n,o){for(var u=n.suspendedLanes,f=n.pingedLanes,_=n.expirationTimes,w=n.pendingLanes;0<w;){var I=31-Mi(w),l=1<<I,N=_[I];N===-1?(!(l&u)||l&f)&&(_[I]=Kw(l,o)):N<=o&&(n.expiredLanes|=l),w&=~l}}function Bf(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Rv(){var n=bh;return bh<<=1,!(bh&4194240)&&(bh=64),n}function Gp(n){for(var o=[],u=0;31>u;u++)o.push(n);return o}function sc(n,o,u){n.pendingLanes|=o,o!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,o=31-Mi(o),n[o]=u}function Jw(n,o){var u=n.pendingLanes&~o;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=o,n.mutableReadLanes&=o,n.entangledLanes&=o,o=n.entanglements;var f=n.eventTimes;for(n=n.expirationTimes;0<u;){var _=31-Mi(u),w=1<<_;o[_]=0,f[_]=-1,n[_]=-1,u&=~w}}function km(n,o){var u=n.entangledLanes|=o;for(n=n.entanglements;u;){var f=31-Mi(u),_=1<<f;_&o|n[f]&o&&(n[f]|=o),u&=~_}}var Zt=0;function Bv(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Fv,Cm,Ov,Nv,Uv,Ff=!1,Eh=[],us=null,cs=null,hs=null,qu=new Map,Zu=new Map,is=[],Qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gy(n,o){switch(n){case"focusin":case"focusout":us=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":qu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(o.pointerId)}}function wu(n,o,u,f,_,w){return n===null||n.nativeEvent!==w?(n={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[_]},o!==null&&(o=lc(o),o!==null&&Cm(o)),n):(n.eventSystemFlags|=f,o=n.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),n)}function eb(n,o,u,f,_){switch(o){case"focusin":return us=wu(us,n,o,u,f,_),!0;case"dragenter":return cs=wu(cs,n,o,u,f,_),!0;case"mouseover":return hs=wu(hs,n,o,u,f,_),!0;case"pointerover":var w=_.pointerId;return qu.set(w,wu(qu.get(w)||null,n,o,u,f,_)),!0;case"gotpointercapture":return w=_.pointerId,Zu.set(w,wu(Zu.get(w)||null,n,o,u,f,_)),!0}return!1}function Vv(n){var o=ra(n.target);if(o!==null){var u=fa(o);if(u!==null){if(o=u.tag,o===13){if(o=zv(u),o!==null){n.blockedOn=o,Uv(n.priority,function(){Ov(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){n.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Oh(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var u=Of(n.domEventName,n.eventSystemFlags,o[0],n.nativeEvent);if(u===null){u=n.nativeEvent;var f=new u.constructor(u.type,u);Mf=f,u.target.dispatchEvent(f),Mf=null}else return o=lc(u),o!==null&&Cm(o),n.blockedOn=u,!1;o.shift()}return!0}function qy(n,o,u){Oh(n)&&u.delete(o)}function tb(){Ff=!1,us!==null&&Oh(us)&&(us=null),cs!==null&&Oh(cs)&&(cs=null),hs!==null&&Oh(hs)&&(hs=null),qu.forEach(qy),Zu.forEach(qy)}function bu(n,o){n.blockedOn===o&&(n.blockedOn=null,Ff||(Ff=!0,Yr.unstable_scheduleCallback(Yr.unstable_NormalPriority,tb)))}function Hu(n){function o(_){return bu(_,n)}if(0<Eh.length){bu(Eh[0],n);for(var u=1;u<Eh.length;u++){var f=Eh[u];f.blockedOn===n&&(f.blockedOn=null)}}for(us!==null&&bu(us,n),cs!==null&&bu(cs,n),hs!==null&&bu(hs,n),qu.forEach(o),Zu.forEach(o),u=0;u<is.length;u++)f=is[u],f.blockedOn===n&&(f.blockedOn=null);for(;0<is.length&&(u=is[0],u.blockedOn===null);)Vv(u),u.blockedOn===null&&is.shift()}var ll=zo.ReactCurrentBatchConfig,Qh=!0;function nb(n,o,u,f){var _=Zt,w=ll.transition;ll.transition=null;try{Zt=1,Im(n,o,u,f)}finally{Zt=_,ll.transition=w}}function rb(n,o,u,f){var _=Zt,w=ll.transition;ll.transition=null;try{Zt=4,Im(n,o,u,f)}finally{Zt=_,ll.transition=w}}function Im(n,o,u,f){if(Qh){var _=Of(n,o,u,f);if(_===null)ef(n,o,f,ed,u),Gy(n,f);else if(eb(_,n,o,u,f))f.stopPropagation();else if(Gy(n,f),o&4&&-1<Qw.indexOf(n)){for(;_!==null;){var w=lc(_);if(w!==null&&Fv(w),w=Of(n,o,u,f),w===null&&ef(n,o,f,ed,u),w===_)break;_=w}_!==null&&f.stopPropagation()}else ef(n,o,f,null,u)}}var ed=null;function Of(n,o,u,f){if(ed=null,n=Em(f),n=ra(n),n!==null)if(o=fa(n),o===null)n=null;else if(u=o.tag,u===13){if(n=zv(o),n!==null)return n;n=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null);return ed=n,null}function $v(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gw()){case Tm:return 1;case Dv:return 4;case Yh:case qw:return 16;case Lv:return 536870912;default:return 16}default:return 16}}var as=null,zm=null,Nh=null;function jv(){if(Nh)return Nh;var n,o=zm,u=o.length,f,_="value"in as?as.value:as.textContent,w=_.length;for(n=0;n<u&&o[n]===_[n];n++);var I=u-n;for(f=1;f<=I&&o[u-f]===_[w-f];f++);return Nh=_.slice(n,1<f?1-f:void 0)}function Uh(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Th(){return!0}function Zy(){return!1}function Qr(n){function o(u,f,_,w,I){this._reactName=u,this._targetInst=_,this.type=f,this.nativeEvent=w,this.target=I,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(u=n[l],this[l]=u?u(w):w[l]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Th:Zy,this.isPropagationStopped=Zy,this}return fn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Th)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Th)},persist:function(){},isPersistent:Th}),o}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Am=Qr(xl),ac=fn({},xl,{view:0,detail:0}),ib=Qr(ac),qp,Zp,Su,xd=fn({},ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Su&&(Su&&n.type==="mousemove"?(qp=n.screenX-Su.screenX,Zp=n.screenY-Su.screenY):Zp=qp=0,Su=n),qp)},movementY:function(n){return"movementY"in n?n.movementY:Zp}}),Hy=Qr(xd),ob=fn({},xd,{dataTransfer:0}),sb=Qr(ob),ab=fn({},ac,{relatedTarget:0}),Hp=Qr(ab),lb=fn({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),ub=Qr(lb),cb=fn({},xl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),hb=Qr(cb),db=fn({},xl,{data:0}),Wy=Qr(db),pb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gb(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=mb[n])?!!o[n]:!1}function Pm(){return gb}var yb=fn({},ac,{key:function(n){if(n.key){var o=pb[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Uh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?fb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pm,charCode:function(n){return n.type==="keypress"?Uh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Uh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),_b=Qr(yb),vb=fn({},xd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xy=Qr(vb),xb=fn({},ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pm}),wb=Qr(xb),bb=fn({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sb=Qr(bb),Eb=fn({},xd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Tb=Qr(Eb),kb=[9,13,27,32],Mm=To&&"CompositionEvent"in window,Du=null;To&&"documentMode"in document&&(Du=document.documentMode);var Cb=To&&"TextEvent"in window&&!Du,Gv=To&&(!Mm||Du&&8<Du&&11>=Du),Ky=String.fromCharCode(32),Yy=!1;function qv(n,o){switch(n){case"keyup":return kb.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zv(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xa=!1;function Ib(n,o){switch(n){case"compositionend":return Zv(o);case"keypress":return o.which!==32?null:(Yy=!0,Ky);case"textInput":return n=o.data,n===Ky&&Yy?null:n;default:return null}}function zb(n,o){if(Xa)return n==="compositionend"||!Mm&&qv(n,o)?(n=jv(),Nh=zm=as=null,Xa=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Gv&&o.locale!=="ko"?null:o.data;default:return null}}var Ab={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jy(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!Ab[n.type]:o==="textarea"}function Hv(n,o,u,f){Ev(f),o=td(o,"onChange"),0<o.length&&(u=new Am("onChange","change",null,u,f),n.push({event:u,listeners:o}))}var Lu=null,Wu=null;function Pb(n){ix(n,0)}function wd(n){var o=Ja(n);if(yv(o))return n}function Mb(n,o){if(n==="change")return o}var Wv=!1;if(To){var Wp;if(To){var Xp="oninput"in document;if(!Xp){var Qy=document.createElement("div");Qy.setAttribute("oninput","return;"),Xp=typeof Qy.oninput=="function"}Wp=Xp}else Wp=!1;Wv=Wp&&(!document.documentMode||9<document.documentMode)}function e_(){Lu&&(Lu.detachEvent("onpropertychange",Xv),Wu=Lu=null)}function Xv(n){if(n.propertyName==="value"&&wd(Wu)){var o=[];Hv(o,Wu,n,Em(n)),Iv(Pb,o)}}function Db(n,o,u){n==="focusin"?(e_(),Lu=o,Wu=u,Lu.attachEvent("onpropertychange",Xv)):n==="focusout"&&e_()}function Lb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return wd(Wu)}function Rb(n,o){if(n==="click")return wd(o)}function Bb(n,o){if(n==="input"||n==="change")return wd(o)}function Fb(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Li=typeof Object.is=="function"?Object.is:Fb;function Xu(n,o){if(Li(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var u=Object.keys(n),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var _=u[f];if(!xf.call(o,_)||!Li(n[_],o[_]))return!1}return!0}function t_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function n_(n,o){var u=t_(n);n=0;for(var f;u;){if(u.nodeType===3){if(f=n+u.textContent.length,n<=o&&f>=o)return{node:u,offset:o-n};n=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=t_(u)}}function Kv(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Kv(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Yv(){for(var n=window,o=Wh();o instanceof n.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)n=o.contentWindow;else break;o=Wh(n.document)}return o}function Dm(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}function Ob(n){var o=Yv(),u=n.focusedElem,f=n.selectionRange;if(o!==u&&u&&u.ownerDocument&&Kv(u.ownerDocument.documentElement,u)){if(f!==null&&Dm(u)){if(o=f.start,n=f.end,n===void 0&&(n=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(n,u.value.length);else if(n=(o=u.ownerDocument||document)&&o.defaultView||window,n.getSelection){n=n.getSelection();var _=u.textContent.length,w=Math.min(f.start,_);f=f.end===void 0?w:Math.min(f.end,_),!n.extend&&w>f&&(_=f,f=w,w=_),_=n_(u,w);var I=n_(u,f);_&&I&&(n.rangeCount!==1||n.anchorNode!==_.node||n.anchorOffset!==_.offset||n.focusNode!==I.node||n.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),n.removeAllRanges(),w>f?(n.addRange(o),n.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),n.addRange(o)))}}for(o=[],n=u;n=n.parentNode;)n.nodeType===1&&o.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)n=o[u],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Nb=To&&"documentMode"in document&&11>=document.documentMode,Ka=null,Nf=null,Ru=null,Uf=!1;function r_(n,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Uf||Ka==null||Ka!==Wh(f)||(f=Ka,"selectionStart"in f&&Dm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Ru&&Xu(Ru,f)||(Ru=f,f=td(Nf,"onSelect"),0<f.length&&(o=new Am("onSelect","select",null,o,u),n.push({event:o,listeners:f}),o.target=Ka)))}function kh(n,o){var u={};return u[n.toLowerCase()]=o.toLowerCase(),u["Webkit"+n]="webkit"+o,u["Moz"+n]="moz"+o,u}var Ya={animationend:kh("Animation","AnimationEnd"),animationiteration:kh("Animation","AnimationIteration"),animationstart:kh("Animation","AnimationStart"),transitionend:kh("Transition","TransitionEnd")},Kp={},Jv={};To&&(Jv=document.createElement("div").style,"AnimationEvent"in window||(delete Ya.animationend.animation,delete Ya.animationiteration.animation,delete Ya.animationstart.animation),"TransitionEvent"in window||delete Ya.transitionend.transition);function bd(n){if(Kp[n])return Kp[n];if(!Ya[n])return n;var o=Ya[n],u;for(u in o)if(o.hasOwnProperty(u)&&u in Jv)return Kp[n]=o[u];return n}var Qv=bd("animationend"),ex=bd("animationiteration"),tx=bd("animationstart"),nx=bd("transitionend"),rx=new Map,i_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vs(n,o){rx.set(n,o),pa(o,[n])}for(var Yp=0;Yp<i_.length;Yp++){var Jp=i_[Yp],Ub=Jp.toLowerCase(),Vb=Jp[0].toUpperCase()+Jp.slice(1);vs(Ub,"on"+Vb)}vs(Qv,"onAnimationEnd");vs(ex,"onAnimationIteration");vs(tx,"onAnimationStart");vs("dblclick","onDoubleClick");vs("focusin","onFocus");vs("focusout","onBlur");vs(nx,"onTransitionEnd");hl("onMouseEnter",["mouseout","mouseover"]);hl("onMouseLeave",["mouseout","mouseover"]);hl("onPointerEnter",["pointerout","pointerover"]);hl("onPointerLeave",["pointerout","pointerover"]);pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pa("onBeforeInput",["compositionend","keypress","textInput","paste"]);pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$b=new Set("cancel close invalid load scroll toggle".split(" ").concat(Au));function o_(n,o,u){var f=n.type||"unknown-event";n.currentTarget=u,Uw(f,o,void 0,n),n.currentTarget=null}function ix(n,o){o=(o&4)!==0;for(var u=0;u<n.length;u++){var f=n[u],_=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var I=f.length-1;0<=I;I--){var l=f[I],N=l.instance,j=l.currentTarget;if(l=l.listener,N!==w&&_.isPropagationStopped())break e;o_(_,l,j),w=N}else for(I=0;I<f.length;I++){if(l=f[I],N=l.instance,j=l.currentTarget,l=l.listener,N!==w&&_.isPropagationStopped())break e;o_(_,l,j),w=N}}}if(Kh)throw n=Rf,Kh=!1,Rf=null,n}function sn(n,o){var u=o[qf];u===void 0&&(u=o[qf]=new Set);var f=n+"__bubble";u.has(f)||(ox(o,n,2,!1),u.add(f))}function Qp(n,o,u){var f=0;o&&(f|=4),ox(u,n,f,o)}var Ch="_reactListening"+Math.random().toString(36).slice(2);function Ku(n){if(!n[Ch]){n[Ch]=!0,dv.forEach(function(u){u!=="selectionchange"&&($b.has(u)||Qp(u,!1,n),Qp(u,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[Ch]||(o[Ch]=!0,Qp("selectionchange",!1,o))}}function ox(n,o,u,f){switch($v(o)){case 1:var _=nb;break;case 4:_=rb;break;default:_=Im}u=_.bind(null,o,u,n),_=void 0,!Lf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),f?_!==void 0?n.addEventListener(o,u,{capture:!0,passive:_}):n.addEventListener(o,u,!0):_!==void 0?n.addEventListener(o,u,{passive:_}):n.addEventListener(o,u,!1)}function ef(n,o,u,f,_){var w=f;if(!(o&1)&&!(o&2)&&f!==null)e:for(;;){if(f===null)return;var I=f.tag;if(I===3||I===4){var l=f.stateNode.containerInfo;if(l===_||l.nodeType===8&&l.parentNode===_)break;if(I===4)for(I=f.return;I!==null;){var N=I.tag;if((N===3||N===4)&&(N=I.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;I=I.return}for(;l!==null;){if(I=ra(l),I===null)return;if(N=I.tag,N===5||N===6){f=w=I;continue e}l=l.parentNode}}f=f.return}Iv(function(){var j=w,ae=Em(u),ne=[];e:{var q=rx.get(n);if(q!==void 0){var Ae=Am,Te=n;switch(n){case"keypress":if(Uh(u)===0)break e;case"keydown":case"keyup":Ae=_b;break;case"focusin":Te="focus",Ae=Hp;break;case"focusout":Te="blur",Ae=Hp;break;case"beforeblur":case"afterblur":Ae=Hp;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Hy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=sb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=wb;break;case Qv:case ex:case tx:Ae=ub;break;case nx:Ae=Sb;break;case"scroll":Ae=ib;break;case"wheel":Ae=Tb;break;case"copy":case"cut":case"paste":Ae=hb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=Xy}var Ie=(o&4)!==0,bt=!Ie&&n==="scroll",ee=Ie?q!==null?q+"Capture":null:q;Ie=[];for(var H=j,re;H!==null;){re=H;var we=re.stateNode;if(re.tag===5&&we!==null&&(re=we,ee!==null&&(we=Gu(H,ee),we!=null&&Ie.push(Yu(H,we,re)))),bt)break;H=H.return}0<Ie.length&&(q=new Ae(q,Te,null,u,ae),ne.push({event:q,listeners:Ie}))}}if(!(o&7)){e:{if(q=n==="mouseover"||n==="pointerover",Ae=n==="mouseout"||n==="pointerout",q&&u!==Mf&&(Te=u.relatedTarget||u.fromElement)&&(ra(Te)||Te[ko]))break e;if((Ae||q)&&(q=ae.window===ae?ae:(q=ae.ownerDocument)?q.defaultView||q.parentWindow:window,Ae?(Te=u.relatedTarget||u.toElement,Ae=j,Te=Te?ra(Te):null,Te!==null&&(bt=fa(Te),Te!==bt||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(Ae=null,Te=j),Ae!==Te)){if(Ie=Hy,we="onMouseLeave",ee="onMouseEnter",H="mouse",(n==="pointerout"||n==="pointerover")&&(Ie=Xy,we="onPointerLeave",ee="onPointerEnter",H="pointer"),bt=Ae==null?q:Ja(Ae),re=Te==null?q:Ja(Te),q=new Ie(we,H+"leave",Ae,u,ae),q.target=bt,q.relatedTarget=re,we=null,ra(ae)===j&&(Ie=new Ie(ee,H+"enter",Te,u,ae),Ie.target=re,Ie.relatedTarget=bt,we=Ie),bt=we,Ae&&Te)t:{for(Ie=Ae,ee=Te,H=0,re=Ie;re;re=Za(re))H++;for(re=0,we=ee;we;we=Za(we))re++;for(;0<H-re;)Ie=Za(Ie),H--;for(;0<re-H;)ee=Za(ee),re--;for(;H--;){if(Ie===ee||ee!==null&&Ie===ee.alternate)break t;Ie=Za(Ie),ee=Za(ee)}Ie=null}else Ie=null;Ae!==null&&s_(ne,q,Ae,Ie,!1),Te!==null&&bt!==null&&s_(ne,bt,Te,Ie,!0)}}e:{if(q=j?Ja(j):window,Ae=q.nodeName&&q.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&q.type==="file")var ze=Mb;else if(Jy(q))if(Wv)ze=Bb;else{ze=Lb;var He=Db}else(Ae=q.nodeName)&&Ae.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(ze=Rb);if(ze&&(ze=ze(n,j))){Hv(ne,ze,u,ae);break e}He&&He(n,q,j),n==="focusout"&&(He=q._wrapperState)&&He.controlled&&q.type==="number"&&Cf(q,"number",q.value)}switch(He=j?Ja(j):window,n){case"focusin":(Jy(He)||He.contentEditable==="true")&&(Ka=He,Nf=j,Ru=null);break;case"focusout":Ru=Nf=Ka=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,r_(ne,u,ae);break;case"selectionchange":if(Nb)break;case"keydown":case"keyup":r_(ne,u,ae)}var De;if(Mm)e:{switch(n){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else Xa?qv(n,u)&&(Fe="onCompositionEnd"):n==="keydown"&&u.keyCode===229&&(Fe="onCompositionStart");Fe&&(Gv&&u.locale!=="ko"&&(Xa||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&Xa&&(De=jv()):(as=ae,zm="value"in as?as.value:as.textContent,Xa=!0)),He=td(j,Fe),0<He.length&&(Fe=new Wy(Fe,n,null,u,ae),ne.push({event:Fe,listeners:He}),De?Fe.data=De:(De=Zv(u),De!==null&&(Fe.data=De)))),(De=Cb?Ib(n,u):zb(n,u))&&(j=td(j,"onBeforeInput"),0<j.length&&(ae=new Wy("onBeforeInput","beforeinput",null,u,ae),ne.push({event:ae,listeners:j}),ae.data=De))}ix(ne,o)})}function Yu(n,o,u){return{instance:n,listener:o,currentTarget:u}}function td(n,o){for(var u=o+"Capture",f=[];n!==null;){var _=n,w=_.stateNode;_.tag===5&&w!==null&&(_=w,w=Gu(n,u),w!=null&&f.unshift(Yu(n,w,_)),w=Gu(n,o),w!=null&&f.push(Yu(n,w,_))),n=n.return}return f}function Za(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function s_(n,o,u,f,_){for(var w=o._reactName,I=[];u!==null&&u!==f;){var l=u,N=l.alternate,j=l.stateNode;if(N!==null&&N===f)break;l.tag===5&&j!==null&&(l=j,_?(N=Gu(u,w),N!=null&&I.unshift(Yu(u,N,l))):_||(N=Gu(u,w),N!=null&&I.push(Yu(u,N,l)))),u=u.return}I.length!==0&&n.push({event:o,listeners:I})}var jb=/\r\n?/g,Gb=/\u0000|\uFFFD/g;function a_(n){return(typeof n=="string"?n:""+n).replace(jb,`
`).replace(Gb,"")}function Ih(n,o,u){if(o=a_(o),a_(n)!==o&&u)throw Error(Pe(425))}function nd(){}var Vf=null,$f=null;function jf(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Gf=typeof setTimeout=="function"?setTimeout:void 0,qb=typeof clearTimeout=="function"?clearTimeout:void 0,l_=typeof Promise=="function"?Promise:void 0,Zb=typeof queueMicrotask=="function"?queueMicrotask:typeof l_<"u"?function(n){return l_.resolve(null).then(n).catch(Hb)}:Gf;function Hb(n){setTimeout(function(){throw n})}function tf(n,o){var u=o,f=0;do{var _=u.nextSibling;if(n.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(f===0){n.removeChild(_),Hu(o);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=_}while(u);Hu(o)}function ds(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return n}function u_(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var u=n.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return n;o--}else u==="/$"&&o++}n=n.previousSibling}return null}var wl=Math.random().toString(36).slice(2),Ji="__reactFiber$"+wl,Ju="__reactProps$"+wl,ko="__reactContainer$"+wl,qf="__reactEvents$"+wl,Wb="__reactListeners$"+wl,Xb="__reactHandles$"+wl;function ra(n){var o=n[Ji];if(o)return o;for(var u=n.parentNode;u;){if(o=u[ko]||u[Ji]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(n=u_(n);n!==null;){if(u=n[Ji])return u;n=u_(n)}return o}n=u,u=n.parentNode}return null}function lc(n){return n=n[Ji]||n[ko],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ja(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Pe(33))}function Sd(n){return n[Ju]||null}var Zf=[],Qa=-1;function xs(n){return{current:n}}function an(n){0>Qa||(n.current=Zf[Qa],Zf[Qa]=null,Qa--)}function on(n,o){Qa++,Zf[Qa]=n.current,n.current=o}var _s={},cr=xs(_s),Br=xs(!1),la=_s;function dl(n,o){var u=n.type.contextTypes;if(!u)return _s;var f=n.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var _={},w;for(w in u)_[w]=o[w];return f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=_),_}function Fr(n){return n=n.childContextTypes,n!=null}function rd(){an(Br),an(cr)}function c_(n,o,u){if(cr.current!==_s)throw Error(Pe(168));on(cr,o),on(Br,u)}function sx(n,o,u){var f=n.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var _ in f)if(!(_ in o))throw Error(Pe(108,Dw(n)||"Unknown",_));return fn({},u,f)}function id(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||_s,la=cr.current,on(cr,n),on(Br,Br.current),!0}function h_(n,o,u){var f=n.stateNode;if(!f)throw Error(Pe(169));u?(n=sx(n,o,la),f.__reactInternalMemoizedMergedChildContext=n,an(Br),an(cr),on(cr,n)):an(Br),on(Br,u)}var wo=null,Ed=!1,nf=!1;function ax(n){wo===null?wo=[n]:wo.push(n)}function Kb(n){Ed=!0,ax(n)}function ws(){if(!nf&&wo!==null){nf=!0;var n=0,o=Zt;try{var u=wo;for(Zt=1;n<u.length;n++){var f=u[n];do f=f(!0);while(f!==null)}wo=null,Ed=!1}catch(_){throw wo!==null&&(wo=wo.slice(n+1)),Mv(Tm,ws),_}finally{Zt=o,nf=!1}}return null}var el=[],tl=0,od=null,sd=0,ci=[],hi=0,ua=null,bo=1,So="";function ta(n,o){el[tl++]=sd,el[tl++]=od,od=n,sd=o}function lx(n,o,u){ci[hi++]=bo,ci[hi++]=So,ci[hi++]=ua,ua=n;var f=bo;n=So;var _=32-Mi(f)-1;f&=~(1<<_),u+=1;var w=32-Mi(o)+_;if(30<w){var I=_-_%5;w=(f&(1<<I)-1).toString(32),f>>=I,_-=I,bo=1<<32-Mi(o)+_|u<<_|f,So=w+n}else bo=1<<w|u<<_|f,So=n}function Lm(n){n.return!==null&&(ta(n,1),lx(n,1,0))}function Rm(n){for(;n===od;)od=el[--tl],el[tl]=null,sd=el[--tl],el[tl]=null;for(;n===ua;)ua=ci[--hi],ci[hi]=null,So=ci[--hi],ci[hi]=null,bo=ci[--hi],ci[hi]=null}var Kr=null,Xr=null,cn=!1,Pi=null;function ux(n,o){var u=di(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=n,o=n.deletions,o===null?(n.deletions=[u],n.flags|=16):o.push(u)}function d_(n,o){switch(n.tag){case 5:var u=n.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(n.stateNode=o,Kr=n,Xr=ds(o.firstChild),!0):!1;case 6:return o=n.pendingProps===""||o.nodeType!==3?null:o,o!==null?(n.stateNode=o,Kr=n,Xr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=ua!==null?{id:bo,overflow:So}:null,n.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=di(18,null,null,0),u.stateNode=o,u.return=n,n.child=u,Kr=n,Xr=null,!0):!1;default:return!1}}function Hf(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Wf(n){if(cn){var o=Xr;if(o){var u=o;if(!d_(n,o)){if(Hf(n))throw Error(Pe(418));o=ds(u.nextSibling);var f=Kr;o&&d_(n,o)?ux(f,u):(n.flags=n.flags&-4097|2,cn=!1,Kr=n)}}else{if(Hf(n))throw Error(Pe(418));n.flags=n.flags&-4097|2,cn=!1,Kr=n}}}function p_(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Kr=n}function zh(n){if(n!==Kr)return!1;if(!cn)return p_(n),cn=!0,!1;var o;if((o=n.tag!==3)&&!(o=n.tag!==5)&&(o=n.type,o=o!=="head"&&o!=="body"&&!jf(n.type,n.memoizedProps)),o&&(o=Xr)){if(Hf(n))throw cx(),Error(Pe(418));for(;o;)ux(n,o),o=ds(o.nextSibling)}if(p_(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Pe(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8){var u=n.data;if(u==="/$"){if(o===0){Xr=ds(n.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}n=n.nextSibling}Xr=null}}else Xr=Kr?ds(n.stateNode.nextSibling):null;return!0}function cx(){for(var n=Xr;n;)n=ds(n.nextSibling)}function pl(){Xr=Kr=null,cn=!1}function Bm(n){Pi===null?Pi=[n]:Pi.push(n)}var Yb=zo.ReactCurrentBatchConfig;function zi(n,o){if(n&&n.defaultProps){o=fn({},o),n=n.defaultProps;for(var u in n)o[u]===void 0&&(o[u]=n[u]);return o}return o}var ad=xs(null),ld=null,nl=null,Fm=null;function Om(){Fm=nl=ld=null}function Nm(n){var o=ad.current;an(ad),n._currentValue=o}function Xf(n,o,u){for(;n!==null;){var f=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),n===u)break;n=n.return}}function ul(n,o){ld=n,Fm=nl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&o&&(Rr=!0),n.firstContext=null)}function fi(n){var o=n._currentValue;if(Fm!==n)if(n={context:n,memoizedValue:o,next:null},nl===null){if(ld===null)throw Error(Pe(308));nl=n,ld.dependencies={lanes:0,firstContext:n}}else nl=nl.next=n;return o}var ia=null;function Um(n){ia===null?ia=[n]:ia.push(n)}function hx(n,o,u,f){var _=o.interleaved;return _===null?(u.next=u,Um(o)):(u.next=_.next,_.next=u),o.interleaved=u,Co(n,f)}function Co(n,o){n.lanes|=o;var u=n.alternate;for(u!==null&&(u.lanes|=o),u=n,n=n.return;n!==null;)n.childLanes|=o,u=n.alternate,u!==null&&(u.childLanes|=o),u=n,n=n.return;return u.tag===3?u.stateNode:null}var rs=!1;function Vm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dx(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Eo(n,o){return{eventTime:n,lane:o,tag:0,payload:null,callback:null,next:null}}function ps(n,o,u){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,Ot&2){var _=f.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),f.pending=o,Co(n,u)}return _=f.interleaved,_===null?(o.next=o,Um(f)):(o.next=_.next,_.next=o),f.interleaved=o,Co(n,u)}function Vh(n,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var f=o.lanes;f&=n.pendingLanes,u|=f,o.lanes=u,km(n,u)}}function f_(n,o){var u=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var _=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var I={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?_=w=I:w=w.next=I,u=u.next}while(u!==null);w===null?_=w=o:w=w.next=o}else _=w=o;u={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:f.shared,effects:f.effects},n.updateQueue=u;return}n=u.lastBaseUpdate,n===null?u.firstBaseUpdate=o:n.next=o,u.lastBaseUpdate=o}function ud(n,o,u,f){var _=n.updateQueue;rs=!1;var w=_.firstBaseUpdate,I=_.lastBaseUpdate,l=_.shared.pending;if(l!==null){_.shared.pending=null;var N=l,j=N.next;N.next=null,I===null?w=j:I.next=j,I=N;var ae=n.alternate;ae!==null&&(ae=ae.updateQueue,l=ae.lastBaseUpdate,l!==I&&(l===null?ae.firstBaseUpdate=j:l.next=j,ae.lastBaseUpdate=N))}if(w!==null){var ne=_.baseState;I=0,ae=j=N=null,l=w;do{var q=l.lane,Ae=l.eventTime;if((f&q)===q){ae!==null&&(ae=ae.next={eventTime:Ae,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var Te=n,Ie=l;switch(q=o,Ae=u,Ie.tag){case 1:if(Te=Ie.payload,typeof Te=="function"){ne=Te.call(Ae,ne,q);break e}ne=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Ie.payload,q=typeof Te=="function"?Te.call(Ae,ne,q):Te,q==null)break e;ne=fn({},ne,q);break e;case 2:rs=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,q=_.effects,q===null?_.effects=[l]:q.push(l))}else Ae={eventTime:Ae,lane:q,tag:l.tag,payload:l.payload,callback:l.callback,next:null},ae===null?(j=ae=Ae,N=ne):ae=ae.next=Ae,I|=q;if(l=l.next,l===null){if(l=_.shared.pending,l===null)break;q=l,l=q.next,q.next=null,_.lastBaseUpdate=q,_.shared.pending=null}}while(1);if(ae===null&&(N=ne),_.baseState=N,_.firstBaseUpdate=j,_.lastBaseUpdate=ae,o=_.shared.interleaved,o!==null){_=o;do I|=_.lane,_=_.next;while(_!==o)}else w===null&&(_.shared.lanes=0);ha|=I,n.lanes=I,n.memoizedState=ne}}function m_(n,o,u){if(n=o.effects,o.effects=null,n!==null)for(o=0;o<n.length;o++){var f=n[o],_=f.callback;if(_!==null){if(f.callback=null,f=u,typeof _!="function")throw Error(Pe(191,_));_.call(f)}}}var px=new hv.Component().refs;function Kf(n,o,u,f){o=n.memoizedState,u=u(f,o),u=u==null?o:fn({},o,u),n.memoizedState=u,n.lanes===0&&(n.updateQueue.baseState=u)}var Td={isMounted:function(n){return(n=n._reactInternals)?fa(n)===n:!1},enqueueSetState:function(n,o,u){n=n._reactInternals;var f=Tr(),_=ms(n),w=Eo(f,_);w.payload=o,u!=null&&(w.callback=u),o=ps(n,w,_),o!==null&&(Di(o,n,_,f),Vh(o,n,_))},enqueueReplaceState:function(n,o,u){n=n._reactInternals;var f=Tr(),_=ms(n),w=Eo(f,_);w.tag=1,w.payload=o,u!=null&&(w.callback=u),o=ps(n,w,_),o!==null&&(Di(o,n,_,f),Vh(o,n,_))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var u=Tr(),f=ms(n),_=Eo(u,f);_.tag=2,o!=null&&(_.callback=o),o=ps(n,_,f),o!==null&&(Di(o,n,f,u),Vh(o,n,f))}};function g_(n,o,u,f,_,w,I){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,w,I):o.prototype&&o.prototype.isPureReactComponent?!Xu(u,f)||!Xu(_,w):!0}function fx(n,o,u){var f=!1,_=_s,w=o.contextType;return typeof w=="object"&&w!==null?w=fi(w):(_=Fr(o)?la:cr.current,f=o.contextTypes,w=(f=f!=null)?dl(n,_):_s),o=new o(u,w),n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Td,n.stateNode=o,o._reactInternals=n,f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=_,n.__reactInternalMemoizedMaskedChildContext=w),o}function y_(n,o,u,f){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==n&&Td.enqueueReplaceState(o,o.state,null)}function Yf(n,o,u,f){var _=n.stateNode;_.props=u,_.state=n.memoizedState,_.refs=px,Vm(n);var w=o.contextType;typeof w=="object"&&w!==null?_.context=fi(w):(w=Fr(o)?la:cr.current,_.context=dl(n,w)),_.state=n.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Kf(n,o,w,u),_.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&Td.enqueueReplaceState(_,_.state,null),ud(n,u,_,f),_.state=n.memoizedState),typeof _.componentDidMount=="function"&&(n.flags|=4194308)}function Eu(n,o,u){if(n=u.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(Pe(309));var f=u.stateNode}if(!f)throw Error(Pe(147,n));var _=f,w=""+n;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(I){var l=_.refs;l===px&&(l=_.refs={}),I===null?delete l[w]:l[w]=I},o._stringRef=w,o)}if(typeof n!="string")throw Error(Pe(284));if(!u._owner)throw Error(Pe(290,n))}return n}function Ah(n,o){throw n=Object.prototype.toString.call(o),Error(Pe(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n))}function __(n){var o=n._init;return o(n._payload)}function mx(n){function o(ee,H){if(n){var re=ee.deletions;re===null?(ee.deletions=[H],ee.flags|=16):re.push(H)}}function u(ee,H){if(!n)return null;for(;H!==null;)o(ee,H),H=H.sibling;return null}function f(ee,H){for(ee=new Map;H!==null;)H.key!==null?ee.set(H.key,H):ee.set(H.index,H),H=H.sibling;return ee}function _(ee,H){return ee=gs(ee,H),ee.index=0,ee.sibling=null,ee}function w(ee,H,re){return ee.index=re,n?(re=ee.alternate,re!==null?(re=re.index,re<H?(ee.flags|=2,H):re):(ee.flags|=2,H)):(ee.flags|=1048576,H)}function I(ee){return n&&ee.alternate===null&&(ee.flags|=2),ee}function l(ee,H,re,we){return H===null||H.tag!==6?(H=cf(re,ee.mode,we),H.return=ee,H):(H=_(H,re),H.return=ee,H)}function N(ee,H,re,we){var ze=re.type;return ze===Wa?ae(ee,H,re.props.children,we,re.key):H!==null&&(H.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===ns&&__(ze)===H.type)?(we=_(H,re.props),we.ref=Eu(ee,H,re),we.return=ee,we):(we=Hh(re.type,re.key,re.props,null,ee.mode,we),we.ref=Eu(ee,H,re),we.return=ee,we)}function j(ee,H,re,we){return H===null||H.tag!==4||H.stateNode.containerInfo!==re.containerInfo||H.stateNode.implementation!==re.implementation?(H=hf(re,ee.mode,we),H.return=ee,H):(H=_(H,re.children||[]),H.return=ee,H)}function ae(ee,H,re,we,ze){return H===null||H.tag!==7?(H=aa(re,ee.mode,we,ze),H.return=ee,H):(H=_(H,re),H.return=ee,H)}function ne(ee,H,re){if(typeof H=="string"&&H!==""||typeof H=="number")return H=cf(""+H,ee.mode,re),H.return=ee,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case vh:return re=Hh(H.type,H.key,H.props,null,ee.mode,re),re.ref=Eu(ee,null,H),re.return=ee,re;case Ha:return H=hf(H,ee.mode,re),H.return=ee,H;case ns:var we=H._init;return ne(ee,we(H._payload),re)}if(Iu(H)||vu(H))return H=aa(H,ee.mode,re,null),H.return=ee,H;Ah(ee,H)}return null}function q(ee,H,re,we){var ze=H!==null?H.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return ze!==null?null:l(ee,H,""+re,we);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case vh:return re.key===ze?N(ee,H,re,we):null;case Ha:return re.key===ze?j(ee,H,re,we):null;case ns:return ze=re._init,q(ee,H,ze(re._payload),we)}if(Iu(re)||vu(re))return ze!==null?null:ae(ee,H,re,we,null);Ah(ee,re)}return null}function Ae(ee,H,re,we,ze){if(typeof we=="string"&&we!==""||typeof we=="number")return ee=ee.get(re)||null,l(H,ee,""+we,ze);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case vh:return ee=ee.get(we.key===null?re:we.key)||null,N(H,ee,we,ze);case Ha:return ee=ee.get(we.key===null?re:we.key)||null,j(H,ee,we,ze);case ns:var He=we._init;return Ae(ee,H,re,He(we._payload),ze)}if(Iu(we)||vu(we))return ee=ee.get(re)||null,ae(H,ee,we,ze,null);Ah(H,we)}return null}function Te(ee,H,re,we){for(var ze=null,He=null,De=H,Fe=H=0,Mt=null;De!==null&&Fe<re.length;Fe++){De.index>Fe?(Mt=De,De=null):Mt=De.sibling;var st=q(ee,De,re[Fe],we);if(st===null){De===null&&(De=Mt);break}n&&De&&st.alternate===null&&o(ee,De),H=w(st,H,Fe),He===null?ze=st:He.sibling=st,He=st,De=Mt}if(Fe===re.length)return u(ee,De),cn&&ta(ee,Fe),ze;if(De===null){for(;Fe<re.length;Fe++)De=ne(ee,re[Fe],we),De!==null&&(H=w(De,H,Fe),He===null?ze=De:He.sibling=De,He=De);return cn&&ta(ee,Fe),ze}for(De=f(ee,De);Fe<re.length;Fe++)Mt=Ae(De,ee,Fe,re[Fe],we),Mt!==null&&(n&&Mt.alternate!==null&&De.delete(Mt.key===null?Fe:Mt.key),H=w(Mt,H,Fe),He===null?ze=Mt:He.sibling=Mt,He=Mt);return n&&De.forEach(function(nn){return o(ee,nn)}),cn&&ta(ee,Fe),ze}function Ie(ee,H,re,we){var ze=vu(re);if(typeof ze!="function")throw Error(Pe(150));if(re=ze.call(re),re==null)throw Error(Pe(151));for(var He=ze=null,De=H,Fe=H=0,Mt=null,st=re.next();De!==null&&!st.done;Fe++,st=re.next()){De.index>Fe?(Mt=De,De=null):Mt=De.sibling;var nn=q(ee,De,st.value,we);if(nn===null){De===null&&(De=Mt);break}n&&De&&nn.alternate===null&&o(ee,De),H=w(nn,H,Fe),He===null?ze=nn:He.sibling=nn,He=nn,De=Mt}if(st.done)return u(ee,De),cn&&ta(ee,Fe),ze;if(De===null){for(;!st.done;Fe++,st=re.next())st=ne(ee,st.value,we),st!==null&&(H=w(st,H,Fe),He===null?ze=st:He.sibling=st,He=st);return cn&&ta(ee,Fe),ze}for(De=f(ee,De);!st.done;Fe++,st=re.next())st=Ae(De,ee,Fe,st.value,we),st!==null&&(n&&st.alternate!==null&&De.delete(st.key===null?Fe:st.key),H=w(st,H,Fe),He===null?ze=st:He.sibling=st,He=st);return n&&De.forEach(function(Mn){return o(ee,Mn)}),cn&&ta(ee,Fe),ze}function bt(ee,H,re,we){if(typeof re=="object"&&re!==null&&re.type===Wa&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case vh:e:{for(var ze=re.key,He=H;He!==null;){if(He.key===ze){if(ze=re.type,ze===Wa){if(He.tag===7){u(ee,He.sibling),H=_(He,re.props.children),H.return=ee,ee=H;break e}}else if(He.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===ns&&__(ze)===He.type){u(ee,He.sibling),H=_(He,re.props),H.ref=Eu(ee,He,re),H.return=ee,ee=H;break e}u(ee,He);break}else o(ee,He);He=He.sibling}re.type===Wa?(H=aa(re.props.children,ee.mode,we,re.key),H.return=ee,ee=H):(we=Hh(re.type,re.key,re.props,null,ee.mode,we),we.ref=Eu(ee,H,re),we.return=ee,ee=we)}return I(ee);case Ha:e:{for(He=re.key;H!==null;){if(H.key===He)if(H.tag===4&&H.stateNode.containerInfo===re.containerInfo&&H.stateNode.implementation===re.implementation){u(ee,H.sibling),H=_(H,re.children||[]),H.return=ee,ee=H;break e}else{u(ee,H);break}else o(ee,H);H=H.sibling}H=hf(re,ee.mode,we),H.return=ee,ee=H}return I(ee);case ns:return He=re._init,bt(ee,H,He(re._payload),we)}if(Iu(re))return Te(ee,H,re,we);if(vu(re))return Ie(ee,H,re,we);Ah(ee,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,H!==null&&H.tag===6?(u(ee,H.sibling),H=_(H,re),H.return=ee,ee=H):(u(ee,H),H=cf(re,ee.mode,we),H.return=ee,ee=H),I(ee)):u(ee,H)}return bt}var fl=mx(!0),gx=mx(!1),uc={},eo=xs(uc),Qu=xs(uc),ec=xs(uc);function oa(n){if(n===uc)throw Error(Pe(174));return n}function $m(n,o){switch(on(ec,o),on(Qu,n),on(eo,uc),n=o.nodeType,n){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:zf(null,"");break;default:n=n===8?o.parentNode:o,o=n.namespaceURI||null,n=n.tagName,o=zf(o,n)}an(eo),on(eo,o)}function ml(){an(eo),an(Qu),an(ec)}function yx(n){oa(ec.current);var o=oa(eo.current),u=zf(o,n.type);o!==u&&(on(Qu,n),on(eo,u))}function jm(n){Qu.current===n&&(an(eo),an(Qu))}var dn=xs(0);function cd(n){for(var o=n;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var rf=[];function Gm(){for(var n=0;n<rf.length;n++)rf[n]._workInProgressVersionPrimary=null;rf.length=0}var $h=zo.ReactCurrentDispatcher,of=zo.ReactCurrentBatchConfig,ca=0,pn=null,Bn=null,Gn=null,hd=!1,Bu=!1,tc=0,Jb=0;function ar(){throw Error(Pe(321))}function qm(n,o){if(o===null)return!1;for(var u=0;u<o.length&&u<n.length;u++)if(!Li(n[u],o[u]))return!1;return!0}function Zm(n,o,u,f,_,w){if(ca=w,pn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,$h.current=n===null||n.memoizedState===null?n2:r2,n=u(f,_),Bu){w=0;do{if(Bu=!1,tc=0,25<=w)throw Error(Pe(301));w+=1,Gn=Bn=null,o.updateQueue=null,$h.current=i2,n=u(f,_)}while(Bu)}if($h.current=dd,o=Bn!==null&&Bn.next!==null,ca=0,Gn=Bn=pn=null,hd=!1,o)throw Error(Pe(300));return n}function Hm(){var n=tc!==0;return tc=0,n}function Yi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gn===null?pn.memoizedState=Gn=n:Gn=Gn.next=n,Gn}function mi(){if(Bn===null){var n=pn.alternate;n=n!==null?n.memoizedState:null}else n=Bn.next;var o=Gn===null?pn.memoizedState:Gn.next;if(o!==null)Gn=o,Bn=n;else{if(n===null)throw Error(Pe(310));Bn=n,n={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Gn===null?pn.memoizedState=Gn=n:Gn=Gn.next=n}return Gn}function nc(n,o){return typeof o=="function"?o(n):o}function sf(n){var o=mi(),u=o.queue;if(u===null)throw Error(Pe(311));u.lastRenderedReducer=n;var f=Bn,_=f.baseQueue,w=u.pending;if(w!==null){if(_!==null){var I=_.next;_.next=w.next,w.next=I}f.baseQueue=_=w,u.pending=null}if(_!==null){w=_.next,f=f.baseState;var l=I=null,N=null,j=w;do{var ae=j.lane;if((ca&ae)===ae)N!==null&&(N=N.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),f=j.hasEagerState?j.eagerState:n(f,j.action);else{var ne={lane:ae,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};N===null?(l=N=ne,I=f):N=N.next=ne,pn.lanes|=ae,ha|=ae}j=j.next}while(j!==null&&j!==w);N===null?I=f:N.next=l,Li(f,o.memoizedState)||(Rr=!0),o.memoizedState=f,o.baseState=I,o.baseQueue=N,u.lastRenderedState=f}if(n=u.interleaved,n!==null){_=n;do w=_.lane,pn.lanes|=w,ha|=w,_=_.next;while(_!==n)}else _===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function af(n){var o=mi(),u=o.queue;if(u===null)throw Error(Pe(311));u.lastRenderedReducer=n;var f=u.dispatch,_=u.pending,w=o.memoizedState;if(_!==null){u.pending=null;var I=_=_.next;do w=n(w,I.action),I=I.next;while(I!==_);Li(w,o.memoizedState)||(Rr=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,f]}function _x(){}function vx(n,o){var u=pn,f=mi(),_=o(),w=!Li(f.memoizedState,_);if(w&&(f.memoizedState=_,Rr=!0),f=f.queue,Wm(bx.bind(null,u,f,n),[n]),f.getSnapshot!==o||w||Gn!==null&&Gn.memoizedState.tag&1){if(u.flags|=2048,rc(9,wx.bind(null,u,f,_,o),void 0,null),qn===null)throw Error(Pe(349));ca&30||xx(u,o,_)}return _}function xx(n,o,u){n.flags|=16384,n={getSnapshot:o,value:u},o=pn.updateQueue,o===null?(o={lastEffect:null,stores:null},pn.updateQueue=o,o.stores=[n]):(u=o.stores,u===null?o.stores=[n]:u.push(n))}function wx(n,o,u,f){o.value=u,o.getSnapshot=f,Sx(o)&&Ex(n)}function bx(n,o,u){return u(function(){Sx(o)&&Ex(n)})}function Sx(n){var o=n.getSnapshot;n=n.value;try{var u=o();return!Li(n,u)}catch{return!0}}function Ex(n){var o=Co(n,1);o!==null&&Di(o,n,1,-1)}function v_(n){var o=Yi();return typeof n=="function"&&(n=n()),o.memoizedState=o.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nc,lastRenderedState:n},o.queue=n,n=n.dispatch=t2.bind(null,pn,n),[o.memoizedState,n]}function rc(n,o,u,f){return n={tag:n,create:o,destroy:u,deps:f,next:null},o=pn.updateQueue,o===null?(o={lastEffect:null,stores:null},pn.updateQueue=o,o.lastEffect=n.next=n):(u=o.lastEffect,u===null?o.lastEffect=n.next=n:(f=u.next,u.next=n,n.next=f,o.lastEffect=n)),n}function Tx(){return mi().memoizedState}function jh(n,o,u,f){var _=Yi();pn.flags|=n,_.memoizedState=rc(1|o,u,void 0,f===void 0?null:f)}function kd(n,o,u,f){var _=mi();f=f===void 0?null:f;var w=void 0;if(Bn!==null){var I=Bn.memoizedState;if(w=I.destroy,f!==null&&qm(f,I.deps)){_.memoizedState=rc(o,u,w,f);return}}pn.flags|=n,_.memoizedState=rc(1|o,u,w,f)}function x_(n,o){return jh(8390656,8,n,o)}function Wm(n,o){return kd(2048,8,n,o)}function kx(n,o){return kd(4,2,n,o)}function Cx(n,o){return kd(4,4,n,o)}function Ix(n,o){if(typeof o=="function")return n=n(),o(n),function(){o(null)};if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function zx(n,o,u){return u=u!=null?u.concat([n]):null,kd(4,4,Ix.bind(null,o,n),u)}function Xm(){}function Ax(n,o){var u=mi();o=o===void 0?null:o;var f=u.memoizedState;return f!==null&&o!==null&&qm(o,f[1])?f[0]:(u.memoizedState=[n,o],n)}function Px(n,o){var u=mi();o=o===void 0?null:o;var f=u.memoizedState;return f!==null&&o!==null&&qm(o,f[1])?f[0]:(n=n(),u.memoizedState=[n,o],n)}function Mx(n,o,u){return ca&21?(Li(u,o)||(u=Rv(),pn.lanes|=u,ha|=u,n.baseState=!0),o):(n.baseState&&(n.baseState=!1,Rr=!0),n.memoizedState=u)}function Qb(n,o){var u=Zt;Zt=u!==0&&4>u?u:4,n(!0);var f=of.transition;of.transition={};try{n(!1),o()}finally{Zt=u,of.transition=f}}function Dx(){return mi().memoizedState}function e2(n,o,u){var f=ms(n);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Lx(n))Rx(o,u);else if(u=hx(n,o,u,f),u!==null){var _=Tr();Di(u,n,f,_),Bx(u,o,f)}}function t2(n,o,u){var f=ms(n),_={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Lx(n))Rx(o,_);else{var w=n.alternate;if(n.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var I=o.lastRenderedState,l=w(I,u);if(_.hasEagerState=!0,_.eagerState=l,Li(l,I)){var N=o.interleaved;N===null?(_.next=_,Um(o)):(_.next=N.next,N.next=_),o.interleaved=_;return}}catch{}finally{}u=hx(n,o,_,f),u!==null&&(_=Tr(),Di(u,n,f,_),Bx(u,o,f))}}function Lx(n){var o=n.alternate;return n===pn||o!==null&&o===pn}function Rx(n,o){Bu=hd=!0;var u=n.pending;u===null?o.next=o:(o.next=u.next,u.next=o),n.pending=o}function Bx(n,o,u){if(u&4194240){var f=o.lanes;f&=n.pendingLanes,u|=f,o.lanes=u,km(n,u)}}var dd={readContext:fi,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},n2={readContext:fi,useCallback:function(n,o){return Yi().memoizedState=[n,o===void 0?null:o],n},useContext:fi,useEffect:x_,useImperativeHandle:function(n,o,u){return u=u!=null?u.concat([n]):null,jh(4194308,4,Ix.bind(null,o,n),u)},useLayoutEffect:function(n,o){return jh(4194308,4,n,o)},useInsertionEffect:function(n,o){return jh(4,2,n,o)},useMemo:function(n,o){var u=Yi();return o=o===void 0?null:o,n=n(),u.memoizedState=[n,o],n},useReducer:function(n,o,u){var f=Yi();return o=u!==void 0?u(o):o,f.memoizedState=f.baseState=o,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:o},f.queue=n,n=n.dispatch=e2.bind(null,pn,n),[f.memoizedState,n]},useRef:function(n){var o=Yi();return n={current:n},o.memoizedState=n},useState:v_,useDebugValue:Xm,useDeferredValue:function(n){return Yi().memoizedState=n},useTransition:function(){var n=v_(!1),o=n[0];return n=Qb.bind(null,n[1]),Yi().memoizedState=n,[o,n]},useMutableSource:function(){},useSyncExternalStore:function(n,o,u){var f=pn,_=Yi();if(cn){if(u===void 0)throw Error(Pe(407));u=u()}else{if(u=o(),qn===null)throw Error(Pe(349));ca&30||xx(f,o,u)}_.memoizedState=u;var w={value:u,getSnapshot:o};return _.queue=w,x_(bx.bind(null,f,w,n),[n]),f.flags|=2048,rc(9,wx.bind(null,f,w,u,o),void 0,null),u},useId:function(){var n=Yi(),o=qn.identifierPrefix;if(cn){var u=So,f=bo;u=(f&~(1<<32-Mi(f)-1)).toString(32)+u,o=":"+o+"R"+u,u=tc++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=Jb++,o=":"+o+"r"+u.toString(32)+":";return n.memoizedState=o},unstable_isNewReconciler:!1},r2={readContext:fi,useCallback:Ax,useContext:fi,useEffect:Wm,useImperativeHandle:zx,useInsertionEffect:kx,useLayoutEffect:Cx,useMemo:Px,useReducer:sf,useRef:Tx,useState:function(){return sf(nc)},useDebugValue:Xm,useDeferredValue:function(n){var o=mi();return Mx(o,Bn.memoizedState,n)},useTransition:function(){var n=sf(nc)[0],o=mi().memoizedState;return[n,o]},useMutableSource:_x,useSyncExternalStore:vx,useId:Dx,unstable_isNewReconciler:!1},i2={readContext:fi,useCallback:Ax,useContext:fi,useEffect:Wm,useImperativeHandle:zx,useInsertionEffect:kx,useLayoutEffect:Cx,useMemo:Px,useReducer:af,useRef:Tx,useState:function(){return af(nc)},useDebugValue:Xm,useDeferredValue:function(n){var o=mi();return Bn===null?o.memoizedState=n:Mx(o,Bn.memoizedState,n)},useTransition:function(){var n=af(nc)[0],o=mi().memoizedState;return[n,o]},useMutableSource:_x,useSyncExternalStore:vx,useId:Dx,unstable_isNewReconciler:!1};function gl(n,o){try{var u="",f=o;do u+=Mw(f),f=f.return;while(f);var _=u}catch(w){_=`
Error generating stack: `+w.message+`
`+w.stack}return{value:n,source:o,stack:_,digest:null}}function lf(n,o,u){return{value:n,source:null,stack:u??null,digest:o??null}}function Jf(n,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var o2=typeof WeakMap=="function"?WeakMap:Map;function Fx(n,o,u){u=Eo(-1,u),u.tag=3,u.payload={element:null};var f=o.value;return u.callback=function(){fd||(fd=!0,lm=f),Jf(n,o)},u}function Ox(n,o,u){u=Eo(-1,u),u.tag=3;var f=n.type.getDerivedStateFromError;if(typeof f=="function"){var _=o.value;u.payload=function(){return f(_)},u.callback=function(){Jf(n,o)}}var w=n.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){Jf(n,o),typeof f!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),u}function w_(n,o,u){var f=n.pingCache;if(f===null){f=n.pingCache=new o2;var _=new Set;f.set(o,_)}else _=f.get(o),_===void 0&&(_=new Set,f.set(o,_));_.has(u)||(_.add(u),n=v2.bind(null,n,o,u),o.then(n,n))}function b_(n){do{var o;if((o=n.tag===13)&&(o=n.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return n;n=n.return}while(n!==null);return null}function S_(n,o,u,f,_){return n.mode&1?(n.flags|=65536,n.lanes=_,n):(n===o?n.flags|=65536:(n.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=Eo(-1,1),o.tag=2,ps(u,o,1))),u.lanes|=1),n)}var s2=zo.ReactCurrentOwner,Rr=!1;function Er(n,o,u,f){o.child=n===null?gx(o,null,u,f):fl(o,n.child,u,f)}function E_(n,o,u,f,_){u=u.render;var w=o.ref;return ul(o,_),f=Zm(n,o,u,f,w,_),u=Hm(),n!==null&&!Rr?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,Io(n,o,_)):(cn&&u&&Lm(o),o.flags|=1,Er(n,o,f,_),o.child)}function T_(n,o,u,f,_){if(n===null){var w=u.type;return typeof w=="function"&&!rg(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=w,Nx(n,o,w,f,_)):(n=Hh(u.type,null,f,o,o.mode,_),n.ref=o.ref,n.return=o,o.child=n)}if(w=n.child,!(n.lanes&_)){var I=w.memoizedProps;if(u=u.compare,u=u!==null?u:Xu,u(I,f)&&n.ref===o.ref)return Io(n,o,_)}return o.flags|=1,n=gs(w,f),n.ref=o.ref,n.return=o,o.child=n}function Nx(n,o,u,f,_){if(n!==null){var w=n.memoizedProps;if(Xu(w,f)&&n.ref===o.ref)if(Rr=!1,o.pendingProps=f=w,(n.lanes&_)!==0)n.flags&131072&&(Rr=!0);else return o.lanes=n.lanes,Io(n,o,_)}return Qf(n,o,u,f,_)}function Ux(n,o,u){var f=o.pendingProps,_=f.children,w=n!==null?n.memoizedState:null;if(f.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},on(il,Wr),Wr|=u;else{if(!(u&1073741824))return n=w!==null?w.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:n,cachePool:null,transitions:null},o.updateQueue=null,on(il,Wr),Wr|=n,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:u,on(il,Wr),Wr|=f}else w!==null?(f=w.baseLanes|u,o.memoizedState=null):f=u,on(il,Wr),Wr|=f;return Er(n,o,_,u),o.child}function Vx(n,o){var u=o.ref;(n===null&&u!==null||n!==null&&n.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function Qf(n,o,u,f,_){var w=Fr(u)?la:cr.current;return w=dl(o,w),ul(o,_),u=Zm(n,o,u,f,w,_),f=Hm(),n!==null&&!Rr?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,Io(n,o,_)):(cn&&f&&Lm(o),o.flags|=1,Er(n,o,u,_),o.child)}function k_(n,o,u,f,_){if(Fr(u)){var w=!0;id(o)}else w=!1;if(ul(o,_),o.stateNode===null)Gh(n,o),fx(o,u,f),Yf(o,u,f,_),f=!0;else if(n===null){var I=o.stateNode,l=o.memoizedProps;I.props=l;var N=I.context,j=u.contextType;typeof j=="object"&&j!==null?j=fi(j):(j=Fr(u)?la:cr.current,j=dl(o,j));var ae=u.getDerivedStateFromProps,ne=typeof ae=="function"||typeof I.getSnapshotBeforeUpdate=="function";ne||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(l!==f||N!==j)&&y_(o,I,f,j),rs=!1;var q=o.memoizedState;I.state=q,ud(o,f,I,_),N=o.memoizedState,l!==f||q!==N||Br.current||rs?(typeof ae=="function"&&(Kf(o,u,ae,f),N=o.memoizedState),(l=rs||g_(o,u,l,f,q,N,j))?(ne||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=N),I.props=f,I.state=N,I.context=j,f=l):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{I=o.stateNode,dx(n,o),l=o.memoizedProps,j=o.type===o.elementType?l:zi(o.type,l),I.props=j,ne=o.pendingProps,q=I.context,N=u.contextType,typeof N=="object"&&N!==null?N=fi(N):(N=Fr(u)?la:cr.current,N=dl(o,N));var Ae=u.getDerivedStateFromProps;(ae=typeof Ae=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(l!==ne||q!==N)&&y_(o,I,f,N),rs=!1,q=o.memoizedState,I.state=q,ud(o,f,I,_);var Te=o.memoizedState;l!==ne||q!==Te||Br.current||rs?(typeof Ae=="function"&&(Kf(o,u,Ae,f),Te=o.memoizedState),(j=rs||g_(o,u,j,f,q,Te,N)||!1)?(ae||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(f,Te,N),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(f,Te,N)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||l===n.memoizedProps&&q===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&q===n.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=Te),I.props=f,I.state=Te,I.context=N,f=j):(typeof I.componentDidUpdate!="function"||l===n.memoizedProps&&q===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&q===n.memoizedState||(o.flags|=1024),f=!1)}return em(n,o,u,f,w,_)}function em(n,o,u,f,_,w){Vx(n,o);var I=(o.flags&128)!==0;if(!f&&!I)return _&&h_(o,u,!1),Io(n,o,w);f=o.stateNode,s2.current=o;var l=I&&typeof u.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,n!==null&&I?(o.child=fl(o,n.child,null,w),o.child=fl(o,null,l,w)):Er(n,o,l,w),o.memoizedState=f.state,_&&h_(o,u,!0),o.child}function $x(n){var o=n.stateNode;o.pendingContext?c_(n,o.pendingContext,o.pendingContext!==o.context):o.context&&c_(n,o.context,!1),$m(n,o.containerInfo)}function C_(n,o,u,f,_){return pl(),Bm(_),o.flags|=256,Er(n,o,u,f),o.child}var tm={dehydrated:null,treeContext:null,retryLane:0};function nm(n){return{baseLanes:n,cachePool:null,transitions:null}}function jx(n,o,u){var f=o.pendingProps,_=dn.current,w=!1,I=(o.flags&128)!==0,l;if((l=I)||(l=n!==null&&n.memoizedState===null?!1:(_&2)!==0),l?(w=!0,o.flags&=-129):(n===null||n.memoizedState!==null)&&(_|=1),on(dn,_&1),n===null)return Wf(o),n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(o.mode&1?n.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(I=f.children,n=f.fallback,w?(f=o.mode,w=o.child,I={mode:"hidden",children:I},!(f&1)&&w!==null?(w.childLanes=0,w.pendingProps=I):w=zd(I,f,0,null),n=aa(n,f,u,null),w.return=o,n.return=o,w.sibling=n,o.child=w,o.child.memoizedState=nm(u),o.memoizedState=tm,n):Km(o,I));if(_=n.memoizedState,_!==null&&(l=_.dehydrated,l!==null))return a2(n,o,I,f,l,_,u);if(w){w=f.fallback,I=o.mode,_=n.child,l=_.sibling;var N={mode:"hidden",children:f.children};return!(I&1)&&o.child!==_?(f=o.child,f.childLanes=0,f.pendingProps=N,o.deletions=null):(f=gs(_,N),f.subtreeFlags=_.subtreeFlags&14680064),l!==null?w=gs(l,w):(w=aa(w,I,u,null),w.flags|=2),w.return=o,f.return=o,f.sibling=w,o.child=f,f=w,w=o.child,I=n.child.memoizedState,I=I===null?nm(u):{baseLanes:I.baseLanes|u,cachePool:null,transitions:I.transitions},w.memoizedState=I,w.childLanes=n.childLanes&~u,o.memoizedState=tm,f}return w=n.child,n=w.sibling,f=gs(w,{mode:"visible",children:f.children}),!(o.mode&1)&&(f.lanes=u),f.return=o,f.sibling=null,n!==null&&(u=o.deletions,u===null?(o.deletions=[n],o.flags|=16):u.push(n)),o.child=f,o.memoizedState=null,f}function Km(n,o){return o=zd({mode:"visible",children:o},n.mode,0,null),o.return=n,n.child=o}function Ph(n,o,u,f){return f!==null&&Bm(f),fl(o,n.child,null,u),n=Km(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function a2(n,o,u,f,_,w,I){if(u)return o.flags&256?(o.flags&=-257,f=lf(Error(Pe(422))),Ph(n,o,I,f)):o.memoizedState!==null?(o.child=n.child,o.flags|=128,null):(w=f.fallback,_=o.mode,f=zd({mode:"visible",children:f.children},_,0,null),w=aa(w,_,I,null),w.flags|=2,f.return=o,w.return=o,f.sibling=w,o.child=f,o.mode&1&&fl(o,n.child,null,I),o.child.memoizedState=nm(I),o.memoizedState=tm,w);if(!(o.mode&1))return Ph(n,o,I,null);if(_.data==="$!"){if(f=_.nextSibling&&_.nextSibling.dataset,f)var l=f.dgst;return f=l,w=Error(Pe(419)),f=lf(w,f,void 0),Ph(n,o,I,f)}if(l=(I&n.childLanes)!==0,Rr||l){if(f=qn,f!==null){switch(I&-I){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(f.suspendedLanes|I)?0:_,_!==0&&_!==w.retryLane&&(w.retryLane=_,Co(n,_),Di(f,n,_,-1))}return ng(),f=lf(Error(Pe(421))),Ph(n,o,I,f)}return _.data==="$?"?(o.flags|=128,o.child=n.child,o=x2.bind(null,n),_._reactRetry=o,null):(n=w.treeContext,Xr=ds(_.nextSibling),Kr=o,cn=!0,Pi=null,n!==null&&(ci[hi++]=bo,ci[hi++]=So,ci[hi++]=ua,bo=n.id,So=n.overflow,ua=o),o=Km(o,f.children),o.flags|=4096,o)}function I_(n,o,u){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o),Xf(n.return,o,u)}function uf(n,o,u,f,_){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:_}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=u,w.tailMode=_)}function Gx(n,o,u){var f=o.pendingProps,_=f.revealOrder,w=f.tail;if(Er(n,o,f.children,u),f=dn.current,f&2)f=f&1|2,o.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&I_(n,u,o);else if(n.tag===19)I_(n,u,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}f&=1}if(on(dn,f),!(o.mode&1))o.memoizedState=null;else switch(_){case"forwards":for(u=o.child,_=null;u!==null;)n=u.alternate,n!==null&&cd(n)===null&&(_=u),u=u.sibling;u=_,u===null?(_=o.child,o.child=null):(_=u.sibling,u.sibling=null),uf(o,!1,_,u,w);break;case"backwards":for(u=null,_=o.child,o.child=null;_!==null;){if(n=_.alternate,n!==null&&cd(n)===null){o.child=_;break}n=_.sibling,_.sibling=u,u=_,_=n}uf(o,!0,u,null,w);break;case"together":uf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Gh(n,o){!(o.mode&1)&&n!==null&&(n.alternate=null,o.alternate=null,o.flags|=2)}function Io(n,o,u){if(n!==null&&(o.dependencies=n.dependencies),ha|=o.lanes,!(u&o.childLanes))return null;if(n!==null&&o.child!==n.child)throw Error(Pe(153));if(o.child!==null){for(n=o.child,u=gs(n,n.pendingProps),o.child=u,u.return=o;n.sibling!==null;)n=n.sibling,u=u.sibling=gs(n,n.pendingProps),u.return=o;u.sibling=null}return o.child}function l2(n,o,u){switch(o.tag){case 3:$x(o),pl();break;case 5:yx(o);break;case 1:Fr(o.type)&&id(o);break;case 4:$m(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,_=o.memoizedProps.value;on(ad,f._currentValue),f._currentValue=_;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(on(dn,dn.current&1),o.flags|=128,null):u&o.child.childLanes?jx(n,o,u):(on(dn,dn.current&1),n=Io(n,o,u),n!==null?n.sibling:null);on(dn,dn.current&1);break;case 19:if(f=(u&o.childLanes)!==0,n.flags&128){if(f)return Gx(n,o,u);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),on(dn,dn.current),f)break;return null;case 22:case 23:return o.lanes=0,Ux(n,o,u)}return Io(n,o,u)}var qx,rm,Zx,Hx;qx=function(n,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)n.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};rm=function(){};Zx=function(n,o,u,f){var _=n.memoizedProps;if(_!==f){n=o.stateNode,oa(eo.current);var w=null;switch(u){case"input":_=Tf(n,_),f=Tf(n,f),w=[];break;case"select":_=fn({},_,{value:void 0}),f=fn({},f,{value:void 0}),w=[];break;case"textarea":_=If(n,_),f=If(n,f),w=[];break;default:typeof _.onClick!="function"&&typeof f.onClick=="function"&&(n.onclick=nd)}Af(u,f);var I;u=null;for(j in _)if(!f.hasOwnProperty(j)&&_.hasOwnProperty(j)&&_[j]!=null)if(j==="style"){var l=_[j];for(I in l)l.hasOwnProperty(I)&&(u||(u={}),u[I]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&($u.hasOwnProperty(j)?w||(w=[]):(w=w||[]).push(j,null));for(j in f){var N=f[j];if(l=_!=null?_[j]:void 0,f.hasOwnProperty(j)&&N!==l&&(N!=null||l!=null))if(j==="style")if(l){for(I in l)!l.hasOwnProperty(I)||N&&N.hasOwnProperty(I)||(u||(u={}),u[I]="");for(I in N)N.hasOwnProperty(I)&&l[I]!==N[I]&&(u||(u={}),u[I]=N[I])}else u||(w||(w=[]),w.push(j,u)),u=N;else j==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,l=l?l.__html:void 0,N!=null&&l!==N&&(w=w||[]).push(j,N)):j==="children"?typeof N!="string"&&typeof N!="number"||(w=w||[]).push(j,""+N):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&($u.hasOwnProperty(j)?(N!=null&&j==="onScroll"&&sn("scroll",n),w||l===N||(w=[])):(w=w||[]).push(j,N))}u&&(w=w||[]).push("style",u);var j=w;(o.updateQueue=j)&&(o.flags|=4)}};Hx=function(n,o,u,f){u!==f&&(o.flags|=4)};function Tu(n,o){if(!cn)switch(n.tailMode){case"hidden":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n.tail=null:u.sibling=null;break;case"collapsed":u=n.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function lr(n){var o=n.alternate!==null&&n.alternate.child===n.child,u=0,f=0;if(o)for(var _=n.child;_!==null;)u|=_.lanes|_.childLanes,f|=_.subtreeFlags&14680064,f|=_.flags&14680064,_.return=n,_=_.sibling;else for(_=n.child;_!==null;)u|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=n,_=_.sibling;return n.subtreeFlags|=f,n.childLanes=u,o}function u2(n,o,u){var f=o.pendingProps;switch(Rm(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(o),null;case 1:return Fr(o.type)&&rd(),lr(o),null;case 3:return f=o.stateNode,ml(),an(Br),an(cr),Gm(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(n===null||n.child===null)&&(zh(o)?o.flags|=4:n===null||n.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Pi!==null&&(hm(Pi),Pi=null))),rm(n,o),lr(o),null;case 5:jm(o);var _=oa(ec.current);if(u=o.type,n!==null&&o.stateNode!=null)Zx(n,o,u,f,_),n.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(Pe(166));return lr(o),null}if(n=oa(eo.current),zh(o)){f=o.stateNode,u=o.type;var w=o.memoizedProps;switch(f[Ji]=o,f[Ju]=w,n=(o.mode&1)!==0,u){case"dialog":sn("cancel",f),sn("close",f);break;case"iframe":case"object":case"embed":sn("load",f);break;case"video":case"audio":for(_=0;_<Au.length;_++)sn(Au[_],f);break;case"source":sn("error",f);break;case"img":case"image":case"link":sn("error",f),sn("load",f);break;case"details":sn("toggle",f);break;case"input":Fy(f,w),sn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},sn("invalid",f);break;case"textarea":Ny(f,w),sn("invalid",f)}Af(u,w),_=null;for(var I in w)if(w.hasOwnProperty(I)){var l=w[I];I==="children"?typeof l=="string"?f.textContent!==l&&(w.suppressHydrationWarning!==!0&&Ih(f.textContent,l,n),_=["children",l]):typeof l=="number"&&f.textContent!==""+l&&(w.suppressHydrationWarning!==!0&&Ih(f.textContent,l,n),_=["children",""+l]):$u.hasOwnProperty(I)&&l!=null&&I==="onScroll"&&sn("scroll",f)}switch(u){case"input":xh(f),Oy(f,w,!0);break;case"textarea":xh(f),Uy(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=nd)}f=_,o.updateQueue=f,f!==null&&(o.flags|=4)}else{I=_.nodeType===9?_:_.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=xv(u)),n==="http://www.w3.org/1999/xhtml"?u==="script"?(n=I.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof f.is=="string"?n=I.createElement(u,{is:f.is}):(n=I.createElement(u),u==="select"&&(I=n,f.multiple?I.multiple=!0:f.size&&(I.size=f.size))):n=I.createElementNS(n,u),n[Ji]=o,n[Ju]=f,qx(n,o,!1,!1),o.stateNode=n;e:{switch(I=Pf(u,f),u){case"dialog":sn("cancel",n),sn("close",n),_=f;break;case"iframe":case"object":case"embed":sn("load",n),_=f;break;case"video":case"audio":for(_=0;_<Au.length;_++)sn(Au[_],n);_=f;break;case"source":sn("error",n),_=f;break;case"img":case"image":case"link":sn("error",n),sn("load",n),_=f;break;case"details":sn("toggle",n),_=f;break;case"input":Fy(n,f),_=Tf(n,f),sn("invalid",n);break;case"option":_=f;break;case"select":n._wrapperState={wasMultiple:!!f.multiple},_=fn({},f,{value:void 0}),sn("invalid",n);break;case"textarea":Ny(n,f),_=If(n,f),sn("invalid",n);break;default:_=f}Af(u,_),l=_;for(w in l)if(l.hasOwnProperty(w)){var N=l[w];w==="style"?Sv(n,N):w==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&wv(n,N)):w==="children"?typeof N=="string"?(u!=="textarea"||N!=="")&&ju(n,N):typeof N=="number"&&ju(n,""+N):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&($u.hasOwnProperty(w)?N!=null&&w==="onScroll"&&sn("scroll",n):N!=null&&xm(n,w,N,I))}switch(u){case"input":xh(n),Oy(n,f,!1);break;case"textarea":xh(n),Uy(n);break;case"option":f.value!=null&&n.setAttribute("value",""+ys(f.value));break;case"select":n.multiple=!!f.multiple,w=f.value,w!=null?ol(n,!!f.multiple,w,!1):f.defaultValue!=null&&ol(n,!!f.multiple,f.defaultValue,!0);break;default:typeof _.onClick=="function"&&(n.onclick=nd)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return lr(o),null;case 6:if(n&&o.stateNode!=null)Hx(n,o,n.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(Pe(166));if(u=oa(ec.current),oa(eo.current),zh(o)){if(f=o.stateNode,u=o.memoizedProps,f[Ji]=o,(w=f.nodeValue!==u)&&(n=Kr,n!==null))switch(n.tag){case 3:Ih(f.nodeValue,u,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ih(f.nodeValue,u,(n.mode&1)!==0)}w&&(o.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[Ji]=o,o.stateNode=f}return lr(o),null;case 13:if(an(dn),f=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(cn&&Xr!==null&&o.mode&1&&!(o.flags&128))cx(),pl(),o.flags|=98560,w=!1;else if(w=zh(o),f!==null&&f.dehydrated!==null){if(n===null){if(!w)throw Error(Pe(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(Pe(317));w[Ji]=o}else pl(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;lr(o),w=!1}else Pi!==null&&(hm(Pi),Pi=null),w=!0;if(!w)return o.flags&65536?o:null}return o.flags&128?(o.lanes=u,o):(f=f!==null,f!==(n!==null&&n.memoizedState!==null)&&f&&(o.child.flags|=8192,o.mode&1&&(n===null||dn.current&1?Fn===0&&(Fn=3):ng())),o.updateQueue!==null&&(o.flags|=4),lr(o),null);case 4:return ml(),rm(n,o),n===null&&Ku(o.stateNode.containerInfo),lr(o),null;case 10:return Nm(o.type._context),lr(o),null;case 17:return Fr(o.type)&&rd(),lr(o),null;case 19:if(an(dn),w=o.memoizedState,w===null)return lr(o),null;if(f=(o.flags&128)!==0,I=w.rendering,I===null)if(f)Tu(w,!1);else{if(Fn!==0||n!==null&&n.flags&128)for(n=o.child;n!==null;){if(I=cd(n),I!==null){for(o.flags|=128,Tu(w,!1),f=I.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=u,u=o.child;u!==null;)w=u,n=f,w.flags&=14680066,I=w.alternate,I===null?(w.childLanes=0,w.lanes=n,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=I.childLanes,w.lanes=I.lanes,w.child=I.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=I.memoizedProps,w.memoizedState=I.memoizedState,w.updateQueue=I.updateQueue,w.type=I.type,n=I.dependencies,w.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),u=u.sibling;return on(dn,dn.current&1|2),o.child}n=n.sibling}w.tail!==null&&Sn()>yl&&(o.flags|=128,f=!0,Tu(w,!1),o.lanes=4194304)}else{if(!f)if(n=cd(I),n!==null){if(o.flags|=128,f=!0,u=n.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Tu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!I.alternate&&!cn)return lr(o),null}else 2*Sn()-w.renderingStartTime>yl&&u!==1073741824&&(o.flags|=128,f=!0,Tu(w,!1),o.lanes=4194304);w.isBackwards?(I.sibling=o.child,o.child=I):(u=w.last,u!==null?u.sibling=I:o.child=I,w.last=I)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=Sn(),o.sibling=null,u=dn.current,on(dn,f?u&1|2:u&1),o):(lr(o),null);case 22:case 23:return tg(),f=o.memoizedState!==null,n!==null&&n.memoizedState!==null!==f&&(o.flags|=8192),f&&o.mode&1?Wr&1073741824&&(lr(o),o.subtreeFlags&6&&(o.flags|=8192)):lr(o),null;case 24:return null;case 25:return null}throw Error(Pe(156,o.tag))}function c2(n,o){switch(Rm(o),o.tag){case 1:return Fr(o.type)&&rd(),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return ml(),an(Br),an(cr),Gm(),n=o.flags,n&65536&&!(n&128)?(o.flags=n&-65537|128,o):null;case 5:return jm(o),null;case 13:if(an(dn),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(Pe(340));pl()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return an(dn),null;case 4:return ml(),null;case 10:return Nm(o.type._context),null;case 22:case 23:return tg(),null;case 24:return null;default:return null}}var Mh=!1,ur=!1,h2=typeof WeakSet=="function"?WeakSet:Set,tt=null;function rl(n,o){var u=n.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){vn(n,o,f)}else u.current=null}function im(n,o,u){try{u()}catch(f){vn(n,o,f)}}var z_=!1;function d2(n,o){if(Vf=Qh,n=Yv(),Dm(n)){if("selectionStart"in n)var u={start:n.selectionStart,end:n.selectionEnd};else e:{u=(u=n.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var _=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var I=0,l=-1,N=-1,j=0,ae=0,ne=n,q=null;t:for(;;){for(var Ae;ne!==u||_!==0&&ne.nodeType!==3||(l=I+_),ne!==w||f!==0&&ne.nodeType!==3||(N=I+f),ne.nodeType===3&&(I+=ne.nodeValue.length),(Ae=ne.firstChild)!==null;)q=ne,ne=Ae;for(;;){if(ne===n)break t;if(q===u&&++j===_&&(l=I),q===w&&++ae===f&&(N=I),(Ae=ne.nextSibling)!==null)break;ne=q,q=ne.parentNode}ne=Ae}u=l===-1||N===-1?null:{start:l,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for($f={focusedElem:n,selectionRange:u},Qh=!1,tt=o;tt!==null;)if(o=tt,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,tt=n;else for(;tt!==null;){o=tt;try{var Te=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var Ie=Te.memoizedProps,bt=Te.memoizedState,ee=o.stateNode,H=ee.getSnapshotBeforeUpdate(o.elementType===o.type?Ie:zi(o.type,Ie),bt);ee.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var re=o.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(we){vn(o,o.return,we)}if(n=o.sibling,n!==null){n.return=o.return,tt=n;break}tt=o.return}return Te=z_,z_=!1,Te}function Fu(n,o,u){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var _=f=f.next;do{if((_.tag&n)===n){var w=_.destroy;_.destroy=void 0,w!==void 0&&im(o,u,w)}_=_.next}while(_!==f)}}function Cd(n,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&n)===n){var f=u.create;u.destroy=f()}u=u.next}while(u!==o)}}function om(n){var o=n.ref;if(o!==null){var u=n.stateNode;switch(n.tag){case 5:n=u;break;default:n=u}typeof o=="function"?o(n):o.current=n}}function Wx(n){var o=n.alternate;o!==null&&(n.alternate=null,Wx(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&(delete o[Ji],delete o[Ju],delete o[qf],delete o[Wb],delete o[Xb])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Xx(n){return n.tag===5||n.tag===3||n.tag===4}function A_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Xx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function sm(n,o,u){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(n,o):u.insertBefore(n,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(n,u)):(o=u,o.appendChild(n)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=nd));else if(f!==4&&(n=n.child,n!==null))for(sm(n,o,u),n=n.sibling;n!==null;)sm(n,o,u),n=n.sibling}function am(n,o,u){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?u.insertBefore(n,o):u.appendChild(n);else if(f!==4&&(n=n.child,n!==null))for(am(n,o,u),n=n.sibling;n!==null;)am(n,o,u),n=n.sibling}var Kn=null,Ai=!1;function ts(n,o,u){for(u=u.child;u!==null;)Kx(n,o,u),u=u.sibling}function Kx(n,o,u){if(Qi&&typeof Qi.onCommitFiberUnmount=="function")try{Qi.onCommitFiberUnmount(vd,u)}catch{}switch(u.tag){case 5:ur||rl(u,o);case 6:var f=Kn,_=Ai;Kn=null,ts(n,o,u),Kn=f,Ai=_,Kn!==null&&(Ai?(n=Kn,u=u.stateNode,n.nodeType===8?n.parentNode.removeChild(u):n.removeChild(u)):Kn.removeChild(u.stateNode));break;case 18:Kn!==null&&(Ai?(n=Kn,u=u.stateNode,n.nodeType===8?tf(n.parentNode,u):n.nodeType===1&&tf(n,u),Hu(n)):tf(Kn,u.stateNode));break;case 4:f=Kn,_=Ai,Kn=u.stateNode.containerInfo,Ai=!0,ts(n,o,u),Kn=f,Ai=_;break;case 0:case 11:case 14:case 15:if(!ur&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){_=f=f.next;do{var w=_,I=w.destroy;w=w.tag,I!==void 0&&(w&2||w&4)&&im(u,o,I),_=_.next}while(_!==f)}ts(n,o,u);break;case 1:if(!ur&&(rl(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(l){vn(u,o,l)}ts(n,o,u);break;case 21:ts(n,o,u);break;case 22:u.mode&1?(ur=(f=ur)||u.memoizedState!==null,ts(n,o,u),ur=f):ts(n,o,u);break;default:ts(n,o,u)}}function P_(n){var o=n.updateQueue;if(o!==null){n.updateQueue=null;var u=n.stateNode;u===null&&(u=n.stateNode=new h2),o.forEach(function(f){var _=w2.bind(null,n,f);u.has(f)||(u.add(f),f.then(_,_))})}}function Ii(n,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var _=u[f];try{var w=n,I=o,l=I;e:for(;l!==null;){switch(l.tag){case 5:Kn=l.stateNode,Ai=!1;break e;case 3:Kn=l.stateNode.containerInfo,Ai=!0;break e;case 4:Kn=l.stateNode.containerInfo,Ai=!0;break e}l=l.return}if(Kn===null)throw Error(Pe(160));Kx(w,I,_),Kn=null,Ai=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(j){vn(_,o,j)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Yx(o,n),o=o.sibling}function Yx(n,o){var u=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ii(o,n),Ki(n),f&4){try{Fu(3,n,n.return),Cd(3,n)}catch(Ie){vn(n,n.return,Ie)}try{Fu(5,n,n.return)}catch(Ie){vn(n,n.return,Ie)}}break;case 1:Ii(o,n),Ki(n),f&512&&u!==null&&rl(u,u.return);break;case 5:if(Ii(o,n),Ki(n),f&512&&u!==null&&rl(u,u.return),n.flags&32){var _=n.stateNode;try{ju(_,"")}catch(Ie){vn(n,n.return,Ie)}}if(f&4&&(_=n.stateNode,_!=null)){var w=n.memoizedProps,I=u!==null?u.memoizedProps:w,l=n.type,N=n.updateQueue;if(n.updateQueue=null,N!==null)try{l==="input"&&w.type==="radio"&&w.name!=null&&_v(_,w),Pf(l,I);var j=Pf(l,w);for(I=0;I<N.length;I+=2){var ae=N[I],ne=N[I+1];ae==="style"?Sv(_,ne):ae==="dangerouslySetInnerHTML"?wv(_,ne):ae==="children"?ju(_,ne):xm(_,ae,ne,j)}switch(l){case"input":kf(_,w);break;case"textarea":vv(_,w);break;case"select":var q=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!w.multiple;var Ae=w.value;Ae!=null?ol(_,!!w.multiple,Ae,!1):q!==!!w.multiple&&(w.defaultValue!=null?ol(_,!!w.multiple,w.defaultValue,!0):ol(_,!!w.multiple,w.multiple?[]:"",!1))}_[Ju]=w}catch(Ie){vn(n,n.return,Ie)}}break;case 6:if(Ii(o,n),Ki(n),f&4){if(n.stateNode===null)throw Error(Pe(162));_=n.stateNode,w=n.memoizedProps;try{_.nodeValue=w}catch(Ie){vn(n,n.return,Ie)}}break;case 3:if(Ii(o,n),Ki(n),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Hu(o.containerInfo)}catch(Ie){vn(n,n.return,Ie)}break;case 4:Ii(o,n),Ki(n);break;case 13:Ii(o,n),Ki(n),_=n.child,_.flags&8192&&(w=_.memoizedState!==null,_.stateNode.isHidden=w,!w||_.alternate!==null&&_.alternate.memoizedState!==null||(Qm=Sn())),f&4&&P_(n);break;case 22:if(ae=u!==null&&u.memoizedState!==null,n.mode&1?(ur=(j=ur)||ae,Ii(o,n),ur=j):Ii(o,n),Ki(n),f&8192){if(j=n.memoizedState!==null,(n.stateNode.isHidden=j)&&!ae&&n.mode&1)for(tt=n,ae=n.child;ae!==null;){for(ne=tt=ae;tt!==null;){switch(q=tt,Ae=q.child,q.tag){case 0:case 11:case 14:case 15:Fu(4,q,q.return);break;case 1:rl(q,q.return);var Te=q.stateNode;if(typeof Te.componentWillUnmount=="function"){f=q,u=q.return;try{o=f,Te.props=o.memoizedProps,Te.state=o.memoizedState,Te.componentWillUnmount()}catch(Ie){vn(f,u,Ie)}}break;case 5:rl(q,q.return);break;case 22:if(q.memoizedState!==null){D_(ne);continue}}Ae!==null?(Ae.return=q,tt=Ae):D_(ne)}ae=ae.sibling}e:for(ae=null,ne=n;;){if(ne.tag===5){if(ae===null){ae=ne;try{_=ne.stateNode,j?(w=_.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(l=ne.stateNode,N=ne.memoizedProps.style,I=N!=null&&N.hasOwnProperty("display")?N.display:null,l.style.display=bv("display",I))}catch(Ie){vn(n,n.return,Ie)}}}else if(ne.tag===6){if(ae===null)try{ne.stateNode.nodeValue=j?"":ne.memoizedProps}catch(Ie){vn(n,n.return,Ie)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===n)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===n)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===n)break e;ae===ne&&(ae=null),ne=ne.return}ae===ne&&(ae=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:Ii(o,n),Ki(n),f&4&&P_(n);break;case 21:break;default:Ii(o,n),Ki(n)}}function Ki(n){var o=n.flags;if(o&2){try{e:{for(var u=n.return;u!==null;){if(Xx(u)){var f=u;break e}u=u.return}throw Error(Pe(160))}switch(f.tag){case 5:var _=f.stateNode;f.flags&32&&(ju(_,""),f.flags&=-33);var w=A_(n);am(n,w,_);break;case 3:case 4:var I=f.stateNode.containerInfo,l=A_(n);sm(n,l,I);break;default:throw Error(Pe(161))}}catch(N){vn(n,n.return,N)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function p2(n,o,u){tt=n,Jx(n)}function Jx(n,o,u){for(var f=(n.mode&1)!==0;tt!==null;){var _=tt,w=_.child;if(_.tag===22&&f){var I=_.memoizedState!==null||Mh;if(!I){var l=_.alternate,N=l!==null&&l.memoizedState!==null||ur;l=Mh;var j=ur;if(Mh=I,(ur=N)&&!j)for(tt=_;tt!==null;)I=tt,N=I.child,I.tag===22&&I.memoizedState!==null?L_(_):N!==null?(N.return=I,tt=N):L_(_);for(;w!==null;)tt=w,Jx(w),w=w.sibling;tt=_,Mh=l,ur=j}M_(n)}else _.subtreeFlags&8772&&w!==null?(w.return=_,tt=w):M_(n)}}function M_(n){for(;tt!==null;){var o=tt;if(o.flags&8772){var u=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ur||Cd(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!ur)if(u===null)f.componentDidMount();else{var _=o.elementType===o.type?u.memoizedProps:zi(o.type,u.memoizedProps);f.componentDidUpdate(_,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&m_(o,w,f);break;case 3:var I=o.updateQueue;if(I!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}m_(o,I,u)}break;case 5:var l=o.stateNode;if(u===null&&o.flags&4){u=l;var N=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&u.focus();break;case"img":N.src&&(u.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var j=o.alternate;if(j!==null){var ae=j.memoizedState;if(ae!==null){var ne=ae.dehydrated;ne!==null&&Hu(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}ur||o.flags&512&&om(o)}catch(q){vn(o,o.return,q)}}if(o===n){tt=null;break}if(u=o.sibling,u!==null){u.return=o.return,tt=u;break}tt=o.return}}function D_(n){for(;tt!==null;){var o=tt;if(o===n){tt=null;break}var u=o.sibling;if(u!==null){u.return=o.return,tt=u;break}tt=o.return}}function L_(n){for(;tt!==null;){var o=tt;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{Cd(4,o)}catch(N){vn(o,u,N)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var _=o.return;try{f.componentDidMount()}catch(N){vn(o,_,N)}}var w=o.return;try{om(o)}catch(N){vn(o,w,N)}break;case 5:var I=o.return;try{om(o)}catch(N){vn(o,I,N)}}}catch(N){vn(o,o.return,N)}if(o===n){tt=null;break}var l=o.sibling;if(l!==null){l.return=o.return,tt=l;break}tt=o.return}}var f2=Math.ceil,pd=zo.ReactCurrentDispatcher,Ym=zo.ReactCurrentOwner,pi=zo.ReactCurrentBatchConfig,Ot=0,qn=null,Pn=null,Yn=0,Wr=0,il=xs(0),Fn=0,ic=null,ha=0,Id=0,Jm=0,Ou=null,Lr=null,Qm=0,yl=1/0,xo=null,fd=!1,lm=null,fs=null,Dh=!1,ls=null,md=0,Nu=0,um=null,qh=-1,Zh=0;function Tr(){return Ot&6?Sn():qh!==-1?qh:qh=Sn()}function ms(n){return n.mode&1?Ot&2&&Yn!==0?Yn&-Yn:Yb.transition!==null?(Zh===0&&(Zh=Rv()),Zh):(n=Zt,n!==0||(n=window.event,n=n===void 0?16:$v(n.type)),n):1}function Di(n,o,u,f){if(50<Nu)throw Nu=0,um=null,Error(Pe(185));sc(n,u,f),(!(Ot&2)||n!==qn)&&(n===qn&&(!(Ot&2)&&(Id|=u),Fn===4&&os(n,Yn)),Or(n,f),u===1&&Ot===0&&!(o.mode&1)&&(yl=Sn()+500,Ed&&ws()))}function Or(n,o){var u=n.callbackNode;Yw(n,o);var f=Jh(n,n===qn?Yn:0);if(f===0)u!==null&&jy(u),n.callbackNode=null,n.callbackPriority=0;else if(o=f&-f,n.callbackPriority!==o){if(u!=null&&jy(u),o===1)n.tag===0?Kb(R_.bind(null,n)):ax(R_.bind(null,n)),Zb(function(){!(Ot&6)&&ws()}),u=null;else{switch(Bv(f)){case 1:u=Tm;break;case 4:u=Dv;break;case 16:u=Yh;break;case 536870912:u=Lv;break;default:u=Yh}u=s0(u,Qx.bind(null,n))}n.callbackPriority=o,n.callbackNode=u}}function Qx(n,o){if(qh=-1,Zh=0,Ot&6)throw Error(Pe(327));var u=n.callbackNode;if(cl()&&n.callbackNode!==u)return null;var f=Jh(n,n===qn?Yn:0);if(f===0)return null;if(f&30||f&n.expiredLanes||o)o=gd(n,f);else{o=f;var _=Ot;Ot|=2;var w=t0();(qn!==n||Yn!==o)&&(xo=null,yl=Sn()+500,sa(n,o));do try{y2();break}catch(l){e0(n,l)}while(1);Om(),pd.current=w,Ot=_,Pn!==null?o=0:(qn=null,Yn=0,o=Fn)}if(o!==0){if(o===2&&(_=Bf(n),_!==0&&(f=_,o=cm(n,_))),o===1)throw u=ic,sa(n,0),os(n,f),Or(n,Sn()),u;if(o===6)os(n,f);else{if(_=n.current.alternate,!(f&30)&&!m2(_)&&(o=gd(n,f),o===2&&(w=Bf(n),w!==0&&(f=w,o=cm(n,w))),o===1))throw u=ic,sa(n,0),os(n,f),Or(n,Sn()),u;switch(n.finishedWork=_,n.finishedLanes=f,o){case 0:case 1:throw Error(Pe(345));case 2:na(n,Lr,xo);break;case 3:if(os(n,f),(f&130023424)===f&&(o=Qm+500-Sn(),10<o)){if(Jh(n,0)!==0)break;if(_=n.suspendedLanes,(_&f)!==f){Tr(),n.pingedLanes|=n.suspendedLanes&_;break}n.timeoutHandle=Gf(na.bind(null,n,Lr,xo),o);break}na(n,Lr,xo);break;case 4:if(os(n,f),(f&4194240)===f)break;for(o=n.eventTimes,_=-1;0<f;){var I=31-Mi(f);w=1<<I,I=o[I],I>_&&(_=I),f&=~w}if(f=_,f=Sn()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*f2(f/1960))-f,10<f){n.timeoutHandle=Gf(na.bind(null,n,Lr,xo),f);break}na(n,Lr,xo);break;case 5:na(n,Lr,xo);break;default:throw Error(Pe(329))}}}return Or(n,Sn()),n.callbackNode===u?Qx.bind(null,n):null}function cm(n,o){var u=Ou;return n.current.memoizedState.isDehydrated&&(sa(n,o).flags|=256),n=gd(n,o),n!==2&&(o=Lr,Lr=u,o!==null&&hm(o)),n}function hm(n){Lr===null?Lr=n:Lr.push.apply(Lr,n)}function m2(n){for(var o=n;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var _=u[f],w=_.getSnapshot;_=_.value;try{if(!Li(w(),_))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function os(n,o){for(o&=~Jm,o&=~Id,n.suspendedLanes|=o,n.pingedLanes&=~o,n=n.expirationTimes;0<o;){var u=31-Mi(o),f=1<<u;n[u]=-1,o&=~f}}function R_(n){if(Ot&6)throw Error(Pe(327));cl();var o=Jh(n,0);if(!(o&1))return Or(n,Sn()),null;var u=gd(n,o);if(n.tag!==0&&u===2){var f=Bf(n);f!==0&&(o=f,u=cm(n,f))}if(u===1)throw u=ic,sa(n,0),os(n,o),Or(n,Sn()),u;if(u===6)throw Error(Pe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=o,na(n,Lr,xo),Or(n,Sn()),null}function eg(n,o){var u=Ot;Ot|=1;try{return n(o)}finally{Ot=u,Ot===0&&(yl=Sn()+500,Ed&&ws())}}function da(n){ls!==null&&ls.tag===0&&!(Ot&6)&&cl();var o=Ot;Ot|=1;var u=pi.transition,f=Zt;try{if(pi.transition=null,Zt=1,n)return n()}finally{Zt=f,pi.transition=u,Ot=o,!(Ot&6)&&ws()}}function tg(){Wr=il.current,an(il)}function sa(n,o){n.finishedWork=null,n.finishedLanes=0;var u=n.timeoutHandle;if(u!==-1&&(n.timeoutHandle=-1,qb(u)),Pn!==null)for(u=Pn.return;u!==null;){var f=u;switch(Rm(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&rd();break;case 3:ml(),an(Br),an(cr),Gm();break;case 5:jm(f);break;case 4:ml();break;case 13:an(dn);break;case 19:an(dn);break;case 10:Nm(f.type._context);break;case 22:case 23:tg()}u=u.return}if(qn=n,Pn=n=gs(n.current,null),Yn=Wr=o,Fn=0,ic=null,Jm=Id=ha=0,Lr=Ou=null,ia!==null){for(o=0;o<ia.length;o++)if(u=ia[o],f=u.interleaved,f!==null){u.interleaved=null;var _=f.next,w=u.pending;if(w!==null){var I=w.next;w.next=_,f.next=I}u.pending=f}ia=null}return n}function e0(n,o){do{var u=Pn;try{if(Om(),$h.current=dd,hd){for(var f=pn.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}hd=!1}if(ca=0,Gn=Bn=pn=null,Bu=!1,tc=0,Ym.current=null,u===null||u.return===null){Fn=1,ic=o,Pn=null;break}e:{var w=n,I=u.return,l=u,N=o;if(o=Yn,l.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var j=N,ae=l,ne=ae.tag;if(!(ae.mode&1)&&(ne===0||ne===11||ne===15)){var q=ae.alternate;q?(ae.updateQueue=q.updateQueue,ae.memoizedState=q.memoizedState,ae.lanes=q.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var Ae=b_(I);if(Ae!==null){Ae.flags&=-257,S_(Ae,I,l,w,o),Ae.mode&1&&w_(w,j,o),o=Ae,N=j;var Te=o.updateQueue;if(Te===null){var Ie=new Set;Ie.add(N),o.updateQueue=Ie}else Te.add(N);break e}else{if(!(o&1)){w_(w,j,o),ng();break e}N=Error(Pe(426))}}else if(cn&&l.mode&1){var bt=b_(I);if(bt!==null){!(bt.flags&65536)&&(bt.flags|=256),S_(bt,I,l,w,o),Bm(gl(N,l));break e}}w=N=gl(N,l),Fn!==4&&(Fn=2),Ou===null?Ou=[w]:Ou.push(w),w=I;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var ee=Fx(w,N,o);f_(w,ee);break e;case 1:l=N;var H=w.type,re=w.stateNode;if(!(w.flags&128)&&(typeof H.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(fs===null||!fs.has(re)))){w.flags|=65536,o&=-o,w.lanes|=o;var we=Ox(w,l,o);f_(w,we);break e}}w=w.return}while(w!==null)}r0(u)}catch(ze){o=ze,Pn===u&&u!==null&&(Pn=u=u.return);continue}break}while(1)}function t0(){var n=pd.current;return pd.current=dd,n===null?dd:n}function ng(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),qn===null||!(ha&268435455)&&!(Id&268435455)||os(qn,Yn)}function gd(n,o){var u=Ot;Ot|=2;var f=t0();(qn!==n||Yn!==o)&&(xo=null,sa(n,o));do try{g2();break}catch(_){e0(n,_)}while(1);if(Om(),Ot=u,pd.current=f,Pn!==null)throw Error(Pe(261));return qn=null,Yn=0,Fn}function g2(){for(;Pn!==null;)n0(Pn)}function y2(){for(;Pn!==null&&!$w();)n0(Pn)}function n0(n){var o=o0(n.alternate,n,Wr);n.memoizedProps=n.pendingProps,o===null?r0(n):Pn=o,Ym.current=null}function r0(n){var o=n;do{var u=o.alternate;if(n=o.return,o.flags&32768){if(u=c2(u,o),u!==null){u.flags&=32767,Pn=u;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Fn=6,Pn=null;return}}else if(u=u2(u,o,Wr),u!==null){Pn=u;return}if(o=o.sibling,o!==null){Pn=o;return}Pn=o=n}while(o!==null);Fn===0&&(Fn=5)}function na(n,o,u){var f=Zt,_=pi.transition;try{pi.transition=null,Zt=1,_2(n,o,u,f)}finally{pi.transition=_,Zt=f}return null}function _2(n,o,u,f){do cl();while(ls!==null);if(Ot&6)throw Error(Pe(327));u=n.finishedWork;var _=n.finishedLanes;if(u===null)return null;if(n.finishedWork=null,n.finishedLanes=0,u===n.current)throw Error(Pe(177));n.callbackNode=null,n.callbackPriority=0;var w=u.lanes|u.childLanes;if(Jw(n,w),n===qn&&(Pn=qn=null,Yn=0),!(u.subtreeFlags&2064)&&!(u.flags&2064)||Dh||(Dh=!0,s0(Yh,function(){return cl(),null})),w=(u.flags&15990)!==0,u.subtreeFlags&15990||w){w=pi.transition,pi.transition=null;var I=Zt;Zt=1;var l=Ot;Ot|=4,Ym.current=null,d2(n,u),Yx(u,n),Ob($f),Qh=!!Vf,$f=Vf=null,n.current=u,p2(u),jw(),Ot=l,Zt=I,pi.transition=w}else n.current=u;if(Dh&&(Dh=!1,ls=n,md=_),w=n.pendingLanes,w===0&&(fs=null),Zw(u.stateNode),Or(n,Sn()),o!==null)for(f=n.onRecoverableError,u=0;u<o.length;u++)_=o[u],f(_.value,{componentStack:_.stack,digest:_.digest});if(fd)throw fd=!1,n=lm,lm=null,n;return md&1&&n.tag!==0&&cl(),w=n.pendingLanes,w&1?n===um?Nu++:(Nu=0,um=n):Nu=0,ws(),null}function cl(){if(ls!==null){var n=Bv(md),o=pi.transition,u=Zt;try{if(pi.transition=null,Zt=16>n?16:n,ls===null)var f=!1;else{if(n=ls,ls=null,md=0,Ot&6)throw Error(Pe(331));var _=Ot;for(Ot|=4,tt=n.current;tt!==null;){var w=tt,I=w.child;if(tt.flags&16){var l=w.deletions;if(l!==null){for(var N=0;N<l.length;N++){var j=l[N];for(tt=j;tt!==null;){var ae=tt;switch(ae.tag){case 0:case 11:case 15:Fu(8,ae,w)}var ne=ae.child;if(ne!==null)ne.return=ae,tt=ne;else for(;tt!==null;){ae=tt;var q=ae.sibling,Ae=ae.return;if(Wx(ae),ae===j){tt=null;break}if(q!==null){q.return=Ae,tt=q;break}tt=Ae}}}var Te=w.alternate;if(Te!==null){var Ie=Te.child;if(Ie!==null){Te.child=null;do{var bt=Ie.sibling;Ie.sibling=null,Ie=bt}while(Ie!==null)}}tt=w}}if(w.subtreeFlags&2064&&I!==null)I.return=w,tt=I;else e:for(;tt!==null;){if(w=tt,w.flags&2048)switch(w.tag){case 0:case 11:case 15:Fu(9,w,w.return)}var ee=w.sibling;if(ee!==null){ee.return=w.return,tt=ee;break e}tt=w.return}}var H=n.current;for(tt=H;tt!==null;){I=tt;var re=I.child;if(I.subtreeFlags&2064&&re!==null)re.return=I,tt=re;else e:for(I=H;tt!==null;){if(l=tt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Cd(9,l)}}catch(ze){vn(l,l.return,ze)}if(l===I){tt=null;break e}var we=l.sibling;if(we!==null){we.return=l.return,tt=we;break e}tt=l.return}}if(Ot=_,ws(),Qi&&typeof Qi.onPostCommitFiberRoot=="function")try{Qi.onPostCommitFiberRoot(vd,n)}catch{}f=!0}return f}finally{Zt=u,pi.transition=o}}return!1}function B_(n,o,u){o=gl(u,o),o=Fx(n,o,1),n=ps(n,o,1),o=Tr(),n!==null&&(sc(n,1,o),Or(n,o))}function vn(n,o,u){if(n.tag===3)B_(n,n,u);else for(;o!==null;){if(o.tag===3){B_(o,n,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(fs===null||!fs.has(f))){n=gl(u,n),n=Ox(o,n,1),o=ps(o,n,1),n=Tr(),o!==null&&(sc(o,1,n),Or(o,n));break}}o=o.return}}function v2(n,o,u){var f=n.pingCache;f!==null&&f.delete(o),o=Tr(),n.pingedLanes|=n.suspendedLanes&u,qn===n&&(Yn&u)===u&&(Fn===4||Fn===3&&(Yn&130023424)===Yn&&500>Sn()-Qm?sa(n,0):Jm|=u),Or(n,o)}function i0(n,o){o===0&&(n.mode&1?(o=Sh,Sh<<=1,!(Sh&130023424)&&(Sh=4194304)):o=1);var u=Tr();n=Co(n,o),n!==null&&(sc(n,o,u),Or(n,u))}function x2(n){var o=n.memoizedState,u=0;o!==null&&(u=o.retryLane),i0(n,u)}function w2(n,o){var u=0;switch(n.tag){case 13:var f=n.stateNode,_=n.memoizedState;_!==null&&(u=_.retryLane);break;case 19:f=n.stateNode;break;default:throw Error(Pe(314))}f!==null&&f.delete(o),i0(n,u)}var o0;o0=function(n,o,u){if(n!==null)if(n.memoizedProps!==o.pendingProps||Br.current)Rr=!0;else{if(!(n.lanes&u)&&!(o.flags&128))return Rr=!1,l2(n,o,u);Rr=!!(n.flags&131072)}else Rr=!1,cn&&o.flags&1048576&&lx(o,sd,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;Gh(n,o),n=o.pendingProps;var _=dl(o,cr.current);ul(o,u),_=Zm(null,o,f,n,_,u);var w=Hm();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Fr(f)?(w=!0,id(o)):w=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Vm(o),_.updater=Td,o.stateNode=_,_._reactInternals=o,Yf(o,f,n,u),o=em(null,o,f,!0,w,u)):(o.tag=0,cn&&w&&Lm(o),Er(null,o,_,u),o=o.child),o;case 16:f=o.elementType;e:{switch(Gh(n,o),n=o.pendingProps,_=f._init,f=_(f._payload),o.type=f,_=o.tag=S2(f),n=zi(f,n),_){case 0:o=Qf(null,o,f,n,u);break e;case 1:o=k_(null,o,f,n,u);break e;case 11:o=E_(null,o,f,n,u);break e;case 14:o=T_(null,o,f,zi(f.type,n),u);break e}throw Error(Pe(306,f,""))}return o;case 0:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:zi(f,_),Qf(n,o,f,_,u);case 1:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:zi(f,_),k_(n,o,f,_,u);case 3:e:{if($x(o),n===null)throw Error(Pe(387));f=o.pendingProps,w=o.memoizedState,_=w.element,dx(n,o),ud(o,f,null,u);var I=o.memoizedState;if(f=I.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){_=gl(Error(Pe(423)),o),o=C_(n,o,f,u,_);break e}else if(f!==_){_=gl(Error(Pe(424)),o),o=C_(n,o,f,u,_);break e}else for(Xr=ds(o.stateNode.containerInfo.firstChild),Kr=o,cn=!0,Pi=null,u=gx(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(pl(),f===_){o=Io(n,o,u);break e}Er(n,o,f,u)}o=o.child}return o;case 5:return yx(o),n===null&&Wf(o),f=o.type,_=o.pendingProps,w=n!==null?n.memoizedProps:null,I=_.children,jf(f,_)?I=null:w!==null&&jf(f,w)&&(o.flags|=32),Vx(n,o),Er(n,o,I,u),o.child;case 6:return n===null&&Wf(o),null;case 13:return jx(n,o,u);case 4:return $m(o,o.stateNode.containerInfo),f=o.pendingProps,n===null?o.child=fl(o,null,f,u):Er(n,o,f,u),o.child;case 11:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:zi(f,_),E_(n,o,f,_,u);case 7:return Er(n,o,o.pendingProps,u),o.child;case 8:return Er(n,o,o.pendingProps.children,u),o.child;case 12:return Er(n,o,o.pendingProps.children,u),o.child;case 10:e:{if(f=o.type._context,_=o.pendingProps,w=o.memoizedProps,I=_.value,on(ad,f._currentValue),f._currentValue=I,w!==null)if(Li(w.value,I)){if(w.children===_.children&&!Br.current){o=Io(n,o,u);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var l=w.dependencies;if(l!==null){I=w.child;for(var N=l.firstContext;N!==null;){if(N.context===f){if(w.tag===1){N=Eo(-1,u&-u),N.tag=2;var j=w.updateQueue;if(j!==null){j=j.shared;var ae=j.pending;ae===null?N.next=N:(N.next=ae.next,ae.next=N),j.pending=N}}w.lanes|=u,N=w.alternate,N!==null&&(N.lanes|=u),Xf(w.return,u,o),l.lanes|=u;break}N=N.next}}else if(w.tag===10)I=w.type===o.type?null:w.child;else if(w.tag===18){if(I=w.return,I===null)throw Error(Pe(341));I.lanes|=u,l=I.alternate,l!==null&&(l.lanes|=u),Xf(I,u,o),I=w.sibling}else I=w.child;if(I!==null)I.return=w;else for(I=w;I!==null;){if(I===o){I=null;break}if(w=I.sibling,w!==null){w.return=I.return,I=w;break}I=I.return}w=I}Er(n,o,_.children,u),o=o.child}return o;case 9:return _=o.type,f=o.pendingProps.children,ul(o,u),_=fi(_),f=f(_),o.flags|=1,Er(n,o,f,u),o.child;case 14:return f=o.type,_=zi(f,o.pendingProps),_=zi(f.type,_),T_(n,o,f,_,u);case 15:return Nx(n,o,o.type,o.pendingProps,u);case 17:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:zi(f,_),Gh(n,o),o.tag=1,Fr(f)?(n=!0,id(o)):n=!1,ul(o,u),fx(o,f,_),Yf(o,f,_,u),em(null,o,f,!0,n,u);case 19:return Gx(n,o,u);case 22:return Ux(n,o,u)}throw Error(Pe(156,o.tag))};function s0(n,o){return Mv(n,o)}function b2(n,o,u,f){this.tag=n,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(n,o,u,f){return new b2(n,o,u,f)}function rg(n){return n=n.prototype,!(!n||!n.isReactComponent)}function S2(n){if(typeof n=="function")return rg(n)?1:0;if(n!=null){if(n=n.$$typeof,n===bm)return 11;if(n===Sm)return 14}return 2}function gs(n,o){var u=n.alternate;return u===null?(u=di(n.tag,o,n.key,n.mode),u.elementType=n.elementType,u.type=n.type,u.stateNode=n.stateNode,u.alternate=n,n.alternate=u):(u.pendingProps=o,u.type=n.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=n.flags&14680064,u.childLanes=n.childLanes,u.lanes=n.lanes,u.child=n.child,u.memoizedProps=n.memoizedProps,u.memoizedState=n.memoizedState,u.updateQueue=n.updateQueue,o=n.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=n.sibling,u.index=n.index,u.ref=n.ref,u}function Hh(n,o,u,f,_,w){var I=2;if(f=n,typeof n=="function")rg(n)&&(I=1);else if(typeof n=="string")I=5;else e:switch(n){case Wa:return aa(u.children,_,w,o);case wm:I=8,_|=8;break;case wf:return n=di(12,u,o,_|2),n.elementType=wf,n.lanes=w,n;case bf:return n=di(13,u,o,_),n.elementType=bf,n.lanes=w,n;case Sf:return n=di(19,u,o,_),n.elementType=Sf,n.lanes=w,n;case mv:return zd(u,_,w,o);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case pv:I=10;break e;case fv:I=9;break e;case bm:I=11;break e;case Sm:I=14;break e;case ns:I=16,f=null;break e}throw Error(Pe(130,n==null?n:typeof n,""))}return o=di(I,u,o,_),o.elementType=n,o.type=f,o.lanes=w,o}function aa(n,o,u,f){return n=di(7,n,f,o),n.lanes=u,n}function zd(n,o,u,f){return n=di(22,n,f,o),n.elementType=mv,n.lanes=u,n.stateNode={isHidden:!1},n}function cf(n,o,u){return n=di(6,n,null,o),n.lanes=u,n}function hf(n,o,u){return o=di(4,n.children!==null?n.children:[],n.key,o),o.lanes=u,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}function E2(n,o,u,f,_){this.tag=o,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gp(0),this.expirationTimes=Gp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gp(0),this.identifierPrefix=f,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function ig(n,o,u,f,_,w,I,l,N){return n=new E2(n,o,u,l,N),o===1?(o=1,w===!0&&(o|=8)):o=0,w=di(3,null,null,o),n.current=w,w.stateNode=n,w.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vm(w),n}function T2(n,o,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ha,key:f==null?null:""+f,children:n,containerInfo:o,implementation:u}}function a0(n){if(!n)return _s;n=n._reactInternals;e:{if(fa(n)!==n||n.tag!==1)throw Error(Pe(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Fr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Pe(171))}if(n.tag===1){var u=n.type;if(Fr(u))return sx(n,u,o)}return o}function l0(n,o,u,f,_,w,I,l,N){return n=ig(u,f,!0,n,_,w,I,l,N),n.context=a0(null),u=n.current,f=Tr(),_=ms(u),w=Eo(f,_),w.callback=o??null,ps(u,w,_),n.current.lanes=_,sc(n,_,f),Or(n,f),n}function Ad(n,o,u,f){var _=o.current,w=Tr(),I=ms(_);return u=a0(u),o.context===null?o.context=u:o.pendingContext=u,o=Eo(w,I),o.payload={element:n},f=f===void 0?null:f,f!==null&&(o.callback=f),n=ps(_,o,I),n!==null&&(Di(n,_,I,w),Vh(n,_,I)),I}function yd(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function F_(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var u=n.retryLane;n.retryLane=u!==0&&u<o?u:o}}function og(n,o){F_(n,o),(n=n.alternate)&&F_(n,o)}function k2(){return null}var u0=typeof reportError=="function"?reportError:function(n){console.error(n)};function sg(n){this._internalRoot=n}Pd.prototype.render=sg.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(Pe(409));Ad(n,o,null,null)};Pd.prototype.unmount=sg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;da(function(){Ad(null,n,null,null)}),o[ko]=null}};function Pd(n){this._internalRoot=n}Pd.prototype.unstable_scheduleHydration=function(n){if(n){var o=Nv();n={blockedOn:null,target:n,priority:o};for(var u=0;u<is.length&&o!==0&&o<is[u].priority;u++);is.splice(u,0,n),u===0&&Vv(n)}};function ag(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Md(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function O_(){}function C2(n,o,u,f,_){if(_){if(typeof f=="function"){var w=f;f=function(){var j=yd(I);w.call(j)}}var I=l0(o,f,n,0,null,!1,!1,"",O_);return n._reactRootContainer=I,n[ko]=I.current,Ku(n.nodeType===8?n.parentNode:n),da(),I}for(;_=n.lastChild;)n.removeChild(_);if(typeof f=="function"){var l=f;f=function(){var j=yd(N);l.call(j)}}var N=ig(n,0,!1,null,null,!1,!1,"",O_);return n._reactRootContainer=N,n[ko]=N.current,Ku(n.nodeType===8?n.parentNode:n),da(function(){Ad(o,N,u,f)}),N}function Dd(n,o,u,f,_){var w=u._reactRootContainer;if(w){var I=w;if(typeof _=="function"){var l=_;_=function(){var N=yd(I);l.call(N)}}Ad(o,I,n,_)}else I=C2(u,o,n,_,f);return yd(I)}Fv=function(n){switch(n.tag){case 3:var o=n.stateNode;if(o.current.memoizedState.isDehydrated){var u=zu(o.pendingLanes);u!==0&&(km(o,u|1),Or(o,Sn()),!(Ot&6)&&(yl=Sn()+500,ws()))}break;case 13:da(function(){var f=Co(n,1);if(f!==null){var _=Tr();Di(f,n,1,_)}}),og(n,1)}};Cm=function(n){if(n.tag===13){var o=Co(n,134217728);if(o!==null){var u=Tr();Di(o,n,134217728,u)}og(n,134217728)}};Ov=function(n){if(n.tag===13){var o=ms(n),u=Co(n,o);if(u!==null){var f=Tr();Di(u,n,o,f)}og(n,o)}};Nv=function(){return Zt};Uv=function(n,o){var u=Zt;try{return Zt=n,o()}finally{Zt=u}};Df=function(n,o,u){switch(o){case"input":if(kf(n,u),o=u.name,u.type==="radio"&&o!=null){for(u=n;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==n&&f.form===n.form){var _=Sd(f);if(!_)throw Error(Pe(90));yv(f),kf(f,_)}}}break;case"textarea":vv(n,u);break;case"select":o=u.value,o!=null&&ol(n,!!u.multiple,o,!1)}};kv=eg;Cv=da;var I2={usingClientEntryPoint:!1,Events:[lc,Ja,Sd,Ev,Tv,eg]},ku={findFiberByHostInstance:ra,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},z2={bundleType:ku.bundleType,version:ku.version,rendererPackageName:ku.rendererPackageName,rendererConfig:ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Av(n),n===null?null:n.stateNode},findFiberByHostInstance:ku.findFiberByHostInstance||k2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lh.isDisabled&&Lh.supportsFiber)try{vd=Lh.inject(z2),Qi=Lh}catch{}}Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I2;Jr.createPortal=function(n,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ag(o))throw Error(Pe(200));return T2(n,o,null,u)};Jr.createRoot=function(n,o){if(!ag(n))throw Error(Pe(299));var u=!1,f="",_=u0;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=ig(n,1,!1,null,null,u,!1,f,_),n[ko]=o.current,Ku(n.nodeType===8?n.parentNode:n),new sg(o)};Jr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(Pe(188)):(n=Object.keys(n).join(","),Error(Pe(268,n)));return n=Av(o),n=n===null?null:n.stateNode,n};Jr.flushSync=function(n){return da(n)};Jr.hydrate=function(n,o,u){if(!Md(o))throw Error(Pe(200));return Dd(null,n,o,!0,u)};Jr.hydrateRoot=function(n,o,u){if(!ag(n))throw Error(Pe(405));var f=u!=null&&u.hydratedSources||null,_=!1,w="",I=u0;if(u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),o=l0(o,null,n,1,u??null,_,!1,w,I),n[ko]=o.current,Ku(n),f)for(n=0;n<f.length;n++)u=f[n],_=u._getVersion,_=_(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,_]:o.mutableSourceEagerHydrationData.push(u,_);return new Pd(o)};Jr.render=function(n,o,u){if(!Md(o))throw Error(Pe(200));return Dd(null,n,o,!1,u)};Jr.unmountComponentAtNode=function(n){if(!Md(n))throw Error(Pe(40));return n._reactRootContainer?(da(function(){Dd(null,null,n,!1,function(){n._reactRootContainer=null,n[ko]=null})}),!0):!1};Jr.unstable_batchedUpdates=eg;Jr.unstable_renderSubtreeIntoContainer=function(n,o,u,f){if(!Md(u))throw Error(Pe(200));if(n==null||n._reactInternals===void 0)throw Error(Pe(38));return Dd(n,o,u,!1,f)};Jr.version="18.2.0-next-9e3b772b8-20220608";(function(n){function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(u){console.error(u)}}o(),n.exports=Jr})(kw);const A2=ev(Vu);var dm={},P2={get exports(){return dm},set exports(n){dm=n}},df,N_;function M2(){return N_||(N_=1,df={tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h1, h2, h3",ignoreSelector:".js-toc-ignore",hasInnerContainers:!1,linkClass:"toc-link",extraLinkClasses:"",activeLinkClass:"is-active-link",listClass:"toc-list",extraListClasses:"",isCollapsedClass:"is-collapsed",collapsibleClass:"is-collapsible",listItemClass:"toc-list-item",activeListItemClass:"is-active-li",collapseDepth:0,scrollSmooth:!0,scrollSmoothDuration:420,scrollSmoothOffset:0,scrollEndCallback:function(n){},headingsOffset:1,throttleTimeout:50,positionFixedSelector:null,positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto",includeHtml:!1,includeTitleTags:!1,onClick:function(n){},orderedList:!0,scrollContainer:null,skipRendering:!1,headingLabelCallback:!1,ignoreHiddenElements:!1,headingObjectCallback:null,basePath:"",disableTocScrollSync:!1}),df}var pf,U_;function D2(){return U_||(U_=1,pf=function(n){var o=[].forEach,u=[].some,f=document.body,_,w=!0,I=" ";function l(ee,H){var re=H.appendChild(j(ee));if(ee.children.length){var we=ae(ee.isCollapsed);ee.children.forEach(function(ze){l(ze,we)}),re.appendChild(we)}}function N(ee,H){var re=!1,we=ae(re);if(H.forEach(function(ze){l(ze,we)}),_=ee||_,_!==null)return _.firstChild&&_.removeChild(_.firstChild),H.length===0?_:_.appendChild(we)}function j(ee){var H=document.createElement("li"),re=document.createElement("a");return n.listItemClass&&H.setAttribute("class",n.listItemClass),n.onClick&&(re.onclick=n.onClick),n.includeTitleTags&&re.setAttribute("title",ee.textContent),n.includeHtml&&ee.childNodes.length?o.call(ee.childNodes,function(we){re.appendChild(we.cloneNode(!0))}):re.textContent=ee.textContent,re.setAttribute("href",n.basePath+"#"+ee.id),re.setAttribute("class",n.linkClass+I+"node-name--"+ee.nodeName+I+n.extraLinkClasses),H.appendChild(re),H}function ae(ee){var H=n.orderedList?"ol":"ul",re=document.createElement(H),we=n.listClass+I+n.extraListClasses;return ee&&(we+=I+n.collapsibleClass,we+=I+n.isCollapsedClass),re.setAttribute("class",we),re}function ne(){if(n.scrollContainer&&document.querySelector(n.scrollContainer)){var ee;ee=document.querySelector(n.scrollContainer).scrollTop}else ee=document.documentElement.scrollTop||f.scrollTop;var H=document.querySelector(n.positionFixedSelector);n.fixedSidebarOffset==="auto"&&(n.fixedSidebarOffset=_.offsetTop),ee>n.fixedSidebarOffset?H.className.indexOf(n.positionFixedClass)===-1&&(H.className+=I+n.positionFixedClass):H.className=H.className.split(I+n.positionFixedClass).join("")}function q(ee){var H=0;return ee!==null&&(H=ee.offsetTop,n.hasInnerContainers&&(H+=q(ee.offsetParent))),H}function Ae(ee){if(n.scrollContainer&&document.querySelector(n.scrollContainer)){var H;H=document.querySelector(n.scrollContainer).scrollTop}else H=document.documentElement.scrollTop||f.scrollTop;n.positionFixedSelector&&ne();var re=ee,we;if(w&&_!==null&&re.length>0){u.call(re,function(st,nn){if(q(st)>H+n.headingsOffset+10){var Mn=nn===0?nn:nn-1;return we=re[Mn],!0}else if(nn===re.length-1)return we=re[re.length-1],!0});var ze=_.querySelectorAll("."+n.linkClass);o.call(ze,function(st){st.className=st.className.split(I+n.activeLinkClass).join("")});var He=_.querySelectorAll("."+n.listItemClass);o.call(He,function(st){st.className=st.className.split(I+n.activeListItemClass).join("")});var De=_.querySelector("."+n.linkClass+".node-name--"+we.nodeName+'[href="'+n.basePath+"#"+we.id.replace(/([ #;&,.+*~':"!^$[\]()=>|/@])/g,"\\$1")+'"]');De&&De.className.indexOf(n.activeLinkClass)===-1&&(De.className+=I+n.activeLinkClass);var Fe=De&&De.parentNode;Fe&&Fe.className.indexOf(n.activeListItemClass)===-1&&(Fe.className+=I+n.activeListItemClass);var Mt=_.querySelectorAll("."+n.listClass+"."+n.collapsibleClass);o.call(Mt,function(st){st.className.indexOf(n.isCollapsedClass)===-1&&(st.className+=I+n.isCollapsedClass)}),De&&De.nextSibling&&De.nextSibling.className.indexOf(n.isCollapsedClass)!==-1&&(De.nextSibling.className=De.nextSibling.className.split(I+n.isCollapsedClass).join("")),Te(De&&De.parentNode.parentNode)}}function Te(ee){return ee&&ee.className.indexOf(n.collapsibleClass)!==-1&&ee.className.indexOf(n.isCollapsedClass)!==-1?(ee.className=ee.className.split(I+n.isCollapsedClass).join(""),Te(ee.parentNode.parentNode)):ee}function Ie(ee){var H=ee.target||ee.srcElement;typeof H.className!="string"||H.className.indexOf(n.linkClass)===-1||(w=!1)}function bt(){w=!0}return{enableTocAnimation:bt,disableTocAnimation:Ie,render:N,updateToc:Ae}}),pf}var ff,V_;function L2(){return V_||(V_=1,ff=function(o){var u=[].reduce;function f(j){return j[j.length-1]}function _(j){return+j.nodeName.toUpperCase().replace("H","")}function w(j){if(!(j instanceof window.HTMLElement))return j;if(o.ignoreHiddenElements&&(!j.offsetHeight||!j.offsetParent))return null;const ae=j.getAttribute("data-heading-label")||(o.headingLabelCallback?String(o.headingLabelCallback(j.textContent)):j.textContent.trim());var ne={id:j.id,children:[],nodeName:j.nodeName,headingLevel:_(j),textContent:ae};return o.includeHtml&&(ne.childNodes=j.childNodes),o.headingObjectCallback?o.headingObjectCallback(ne,j):ne}function I(j,ae){for(var ne=w(j),q=ne.headingLevel,Ae=ae,Te=f(Ae),Ie=Te?Te.headingLevel:0,bt=q-Ie;bt>0&&(Te=f(Ae),!(Te&&q===Te.headingLevel));)Te&&Te.children!==void 0&&(Ae=Te.children),bt--;return q>=o.collapseDepth&&(ne.isCollapsed=!0),Ae.push(ne),Ae}function l(j,ae){var ne=ae;o.ignoreSelector&&(ne=ae.split(",").map(function(Ae){return Ae.trim()+":not("+o.ignoreSelector+")"}));try{return j.querySelectorAll(ne)}catch{return console.warn("Headers not found with selector: "+ne),null}}function N(j){return u.call(j,function(ne,q){var Ae=w(q);return Ae&&I(Ae,ne.nest),ne},{nest:[]})}return{nestHeadingsArray:N,selectHeadings:l}}),ff}var mf,$_;function R2(){return $_||($_=1,mf=function(o){var u=o.tocElement||document.querySelector(o.tocSelector);if(u&&u.scrollHeight>u.clientHeight){var f=u.querySelector("."+o.activeListItemClass);f&&(u.scrollTop=f.offsetTop)}}),mf}var gf={},j_;function B2(){if(j_)return gf;j_=1,gf.initSmoothScrolling=n;function n(u){var f=u.duration,_=u.offset,w=location.hash?N(location.href):location.href;I();function I(){document.body.addEventListener("click",ae,!1);function ae(ne){!l(ne.target)||ne.target.className.indexOf("no-smooth-scroll")>-1||ne.target.href.charAt(ne.target.href.length-2)==="#"&&ne.target.href.charAt(ne.target.href.length-1)==="!"||ne.target.className.indexOf(u.linkClass)===-1||o(ne.target.hash,{duration:f,offset:_,callback:function(){j(ne.target.hash)}})}}function l(ae){return ae.tagName.toLowerCase()==="a"&&(ae.hash.length>0||ae.href.charAt(ae.href.length-1)==="#")&&(N(ae.href)===w||N(ae.href)+"#"===w)}function N(ae){return ae.slice(0,ae.lastIndexOf("#"))}function j(ae){var ne=document.getElementById(ae.substring(1));ne&&(/^(?:a|select|input|button|textarea)$/i.test(ne.tagName)||(ne.tabIndex=-1),ne.focus())}}function o(u,f){var _=window.pageYOffset,w={duration:f.duration,offset:f.offset||0,callback:f.callback,easing:f.easing||Ae},I=document.querySelector('[id="'+decodeURI(u).split("#").join("")+'"]')||document.querySelector('[id="'+u.split("#").join("")+'"]'),l=typeof u=="string"?w.offset+(u?I&&I.getBoundingClientRect().top||0:-(document.documentElement.scrollTop||document.body.scrollTop)):u,N=typeof w.duration=="function"?w.duration(l):w.duration,j,ae;requestAnimationFrame(function(Te){j=Te,ne(Te)});function ne(Te){ae=Te-j,window.scrollTo(0,w.easing(ae,_,l,N)),ae<N?requestAnimationFrame(ne):q()}function q(){window.scrollTo(0,_+l),typeof w.callback=="function"&&w.callback()}function Ae(Te,Ie,bt,ee){return Te/=ee/2,Te<1?bt/2*Te*Te+Ie:(Te--,-bt/2*(Te*(Te-2)-1)+Ie)}}return gf}(function(n,o){(function(u,f){n.exports=f(u)})(typeof Rh<"u"?Rh:window||Rh,function(u){var f=M2(),_={},w={},I=D2(),l=L2(),N=R2(),j,ae,ne=!!u&&!!u.document&&!!u.document.querySelector&&!!u.addEventListener;if(typeof window>"u"&&!ne)return;var q,Ae=Object.prototype.hasOwnProperty;function Te(){for(var H={},re=0;re<arguments.length;re++){var we=arguments[re];for(var ze in we)Ae.call(we,ze)&&(H[ze]=we[ze])}return H}function Ie(H,re,we){re||(re=250);var ze,He;return function(){var De=we||this,Fe=+new Date,Mt=arguments;ze&&Fe<ze+re?(clearTimeout(He),He=setTimeout(function(){ze=Fe,H.apply(De,Mt)},re)):(ze=Fe,H.apply(De,Mt))}}function bt(H){try{return H.contentElement||document.querySelector(H.contentSelector)}catch{return console.warn("Contents element not found: "+H.contentSelector),null}}function ee(H){try{return H.tocElement||document.querySelector(H.tocSelector)}catch{return console.warn("TOC element not found: "+H.tocSelector),null}}return w.destroy=function(){var H=ee(_);H!==null&&(_.skipRendering||H&&(H.innerHTML=""),_.scrollContainer&&document.querySelector(_.scrollContainer)?(document.querySelector(_.scrollContainer).removeEventListener("scroll",this._scrollListener,!1),document.querySelector(_.scrollContainer).removeEventListener("resize",this._scrollListener,!1),j&&document.querySelector(_.scrollContainer).removeEventListener("click",this._clickListener,!1)):(document.removeEventListener("scroll",this._scrollListener,!1),document.removeEventListener("resize",this._scrollListener,!1),j&&document.removeEventListener("click",this._clickListener,!1)))},w.init=function(H){if(ne){_=Te(f,H||{}),this.options=_,this.state={},_.scrollSmooth&&(_.duration=_.scrollSmoothDuration,_.offset=_.scrollSmoothOffset,w.scrollSmooth=B2().initSmoothScrolling(_)),j=I(_),ae=l(_),this._buildHtml=j,this._parseContent=ae,this._headingsArray=q,w.destroy();var re=bt(_);if(re!==null){var we=ee(_);if(we!==null&&(q=ae.selectHeadings(re,_.headingSelector),q!==null)){var ze=ae.nestHeadingsArray(q),He=ze.nest;_.skipRendering||j.render(we,He),this._scrollListener=Ie(function(Fe){j.updateToc(q),!_.disableTocScrollSync&&N(_);var Mt=Fe&&Fe.target&&Fe.target.scrollingElement&&Fe.target.scrollingElement.scrollTop===0;(Fe&&(Fe.eventPhase===0||Fe.currentTarget===null)||Mt)&&(j.updateToc(q),_.scrollEndCallback&&_.scrollEndCallback(Fe))},_.throttleTimeout),this._scrollListener(),_.scrollContainer&&document.querySelector(_.scrollContainer)?(document.querySelector(_.scrollContainer).addEventListener("scroll",this._scrollListener,!1),document.querySelector(_.scrollContainer).addEventListener("resize",this._scrollListener,!1)):(document.addEventListener("scroll",this._scrollListener,!1),document.addEventListener("resize",this._scrollListener,!1));var De=null;return this._clickListener=Ie(function(Fe){_.scrollSmooth&&j.disableTocAnimation(Fe),j.updateToc(q),De&&clearTimeout(De),De=setTimeout(function(){j.enableTocAnimation()},_.scrollSmoothDuration)},_.throttleTimeout),_.scrollContainer&&document.querySelector(_.scrollContainer)?document.querySelector(_.scrollContainer).addEventListener("click",this._clickListener,!1):document.addEventListener("click",this._clickListener,!1),this}}}},w.refresh=function(H){w.destroy(),w.init(H||this.options)},u.tocbot=w,w})})(P2);const G_=dm,F2="modulepreload",O2=function(n){return"/OpenStoryMaps/"+n},q_={},N2=function(o,u,f){if(!u||u.length===0)return o();const _=document.getElementsByTagName("link");return Promise.all(u.map(w=>{if(w=O2(w),w in q_)return;q_[w]=!0;const I=w.endsWith(".css"),l=I?'[rel="stylesheet"]':"";if(!!f)for(let ae=_.length-1;ae>=0;ae--){const ne=_[ae];if(ne.href===w&&(!I||ne.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${w}"]${l}`))return;const j=document.createElement("link");if(j.rel=I?"stylesheet":F2,I||(j.as="script",j.crossOrigin=""),j.href=w,document.head.appendChild(j),I)return new Promise((ae,ne)=>{j.addEventListener("load",ae),j.addEventListener("error",()=>ne(new Error(`Unable to preload CSS for ${w}`)))})})).then(()=>o())},U2=pt.createContext(null);function V2(n){const o=n.clone();return o.pixelsToGLUnits=n.pixelsToGLUnits,o}function Z_(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function H_(n,o){const u=o.viewState||o;let f=!1;if("longitude"in u&&"latitude"in u){const _=n.center;n.center=new _.constructor(u.longitude,u.latitude),f=f||_!==n.center}if("zoom"in u){const _=n.zoom;n.zoom=u.zoom,f=f||_!==n.zoom}if("bearing"in u){const _=n.bearing;n.bearing=u.bearing,f=f||_!==n.bearing}if("pitch"in u){const _=n.pitch;n.pitch=u.pitch,f=f||_!==n.pitch}return u.padding&&!n.isPaddingEqual(u.padding)&&(f=!0,n.padding=u.padding),f}const $2=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function W_(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const o={};for(const f of n.layers)o[f.id]=f;const u=n.layers.map(f=>{const _=o[f.ref];let w=null;if("interactive"in f&&(w={...f},delete w.interactive),_){w=w||{...f},delete w.ref;for(const I of $2)I in _&&(w[I]=_[I])}return w||f});return{...n,layers:u}}function j2(n,o){const u=Array.isArray(n)?n[0]:n?n.x:0,f=Array.isArray(n)?n[1]:n?n.y:0,_=Array.isArray(o)?o[0]:o?o.x:0,w=Array.isArray(o)?o[1]:o?o.y:0;return u===_&&f===w}function ss(n,o){if(n===o)return!0;if(!n||!o)return!1;if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let u=0;u<n.length;u++)if(!ss(n[u],o[u]))return!1;return!0}else if(Array.isArray(o))return!1;if(typeof n=="object"&&typeof o=="object"){const u=Object.keys(n),f=Object.keys(o);if(u.length!==f.length)return!1;for(const _ of u)if(!o.hasOwnProperty(_)||!ss(n[_],o[_]))return!1;return!0}return!1}const X_={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},yf={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},K_={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},G2=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],q2=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _l{constructor(o,u,f){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=_=>{const w=this.props[K_[_.type]];w&&w(_)},this._onPointerEvent=_=>{(_.type==="mousemove"||_.type==="mouseout")&&this._updateHover(_);const w=this.props[X_[_.type]];if(w){if(this.props.interactiveLayerIds&&_.type!=="mouseover"&&_.type!=="mouseout"){const I=this._hoveredFeatures||this._map.queryRenderedFeatures(_.point,{layers:this.props.interactiveLayerIds});_.features=I}w(_),delete _.features}},this._onCameraEvent=_=>{if(!this._internalUpdate){const w=this.props[yf[_.type]];w&&w(_)}_.type in this._deferredEvents&&(this._deferredEvents[_.type]=!1)},this._MapClass=o,this.props=u,this._initialize(f)}get map(){return this._map}get transform(){return this._renderTransform}setProps(o){const u=this.props;this.props=o;const f=this._updateSettings(o,u);f&&this._createShadowTransform(this._map);const _=this._updateSize(o),w=this._updateViewState(o,!0);this._updateStyle(o,u),this._updateStyleComponents(o,u),this._updateHandlers(o,u),(f||_||w&&!this._map.isMoving())&&this.redraw()}static reuse(o,u){const f=_l.savedMaps.pop();if(!f)return null;const _=f.map,w=_.getContainer();for(u.className=w.className;w.childNodes.length>0;)u.appendChild(w.childNodes[0]);_._container=u,f.setProps({...o,styleDiffing:!1}),_.resize();const{initialViewState:I}=o;return I&&(I.bounds?_.fitBounds(I.bounds,{...I.fitBoundsOptions,duration:0}):f._updateViewState(I,!1)),_.isStyleLoaded()?_.fire("load"):_.once("styledata",()=>_.fire("load")),f}_initialize(o){const{props:u}=this,f={...u,...u.initialViewState,accessToken:u.mapboxAccessToken||Z2()||null,container:o,style:W_(u.mapStyle)},_=f.initialViewState||f.viewState||f;if(Object.assign(f,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),u.gl){const j=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=j,u.gl)}const w=new this._MapClass(f);_.padding&&w.setPadding(_.padding),u.cursor&&(w.getCanvas().style.cursor=u.cursor),this._createShadowTransform(w);const I=w._render;w._render=j=>{this._inRender=!0,I.call(w,j),this._inRender=!1};const l=w._renderTaskQueue.run;w._renderTaskQueue.run=j=>{l.call(w._renderTaskQueue,j),this._onBeforeRepaint()},w.on("render",()=>this._onAfterRepaint());const N=w.fire;w.fire=this._fireEvent.bind(this,N),w.on("resize",()=>{this._renderTransform.resize(w.transform.width,w.transform.height)}),w.on("styledata",()=>this._updateStyleComponents(this.props,{})),w.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const j in X_)w.on(j,this._onPointerEvent);for(const j in yf)w.on(j,this._onCameraEvent);for(const j in K_)w.on(j,this._onEvent);this._map=w}recycle(){_l.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const o=this._map;!this._inRender&&o.style&&(o._frame&&(o._frame.cancel(),o._frame=null),o._render())}_createShadowTransform(o){const u=V2(o.transform);o.painter.transform=u,this._renderTransform=u}_updateSize(o){const{viewState:u}=o;if(u){const f=this._map;if(u.width!==f.transform.width||u.height!==f.transform.height)return f.resize(),!0}return!1}_updateViewState(o,u){if(this._internalUpdate)return!1;const f=this._map,_=this._renderTransform,{zoom:w,pitch:I,bearing:l}=_,N=f.isMoving();N&&(_.cameraElevationReference="sea");const j=H_(_,{...Z_(f.transform),...o});if(N&&(_.cameraElevationReference="ground"),j&&u){const ae=this._deferredEvents;ae.move=!0,ae.zoom||(ae.zoom=w!==_.zoom),ae.rotate||(ae.rotate=l!==_.bearing),ae.pitch||(ae.pitch=I!==_.pitch)}return N||H_(f.transform,o),j}_updateSettings(o,u){const f=this._map;let _=!1;for(const w of G2)w in o&&!ss(o[w],u[w])&&(_=!0,f[`set${w[0].toUpperCase()}${w.slice(1)}`](o[w]));return _}_updateStyle(o,u){if(o.cursor!==u.cursor&&(this._map.getCanvas().style.cursor=o.cursor),o.mapStyle!==u.mapStyle){const f={diff:o.styleDiffing};return"localIdeographFontFamily"in o&&(f.localIdeographFontFamily=o.localIdeographFontFamily),this._map.setStyle(W_(o.mapStyle),f),!0}return!1}_updateStyleComponents(o,u){const f=this._map;let _=!1;return f.style.loaded()&&("light"in o&&!ss(o.light,u.light)&&(_=!0,f.setLight(o.light)),"fog"in o&&!ss(o.fog,u.fog)&&(_=!0,f.setFog(o.fog)),"terrain"in o&&!ss(o.terrain,u.terrain)&&(!o.terrain||f.getSource(o.terrain.source))&&(_=!0,f.setTerrain(o.terrain))),_}_updateHandlers(o,u){const f=this._map;let _=!1;for(const w of q2){const I=o[w];ss(I,u[w])||(_=!0,I?f[w].enable(I):f[w].disable())}return _}_updateHover(o){var u;const{props:f}=this;if(f.interactiveLayerIds&&(f.onMouseMove||f.onMouseEnter||f.onMouseLeave)){const w=o.type,I=((u=this._hoveredFeatures)===null||u===void 0?void 0:u.length)>0;let l;if(w==="mousemove")try{l=this._map.queryRenderedFeatures(o.point,{layers:f.interactiveLayerIds})}catch{l=[]}else l=[];const N=l.length>0;!N&&I&&(o.type="mouseleave",this._onPointerEvent(o)),this._hoveredFeatures=l,N&&!I&&(o.type="mouseenter",this._onPointerEvent(o)),o.type=w}else this._hoveredFeatures=null}_fireEvent(o,u,f){const _=this._map,w=_.transform,I=typeof u=="string"?u:u.type;return I==="move"&&this._updateViewState(this.props,!1),I in yf&&(typeof u=="object"&&(u.viewState=Z_(w)),this._map.isMoving())?(_.transform=this._renderTransform,o.call(_,u,f),_.transform=w,_):(o.call(_,u,f),_)}_onBeforeRepaint(){const o=this._map;this._internalUpdate=!0;for(const f in this._deferredEvents)this._deferredEvents[f]&&o.fire(f);this._internalUpdate=!1;const u=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=u}}}_l.savedMaps=[];function Z2(){let n=null;if(typeof location<"u"){const o=/access_token=([^&\/]*)/.exec(location.search);n=o&&o[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const H2=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function W2(n,o){if(!n)return null;const u=n.map,f={getMap:()=>u,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:_=>n.transform.locationPoint(o.LngLat.convert(_)),unproject:_=>n.transform.pointLocation(o.Point.convert(_)),queryTerrainElevation:(_,w)=>{const I=u.transform;u.transform=n.transform;const l=u.queryTerrainElevation(_,w);return u.transform=I,l}};for(const _ of X2(u))!(_ in f)&&!H2.includes(_)&&(f[_]=u[_].bind(u));return f}function X2(n){const o=new Set;let u=n;for(;u;){for(const f of Object.getOwnPropertyNames(u))f[0]!=="_"&&typeof n[f]=="function"&&f!=="fire"&&f!=="setEventedParent"&&o.add(f);u=Object.getPrototypeOf(u)}return Array.from(o)}const K2=typeof document<"u"?pt.useLayoutEffect:pt.useEffect,Y2=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function J2(n,o){for(const u of Y2)u in o&&(n[u]=o[u]);o.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(o.RTLTextPlugin,u=>{u&&console.error(u)},!1)}const Ld=pt.createContext(null),Q2={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},lg=pt.forwardRef((n,o)=>{const u=pt.useContext(U2),[f,_]=pt.useState(null),w=pt.useRef(),{current:I}=pt.useRef({mapLib:null,map:null});pt.useEffect(()=>{const N=n.mapLib;let j=!0,ae;return Promise.resolve(N||N2(()=>import("./index-7d0857aa.js").then(ne=>ne.i),[])).then(ne=>{if(j){if(ne.Map||(ne=ne.default),!ne||!ne.Map)throw new Error("Invalid mapLib");if(ne.supported(n))J2(ne,n),n.reuseMaps&&(ae=_l.reuse(n,w.current)),ae||(ae=new _l(ne.Map,n,w.current)),I.map=W2(ae,ne),I.mapLib=ne,_(ae),u==null||u.onMapMount(I.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(ne=>{n.onError({type:"error",target:null,originalEvent:null,error:ne})}),()=>{j=!1,ae&&(u==null||u.onMapUnmount(n.id),n.reuseMaps?ae.recycle():ae.destroy())}},[]),K2(()=>{f&&f.setProps(n)}),pt.useImperativeHandle(o,()=>I.map,[f]);const l=pt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]);return pt.createElement("div",{id:n.id,ref:w,style:l},f&&pt.createElement(Ld.Provider,{value:I},n.children))});lg.displayName="Map";lg.defaultProps=Q2;const eS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ma(n,o){if(!n||!o)return;const u=n.style;for(const f in o){const _=o[f];Number.isFinite(_)&&!eS.test(f)?u[f]=`${_}px`:u[f]=_}}const tS={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function c0(n){const{map:o,mapLib:u}=pt.useContext(Ld),f=pt.useRef({props:n});f.current.props=n;const _=pt.useMemo(()=>{let w=!1;pt.Children.forEach(n.children,N=>{N&&(w=!0)});const I={...n,element:w?document.createElement("div"):null},l=new u.Marker(I).setLngLat([n.longitude,n.latitude]);return l.getElement().addEventListener("click",N=>{var j,ae;(ae=(j=f.current.props).onClick)===null||ae===void 0||ae.call(j,{type:"click",target:l,originalEvent:N})}),l.on("dragstart",N=>{var j,ae;const ne=N;ne.lngLat=_.getLngLat(),(ae=(j=f.current.props).onDragStart)===null||ae===void 0||ae.call(j,ne)}),l.on("drag",N=>{var j,ae;const ne=N;ne.lngLat=_.getLngLat(),(ae=(j=f.current.props).onDrag)===null||ae===void 0||ae.call(j,ne)}),l.on("dragend",N=>{var j,ae;const ne=N;ne.lngLat=_.getLngLat(),(ae=(j=f.current.props).onDragEnd)===null||ae===void 0||ae.call(j,ne)}),l},[]);return pt.useEffect(()=>(_.addTo(o.getMap()),()=>{_.remove()}),[]),pt.useEffect(()=>{ma(_.getElement(),n.style)},[n.style]),(_.getLngLat().lng!==n.longitude||_.getLngLat().lat!==n.latitude)&&_.setLngLat([n.longitude,n.latitude]),n.offset&&!j2(_.getOffset(),n.offset)&&_.setOffset(n.offset),_.isDraggable()!==n.draggable&&_.setDraggable(n.draggable),_.getRotation()!==n.rotation&&_.setRotation(n.rotation),_.getRotationAlignment()!==n.rotationAlignment&&_.setRotationAlignment(n.rotationAlignment),_.getPitchAlignment()!==n.pitchAlignment&&_.setPitchAlignment(n.pitchAlignment),_.getPopup()!==n.popup&&_.setPopup(n.popup),Vu.createPortal(n.children,_.getElement())}c0.defaultProps=tS;pt.memo(c0);function Y_(n){return new Set(n?n.trim().split(/\s+/):[])}function nS(n){const{map:o,mapLib:u}=pt.useContext(Ld),f=pt.useMemo(()=>document.createElement("div"),[]),_=pt.useRef({props:n});_.current.props=n;const w=pt.useMemo(()=>{const I={...n},l=new u.Popup(I).setLngLat([n.longitude,n.latitude]);return l.once("open",N=>{var j,ae;(ae=(j=_.current.props).onOpen)===null||ae===void 0||ae.call(j,N)}),l},[]);if(pt.useEffect(()=>{const I=l=>{var N,j;(j=(N=_.current.props).onClose)===null||j===void 0||j.call(N,l)};return w.on("close",I),w.setDOMContent(f).addTo(o.getMap()),()=>{w.off("close",I),w.isOpen()&&w.remove()}},[]),pt.useEffect(()=>{ma(w.getElement(),n.style)},[n.style]),w.isOpen()&&((w.getLngLat().lng!==n.longitude||w.getLngLat().lat!==n.latitude)&&w.setLngLat([n.longitude,n.latitude]),n.offset&&!ss(w.options.offset,n.offset)&&w.setOffset(n.offset),(w.options.anchor!==n.anchor||w.options.maxWidth!==n.maxWidth)&&(w.options.anchor=n.anchor,w.setMaxWidth(n.maxWidth)),w.options.className!==n.className)){const I=Y_(w.options.className),l=Y_(n.className);for(const N of I)l.has(N)||w.removeClassName(N);for(const N of l)I.has(N)||w.addClassName(N);w.options.className=n.className}return Vu.createPortal(n.children,f)}pt.memo(nS);function cc(n,o,u,f){const _=pt.useContext(Ld),w=pt.useMemo(()=>n(_),[]);return pt.useEffect(()=>{const I=f||u||o,l=typeof o=="function"&&typeof u=="function"?o:null,N=typeof u=="function"?u:typeof o=="function"?o:null,{map:j}=_;return j.hasControl(w)||(j.addControl(w,I==null?void 0:I.position),l&&l(_)),()=>{N&&N(_),j.hasControl(w)&&j.removeControl(w)}},[]),w}function rS(n){const o=cc(({mapLib:u})=>new u.AttributionControl(n),{position:n.position});return pt.useEffect(()=>{ma(o._container,n.style)},[n.style]),null}pt.memo(rS);function iS(n){const o=cc(({mapLib:u})=>new u.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return pt.useEffect(()=>{ma(o._controlContainer,n.style)},[n.style]),null}pt.memo(iS);const h0=pt.forwardRef((n,o)=>{const u=pt.useRef({props:n}),f=cc(({mapLib:_})=>{const w=new _.GeolocateControl(n),I=w._setupUI;return w._setupUI=l=>{w._container.hasChildNodes()||I(l)},w.on("geolocate",l=>{var N,j;(j=(N=u.current.props).onGeolocate)===null||j===void 0||j.call(N,l)}),w.on("error",l=>{var N,j;(j=(N=u.current.props).onError)===null||j===void 0||j.call(N,l)}),w.on("outofmaxbounds",l=>{var N,j;(j=(N=u.current.props).onOutOfMaxBounds)===null||j===void 0||j.call(N,l)}),w.on("trackuserlocationstart",l=>{var N,j;(j=(N=u.current.props).onTrackUserLocationStart)===null||j===void 0||j.call(N,l)}),w.on("trackuserlocationend",l=>{var N,j;(j=(N=u.current.props).onTrackUserLocationEnd)===null||j===void 0||j.call(N,l)}),w},{position:n.position});return u.current.props=n,pt.useImperativeHandle(o,()=>({trigger:()=>f.trigger()}),[]),pt.useEffect(()=>{ma(f._container,n.style)},[n.style]),null});h0.displayName="GeolocateControl";pt.memo(h0);function oS(n){const o=cc(({mapLib:u})=>new u.NavigationControl(n),{position:n.position});return pt.useEffect(()=>{ma(o._container,n.style)},[n.style]),null}const sS=pt.memo(oS),aS={unit:"metric",maxWidth:100};function d0(n){const o=cc(({mapLib:u})=>new u.ScaleControl(n),{position:n.position});return(o.options.unit!==n.unit||o.options.maxWidth!==n.maxWidth)&&(o.options.maxWidth=n.maxWidth,o.setUnit(n.unit)),pt.useEffect(()=>{ma(o._container,n.style)},[n.style]),null}d0.defaultProps=aS;pt.memo(d0);var pm={},lS={get exports(){return pm},set exports(n){pm=n}};(function(n,o){(function(u,f){n.exports=f()})(Rh,function(){var u,f,_;function w(l,N){if(!u)u=N;else if(!f)f=N;else{var j="var sharedChunk = {}; ("+u+")(sharedChunk); ("+f+")(sharedChunk);",ae={};u(ae),_=N(ae),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([j],{type:"text/javascript"})))}}w(["exports"],function(l){var N=j;function j(r,e,i,a){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=i,this.p2y=a}function ae(r,e,i,a){const d=new N(r,e,i,a);return function(m){return d.solve(m)}}j.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,a=0;a<8;a++){var d=this.sampleCurveX(i)-r;if(Math.abs(d)<e)return i;var m=this.sampleCurveDerivativeX(i);if(Math.abs(m)<1e-6)break;i-=d/m}var y=0,x=1;for(i=r,a=0;a<20&&(d=this.sampleCurveX(i),!(Math.abs(d-r)<e));a++)r>d?y=i:x=i,i=.5*(x-y)+y;return i},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};const ne=ae(.25,.1,.25,1);function q(r,e,i){return Math.min(i,Math.max(e,r))}function Ae(r,e,i){const a=i-e,d=((r-e)%a+a)%a+e;return d===e?i:d}function Te(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}let Ie=1;function bt(r,e){r.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function ee(r,e,i){const a={};for(const d in r)a[d]=e.call(i||this,r[d],d,r);return a}function H(r,e,i){const a={};for(const d in r)e.call(i||this,r[d],d,r)&&(a[d]=r[d]);return a}function re(r){return Array.isArray(r)?r.map(re):typeof r=="object"&&r?ee(r,re):r}const we={};function ze(r){we[r]||(typeof console<"u"&&console.warn(r),we[r]=!0)}function He(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function De(r){let e=0;for(let i,a,d=0,m=r.length,y=m-1;d<m;y=d++)i=r[d],a=r[y],e+=(a.x-i.x)*(i.y+a.y);return e}function Fe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Mt(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,d,m)=>{const y=d||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let st,nn,Mn=null;function Ir(r){if(Mn==null){const e=r.navigator?r.navigator.userAgent:null;Mn=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Mn}function Nr(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const ei={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const e=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(r,e=0){const i=window.document.createElement("canvas"),a=i.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return i.width=r.width,i.height=r.height,a.drawImage(r,0,0,r.width,r.height),a.getImageData(-e,-e,r.width+2*e,r.height+2*e)},resolveURL:r=>(st||(st=document.createElement("a")),st.href=r,st.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(nn==null&&(nn=matchMedia("(prefers-reduced-motion: reduce)")),nn.matches)}};var at=hr;function hr(r,e){this.x=r,this.y=e}hr.prototype={clone:function(){return new hr(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(r,e){var i=Math.cos(r),a=Math.sin(r),d=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},hr.convert=function(r){return r instanceof hr?r:Array.isArray(r)?new hr(r[0],r[1]):r};const We={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},lt="mapbox-tiles";let ct,Vt,Xt=500,Ur=50;function Qn(){typeof caches>"u"||ct||(ct=caches.open(lt))}let er=1/0;const On={supported:!1,testSupport:function(r){!tr&&Ri&&(Ao?bs(r):dr=r)}};let dr,Ri,tr=!1,Ao=!1;function bs(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,Ri),r.isContextLost())return;On.supported=!0}catch{}r.deleteTexture(e),tr=!0}typeof document<"u"&&(Ri=document.createElement("img"),Ri.onload=function(){dr&&bs(dr),dr=null,Ao=!0},Ri.onerror=function(){tr=!0,dr=null},Ri.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const gi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(gi);class pr extends Error{constructor(e,i,a,d){super(`AJAXError: ${i} (${e}): ${a}`),this.status=e,this.statusText=i,this.url=a,this.body=d}}const Ss=Fe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Bi(r,e){const i=new AbortController,a=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:Ss(),signal:i.signal});let d=!1,m=!1;return r.type==="json"&&a.headers.set("Accept","application/json"),((y,x,b)=>{if(m)return;const T=Date.now();fetch(a).then(z=>z.ok?((P,L,B)=>{(r.type==="arrayBuffer"?P.arrayBuffer():r.type==="json"?P.json():P.text()).then(F=>{m||(L&&B&&function(K,X,ue){if(Qn(),!ct)return;const fe={status:X.status,statusText:X.statusText,headers:new Headers};X.headers.forEach((de,Se)=>fe.headers.set(Se,de));const le=Mt(X.headers.get("Cache-Control")||"");le["no-store"]||(le["max-age"]&&fe.headers.set("Expires",new Date(ue+1e3*le["max-age"]).toUTCString()),new Date(fe.headers.get("Expires")).getTime()-ue<42e4||function(de,Se){if(Vt===void 0)try{new Response(new ReadableStream),Vt=!0}catch{Vt=!1}Vt?Se(de.body):de.blob().then(Se)}(X,de=>{const Se=new Response(de,fe);Qn(),ct&&ct.then(be=>be.put(function(Ze){const Ye=Ze.indexOf("?");return Ye<0?Ze:Ze.slice(0,Ye)}(K.url),Se)).catch(be=>ze(be.message))}))}(a,L,B),d=!0,e(null,F,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(F=>{m||e(new Error(F.message))})})(z,null,T):z.blob().then(P=>e(new pr(z.status,z.statusText,r.url,P)))).catch(z=>{z.code!==20&&e(new Error(z.message))})})(),{cancel:()=>{m=!0,d||i.abort()}}}const Po=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(Fe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e);if(!Fe()){const a=r.url.substring(0,r.url.indexOf("://"));return(We.REGISTERED_PROTOCOLS[a]||Bi)(r,e)}}if(!(/^file:/.test(i=r.url)||/^file:/.test(Ss())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Bi(r,e);if(Fe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(a,d){const m=new XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(x){return d(x)}d(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const y=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new pr(m.status,m.statusText,a.url,y))}},m.send(a.body),{cancel:()=>m.abort()}}(r,e)},Mo=function(r,e){return Po(Te(r,{type:"arrayBuffer"}),e)};function Es(r){const e=window.document.createElement("a");return e.href=r,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ti,Fi;ti=[],Fi=0;const Oi=function(r,e){if(On.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Fi>=We.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ti.push(m),m}Fi++;let i=!1;const a=()=>{if(!i)for(i=!0,Fi--;ti.length&&Fi<We.MAX_PARALLEL_IMAGE_REQUESTS;){const m=ti.shift(),{requestParameters:y,callback:x,cancelled:b}=m;b||(m.cancel=Oi(y,x).cancel)}},d=Mo(r,(m,y,x,b)=>{a(),m?e(m):y&&function(T,z){typeof createImageBitmap=="function"?function(P,L){const B=new Blob([new Uint8Array(P)],{type:"image/png"});createImageBitmap(B).then(F=>{L(null,F)}).catch(F=>{L(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,z):function(P,L){const B=new Image;B.onload=()=>{L(null,B),URL.revokeObjectURL(B.src),B.onload=null,window.requestAnimationFrame(()=>{B.src=kt})},B.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new Blob([new Uint8Array(P)],{type:"image/png"});B.src=P.byteLength?URL.createObjectURL(F):kt}(T,z)}(y,(T,z)=>{T!=null?e(T):z!=null&&e(null,z,{cacheControl:x,expires:b})})});return{cancel:()=>{d.cancel(),a()}}};function Ts(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function yi(r,e,i){if(i&&i[r]){const a=i[r].indexOf(e);a!==-1&&i[r].splice(a,1)}}class _i{constructor(e,i={}){Te(this,i),this.type=e}}class Do extends _i{constructor(e,i={}){super("error",Te({error:e},i))}}class vi{on(e,i){return this._listeners=this._listeners||{},Ts(e,i,this._listeners),this}off(e,i){return yi(e,i,this._listeners),yi(e,i,this._oneTimeListeners),this}once(e,i){return this._oneTimeListeners=this._oneTimeListeners||{},Ts(e,i,this._oneTimeListeners),this}fire(e,i){typeof e=="string"&&(e=new _i(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const d=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const x of d)x.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const x of m)yi(a,x,this._oneTimeListeners),x.call(this,e);const y=this._eventedParent;y&&(Te(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Do&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Oe{constructor(e,i,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),i!=null&&i.__line__&&(this.line=i.__line__)}}function to(r){const e=r.value;return e?[new Oe(r.key,e,"constants have been deprecated as of v8")]:[]}function Vr(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}function Ct(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function zr(r){if(Array.isArray(r))return r.map(zr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=zr(r[i]);return e}return Ct(r)}class fr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class mr{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,d]of i)this.bindings[a]=d}concat(e){return new mr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ni={kind:"null"},Le={kind:"number"},gt={kind:"string"},ft={kind:"boolean"},Dn={kind:"color"},Ui={kind:"object"},dt={kind:"value"},xi={kind:"collator"},En={kind:"formatted"},Lo={kind:"padding"},mn={kind:"resolvedImage"};function Zn(r,e){return{kind:"array",itemType:r,N:e}}function Nt(r){if(r.kind==="array"){const e=Nt(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const Ro=[Ni,Le,gt,ft,Dn,En,Ui,Zn(dt),Lo,mn];function ni(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ni(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of Ro)if(!ni(i,e))return null}}return`Expected ${Nt(r)} but found ${Nt(e)} instead.`}function no(r,e){return e.some(i=>i.kind===r.kind)}function ro(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var Bo,io={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function V(r){return(r=Math.round(r))<0?0:r>255?255:r}function C(r){return V(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function M(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function O(r,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(e-r)*i*6:2*i<1?e:3*i<2?r+(e-r)*(2/3-i)*6:r}try{Bo={}.parseCSSColor=function(r){var e,i=r.replace(/ /g,"").toLowerCase();if(i in io)return io[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),d=i.indexOf(")");if(a!==-1&&d+1===i.length){var m=i.substr(0,a),y=i.substr(a+1,d-(a+1)).split(","),x=1;switch(m){case"rgba":if(y.length!==4)return null;x=M(y.pop());case"rgb":return y.length!==3?null:[C(y[0]),C(y[1]),C(y[2]),x];case"hsla":if(y.length!==4)return null;x=M(y.pop());case"hsl":if(y.length!==3)return null;var b=(parseFloat(y[0])%360+360)%360/360,T=M(y[1]),z=M(y[2]),P=z<=.5?z*(T+1):z+T-z*T,L=2*z-P;return[V(255*O(L,P,b+1/3)),V(255*O(L,P,b)),V(255*O(L,P,b-1/3)),x];default:return null}}return null}}catch{}class U{constructor(e,i,a,d=1){this.r=e,this.g=i,this.b=a,this.a=d}static parse(e){if(!e)return;if(e instanceof U)return e;if(typeof e!="string")return;const i=Bo(e);return i?new U(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${d})`}toArray(){const{r:e,g:i,b:a,a:d}=this;return d===0?[0,0,0,0]:[255*e/d,255*i/d,255*a/d,d]}}U.black=new U(0,0,0,1),U.white=new U(1,1,1,1),U.transparent=new U(0,0,0,0),U.red=new U(1,0,0,1);class Y{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ie{constructor(e,i,a,d,m){this.text=e,this.image=i,this.scale=a,this.fontStack=d,this.textColor=m}}class Q{constructor(e){this.sections=e}static fromString(e){return new Q([new ie(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Q?e:Q.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class J{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof J)return e;if(typeof e=="number")return new J([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new J(e)}}toString(){return JSON.stringify(this.values)}}class oe{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new oe({name:e,available:!1}):null}}function ge(r,e,i,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,i,a]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ee(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof U||r instanceof Y||r instanceof Q||r instanceof J||r instanceof oe)return!0;if(Array.isArray(r)){for(const e of r)if(!Ee(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Ee(r[e]))return!1;return!0}return!1}function me(r){if(r===null)return Ni;if(typeof r=="string")return gt;if(typeof r=="boolean")return ft;if(typeof r=="number")return Le;if(r instanceof U)return Dn;if(r instanceof Y)return xi;if(r instanceof Q)return En;if(r instanceof J)return Lo;if(r instanceof oe)return mn;if(Array.isArray(r)){const e=r.length;let i;for(const a of r){const d=me(a);if(i){if(i===d)continue;i=dt;break}i=d}return Zn(i||dt,e)}return Ui}function Ke(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof U||r instanceof Q||r instanceof J||r instanceof oe?r.toString():JSON.stringify(r)}class Je{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ee(e[1]))return i.error("invalid value");const a=e[1];let d=me(a);const m=i.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new Je(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class je{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const it={string:gt,number:Le,boolean:ft,object:Ui};class ut{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,d=1;const m=e[0];if(m==="array"){let x,b;if(e.length>2){const T=e[1];if(typeof T!="string"||!(T in it)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=it[T],d++}else x=dt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);b=e[2],d++}a=Zn(x,b)}else{if(!it[m])throw new Error(`Types doesn't contain name = ${m}`);a=it[m]}const y=[];for(;d<e.length;d++){const x=i.parse(e[d],d,dt);if(!x)return null;y.push(x)}return new ut(a,y)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!ni(this.type,me(a)))return a;if(i===this.args.length-1)throw new je(`Expected value to be of type ${Nt(this.type)}, but found ${Nt(me(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const It={"to-boolean":ft,"to-color":Dn,"to-number":Le,"to-string":gt};class ht{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(!It[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return i.error("Expected one argument.");const d=It[a],m=[];for(let y=1;y<e.length;y++){const x=i.parse(e[y],y,dt);if(!x)return null;m.push(x)}return new ht(d,m)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let i,a;for(const d of this.args){if(i=d.evaluate(e),a=null,i instanceof U)return i;if(typeof i=="string"){const m=e.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ge(i[0],i[1],i[2],i[3]),!a))return new U(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new je(a||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}if(this.type.kind==="padding"){let i;for(const a of this.args){i=a.evaluate(e);const d=J.parse(i);if(d)return d}throw new je(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}if(this.type.kind==="number"){let i=null;for(const a of this.args){if(i=a.evaluate(e),i===null)return 0;const d=Number(i);if(!isNaN(d))return d}throw new je(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Q.fromString(Ke(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?oe.fromString(Ke(this.args[0].evaluate(e))):Ke(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const yt=["Unknown","Point","LineString","Polygon"];class zt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=U.parse(e)),i}}class $t{constructor(e,i,a,d){this.name=e,this.type=i,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const a=e[0],d=$t.definitions[a];if(!d)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=y.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let b=null;for(const[T,z]of x){b=new No(i.registry,i.path,null,i.scope);const P=[];let L=!1;for(let B=1;B<e.length;B++){const F=e[B],K=Array.isArray(T)?T[B-1]:T.type,X=b.parse(F,1+P.length,K);if(!X){L=!0;break}P.push(X)}if(!L)if(Array.isArray(T)&&T.length!==P.length)b.error(`Expected ${T.length} arguments, but found ${P.length} instead.`);else{for(let B=0;B<P.length;B++){const F=Array.isArray(T)?T[B]:T.type,K=P[B];b.concat(B+1).checkSubtype(F,K.type)}if(b.errors.length===0)return new $t(a,m,z,P)}}if(x.length===1)i.errors.push(...b.errors);else{const T=(x.length?x:y).map(([P])=>{return L=P,Array.isArray(L)?`(${L.map(Nt).join(", ")})`:`(${Nt(L.type)}...)`;var L}).join(" | "),z=[];for(let P=1;P<e.length;P++){const L=i.parse(e[P],1+z.length);if(!L)return null;z.push(Nt(L.type))}i.error(`Expected arguments of type ${T}, but found (${z.join(", ")}) instead.`)}return null}static register(e,i){$t.definitions=i;for(const a in i)e[a]=$t}}class Tn{constructor(e,i,a){this.type=xi,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const d=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,ft);if(!d)return null;const m=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,ft);if(!m)return null;let y=null;return a.locale&&(y=i.parse(a.locale,1,gt),!y)?null:new Tn(d,m,y)}evaluate(e){return new Y(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Kt=8192;function Nn(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Fo(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function ks(r,e){const i=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(i*d*Kt),Math.round(a*d*Kt)]}function jt(r,e,i){const a=r[0]-e[0],d=r[1]-e[1],m=r[0]-i[0],y=r[1]-i[1];return a*y-m*d==0&&a*m<=0&&d*y<=0}function bl(r,e){let i=!1;for(let y=0,x=e.length;y<x;y++){const b=e[y];for(let T=0,z=b.length;T<z-1;T++){if(jt(r,b[T],b[T+1]))return!1;(d=b[T])[1]>(a=r)[1]!=(m=b[T+1])[1]>a[1]&&a[0]<(m[0]-d[0])*(a[1]-d[1])/(m[1]-d[1])+d[0]&&(i=!i)}}var a,d,m;return i}function Sl(r,e){for(let i=0;i<e.length;i++)if(bl(r,e[i]))return!0;return!1}function hc(r,e,i,a){const d=a[0]-i[0],m=a[1]-i[1],y=(r[0]-i[0])*m-d*(r[1]-i[1]),x=(e[0]-i[0])*m-d*(e[1]-i[1]);return y>0&&x<0||y<0&&x>0}function dc(r,e,i){for(const T of i)for(let z=0;z<T.length-1;++z)if((x=[(y=T[z+1])[0]-(m=T[z])[0],y[1]-m[1]])[0]*(b=[(d=e)[0]-(a=r)[0],d[1]-a[1]])[1]-x[1]*b[0]!=0&&hc(a,d,m,y)&&hc(m,y,a,d))return!0;var a,d,m,y,x,b;return!1}function El(r,e){for(let i=0;i<r.length;++i)if(!bl(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(dc(r[i],r[i+1],e))return!1;return!0}function Rd(r,e){for(let i=0;i<e.length;i++)if(El(r,e[i]))return!0;return!1}function ga(r,e,i){const a=[];for(let d=0;d<r.length;d++){const m=[];for(let y=0;y<r[d].length;y++){const x=ks(r[d][y],i);Nn(e,x),m.push(x)}a.push(m)}return a}function Tl(r,e,i){const a=[];for(let d=0;d<r.length;d++){const m=ga(r[d],e,i);a.push(m)}return a}function pc(r,e,i,a){if(r[0]<i[0]||r[0]>i[2]){const d=.5*a;let m=r[0]-i[0]>d?-a:i[0]-r[0]>d?a:0;m===0&&(m=r[0]-i[2]>d?-a:i[2]-r[0]>d?a:0),r[0]+=m}Nn(e,r)}function fc(r,e,i,a){const d=Math.pow(2,a.z)*Kt,m=[a.x*Kt,a.y*Kt],y=[];for(const x of r)for(const b of x){const T=[b.x+m[0],b.y+m[1]];pc(T,e,i,d),y.push(T)}return y}function mc(r,e,i,a){const d=Math.pow(2,a.z)*Kt,m=[a.x*Kt,a.y*Kt],y=[];for(const b of r){const T=[];for(const z of b){const P=[z.x+m[0],z.y+m[1]];Nn(e,P),T.push(P)}y.push(T)}if(e[2]-e[0]<=d/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const b of y)for(const T of b)pc(T,e,i,d)}var x;return y}class oo{constructor(e,i){this.type=ft,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ee(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let d=0;d<a.features.length;++d){const m=a.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new oo(a,a.features[d].geometry)}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new oo(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new oo(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(a.type==="Polygon"){const x=ga(a.coordinates,m,y),b=fc(i.geometry(),d,m,y);if(!Fo(d,m))return!1;for(const T of b)if(!bl(T,x))return!1}if(a.type==="MultiPolygon"){const x=Tl(a.coordinates,m,y),b=fc(i.geometry(),d,m,y);if(!Fo(d,m))return!1;for(const T of b)if(!Sl(T,x))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(a.type==="Polygon"){const x=ga(a.coordinates,m,y),b=mc(i.geometry(),d,m,y);if(!Fo(d,m))return!1;for(const T of b)if(!El(T,x))return!1}if(a.type==="MultiPolygon"){const x=Tl(a.coordinates,m,y),b=mc(i.geometry(),d,m,y);if(!Fo(d,m))return!1;for(const T of b)if(!Rd(T,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Cs(r){if(r instanceof $t&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof oo)return!1;let e=!0;return r.eachChild(i=>{e&&!Cs(i)&&(e=!1)}),e}function Oo(r){if(r instanceof $t&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!Oo(i)&&(e=!1)}),e}function ya(r,e){if(r instanceof $t&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(a=>{i&&!ya(a,e)&&(i=!1)}),i}class _a{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new _a(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class No{constructor(e,i=[],a,d=new mr,m=[]){this.registry=e,this.path=i,this.key=i.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=m,this.expectedType=a}parse(e,i,a,d,m={}){return i?this.concat(i,a,d)._parse(e,m):this._parse(e,m)}_parse(e,i){function a(d,m,y){return y==="assert"?new ut(m,[d]):y==="coerce"?new ht(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,b=y.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||b.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(x.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array"){if(this.checkSubtype(x,b))return null}else y=a(y,x,i.typeAnnotation||"coerce");else y=a(y,x,i.typeAnnotation||"coerce");else y=a(y,x,i.typeAnnotation||"assert")}if(!(y instanceof Je)&&y.type.kind!=="resolvedImage"&&kl(y)){const x=new zt;try{y=new Je(y.type,y.evaluate(x))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new No(this.registry,d,i||null,m,this.errors)}error(e,...i){const a=`${this.key}${i.map(d=>`[${d}]`).join("")}`;this.errors.push(new fr(a,e))}checkSubtype(e,i){const a=ni(e,i);return a&&this.error(a),a}}function kl(r){if(r instanceof _a)return kl(r.boundExpression);if(r instanceof $t&&r.name==="error"||r instanceof Tn||r instanceof oo)return!1;const e=r instanceof ht||r instanceof ut;let i=!0;return r.eachChild(a=>{i=e?i&&kl(a):i&&a instanceof Je}),!!i&&Cs(r)&&ya(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function va(r,e){const i=r.length-1;let a,d,m=0,y=i,x=0;for(;m<=y;)if(x=Math.floor((m+y)/2),a=r[x],d=r[x+1],a<=e){if(x===i||e<d)return x;m=x+1}else{if(!(a>e))throw new je("Input is not a number.");y=x-1}return 0}class Is{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,Le);if(!a)return null;const d=[];let m=null;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);for(let y=1;y<e.length;y+=2){const x=y===1?-1/0:e[y],b=e[y+1],T=y,z=y+1;if(typeof x!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(d.length&&d[d.length-1][0]>=x)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const P=i.parse(b,z,m);if(!P)return null;m=m||P.type,d.push([x,P])}return new Is(m,a,d)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;return d>=i[m-1]?a[m-1].evaluate(e):a[va(i,d)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Yt(r,e,i){return r*(1-i)+e*i}var zs=Object.freeze({__proto__:null,number:Yt,color:function(r,e,i){return new U(Yt(r.r,e.r,i),Yt(r.g,e.g,i),Yt(r.b,e.b,i),Yt(r.a,e.a,i))},array:function(r,e,i){return r.map((a,d)=>Yt(a,e[d],i))},padding:function(r,e,i){const a=r.values,d=e.values;return new J([Yt(a[0],d[0],i),Yt(a[1],d[1],i),Yt(a[2],d[2],i),Yt(a[3],d[3],i)])}});const gc=.95047,yc=1.08883,Cl=4/29,xa=6/29,_c=3*xa*xa,Bd=Math.PI/180,Fd=180/Math.PI;function Il(r){return r>.008856451679035631?Math.pow(r,1/3):r/_c+Cl}function zl(r){return r>xa?r*r*r:_c*(r-Cl)}function Al(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Pl(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Dt(r){const e=Pl(r.r),i=Pl(r.g),a=Pl(r.b),d=Il((.4124564*e+.3575761*i+.1804375*a)/gc),m=Il((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-Il((.0193339*e+.119192*i+.9503041*a)/yc)),alpha:r.a}}function vc(r){let e=(r.l+16)/116,i=isNaN(r.a)?e:e+r.a/500,a=isNaN(r.b)?e:e-r.b/200;return e=1*zl(e),i=gc*zl(i),a=yc*zl(a),new U(Al(3.2404542*i-1.5371385*e-.4985314*a),Al(-.969266*i+1.8760108*e+.041556*a),Al(.0556434*i-.2040259*e+1.0572252*a),r.alpha)}function Od(r,e,i){const a=e-r;return r+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const As={forward:Dt,reverse:vc,interpolate:function(r,e,i){return{l:Yt(r.l,e.l,i),a:Yt(r.a,e.a,i),b:Yt(r.b,e.b,i),alpha:Yt(r.alpha,e.alpha,i)}}},Ps={forward:function(r){const{l:e,a:i,b:a}=Dt(r),d=Math.atan2(a,i)*Fd;return{h:d<0?d+360:d,c:Math.sqrt(i*i+a*a),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Bd,i=r.c;return vc({l:r.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:r.alpha})},interpolate:function(r,e,i){return{h:Od(r.h,e.h,i),c:Yt(r.c,e.c,i),l:Yt(r.l,e.l,i),alpha:Yt(r.alpha,e.alpha,i)}}};var xc=Object.freeze({__proto__:null,lab:As,hcl:Ps});class gr{constructor(e,i,a,d,m){this.type=e,this.operator=i,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[y,x]of m)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(e,i,a,d){let m=0;if(e.name==="exponential")m=Ml(i,e.base,a,d);else if(e.name==="linear")m=Ml(i,1,a,d);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new N(y[0],y[1],y[2],y[3]).solve(Ml(i,1,a,d))}return m}static parse(e,i){let[a,d,m,...y]=e;if(!Array.isArray(d)||d.length===0)return i.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const T=d[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:T}}else{if(d[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const T=d.slice(1);if(T.length!==4||T.some(z=>typeof z!="number"||z<0||z>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,Le),!m)return null;const x=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=Dn:i.expectedType&&i.expectedType.kind!=="value"&&(b=i.expectedType);for(let T=0;T<y.length;T+=2){const z=y[T],P=y[T+1],L=T+3,B=T+4;if(typeof z!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=z)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const F=i.parse(P,B,b);if(!F)return null;b=b||F.type,x.push([z,F])}return b.kind==="number"||b.kind==="color"||b.kind==="padding"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new gr(b,a,d,m,x):i.error(`Type ${Nt(b)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;if(d>=i[m-1])return a[m-1].evaluate(e);const y=va(i,d),x=gr.interpolationFactor(this.interpolation,d,i[y],i[y+1]),b=a[y].evaluate(e),T=a[y+1].evaluate(e);return this.operator==="interpolate"?zs[this.type.kind.toLowerCase()](b,T,x):this.operator==="interpolate-hcl"?Ps.reverse(Ps.interpolate(Ps.forward(b),Ps.forward(T),x)):As.reverse(As.interpolate(As.forward(b),As.forward(T),x))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ml(r,e,i,a){const d=a-i,m=r-i;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class wa{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const d=i.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const x of e.slice(1)){const b=i.parse(x,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,m.push(b)}if(!a)throw new Error("No output type");const y=d&&m.some(x=>ni(d,x.type));return new wa(y?dt:a,m)}evaluate(e){let i,a=null,d=0;for(const m of this.args)if(d++,a=m.evaluate(e),a&&a instanceof oe&&!a.available&&(i||(i=a.name),a=null,d===this.args.length&&(a=i)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class ba{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return i.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const x=i.parse(e[m+1],m+1);if(!x)return null;a.push([y,x])}const d=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return d?new ba(a,d):null}outputDefined(){return this.result.outputDefined()}}class Dl{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Le),d=i.parse(e[2],2,Zn(i.expectedType||dt));return a&&d?new Dl(d.type.itemType,a,d):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new je(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new je(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new je(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Ll{constructor(e,i){this.type=ft,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,dt),d=i.parse(e[2],2,dt);return a&&d?no(a.type,[ft,gt,Le,Ni,dt])?new Ll(a,d):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!ro(i,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(me(i))} instead.`);if(!ro(a,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Nt(me(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Sa{constructor(e,i,a){this.type=Le,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,dt),d=i.parse(e[2],2,dt);if(!a||!d)return null;if(!no(a.type,[ft,gt,Le,Ni,dt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(a.type)} instead`);if(e.length===4){const m=i.parse(e[3],3,Le);return m?new Sa(a,d,m):null}return new Sa(a,d)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!ro(i,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(me(i))} instead.`);if(!ro(a,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Nt(me(a))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return a.indexOf(i,d)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Rl{constructor(e,i,a,d,m,y){this.inputType=e,this.type=i,this.input=a,this.cases=d,this.outputs=m,this.otherwise=y}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,d;i.expectedType&&i.expectedType.kind!=="value"&&(d=i.expectedType);const m={},y=[];for(let T=2;T<e.length-1;T+=2){let z=e[T];const P=e[T+1];Array.isArray(z)||(z=[z]);const L=i.concat(T);if(z.length===0)return L.error("Expected at least one branch label.");for(const F of z){if(typeof F!="number"&&typeof F!="string")return L.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof F=="number"&&Math.floor(F)!==F)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,me(F)))return null}else a=me(F);if(m[String(F)]!==void 0)return L.error("Branch labels must be unique.");m[String(F)]=y.length}const B=i.parse(P,T,d);if(!B)return null;d=d||B.type,y.push(B)}const x=i.parse(e[1],1,dt);if(!x)return null;const b=i.parse(e[e.length-1],e.length-1,d);return b?x.type.kind!=="value"&&i.concat(1).checkSubtype(a,x.type)?null:new Rl(a,d,x,m,y,b):null}evaluate(e){const i=this.input.evaluate(e);return(me(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Bl{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const d=[];for(let y=1;y<e.length-1;y+=2){const x=i.parse(e[y],y,ft);if(!x)return null;const b=i.parse(e[y+1],y+1,a);if(!b)return null;d.push([x,b]),a=a||b.type}const m=i.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Bl(a,d,m)}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class Ea{constructor(e,i,a,d){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=d}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,dt),d=i.parse(e[2],2,Le);if(!a||!d)return null;if(!no(a.type,[Zn(dt),gt,dt]))return i.error(`Expected first argument to be of type array or string, but found ${Nt(a.type)} instead`);if(e.length===4){const m=i.parse(e[3],3,Le);return m?new Ea(a.type,a,d,m):null}return new Ea(a.type,a,d)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!ro(i,["string","array"]))throw new je(`Expected first argument to be of type array or string, but found ${Nt(me(i))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return i.slice(a,d)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function wc(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function bc(r,e,i,a){return a.compare(e,i)===0}function Uo(r,e,i){const a=r!=="=="&&r!=="!=";return class p0{constructor(m,y,x){this.type=ft,this.lhs=m,this.rhs=y,this.collator=x,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const x=m[0];let b=y.parse(m[1],1,dt);if(!b)return null;if(!wc(x,b.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${Nt(b.type)}'.`);let T=y.parse(m[2],2,dt);if(!T)return null;if(!wc(x,T.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${Nt(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error(`Cannot compare types '${Nt(b.type)}' and '${Nt(T.type)}'.`);a&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new ut(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new ut(b.type,[T])));let z=null;if(m.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(z=y.parse(m[3],3,xi),!z)return null}return new p0(b,T,z)}evaluate(m){const y=this.lhs.evaluate(m),x=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const b=me(y),T=me(x);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new je(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=me(y),T=me(x);if(b.kind!=="string"||T.kind!=="string")return e(m,y,x)}return this.collator?i(m,y,x,this.collator.evaluate(m)):e(m,y,x)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Nd=Uo("==",function(r,e,i){return e===i},bc),Ud=Uo("!=",function(r,e,i){return e!==i},function(r,e,i,a){return!bc(0,e,i,a)}),Vd=Uo("<",function(r,e,i){return e<i},function(r,e,i,a){return a.compare(e,i)<0}),$d=Uo(">",function(r,e,i){return e>i},function(r,e,i,a){return a.compare(e,i)>0}),jd=Uo("<=",function(r,e,i){return e<=i},function(r,e,i,a){return a.compare(e,i)<=0}),Gd=Uo(">=",function(r,e,i){return e>=i},function(r,e,i,a){return a.compare(e,i)>=0});class Fl{constructor(e,i,a,d,m){this.type=gt,this.number=e,this.locale=i,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Le);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return i.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=i.parse(d.locale,1,gt),!m))return null;let y=null;if(d.currency&&(y=i.parse(d.currency,1,gt),!y))return null;let x=null;if(d["min-fraction-digits"]&&(x=i.parse(d["min-fraction-digits"],1,Le),!x))return null;let b=null;return d["max-fraction-digits"]&&(b=i.parse(d["max-fraction-digits"],1,Le),!b)?null:new Fl(a,m,y,x,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ta{constructor(e){this.type=En,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=e.length-1;++y){const x=e[y];if(m&&typeof x=="object"&&!Array.isArray(x)){m=!1;let b=null;if(x["font-scale"]&&(b=i.parse(x["font-scale"],1,Le),!b))return null;let T=null;if(x["text-font"]&&(T=i.parse(x["text-font"],1,Zn(gt)),!T))return null;let z=null;if(x["text-color"]&&(z=i.parse(x["text-color"],1,Dn),!z))return null;const P=d[d.length-1];P.scale=b,P.font=T,P.textColor=z}else{const b=i.parse(e[y],1,dt);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:b,scale:null,font:null,textColor:null})}}return new Ta(d)}evaluate(e){return new Q(this.sections.map(i=>{const a=i.content.evaluate(e);return me(a)===mn?new ie("",a,null,null,null):new ie(Ke(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}}class Ol{constructor(e){this.type=mn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const a=i.parse(e[1],1,gt);return a?new Ol(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=oe.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class Nl{constructor(e){this.type=Le,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Nt(a.type)} instead.`):new Nl(a):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new je(`Expected value to be of type string or array, but found ${Nt(me(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Vo={"==":Nd,"!=":Ud,">":$d,"<":Vd,">=":Gd,"<=":jd,array:ut,at:Dl,boolean:ut,case:Bl,coalesce:wa,collator:Tn,format:Ta,image:Ol,in:Ll,"index-of":Sa,interpolate:gr,"interpolate-hcl":gr,"interpolate-lab":gr,length:Nl,let:ba,literal:Je,match:Rl,number:ut,"number-format":Fl,object:ut,slice:Ea,step:Is,string:ut,"to-boolean":ht,"to-color":ht,"to-number":ht,"to-string":ht,var:_a,within:oo};function Sc(r,[e,i,a,d]){e=e.evaluate(r),i=i.evaluate(r),a=a.evaluate(r);const m=d?d.evaluate(r):1,y=ge(e,i,a,m);if(y)throw new je(y);return new U(e/255*m,i/255*m,a/255*m,m)}function Ec(r,e){return r in e}function ka(r,e){const i=e[r];return i===void 0?null:i}function so(r){return{type:r}}function Tc(r){return{result:"success",value:r}}function $o(r){return{result:"error",value:r}}function Ht(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function kc(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function St(r){return!!r.expression&&r.expression.interpolated}function Lt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function qt(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Jt(r){return r}function Ms(r,e){const i=e.type==="color",a=r.stops&&typeof r.stops[0][0]=="object",d=a||!(a||r.property!==void 0),m=r.type||(St(e)?"exponential":"interval");if(i||e.type==="padding"){const T=i?U.parse:J.parse;(r=Vr({},r)).stops&&(r.stops=r.stops.map(z=>[z[0],T(z[1])])),r.default=T(r.default?r.default:e.default)}if(r.colorSpace&&r.colorSpace!=="rgb"&&!xc[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let y,x,b;if(m==="exponential")y=Cc;else if(m==="interval")y=Zd;else if(m==="categorical"){y=qd,x=Object.create(null);for(const T of r.stops)x[T[0]]=T[1];b=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=Hd}if(a){const T={},z=[];for(let B=0;B<r.stops.length;B++){const F=r.stops[B],K=F[0].zoom;T[K]===void 0&&(T[K]={zoom:K,type:r.type,property:r.property,default:r.default,stops:[]},z.push(K)),T[K].stops.push([F[0].value,F[1]])}const P=[];for(const B of z)P.push([T[B].zoom,Ms(T[B],e)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:gr.interpolationFactor.bind(void 0,L),zoomStops:P.map(B=>B[0]),evaluate:({zoom:B},F)=>Cc({stops:P,base:r.base},e,B).evaluate(B,F)}}if(d){const T=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:gr.interpolationFactor.bind(void 0,T),zoomStops:r.stops.map(z=>z[0]),evaluate:({zoom:z})=>y(r,e,z,x,b)}}return{kind:"source",evaluate(T,z){const P=z&&z.properties?z.properties[r.property]:void 0;return P===void 0?jo(r.default,e.default):y(r,e,P,x,b)}}}function jo(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function qd(r,e,i,a,d){return jo(typeof i===d?a[i]:void 0,r.default,e.default)}function Zd(r,e,i){if(Lt(i)!=="number")return jo(r.default,e.default);const a=r.stops.length;if(a===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[a-1][0])return r.stops[a-1][1];const d=va(r.stops.map(m=>m[0]),i);return r.stops[d][1]}function Cc(r,e,i){const a=r.base!==void 0?r.base:1;if(Lt(i)!=="number")return jo(r.default,e.default);const d=r.stops.length;if(d===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[d-1][0])return r.stops[d-1][1];const m=va(r.stops.map(z=>z[0]),i),y=function(z,P,L,B){const F=B-L,K=z-L;return F===0?0:P===1?K/F:(Math.pow(P,K)-1)/(Math.pow(P,F)-1)}(i,a,r.stops[m][0],r.stops[m+1][0]),x=r.stops[m][1],b=r.stops[m+1][1];let T=zs[e.type]||Jt;if(r.colorSpace&&r.colorSpace!=="rgb"){const z=xc[r.colorSpace];T=(P,L)=>z.reverse(z.interpolate(z.forward(P),z.forward(L),y))}return typeof x.evaluate=="function"?{evaluate(...z){const P=x.evaluate.apply(void 0,z),L=b.evaluate.apply(void 0,z);if(P!==void 0&&L!==void 0)return T(P,L,y)}}:T(x,b,y)}function Hd(r,e,i){switch(e.type){case"color":i=U.parse(i);break;case"formatted":i=Q.fromString(i.toString());break;case"resolvedImage":i=oe.fromString(i.toString());break;case"padding":i=J.parse(i);break;default:Lt(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return jo(i,r.default,e.default)}$t.register(Vo,{error:[{kind:"error"},[gt],(r,[e])=>{throw new je(e.evaluate(r))}],typeof:[gt,[dt],(r,[e])=>Nt(me(e.evaluate(r)))],"to-rgba":[Zn(Le,4),[Dn],(r,[e])=>e.evaluate(r).toArray()],rgb:[Dn,[Le,Le,Le],Sc],rgba:[Dn,[Le,Le,Le,Le],Sc],has:{type:ft,overloads:[[[gt],(r,[e])=>Ec(e.evaluate(r),r.properties())],[[gt,Ui],(r,[e,i])=>Ec(e.evaluate(r),i.evaluate(r))]]},get:{type:dt,overloads:[[[gt],(r,[e])=>ka(e.evaluate(r),r.properties())],[[gt,Ui],(r,[e,i])=>ka(e.evaluate(r),i.evaluate(r))]]},"feature-state":[dt,[gt],(r,[e])=>ka(e.evaluate(r),r.featureState||{})],properties:[Ui,[],r=>r.properties()],"geometry-type":[gt,[],r=>r.geometryType()],id:[dt,[],r=>r.id()],zoom:[Le,[],r=>r.globals.zoom],"heatmap-density":[Le,[],r=>r.globals.heatmapDensity||0],"line-progress":[Le,[],r=>r.globals.lineProgress||0],accumulated:[dt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Le,so(Le),(r,e)=>{let i=0;for(const a of e)i+=a.evaluate(r);return i}],"*":[Le,so(Le),(r,e)=>{let i=1;for(const a of e)i*=a.evaluate(r);return i}],"-":{type:Le,overloads:[[[Le,Le],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[Le],(r,[e])=>-e.evaluate(r)]]},"/":[Le,[Le,Le],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[Le,[Le,Le],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[Le,[],()=>Math.LN2],pi:[Le,[],()=>Math.PI],e:[Le,[],()=>Math.E],"^":[Le,[Le,Le],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[Le,[Le],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Le,[Le],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Le,[Le],(r,[e])=>Math.log(e.evaluate(r))],log2:[Le,[Le],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Le,[Le],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Le,[Le],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Le,[Le],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Le,[Le],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Le,[Le],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Le,[Le],(r,[e])=>Math.atan(e.evaluate(r))],min:[Le,so(Le),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[Le,so(Le),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[Le,[Le],(r,[e])=>Math.abs(e.evaluate(r))],round:[Le,[Le],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Le,[Le],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Le,[Le],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[ft,[gt,dt],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[ft,[dt],(r,[e])=>r.id()===e.value],"filter-type-==":[ft,[gt],(r,[e])=>r.geometryType()===e.value],"filter-<":[ft,[gt,dt],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a<d}],"filter-id-<":[ft,[dt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[ft,[gt,dt],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a>d}],"filter-id->":[ft,[dt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[ft,[gt,dt],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[ft,[dt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[ft,[gt,dt],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[ft,[dt],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[ft,[dt],(r,[e])=>e.value in r.properties()],"filter-has-id":[ft,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[ft,[Zn(gt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[ft,[Zn(dt)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[ft,[gt,Zn(dt)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[ft,[gt,Zn(dt)],(r,[e,i])=>function(a,d,m,y){for(;m<=y;){const x=m+y>>1;if(d[x]===a)return!0;d[x]>a?y=x-1:m=x+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:ft,overloads:[[[ft,ft],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[so(ft),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:ft,overloads:[[[ft,ft],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[so(ft),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[ft,[ft],(r,[e])=>!e.evaluate(r)],"is-supported-script":[ft,[gt],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[gt,[gt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[gt,[gt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[gt,so(dt),(r,e)=>e.map(i=>Ke(i.evaluate(r))).join("")],"resolved-locale":[gt,[xi],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Ca{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new zt,this._defaultValue=i?function(a){return a.type==="color"&&qt(a.default)?new U(0,0,0,0):a.type==="color"?U.parse(a.default)||null:a.type==="padding"?J.parse(a.default)||null:a.default===void 0?null:a.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,d,m,y){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new je(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Ds(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Vo}function Ls(r,e){const i=new No(Vo,[],e?function(d){const m={color:Dn,string:gt,number:Le,enum:gt,boolean:ft,formatted:En,padding:Lo,resolvedImage:mn};return d.type==="array"?Zn(m[d.value]||dt,d.length):m[d.type]}(e):void 0),a=i.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Tc(new Ca(a,e)):$o(i.errors)}class Rs{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!Oo(i.expression)}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,y)}evaluate(e,i,a,d,m,y){return this._styleExpression.evaluate(e,i,a,d,m,y)}}class Ul{constructor(e,i,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Oo(i.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,y)}evaluate(e,i,a,d,m,y){return this._styleExpression.evaluate(e,i,a,d,m,y)}interpolationFactor(e,i,a){return this.interpolationType?gr.interpolationFactor(this.interpolationType,e,i,a):0}}function Ic(r,e){const i=Ls(r,e);if(i.result==="error")return i;const a=i.value.expression,d=Cs(a);if(!d&&!Ht(e))return $o([new fr("","data expressions not supported")]);const m=ya(a,["zoom"]);if(!m&&!kc(e))return $o([new fr("","zoom expressions not supported")]);const y=za(a);return y||m?y instanceof fr?$o([y]):y instanceof gr&&!St(e)?$o([new fr("",'"interpolate" expressions cannot be used with this property')]):Tc(y?new Ul(d?"camera":"composite",i.value,y.labels,y instanceof gr?y.interpolation:void 0):new Rs(d?"constant":"source",i.value)):$o([new fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ia{constructor(e,i){this._parameters=e,this._specification=i,Vr(this,Ms(this._parameters,this._specification))}static deserialize(e){return new Ia(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function za(r){let e=null;if(r instanceof ba)e=za(r.result);else if(r instanceof wa){for(const i of r.args)if(e=za(i),e)break}else(r instanceof Is||r instanceof gr)&&r.input instanceof $t&&r.input.name==="zoom"&&(e=r);return e instanceof fr||r.eachChild(i=>{const a=za(i);a instanceof fr?e=a:!e&&a?e=new fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function $r(r){const e=r.key,i=r.value,a=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,y=r.styleSpec;let x=[];const b=Lt(i);if(b!=="object")return[new Oe(e,i,`object expected, ${b} found`)];for(const T in i){const z=T.split(".")[0],P=a[z]||a["*"];let L;if(d[z])L=d[z];else if(a[z])L=_r;else if(d["*"])L=d["*"];else{if(!a["*"]){x.push(new Oe(e,i[T],`unknown property "${T}"`));continue}L=_r}x=x.concat(L({key:(e&&`${e}.`)+T,value:i[T],valueSpec:P,style:m,styleSpec:y,object:i,objectKey:T},i))}for(const T in a)d[T]||a[T].required&&a[T].default===void 0&&i[T]===void 0&&x.push(new Oe(e,i,`missing required property "${T}"`));return x}function zc(r){const e=r.value,i=r.valueSpec,a=r.style,d=r.styleSpec,m=r.key,y=r.arrayElementValidator||_r;if(Lt(e)!=="array")return[new Oe(m,e,`array expected, ${Lt(e)} found`)];if(i.length&&e.length!==i.length)return[new Oe(m,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Oe(m,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let x={type:i.value,values:i.values};d.$version<7&&(x.function=i.function),Lt(i.value)==="object"&&(x=i.value);let b=[];for(let T=0;T<e.length;T++)b=b.concat(y({array:e,arrayIndex:T,value:e[T],valueSpec:x,style:a,styleSpec:d,key:`${m}[${T}]`}));return b}function Vl(r){const e=r.key,i=r.value,a=r.valueSpec;let d=Lt(i);return d==="number"&&i!=i&&(d="NaN"),d!=="number"?[new Oe(e,i,`number expected, ${d} found`)]:"minimum"in a&&i<a.minimum?[new Oe(e,i,`${i} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&i>a.maximum?[new Oe(e,i,`${i} is greater than the maximum value ${a.maximum}`)]:[]}function Ac(r){const e=r.valueSpec,i=Ct(r.value.type);let a,d,m,y={};const x=i!=="categorical"&&r.value.property===void 0,b=!x,T=Lt(r.value.stops)==="array"&&Lt(r.value.stops[0])==="array"&&Lt(r.value.stops[0][0])==="object",z=$r({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(B){if(i==="identity")return[new Oe(B.key,B.value,'identity function may not have a "stops" property')];let F=[];const K=B.value;return F=F.concat(zc({key:B.key,value:K,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:P})),Lt(K)==="array"&&K.length===0&&F.push(new Oe(B.key,K,"array must have at least one stop")),F},default:function(B){return _r({key:B.key,value:B.value,valueSpec:e,style:B.style,styleSpec:B.styleSpec})}}});return i==="identity"&&x&&z.push(new Oe(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||z.push(new Oe(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!St(r.valueSpec)&&z.push(new Oe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(b&&!Ht(r.valueSpec)?z.push(new Oe(r.key,r.value,"property functions not supported")):x&&!kc(r.valueSpec)&&z.push(new Oe(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!T||r.value.property!==void 0||z.push(new Oe(r.key,r.value,'"property" property is required')),z;function P(B){let F=[];const K=B.value,X=B.key;if(Lt(K)!=="array")return[new Oe(X,K,`array expected, ${Lt(K)} found`)];if(K.length!==2)return[new Oe(X,K,`array length 2 expected, length ${K.length} found`)];if(T){if(Lt(K[0])!=="object")return[new Oe(X,K,`object expected, ${Lt(K[0])} found`)];if(K[0].zoom===void 0)return[new Oe(X,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Oe(X,K,"object stop key must have value")];if(m&&m>Ct(K[0].zoom))return[new Oe(X,K[0].zoom,"stop zoom values must appear in ascending order")];Ct(K[0].zoom)!==m&&(m=Ct(K[0].zoom),d=void 0,y={}),F=F.concat($r({key:`${X}[0]`,value:K[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Vl,value:L}}))}else F=F.concat(L({key:`${X}[0]`,value:K[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},K));return Ds(zr(K[1]))?F.concat([new Oe(`${X}[1]`,K[1],"expressions are not allowed in function stops.")]):F.concat(_r({key:`${X}[1]`,value:K[1],valueSpec:e,style:B.style,styleSpec:B.styleSpec}))}function L(B,F){const K=Lt(B.value),X=Ct(B.value),ue=B.value!==null?B.value:F;if(a){if(K!==a)return[new Oe(B.key,ue,`${K} stop domain type must match previous stop domain type ${a}`)]}else a=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new Oe(B.key,ue,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&i!=="categorical"){let fe=`number expected, ${K} found`;return Ht(e)&&i===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Oe(B.key,ue,fe)]}return i!=="categorical"||K!=="number"||isFinite(X)&&Math.floor(X)===X?i!=="categorical"&&K==="number"&&d!==void 0&&X<d?[new Oe(B.key,ue,"stop domain values must appear in ascending order")]:(d=X,i==="categorical"&&X in y?[new Oe(B.key,ue,"stop domain values must be unique")]:(y[X]=!0,[])):[new Oe(B.key,ue,`integer expected, found ${X}`)]}}function ao(r){const e=(r.expressionContext==="property"?Ic:Ls)(zr(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new Oe(`${r.key}${a.key}`,r.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new Oe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Oo(i))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Oo(i))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ya(i,["zoom","feature-state"]))return[new Oe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Cs(i))return[new Oe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bs(r){const e=r.key,i=r.value,a=r.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(Ct(i))===-1&&d.push(new Oe(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(Ct(i))===-1&&d.push(new Oe(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),d}function Go(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Go(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Wd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Aa(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Go(r)||(r=Fs(r));const e=Ls(r,Wd);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,a,d)=>e.value.evaluate(i,a,{},d),needGeometry:Mc(r)}}function Pc(r,e){return r<e?-1:r>e?1:0}function Mc(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(Mc(r[e]))return!0;return!1}function Fs(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?$l(r[1],r[2],"=="):e==="!="?qo($l(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?$l(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map(Fs))):e==="all"?["all"].concat(r.slice(1).map(Fs)):e==="none"?["all"].concat(r.slice(1).map(Fs).map(qo)):e==="in"?Pa(r[1],r.slice(2)):e==="!in"?qo(Pa(r[1],r.slice(2))):e==="has"?Os(r[1]):e==="!has"?qo(Os(r[1])):e!=="within"||r;var i}function $l(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function Pa(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort(Pc)]]:["filter-in-small",r,["literal",e]]}}function Os(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function qo(r){return["!",r]}function Ns(r){return Go(zr(r.value))?ao(Vr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Dc(r)}function Dc(r){const e=r.value,i=r.key;if(Lt(e)!=="array")return[new Oe(i,e,`array expected, ${Lt(e)} found`)];const a=r.styleSpec;let d,m=[];if(e.length<1)return[new Oe(i,e,"filter array must have at least 1 element")];switch(m=m.concat(Bs({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),Ct(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Ct(e[1])==="$type"&&m.push(new Oe(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Oe(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=Lt(e[1]),d!=="string"&&m.push(new Oe(`${i}[1]`,e[1],`string expected, ${d} found`)));for(let y=2;y<e.length;y++)d=Lt(e[y]),Ct(e[1])==="$type"?m=m.concat(Bs({key:`${i}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Oe(`${i}[${y}]`,e[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(Dc({key:`${i}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=Lt(e[1]),e.length!==2?m.push(new Oe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Oe(`${i}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=Lt(e[1]),e.length!==2?m.push(new Oe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Oe(`${i}[1]`,e[1],`object expected, ${d} found`))}return m}function Us(r,e){const i=r.key,a=r.style,d=r.styleSpec,m=r.value,y=r.objectKey,x=d[`${e}_${r.layerType}`];if(!x)return[];const b=y.match(/^(.*)-transition$/);if(e==="paint"&&b&&x[b[1]]&&x[b[1]].transition)return _r({key:i,value:m,valueSpec:d.transition,style:a,styleSpec:d});const T=r.valueSpec||x[y];if(!T)return[new Oe(i,m,`unknown property "${y}"`)];let z;if(Lt(m)==="string"&&Ht(T)&&!T.tokens&&(z=/^{([^}]+)}$/.exec(m)))return[new Oe(i,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const P=[];return r.layerType==="symbol"&&(y==="text-field"&&a&&!a.glyphs&&P.push(new Oe(i,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&qt(zr(m))&&Ct(m.type)==="identity"&&P.push(new Oe(i,m,'"text-font" does not support identity functions'))),P.concat(_r({key:r.key,value:m,valueSpec:T,style:a,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:y}))}function Lc(r){return Us(r,"paint")}function Rc(r){return Us(r,"layout")}function Bc(r){let e=[];const i=r.value,a=r.key,d=r.style,m=r.styleSpec;i.type||i.ref||e.push(new Oe(a,i,'either "type" or "ref" is required'));let y=Ct(i.type);const x=Ct(i.ref);if(i.id){const b=Ct(i.id);for(let T=0;T<r.arrayIndex;T++){const z=d.layers[T];Ct(z.id)===b&&e.push(new Oe(a,i.id,`duplicate layer id "${i.id}", previously used at line ${z.id.__line__}`))}}if("ref"in i){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&e.push(new Oe(a,i[T],`"${T}" is prohibited for ref layers`))}),d.layers.forEach(T=>{Ct(T.id)===x&&(b=T)}),b?b.ref?e.push(new Oe(a,i.ref,"ref cannot reference another ref layer")):y=Ct(b.type):e.push(new Oe(a,i.ref,`ref layer "${x}" not found`))}else if(y!=="background")if(i.source){const b=d.sources&&d.sources[i.source],T=b&&Ct(b.type);b?T==="vector"&&y==="raster"?e.push(new Oe(a,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&y!=="raster"?e.push(new Oe(a,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&y!=="hillshade"?e.push(new Oe(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!i.paint||!i.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||e.push(new Oe(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Oe(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Oe(a,i.source,`source "${i.source}" not found`))}else e.push(new Oe(a,i,'missing required property "source"'));return e=e.concat($r({key:a,value:i,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_r({key:`${a}.type`,value:i.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:Ns,layout:b=>$r({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Rc(Vr({layerType:y},T))}}),paint:b=>$r({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Lc(Vr({layerType:y},T))}})}})),e}function Zo(r){const e=r.value,i=r.key,a=Lt(e);return a!=="string"?[new Oe(i,e,`string expected, ${a} found`)]:[]}const Fc={promoteId:function({key:r,value:e}){if(Lt(e)==="string")return Zo({key:r,value:e});{const i=[];for(const a in e)i.push(...Zo({key:`${r}.${a}`,value:e[a]}));return i}}};function Vs(r){const e=r.value,i=r.key,a=r.styleSpec,d=r.style;if(!e.type)return[new Oe(i,e,'"type" is required')];const m=Ct(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=$r({key:i,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:Fc}),y;case"geojson":if(y=$r({key:i,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,objectElementValidators:Fc}),e.cluster)for(const x in e.clusterProperties){const[b,T]=e.clusterProperties[x],z=typeof b=="string"?[b,["accumulated"],["get",x]]:b;y.push(...ao({key:`${i}.${x}.map`,value:T,expressionContext:"cluster-map"})),y.push(...ao({key:`${i}.${x}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return y;case"video":return $r({key:i,value:e,valueSpec:a.source_video,style:d,styleSpec:a});case"image":return $r({key:i,value:e,valueSpec:a.source_image,style:d,styleSpec:a});case"canvas":return[new Oe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bs({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:a})}}function $s(r){const e=r.value,i=r.styleSpec,a=i.light,d=r.style;let m=[];const y=Lt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Oe("light",e,`object expected, ${y} found`)]),m;for(const x in e){const b=x.match(/^(.*)-transition$/);m=m.concat(b&&a[b[1]]&&a[b[1]].transition?_r({key:x,value:e[x],valueSpec:i.transition,style:d,styleSpec:i}):a[x]?_r({key:x,value:e[x],valueSpec:a[x],style:d,styleSpec:i}):[new Oe(x,e[x],`unknown property "${x}"`)])}return m}function yr(r){const e=r.value,i=r.styleSpec,a=i.terrain,d=r.style;let m=[];const y=Lt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Oe("terrain",e,`object expected, ${y} found`)]),m;for(const x in e)m=m.concat(a[x]?_r({key:x,value:e[x],valueSpec:a[x],style:d,styleSpec:i}):[new Oe(x,e[x],`unknown property "${x}"`)]);return m}const js={"*":()=>[],array:zc,boolean:function(r){const e=r.value,i=r.key,a=Lt(e);return a!=="boolean"?[new Oe(i,e,`boolean expected, ${a} found`)]:[]},number:Vl,color:function(r){const e=r.key,i=r.value,a=Lt(i);return a!=="string"?[new Oe(e,i,`color expected, ${a} found`)]:Bo(i)===null?[new Oe(e,i,`color expected, "${i}" found`)]:[]},constants:to,enum:Bs,filter:Ns,function:Ac,layer:Bc,object:$r,source:Vs,light:$s,terrain:yr,string:Zo,formatted:function(r){return Zo(r).length===0?[]:ao(r)},resolvedImage:function(r){return Zo(r).length===0?[]:ao(r)},padding:function(r){const e=r.key,i=r.value;if(Lt(i)==="array"){if(i.length<1||i.length>4)return[new Oe(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<i.length;m++)d=d.concat(_r({key:`${e}[${m}]`,value:i[m],valueSpec:a}));return d}return Vl({key:e,value:i,valueSpec:{}})}};function _r(r){const e=r.value,i=r.valueSpec,a=r.styleSpec;return i.expression&&qt(Ct(e))?Ac(r):i.expression&&Ds(zr(e))?ao(r):i.type&&js[i.type]?js[i.type](r):$r(Vr({},r,{valueSpec:i.type?a[i.type]:i}))}function Xd(r){const e=r.value,i=r.key,a=Zo(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Oe(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Oe(i,e,'"glyphs" url must include a "{range}" token'))),a}function Vi(r,e=xe){let i=[];return i=i.concat(_r({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:Xd,"*":()=>[]}})),r.constants&&(i=i.concat(to({key:"constants",value:r.constants,style:r,styleSpec:e}))),Oc(i)}function Oc(r){return[].concat(r).sort((e,i)=>e.line-i.line)}function wi(r){return function(...e){return Oc(r.apply(this,e))}}Vi.source=wi(Vs),Vi.light=wi($s),Vi.terrain=wi(yr),Vi.layer=wi(Bc),Vi.filter=wi(Ns),Vi.paintProperty=wi(Lc),Vi.layoutProperty=wi(Rc);const Gs=Vi,jl=Gs.light,Kd=Gs.paintProperty,Yd=Gs.layoutProperty;function Ma(r,e){let i=!1;if(e&&e.length)for(const a of e)r.fire(new Do(new Error(a.message))),i=!0;return i}class qs{constructor(e,i,a){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(i=y[1])+2*(a=y[2]);for(let b=0;b<this.d*this.d;b++){const T=y[3+b],z=y[3+b+1];d.push(T===z?null:y.subarray(T,z))}const x=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],x),this.bboxes=y.subarray(x),this.insert=this._insertReadonly}else{this.d=i+2*a;for(let y=0;y<this.d*this.d;y++)d.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=a,this.scale=i/e,this.uid=0;const m=a/i*e;this.min=-m,this.max=e+m}insert(e,i,a,d,m){this._forEachCell(i,a,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,a,d,m,y){this.cells[m].push(y)}query(e,i,a,d,m){const y=this.min,x=this.max;if(e<=y&&i<=y&&x<=a&&x<=d&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,i,a,d,this._queryCell,b,{},m),b}}_queryCell(e,i,a,d,m,y,x,b){const T=this.cells[m];if(T!==null){const z=this.keys,P=this.bboxes;for(let L=0;L<T.length;L++){const B=T[L];if(x[B]===void 0){const F=4*B;(b?b(P[F+0],P[F+1],P[F+2],P[F+3]):e<=P[F+2]&&i<=P[F+3]&&a>=P[F+0]&&d>=P[F+1])?(x[B]=!0,y.push(z[B])):x[B]=!1}}}}_forEachCell(e,i,a,d,m,y,x,b){const T=this._convertToCellCoord(e),z=this._convertToCellCoord(i),P=this._convertToCellCoord(a),L=this._convertToCellCoord(d);for(let B=T;B<=P;B++)for(let F=z;F<=L;F++){const K=this.d*F+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(F),this._convertFromCellCoord(B+1),this._convertFromCellCoord(F+1)))&&m.call(this,e,i,a,d,K,y,x,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let a=0;for(let y=0;y<this.cells.length;y++)a+=this.cells[y].length;const d=new Int32Array(i+a+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=i;for(let y=0;y<e.length;y++){const x=e[y];d[3+y]=m,d.set(x,m),m+=x.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,i){const a=e.toArrayBuffer();return i&&i.push(a),{buffer:a}}static deserialize(e){return new qs(e.buffer)}}const bi={};function Xe(r,e,i={}){if(bi[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),bi[r]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Xe("Object",Object),Xe("TransferableGridIndex",qs),Xe("Color",U),Xe("Error",Error),Xe("AJAXError",pr),Xe("ResolvedImage",oe),Xe("StylePropertyFunction",Ia),Xe("StyleExpression",Ca,{omit:["_evaluator"]}),Xe("ZoomDependentExpression",Ul),Xe("ZoomConstantExpression",Rs),Xe("CompoundExpression",$t,{omit:["_evaluate"]});for(const r in Vo)Vo[r]._classRegistryKey||Xe(`Expression_${r}`,Vo[r]);function Nc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function lo(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Nc(r)||Nr(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.push(i.buffer),i}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const a of r)i.push(lo(a,e));return i}if(typeof r=="object"){const i=r.constructor,a=i._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");if(!bi[a])throw new Error(`${a} is not registered.`);const d=i.serialize?i.serialize(r,e):{};if(i.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||bi[a].omit.indexOf(m)>=0)continue;const y=r[m];d[m]=bi[a].shallow.indexOf(m)>=0?y:lo(y,e)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(d.$name=a),d}throw new Error("can't serialize object of type "+typeof r)}function $i(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Nc(r)||Nr(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map($i);if(typeof r=="object"){const e=r.$name||"Object";if(!bi[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=bi[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const a=Object.create(i.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const m=r[d];a[d]=bi[e].shallow.indexOf(d)>=0?m:$i(m)}return a}throw new Error("can't deserialize object of type "+typeof r)}class Gl{constructor(){this.first=!0}update(e,i){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Ue={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Da(r){for(const e of r)if(Zl(e.charCodeAt(0)))return!0;return!1}function Jd(r){for(const e of r)if(!ql(e.charCodeAt(0)))return!1;return!0}function ql(r){return!(Ue.Arabic(r)||Ue["Arabic Supplement"](r)||Ue["Arabic Extended-A"](r)||Ue["Arabic Presentation Forms-A"](r)||Ue["Arabic Presentation Forms-B"](r))}function Zl(r){return!(r!==746&&r!==747&&(r<4352||!(Ue["Bopomofo Extended"](r)||Ue.Bopomofo(r)||Ue["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Ue["CJK Compatibility Ideographs"](r)||Ue["CJK Compatibility"](r)||Ue["CJK Radicals Supplement"](r)||Ue["CJK Strokes"](r)||!(!Ue["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Ue["CJK Unified Ideographs Extension A"](r)||Ue["CJK Unified Ideographs"](r)||Ue["Enclosed CJK Letters and Months"](r)||Ue["Hangul Compatibility Jamo"](r)||Ue["Hangul Jamo Extended-A"](r)||Ue["Hangul Jamo Extended-B"](r)||Ue["Hangul Jamo"](r)||Ue["Hangul Syllables"](r)||Ue.Hiragana(r)||Ue["Ideographic Description Characters"](r)||Ue.Kanbun(r)||Ue["Kangxi Radicals"](r)||Ue["Katakana Phonetic Extensions"](r)||Ue.Katakana(r)&&r!==12540||!(!Ue["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Ue["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Ue["Unified Canadian Aboriginal Syllabics"](r)||Ue["Unified Canadian Aboriginal Syllabics Extended"](r)||Ue["Vertical Forms"](r)||Ue["Yijing Hexagram Symbols"](r)||Ue["Yi Syllables"](r)||Ue["Yi Radicals"](r))))}function Uc(r){return!(Zl(r)||function(e){return!!(Ue["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ue["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ue["Letterlike Symbols"](e)||Ue["Number Forms"](e)||Ue["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ue["Control Pictures"](e)&&e!==9251||Ue["Optical Character Recognition"](e)||Ue["Enclosed Alphanumerics"](e)||Ue["Geometric Shapes"](e)||Ue["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ue["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ue["CJK Symbols and Punctuation"](e)||Ue.Katakana(e)||Ue["Private Use Area"](e)||Ue["CJK Compatibility Forms"](e)||Ue["Small Form Variants"](e)||Ue["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Vc(r){return r>=1424&&r<=2303||Ue["Arabic Presentation Forms-A"](r)||Ue["Arabic Presentation Forms-B"](r)}function Qd(r,e){return!(!e&&Vc(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Ue.Khmer(r))}function $c(r){for(const e of r)if(Vc(e.charCodeAt(0)))return!0;return!1}const Hl="deferred",Wl="loading",Xl="loaded";let Kl=null,nr="unavailable",ji=null;const jc=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(nr="error"),Kl&&Kl(r)};function Ho(){Yl.fire(new _i("pluginStateChange",{pluginStatus:nr,pluginURL:ji}))}const Yl=new vi,Zs=function(){return nr},Gc=function(){if(nr!==Hl||!ji)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nr=Wl,Ho(),ji&&Mo({url:ji},r=>{r?jc(r):(nr=Xl,Ho())})},Ar={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>nr===Xl||Ar.applyArabicShaping!=null,isLoading:()=>nr===Wl,setState(r){if(!Fe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");nr=r.pluginStatus,ji=r.pluginURL},isParsed(){if(!Fe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Ar.applyArabicShaping!=null&&Ar.processBidirectionalText!=null&&Ar.processStyledBidirectionalText!=null},getPluginURL(){if(!Fe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ji}};class Qt{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gl,this.transition={})}isSupportedScript(e){return function(i,a){for(const d of i)if(!Qd(d.charCodeAt(0),a))return!1;return!0}(e,Ar.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class Hs{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,d){if(qt(a))return new Ia(a,d);if(Ds(a)){const m=Ic(a,d);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return d.type==="color"&&typeof a=="string"?m=U.parse(a):d.type!=="padding"||typeof a!="number"&&!Array.isArray(a)||(m=J.parse(a)),{kind:"constant",evaluate:()=>m}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class La{constructor(e){this.property=e,this.value=new Hs(e,void 0)}transitioned(e,i){return new Zc(this.property,this.value,i,Te({},e.transition,this.transition),e.now)}untransitioned(){return new Zc(this.property,this.value,null,{},0)}}class qc{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return re(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new La(this._values[e].property)),this._values[e].value=new Hs(this._values[e].property,i===null?void 0:re(i))}getTransition(e){return re(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new La(this._values[e].property)),this._values[e].transition=re(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a);const d=this.getTransition(i);d!==void 0&&(e[`${i}-transition`]=d)}return e}transitioned(e,i){const a=new Hc(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].transitioned(e,i._values[d]);return a}untransitioned(){const e=new Hc(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Zc{constructor(e,i,a,d,m){this.property=e,this.value=i,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const d=e.now||0,m=this.value.possiblyEvaluate(e,i,a),y=this.prior;if(y){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return y.possiblyEvaluate(e,i,a);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,i,a),m,function(b){if(b<=0)return 0;if(b>=1)return 1;const T=b*b,z=T*b;return 4*(b<.5?z:3*(b-T)+z-.75)}(x))}}return m}}class Hc{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const d=new Ws(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ep{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return re(this._values[e].value)}setValue(e,i){this._values[e]=new Hs(this._values[e].property,i===null?void 0:re(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const d=new Ws(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}}class ri{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,a,d){return this.property.evaluate(this.value,this.parameters,e,i,a,d)}}class Ws{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Qe{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,a){const d=zs[this.specification.type];return d?d(e,i,a):e}}class ot{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,d){return new ri(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},a,d)}:e.expression,i)}interpolate(e,i,a){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new ri(this,{kind:"constant",value:void 0},e.parameters);const d=zs[this.specification.type];return d?new ri(this,{kind:"constant",value:d(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,d,m,y){return e.kind==="constant"?e.value:e.evaluate(i,a,d,m,y)}}class Wo extends ot{possiblyEvaluate(e,i,a,d){if(e.value===void 0)return new ri(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const m=e.expression.evaluate(i,null,{},a,d),y=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,x=this._calculate(y,y,y,i);return new ri(this,{kind:"constant",value:x},i)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new ri(this,{kind:"constant",value:m},i)}return new ri(this,e.expression,i)}evaluate(e,i,a,d,m,y){if(e.kind==="source"){const x=e.evaluate(i,a,d,m,y);return this._calculate(x,x,x,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},a,d),e.evaluate({zoom:Math.floor(i.zoom)},a,d),e.evaluate({zoom:Math.floor(i.zoom)+1},a,d),i):e.value}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class Jl{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(i,null,{},a,d);return this._calculate(m,m,m,i)}return this._calculate(e.expression.evaluate(new Qt(Math.floor(i.zoom-1),i)),e.expression.evaluate(new Qt(Math.floor(i.zoom),i)),e.expression.evaluate(new Qt(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class Gi{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){return!!e.expression.evaluate(i,null,{},a,d)}interpolate(){return!1}}class Ln{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const a=e[i];a.specification.overridable&&this.overridableProperties.push(i);const d=this.defaultPropertyValues[i]=new Hs(a,void 0),m=this.defaultTransitionablePropertyValues[i]=new La(a);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=d.possiblyEvaluate({})}}}Xe("DataDrivenProperty",ot),Xe("DataConstantProperty",Qe),Xe("CrossFadedDataDrivenProperty",Wo),Xe("CrossFadedProperty",Jl),Xe("ColorRampProperty",Gi);const qi="-transition";class ii extends vi{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new ep(i.layout)),i.paint)){this._transitionablePaint=new qc(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ws(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){i!=null&&this._validate(Yd,`layers.${this.id}.layout.${e}`,e,i,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return e.endsWith(qi)?this._transitionablePaint.getTransition(e.slice(0,-qi.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(i!=null&&this._validate(Kd,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(e.endsWith(qi))return this._transitionablePaint.setTransition(e.slice(0,-qi.length),i||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,x,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),H(e,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(e,i,a,d,m={}){return(!m||m.validate!==!1)&&Ma(this,e.call(Gs,{key:i,layerType:this.type,objectKey:a,value:d,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof ri&&Ht(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const Wc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Zi{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ln{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function gn(r,e=1){let i=0,a=0;return{members:r.map(d=>{const m=Wc[d.type].BYTES_PER_ELEMENT,y=i=Ql(i,Math.max(e,m)),x=d.components||1;return a=Math.max(a,m),i+=m*x,{name:d.name,type:d.type,components:x,offset:y}}),size:Ql(i,Math.max(a,e)),alignment:e}}function Ql(r,e){return Math.ceil(r/e)*e}class uo extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.int16[d+0]=i,this.int16[d+1]=a,e}}uo.prototype.bytesPerElement=4,Xe("StructArrayLayout2i4",uo);class h extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=4*e;return this.int16[y+0]=i,this.int16[y+1]=a,this.int16[y+2]=d,this.int16[y+3]=m,e}}h.prototype.bytesPerElement=8,Xe("StructArrayLayout4i8",h);class t extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=6*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=x,e}}t.prototype.bytesPerElement=12,Xe("StructArrayLayout2i4i12",t);class s extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=4*e,T=8*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.uint8[T+4]=d,this.uint8[T+5]=m,this.uint8[T+6]=y,this.uint8[T+7]=x,e}}s.prototype.bytesPerElement=8,Xe("StructArrayLayout2i4ub8",s);class c extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.float32[d+0]=i,this.float32[d+1]=a,e}}c.prototype.bytesPerElement=8,Xe("StructArrayLayout2f8",c);class p extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z){const P=this.length;return this.resize(P+1),this.emplace(P,e,i,a,d,m,y,x,b,T,z)}emplace(e,i,a,d,m,y,x,b,T,z,P){const L=10*e;return this.uint16[L+0]=i,this.uint16[L+1]=a,this.uint16[L+2]=d,this.uint16[L+3]=m,this.uint16[L+4]=y,this.uint16[L+5]=x,this.uint16[L+6]=b,this.uint16[L+7]=T,this.uint16[L+8]=z,this.uint16[L+9]=P,e}}p.prototype.bytesPerElement=20,Xe("StructArrayLayout10ui20",p);class g extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,P,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,a,d,m,y,x,b,T,z,P,L)}emplace(e,i,a,d,m,y,x,b,T,z,P,L,B){const F=12*e;return this.int16[F+0]=i,this.int16[F+1]=a,this.int16[F+2]=d,this.int16[F+3]=m,this.uint16[F+4]=y,this.uint16[F+5]=x,this.uint16[F+6]=b,this.uint16[F+7]=T,this.int16[F+8]=z,this.int16[F+9]=P,this.int16[F+10]=L,this.int16[F+11]=B,e}}g.prototype.bytesPerElement=24,Xe("StructArrayLayout4i4ui4i24",g);class v extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.float32[m+0]=i,this.float32[m+1]=a,this.float32[m+2]=d,e}}v.prototype.bytesPerElement=12,Xe("StructArrayLayout3f12",v);class S extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}S.prototype.bytesPerElement=4,Xe("StructArrayLayout1ul4",S);class E extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T){const z=this.length;return this.resize(z+1),this.emplace(z,e,i,a,d,m,y,x,b,T)}emplace(e,i,a,d,m,y,x,b,T,z){const P=10*e,L=5*e;return this.int16[P+0]=i,this.int16[P+1]=a,this.int16[P+2]=d,this.int16[P+3]=m,this.int16[P+4]=y,this.int16[P+5]=x,this.uint32[L+3]=b,this.uint16[P+8]=T,this.uint16[P+9]=z,e}}E.prototype.bytesPerElement=20,Xe("StructArrayLayout6i1ul2ui20",E);class k extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=6*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=x,e}}k.prototype.bytesPerElement=12,Xe("StructArrayLayout2i2i2i12",k);class A extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,a,d,m)}emplace(e,i,a,d,m,y){const x=4*e,b=8*e;return this.float32[x+0]=i,this.float32[x+1]=a,this.float32[x+2]=d,this.int16[b+6]=m,this.int16[b+7]=y,e}}A.prototype.bytesPerElement=16,Xe("StructArrayLayout2f1f2i16",A);class D extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=12*e,x=3*e;return this.uint8[y+0]=i,this.uint8[y+1]=a,this.float32[x+1]=d,this.float32[x+2]=m,e}}D.prototype.bytesPerElement=12,Xe("StructArrayLayout2ub2f12",D);class R extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=a,this.uint16[m+2]=d,e}}R.prototype.bytesPerElement=6,Xe("StructArrayLayout3ui6",R);class Z extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue){const fe=this.length;return this.resize(fe+1),this.emplace(fe,e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue)}emplace(e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue,fe){const le=24*e,de=12*e,Se=48*e;return this.int16[le+0]=i,this.int16[le+1]=a,this.uint16[le+2]=d,this.uint16[le+3]=m,this.uint32[de+2]=y,this.uint32[de+3]=x,this.uint32[de+4]=b,this.uint16[le+10]=T,this.uint16[le+11]=z,this.uint16[le+12]=P,this.float32[de+7]=L,this.float32[de+8]=B,this.uint8[Se+36]=F,this.uint8[Se+37]=K,this.uint8[Se+38]=X,this.uint32[de+10]=ue,this.int16[le+22]=fe,e}}Z.prototype.bytesPerElement=48,Xe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Z);class $ extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue,fe,le,de,Se,be,Ze,Ye,Ve,Be,Me,$e){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue,fe,le,de,Se,be,Ze,Ye,Ve,Be,Me,$e)}emplace(e,i,a,d,m,y,x,b,T,z,P,L,B,F,K,X,ue,fe,le,de,Se,be,Ze,Ye,Ve,Be,Me,$e,Ne){const Ce=34*e,rt=17*e;return this.int16[Ce+0]=i,this.int16[Ce+1]=a,this.int16[Ce+2]=d,this.int16[Ce+3]=m,this.int16[Ce+4]=y,this.int16[Ce+5]=x,this.int16[Ce+6]=b,this.int16[Ce+7]=T,this.uint16[Ce+8]=z,this.uint16[Ce+9]=P,this.uint16[Ce+10]=L,this.uint16[Ce+11]=B,this.uint16[Ce+12]=F,this.uint16[Ce+13]=K,this.uint16[Ce+14]=X,this.uint16[Ce+15]=ue,this.uint16[Ce+16]=fe,this.uint16[Ce+17]=le,this.uint16[Ce+18]=de,this.uint16[Ce+19]=Se,this.uint16[Ce+20]=be,this.uint16[Ce+21]=Ze,this.uint16[Ce+22]=Ye,this.uint32[rt+12]=Ve,this.float32[rt+13]=Be,this.float32[rt+14]=Me,this.float32[rt+15]=$e,this.float32[rt+16]=Ne,e}}$.prototype.bytesPerElement=68,Xe("StructArrayLayout8i15ui1ul4f68",$);class G extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}G.prototype.bytesPerElement=4,Xe("StructArrayLayout1f4",G);class te extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.int16[m+0]=i,this.int16[m+1]=a,this.int16[m+2]=d,e}}te.prototype.bytesPerElement=6,Xe("StructArrayLayout3i6",te);class se extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=4*e;return this.uint32[2*e+0]=i,this.uint16[m+2]=a,this.uint16[m+3]=d,e}}se.prototype.bytesPerElement=8,Xe("StructArrayLayout1ul2ui8",se);class ce extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.uint16[d+0]=i,this.uint16[d+1]=a,e}}ce.prototype.bytesPerElement=4,Xe("StructArrayLayout2ui4",ce);class W extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}W.prototype.bytesPerElement=2,Xe("StructArrayLayout1ui2",W);class pe extends ln{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=4*e;return this.float32[y+0]=i,this.float32[y+1]=a,this.float32[y+2]=d,this.float32[y+3]=m,e}}pe.prototype.bytesPerElement=16,Xe("StructArrayLayout4f16",pe);class he extends Zi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new at(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class _e extends E{get(e){return new he(this,e)}}Xe("CollisionBoxArray",_e);class ve extends Zi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ve.prototype.size=48;class ke extends Z{get(e){return new ve(this,e)}}Xe("PlacedSymbolArray",ke);class ye extends Zi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}ye.prototype.size=68;class Ge extends ${get(e){return new ye(this,e)}}Xe("SymbolInstanceArray",Ge);class Re extends G{getoffsetX(e){return this.float32[1*e+0]}}Xe("GlyphOffsetArray",Re);class qe extends te{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Xe("SymbolLineVertexArray",qe);class mt extends Zi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}mt.prototype.size=8;class _t extends se{get(e){return new mt(this,e)}}Xe("FeatureIndexArray",_t);class nt extends uo{}class Bt extends uo{}class Ft extends uo{}class Et extends t{}class At extends s{}class Ut extends c{}class kn extends p{}class oi extends g{}class jr extends v{}class si extends S{}class Hi extends k{}class Pr extends D{}class rr extends R{}class Si extends ce{}const Ra=gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:xn}=Ra;class xt{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,d){let m=this.segments[this.segments.length-1];return e>xt.MAX_VERTEX_ARRAY_LENGTH&&ze(`Max vertices per segment is ${xt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>xt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,d){return new xt([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:d,vaos:{},sortKey:0}])}}function Rt(r,e){return 256*(r=q(Math.floor(r),0,255))+q(Math.floor(e),0,255)}xt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xe("SegmentVector",xt);const Cn=gn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var In={exports:{}},en={exports:{}};en.exports=function(r,e){var i,a,d,m,y,x,b,T;for(a=r.length-(i=3&r.length),d=e,y=3432918353,x=461845907,T=0;T<a;)b=255&r.charCodeAt(T)|(255&r.charCodeAt(++T))<<8|(255&r.charCodeAt(++T))<<16|(255&r.charCodeAt(++T))<<24,++T,d=27492+(65535&(m=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,i){case 3:b^=(255&r.charCodeAt(T+2))<<16;case 2:b^=(255&r.charCodeAt(T+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&r.charCodeAt(T)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var Mr={exports:{}};Mr.exports=function(r,e){for(var i,a=r.length,d=e^a,m=0;a>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(m)|(255&r.charCodeAt(++m))<<8|(255&r.charCodeAt(++m))<<16|(255&r.charCodeAt(++m))<<24))+((1540483477*(i>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:d^=(255&r.charCodeAt(m+2))<<16;case 2:d^=(255&r.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var co=en.exports,eu=Mr.exports;In.exports=co,In.exports.murmur3=co,In.exports.murmur2=eu;class Xo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,d){this.ids.push(Xc(e)),this.positions.push(i,a,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=Xc(e);let a=0,d=this.ids.length-1;for(;a<d;){const y=a+d>>1;this.ids[y]>=i?d=y:a=y+1}const m=[];for(;this.ids[a]===i;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,i){const a=new Float64Array(e.ids),d=new Uint32Array(e.positions);return tu(a,d,0,a.length-1),i&&i.push(a.buffer,d.buffer),{ids:a,positions:d}}static deserialize(e){const i=new Xo;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Xc(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:In.exports(String(r))}function tu(r,e,i,a){for(;i<a;){const d=r[i+a>>1];let m=i-1,y=a+1;for(;;){do m++;while(r[m]<d);do y--;while(r[y]>d);if(m>=y)break;Wi(r,m,y),Wi(e,3*m,3*y),Wi(e,3*m+1,3*y+1),Wi(e,3*m+2,3*y+2)}y-i<a-y?(tu(r,e,i,y),i=y+1):(tu(r,e,y+1,a),a=y)}}function Wi(r,e,i){const a=r[e];r[e]=r[i],r[i]=a}Xe("FeaturePositionMap",Xo);class ho{constructor(e,i){this.gl=e.gl,this.location=i}}class po extends ho{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ba extends ho{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class ug extends ho{constructor(e,i){super(e,i),this.current=U.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const f0=new Float32Array(16);function tp(r){return[Rt(255*r.r,255*r.g),Rt(255*r.b,255*r.a)]}class nu{constructor(e,i,a){this.value=e,this.uniformNames=i.map(d=>`u_${d}`),this.type=a}setUniform(e,i,a){e.set(a.constantOr(this.value))}getBinding(e,i,a){return this.type==="color"?new ug(e,i):new po(e,i)}}class Fa{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setUniform(e,i,a,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,i,a){return a.substr(0,9)==="u_pattern"?new Ba(e,i):new po(e,i)}}class fo{constructor(e,i,a,d){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,i,a,d,m){const y=this.paintVertexArray.length,x=this.expression.evaluate(new Qt(0),i,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,x)}updatePaintArray(e,i,a,d){const m=this.expression.evaluate({zoom:0},a,d);this._setPaintValue(e,i,m)}_setPaintValue(e,i,a){if(this.type==="color"){const d=tp(a);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ei{constructor(e,i,a,d,m,y){this.expression=e,this.uniformNames=i.map(x=>`u_${x}_t`),this.type=a,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(x=>({name:`a_${x}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,i,a,d,m){const y=this.expression.evaluate(new Qt(this.zoom),i,{},d,[],m),x=this.expression.evaluate(new Qt(this.zoom+1),i,{},d,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,y,x)}updatePaintArray(e,i,a,d){const m=this.expression.evaluate({zoom:this.zoom},a,d),y=this.expression.evaluate({zoom:this.zoom+1},a,d);this._setPaintValue(e,i,m,y)}_setPaintValue(e,i,a,d){if(this.type==="color"){const m=tp(a),y=tp(d);for(let x=e;x<i;x++)this.paintVertexArray.emplace(x,m[0],m[1],y[0],y[1])}else{for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,a,d);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,d=q(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,i,a){return new po(e,i)}}class Ko{constructor(e,i,a,d,m,y){this.expression=e,this.type=i,this.useIntegerZoom=a,this.zoom=d,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,i,a){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,d,m){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,i,a,d){if(!d||!a)return;const{min:m,mid:y,max:x}=a,b=d[m],T=d[y],z=d[x];if(b&&T&&z)for(let P=e;P<i;P++)this.zoomInPaintVertexArray.emplace(P,T.tl[0],T.tl[1],T.br[0],T.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],T.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,T.tl[0],T.tl[1],T.br[0],T.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],T.pixelRatio,z.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Cn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Cn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class cg{constructor(e,i,a){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof ri&&Ht(y.property.specification)))continue;const x=m0(m,e.type),b=y.value,T=y.property.specification.type,z=y.property.useIntegerZoom,P=y.property.specification["property-type"],L=P==="cross-faded"||P==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=L?new Fa(b.value,x):new nu(b.value,x,T),d.push(`/u_${m}`);else if(b.kind==="source"||L){const B=hg(m,T,"source");this.binders[m]=L?new Ko(b,T,z,i,B,e.id):new fo(b,x,T,B),d.push(`/a_${m}`)}else{const B=hg(m,T,"composite");this.binders[m]=new Ei(b,x,T,z,i,B),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof fo||i instanceof Ei?i.maxValue:0}populatePaintArrays(e,i,a,d,m){for(const y in this.binders){const x=this.binders[y];(x instanceof fo||x instanceof Ei||x instanceof Ko)&&x.populatePaintArray(e,i,a,d,m)}}setConstantPatternPositions(e,i){for(const a in this.binders){const d=this.binders[a];d instanceof Fa&&d.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,a,d,m){let y=!1;for(const x in e){const b=i.getPositions(x);for(const T of b){const z=a.feature(T.index);for(const P in this.binders){const L=this.binders[P];if((L instanceof fo||L instanceof Ei||L instanceof Ko)&&L.expression.isStateDependent===!0){const B=d.paint.get(P);L.expression=B.value,L.updatePaintArray(T.start,T.end,z,e[x],m),y=!0}}}}return y}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof nu||a instanceof Fa)&&e.push(...a.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof fo||a instanceof Ei)for(let d=0;d<a.paintVertexAttributes.length;d++)e.push(a.paintVertexAttributes[d].name);else if(a instanceof Ko)for(let d=0;d<Cn.members.length;d++)e.push(Cn.members[d].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof nu||a instanceof Fa||a instanceof Ei)for(const d of a.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof nu||m instanceof Fa||m instanceof Ei){for(const y of m.uniformNames)if(i[y]){const x=m.getBinding(e,i[y],y);a.push({name:y,property:d,binding:x})}}}return a}setUniforms(e,i,a,d){for(const{name:m,property:y,binding:x}of i)this.binders[y].setUniform(x,d,a.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(e&&a instanceof Ko){const d=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(a instanceof fo||a instanceof Ei)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof fo||a instanceof Ei||a instanceof Ko)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof fo||i instanceof Ei||i instanceof Ko)&&i.destroy()}}}class Xs{constructor(e,i,a=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new cg(d,i,a);this.needsUpload=!1,this._featureMap=new Xo,this._bufferOffset=0}populatePaintArrays(e,i,a,d,m,y){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,i,d,m,y);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,d){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,i,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function m0(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function hg(r,e,i){const a={color:{source:c,composite:pe},number:{source:G,composite:c}},d=function(m){return{"line-pattern":{source:kn,composite:kn},"fill-pattern":{source:kn,composite:kn},"fill-extrusion-pattern":{source:kn,composite:kn}}[m]}(r);return d&&d[i]||a[e][i]}Xe("ConstantBinder",nu),Xe("CrossFadedConstantBinder",Fa),Xe("SourceExpressionBinder",fo),Xe("CrossFadedCompositeBinder",Ko),Xe("CompositeExpressionBinder",Ei),Xe("ProgramConfiguration",cg,{omit:["_buffers"]}),Xe("ProgramConfigurationSet",Xs);var wn=8192;const np=Math.pow(2,14)-1,dg=-np-1;function Ks(r){const e=wn/r.extent,i=r.loadGeometry();for(let a=0;a<i.length;a++){const d=i[a];for(let m=0;m<d.length;m++){const y=d[m],x=Math.round(y.x*e),b=Math.round(y.y*e);y.x=q(x,dg,np),y.y=q(b,dg,np),(x<y.x||x>y.x+1||b<y.y||b>y.y+1)&&ze("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Ys(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Ks(r):[]}}function Kc(r,e,i,a,d){r.emplaceBack(2*e+(a+1)/2,2*i+(d+1)/2)}class rp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Bt,this.indexArray=new rr,this.segments=new xt,this.programConfigurations=new Xs(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){const d=this.layers[0],m=[];let y=null,x=!1;d.type==="circle"&&(y=d.layout.get("circle-sort-key"),x=!y.isConstant());for(const{feature:b,id:T,index:z,sourceLayerIndex:P}of e){const L=this.layers[0]._featureFilter.needGeometry,B=Ys(b,L);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),B,a))continue;const F=x?y.evaluate(B,{},a):void 0,K={id:T,properties:b.properties,type:b.type,sourceLayerIndex:P,index:z,geometry:L?B.geometry:Ks(b),patterns:{},sortKey:F};m.push(K)}x&&m.sort((b,T)=>b.sortKey-T.sortKey);for(const b of m){const{geometry:T,index:z,sourceLayerIndex:P}=b,L=e[z].feature;this.addFeature(b,T,z,a),i.featureIndex.insert(L,T,z,P,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,d){for(const m of i)for(const y of m){const x=y.x,b=y.y;if(x<0||x>=wn||b<0||b>=wn)continue;const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),z=T.vertexLength;Kc(this.layoutVertexArray,x,b,-1,-1),Kc(this.layoutVertexArray,x,b,1,-1),Kc(this.layoutVertexArray,x,b,1,1),Kc(this.layoutVertexArray,x,b,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},d)}}function pg(r,e){for(let i=0;i<r.length;i++)if(Oa(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Oa(r,e[i]))return!0;return!!ip(r,e)}function g0(r,e,i){return!!Oa(r,e)||!!op(e,r,i)}function fg(r,e){if(r.length===1)return gg(e,r[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let d=0;d<a.length;d++)if(Oa(r,a[d]))return!0}for(let i=0;i<r.length;i++)if(gg(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(ip(r,e[i]))return!0;return!1}function y0(r,e,i){if(r.length>1){if(ip(r,e))return!0;for(let a=0;a<e.length;a++)if(op(e[a],r,i))return!0}for(let a=0;a<r.length;a++)if(op(r[a],e,i))return!0;return!1}function ip(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const a=r[i],d=r[i+1];for(let m=0;m<e.length-1;m++)if(_0(a,d,e[m],e[m+1]))return!0}return!1}function _0(r,e,i,a){return He(r,i,a)!==He(e,i,a)&&He(r,e,i)!==He(r,e,a)}function op(r,e,i){const a=i*i;if(e.length===1)return r.distSqr(e[0])<a;for(let d=1;d<e.length;d++)if(mg(r,e[d-1],e[d])<a)return!0;return!1}function mg(r,e,i){const a=e.distSqr(i);if(a===0)return r.distSqr(e);const d=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/a;return r.distSqr(d<0?e:d>1?i:i.sub(e)._mult(d)._add(e))}function gg(r,e){let i,a,d,m=!1;for(let y=0;y<r.length;y++){i=r[y];for(let x=0,b=i.length-1;x<i.length;b=x++)a=i[x],d=i[b],a.y>e.y!=d.y>e.y&&e.x<(d.x-a.x)*(e.y-a.y)/(d.y-a.y)+a.x&&(m=!m)}return m}function Oa(r,e){let i=!1;for(let a=0,d=r.length-1;a<r.length;d=a++){const m=r[a],y=r[d];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(i=!i)}return i}function v0(r,e,i){const a=i[0],d=i[2];if(r.x<a.x&&e.x<a.x||r.x>d.x&&e.x>d.x||r.y<a.y&&e.y<a.y||r.y>d.y&&e.y>d.y)return!1;const m=He(r,e,i[0]);return m!==He(r,e,i[1])||m!==He(r,e,i[2])||m!==He(r,e,i[3])}function ru(r,e,i){const a=e.paint.get(r).value;return a.kind==="constant"?a.value:i.programConfigurations.get(e.id).getMaxValue(r)}function Yc(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Jc(r,e,i,a,d){if(!e[0]&&!e[1])return r;const m=at.convert(e)._mult(d);i==="viewport"&&m._rotate(-a);const y=[];for(let x=0;x<r.length;x++)y.push(r[x].sub(m));return y}Xe("CircleBucket",rp,{omit:["layers"]});const x0=new Ln({"circle-sort-key":new ot(xe.layout_circle["circle-sort-key"])});var w0={paint:new Ln({"circle-radius":new ot(xe.paint_circle["circle-radius"]),"circle-color":new ot(xe.paint_circle["circle-color"]),"circle-blur":new ot(xe.paint_circle["circle-blur"]),"circle-opacity":new ot(xe.paint_circle["circle-opacity"]),"circle-translate":new Qe(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Qe(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qe(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qe(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ot(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ot(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ot(xe.paint_circle["circle-stroke-opacity"])}),layout:x0},ir=1e-6,or=typeof Float32Array<"u"?Float32Array:Array;function yg(){var r=new or(9);return or!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function sp(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function _g(r,e,i){var a=e[0],d=e[1],m=e[2],y=e[3],x=e[4],b=e[5],T=e[6],z=e[7],P=e[8],L=e[9],B=e[10],F=e[11],K=e[12],X=e[13],ue=e[14],fe=e[15],le=i[0],de=i[1],Se=i[2],be=i[3];return r[0]=le*a+de*x+Se*P+be*K,r[1]=le*d+de*b+Se*L+be*X,r[2]=le*m+de*T+Se*B+be*ue,r[3]=le*y+de*z+Se*F+be*fe,r[4]=(le=i[4])*a+(de=i[5])*x+(Se=i[6])*P+(be=i[7])*K,r[5]=le*d+de*b+Se*L+be*X,r[6]=le*m+de*T+Se*B+be*ue,r[7]=le*y+de*z+Se*F+be*fe,r[8]=(le=i[8])*a+(de=i[9])*x+(Se=i[10])*P+(be=i[11])*K,r[9]=le*d+de*b+Se*L+be*X,r[10]=le*m+de*T+Se*B+be*ue,r[11]=le*y+de*z+Se*F+be*fe,r[12]=(le=i[12])*a+(de=i[13])*x+(Se=i[14])*P+(be=i[15])*K,r[13]=le*d+de*b+Se*L+be*X,r[14]=le*m+de*T+Se*B+be*ue,r[15]=le*y+de*z+Se*F+be*fe,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var iu,b0=_g;function vg(){var r=new or(3);return or!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function xg(r,e,i){var a=new or(3);return a[0]=r,a[1]=e,a[2]=i,a}function Qc(r,e,i){var a=e[0],d=e[1],m=e[2],y=e[3];return r[0]=i[0]*a+i[4]*d+i[8]*m+i[12]*y,r[1]=i[1]*a+i[5]*d+i[9]*m+i[13]*y,r[2]=i[2]*a+i[6]*d+i[10]*m+i[14]*y,r[3]=i[3]*a+i[7]*d+i[11]*m+i[15]*y,r}function wg(){var r=new or(4);return or!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function bg(r,e){const i=Qc([],[r.x,r.y,0,1],e);return new at(i[0]/i[3],i[1]/i[3])}vg(),iu=new or(4),or!=Float32Array&&(iu[0]=0,iu[1]=0,iu[2]=0,iu[3]=0),vg(),xg(1,0,0),xg(0,1,0),wg(),wg(),yg(),function(){var r;r=new or(2),or!=Float32Array&&(r[0]=0,r[1]=0)}();class Sg extends rp{}Xe("HeatmapBucket",Sg,{omit:["layers"]});var S0={paint:new Ln({"heatmap-radius":new ot(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ot(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qe(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gi(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qe(xe.paint_heatmap["heatmap-opacity"])})};function ap(r,{width:e,height:i},a,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*i*a)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*i*a}`)}else d=new Uint8Array(e*i*a);return r.width=e,r.height=i,r.data=d,r}function Eg(r,{width:e,height:i},a){if(e===r.width&&i===r.height)return;const d=ap({},{width:e,height:i},a);lp(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,i)},a),r.width=e,r.height=i,r.data=d.data}function lp(r,e,i,a,d,m){if(d.width===0||d.height===0)return e;if(d.width>r.width||d.height>r.height||i.x>r.width-d.width||i.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||a.x>e.width-d.width||a.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,x=e.data;if(y===x)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<d.height;b++){const T=((i.y+b)*r.width+i.x)*m,z=((a.y+b)*e.width+a.x)*m;for(let P=0;P<d.width*m;P++)x[z+P]=y[T+P]}return e}class ou{constructor(e,i){ap(this,e,1,i)}resize(e){Eg(this,e,1)}clone(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){lp(e,i,a,d,m,1)}}class Gr{constructor(e,i){ap(this,e,4,i)}resize(e){Eg(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Gr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){lp(e,i,a,d,m,4)}}function Tg(r){const e={},i=r.resolution||256,a=r.clips?r.clips.length:1,d=r.image||new Gr({width:i,height:a});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const m=(y,x,b)=>{e[r.evaluationKey]=b;const T=r.expression.evaluate(e);d.data[y+x+0]=Math.floor(255*T.r/T.a),d.data[y+x+1]=Math.floor(255*T.g/T.a),d.data[y+x+2]=Math.floor(255*T.b/T.a),d.data[y+x+3]=Math.floor(255*T.a)};if(r.clips)for(let y=0,x=0;y<a;++y,x+=4*i)for(let b=0,T=0;b<i;b++,T+=4){const z=b/(i-1),{start:P,end:L}=r.clips[y];m(x,T,P*(1-z)+L*z)}else for(let y=0,x=0;y<i;y++,x+=4)m(0,x,y/(i-1));return d}Xe("AlphaImage",ou),Xe("RGBAImage",Gr);var E0={paint:new Ln({"hillshade-illumination-direction":new Qe(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qe(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qe(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qe(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qe(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qe(xe.paint_hillshade["hillshade-accent-color"])})};const T0=gn([{name:"a_pos",components:2,type:"Int16"}],4),{members:k0}=T0;var eh={exports:{}};function th(r,e,i){i=i||2;var a,d,m,y,x,b,T,z=e&&e.length,P=z?e[0]*i:r.length,L=kg(r,0,P,i,!0),B=[];if(!L||L.next===L.prev)return B;if(z&&(L=function(K,X,ue,fe){var le,de,Se,be=[];for(le=0,de=X.length;le<de;le++)(Se=kg(K,X[le]*fe,le<de-1?X[le+1]*fe:K.length,fe,!1))===Se.next&&(Se.steiner=!0),be.push(L0(Se));for(be.sort(P0),le=0;le<be.length;le++)ue=M0(be[le],ue);return ue}(r,e,L,i)),r.length>80*i){a=m=r[0],d=y=r[1];for(var F=i;F<P;F+=i)(x=r[F])<a&&(a=x),(b=r[F+1])<d&&(d=b),x>m&&(m=x),b>y&&(y=b);T=(T=Math.max(m-a,y-d))!==0?32767/T:0}return su(L,B,i,a,d,T,0),B}function kg(r,e,i,a,d){var m,y;if(d===hp(r,e,i,a)>0)for(m=e;m<i;m+=a)y=zg(m,r[m],r[m+1],y);else for(m=i-a;m>=e;m-=a)y=zg(m,r[m],r[m+1],y);return y&&nh(y,y.next)&&(lu(y),y=y.next),y}function Js(r,e){if(!r)return r;e||(e=r);var i,a=r;do if(i=!1,a.steiner||!nh(a,a.next)&&hn(a.prev,a,a.next)!==0)a=a.next;else{if(lu(a),(a=e=a.prev)===a.next)break;i=!0}while(i||a!==e);return e}function su(r,e,i,a,d,m,y){if(r){!y&&m&&function(z,P,L,B){var F=z;do F.z===0&&(F.z=up(F.x,F.y,P,L,B)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==z);F.prevZ.nextZ=null,F.prevZ=null,function(K){var X,ue,fe,le,de,Se,be,Ze,Ye=1;do{for(ue=K,K=null,de=null,Se=0;ue;){for(Se++,fe=ue,be=0,X=0;X<Ye&&(be++,fe=fe.nextZ);X++);for(Ze=Ye;be>0||Ze>0&&fe;)be!==0&&(Ze===0||!fe||ue.z<=fe.z)?(le=ue,ue=ue.nextZ,be--):(le=fe,fe=fe.nextZ,Ze--),de?de.nextZ=le:K=le,le.prevZ=de,de=le;ue=fe}de.nextZ=null,Ye*=2}while(Se>1)}(F)}(r,a,d,m);for(var x,b,T=r;r.prev!==r.next;)if(x=r.prev,b=r.next,m?I0(r,a,d,m):C0(r))e.push(x.i/i|0),e.push(r.i/i|0),e.push(b.i/i|0),lu(r),r=b.next,T=b.next;else if((r=b)===T){y?y===1?su(r=z0(Js(r),e,i),e,i,a,d,m,2):y===2&&A0(r,e,i,a,d,m):su(Js(r),e,i,a,d,m,1);break}}}function C0(r){var e=r.prev,i=r,a=r.next;if(hn(e,i,a)>=0)return!1;for(var d=e.x,m=i.x,y=a.x,x=e.y,b=i.y,T=a.y,z=d<m?d<y?d:y:m<y?m:y,P=x<b?x<T?x:T:b<T?b:T,L=d>m?d>y?d:y:m>y?m:y,B=x>b?x>T?x:T:b>T?b:T,F=a.next;F!==e;){if(F.x>=z&&F.x<=L&&F.y>=P&&F.y<=B&&Na(d,x,m,b,y,T,F.x,F.y)&&hn(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function I0(r,e,i,a){var d=r.prev,m=r,y=r.next;if(hn(d,m,y)>=0)return!1;for(var x=d.x,b=m.x,T=y.x,z=d.y,P=m.y,L=y.y,B=x<b?x<T?x:T:b<T?b:T,F=z<P?z<L?z:L:P<L?P:L,K=x>b?x>T?x:T:b>T?b:T,X=z>P?z>L?z:L:P>L?P:L,ue=up(B,F,e,i,a),fe=up(K,X,e,i,a),le=r.prevZ,de=r.nextZ;le&&le.z>=ue&&de&&de.z<=fe;){if(le.x>=B&&le.x<=K&&le.y>=F&&le.y<=X&&le!==d&&le!==y&&Na(x,z,b,P,T,L,le.x,le.y)&&hn(le.prev,le,le.next)>=0||(le=le.prevZ,de.x>=B&&de.x<=K&&de.y>=F&&de.y<=X&&de!==d&&de!==y&&Na(x,z,b,P,T,L,de.x,de.y)&&hn(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;le&&le.z>=ue;){if(le.x>=B&&le.x<=K&&le.y>=F&&le.y<=X&&le!==d&&le!==y&&Na(x,z,b,P,T,L,le.x,le.y)&&hn(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;de&&de.z<=fe;){if(de.x>=B&&de.x<=K&&de.y>=F&&de.y<=X&&de!==d&&de!==y&&Na(x,z,b,P,T,L,de.x,de.y)&&hn(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function z0(r,e,i){var a=r;do{var d=a.prev,m=a.next.next;!nh(d,m)&&Cg(d,a,a.next,m)&&au(d,m)&&au(m,d)&&(e.push(d.i/i|0),e.push(a.i/i|0),e.push(m.i/i|0),lu(a),lu(a.next),a=r=m),a=a.next}while(a!==r);return Js(a)}function A0(r,e,i,a,d,m){var y=r;do{for(var x=y.next.next;x!==y.prev;){if(y.i!==x.i&&R0(y,x)){var b=Ig(y,x);return y=Js(y,y.next),b=Js(b,b.next),su(y,e,i,a,d,m,0),void su(b,e,i,a,d,m,0)}x=x.next}y=y.next}while(y!==r)}function P0(r,e){return r.x-e.x}function M0(r,e){var i=function(d,m){var y,x=m,b=d.x,T=d.y,z=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var P=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(P<=b&&P>z&&(z=P,y=x.x<x.next.x?x:x.next,P===b))return y}x=x.next}while(x!==m);if(!y)return null;var L,B=y,F=y.x,K=y.y,X=1/0;x=y;do b>=x.x&&x.x>=F&&b!==x.x&&Na(T<K?b:z,T,F,K,T<K?z:b,T,x.x,x.y)&&(L=Math.abs(T-x.y)/(b-x.x),au(x,d)&&(L<X||L===X&&(x.x>y.x||x.x===y.x&&D0(y,x)))&&(y=x,X=L)),x=x.next;while(x!==B);return y}(r,e);if(!i)return e;var a=Ig(i,r);return Js(a,a.next),Js(i,i.next)}function D0(r,e){return hn(r.prev,r,e.prev)<0&&hn(e.next,r,r.next)<0}function up(r,e,i,a,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function L0(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function Na(r,e,i,a,d,m,y,x){return(d-y)*(e-x)>=(r-y)*(m-x)&&(r-y)*(a-x)>=(i-y)*(e-x)&&(i-y)*(m-x)>=(d-y)*(a-x)}function R0(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,a){var d=i;do{if(d.i!==i.i&&d.next.i!==i.i&&d.i!==a.i&&d.next.i!==a.i&&Cg(d,d.next,i,a))return!0;d=d.next}while(d!==i);return!1}(r,e)&&(au(r,e)&&au(e,r)&&function(i,a){var d=i,m=!1,y=(i.x+a.x)/2,x=(i.y+a.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&y<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==i);return m}(r,e)&&(hn(r.prev,r,e.prev)||hn(r,e.prev,e))||nh(r,e)&&hn(r.prev,r,r.next)>0&&hn(e.prev,e,e.next)>0)}function hn(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function nh(r,e){return r.x===e.x&&r.y===e.y}function Cg(r,e,i,a){var d=ih(hn(r,e,i)),m=ih(hn(r,e,a)),y=ih(hn(i,a,r)),x=ih(hn(i,a,e));return d!==m&&y!==x||!(d!==0||!rh(r,i,e))||!(m!==0||!rh(r,a,e))||!(y!==0||!rh(i,r,a))||!(x!==0||!rh(i,e,a))}function rh(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function ih(r){return r>0?1:r<0?-1:0}function au(r,e){return hn(r.prev,r,r.next)<0?hn(r,e,r.next)>=0&&hn(r,r.prev,e)>=0:hn(r,e,r.prev)<0||hn(r,r.next,e)<0}function Ig(r,e){var i=new cp(r.i,r.x,r.y),a=new cp(e.i,e.x,e.y),d=r.next,m=e.prev;return r.next=e,e.prev=r,i.next=d,d.prev=i,a.next=i,i.prev=a,m.next=a,a.prev=m,a}function zg(r,e,i,a){var d=new cp(r,e,i);return a?(d.next=a.next,d.prev=a,a.next.prev=d,a.next=d):(d.prev=d,d.next=d),d}function lu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function cp(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hp(r,e,i,a){for(var d=0,m=e,y=i-a;m<i;m+=a)d+=(r[y]-r[m])*(r[m+1]+r[y+1]),y=m;return d}function B0(r,e,i,a,d){Ag(r,e,i||0,a||r.length-1,d||F0)}function Ag(r,e,i,a,d){for(;a>i;){if(a-i>600){var m=a-i+1,y=e-i+1,x=Math.log(m),b=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*b*(m-b)/m)*(y-m/2<0?-1:1);Ag(r,e,Math.max(i,Math.floor(e-y*b/m+T)),Math.min(a,Math.floor(e+(m-y)*b/m+T)),d)}var z=r[e],P=i,L=a;for(uu(r,i,e),d(r[a],z)>0&&uu(r,i,a);P<L;){for(uu(r,P,L),P++,L--;d(r[P],z)<0;)P++;for(;d(r[L],z)>0;)L--}d(r[i],z)===0?uu(r,i,L):uu(r,++L,a),L<=e&&(i=L+1),e<=L&&(a=L-1)}}function uu(r,e,i){var a=r[e];r[e]=r[i],r[i]=a}function F0(r,e){return r<e?-1:r>e?1:0}function dp(r,e){const i=r.length;if(i<=1)return[r];const a=[];let d,m;for(let y=0;y<i;y++){const x=De(r[y]);x!==0&&(r[y].area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(d&&a.push(d),d=[r[y]]):d.push(r[y]))}if(d&&a.push(d),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(B0(a[y],e,1,a[y].length-1,O0),a[y]=a[y].slice(0,e));return a}function O0(r,e){return e.area-r.area}function pp(r,e,i){const a=i.patternDependencies;let d=!1;for(const m of e){const y=m.paint.get(`${r}-pattern`);y.isConstant()||(d=!0);const x=y.constantOr(null);x&&(d=!0,a[x.to]=!0,a[x.from]=!0)}return d}function fp(r,e,i,a,d){const m=d.patternDependencies;for(const y of e){const x=y.paint.get(`${r}-pattern`).value;if(x.kind!=="constant"){let b=x.evaluate({zoom:a-1},i,{},d.availableImages),T=x.evaluate({zoom:a},i,{},d.availableImages),z=x.evaluate({zoom:a+1},i,{},d.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,z=z&&z.name?z.name:z,m[b]=!0,m[T]=!0,m[z]=!0,i.patterns[y.id]={min:b,mid:T,max:z}}}return i}eh.exports=th,eh.exports.default=th,th.deviation=function(r,e,i,a){var d=e&&e.length,m=Math.abs(hp(r,0,d?e[0]*i:r.length,i));if(d)for(var y=0,x=e.length;y<x;y++)m-=Math.abs(hp(r,e[y]*i,y<x-1?e[y+1]*i:r.length,i));var b=0;for(y=0;y<a.length;y+=3){var T=a[y]*i,z=a[y+1]*i,P=a[y+2]*i;b+=Math.abs((r[T]-r[P])*(r[z+1]-r[T+1])-(r[T]-r[z])*(r[P+1]-r[T+1]))}return m===0&&b===0?0:Math.abs((b-m)/m)},th.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,d=0;d<r.length;d++){for(var m=0;m<r[d].length;m++)for(var y=0;y<e;y++)i.vertices.push(r[d][m][y]);d>0&&i.holes.push(a+=r[d-1].length)}return i};class mp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ft,this.indexArray=new rr,this.indexArray2=new Si,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new xt,this.segments2=new xt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.hasPattern=pp("fill",this.layers,i);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),y=[];for(const{feature:x,id:b,index:T,sourceLayerIndex:z}of e){const P=this.layers[0]._featureFilter.needGeometry,L=Ys(x,P);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a,i.availableImages):void 0,F={id:b,properties:x.properties,type:x.type,sourceLayerIndex:z,index:T,geometry:P?L.geometry:Ks(x),patterns:{},sortKey:B};y.push(F)}m&&y.sort((x,b)=>x.sortKey-b.sortKey);for(const x of y){const{geometry:b,index:T,sourceLayerIndex:z}=x;if(this.hasPattern){const P=fp("fill",this.layers,x,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(x,b,T,a,{});i.featureIndex.insert(e[T].feature,b,T,z,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}addFeatures(e,i,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,k0),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,d,m){for(const y of dp(i,500)){let x=0;for(const B of y)x+=B.length;const b=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),T=b.vertexLength,z=[],P=[];for(const B of y){if(B.length===0)continue;B!==y[0]&&P.push(z.length/2);const F=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),K=F.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(K+B.length-1,K),z.push(B[0].x),z.push(B[0].y);for(let X=1;X<B.length;X++)this.layoutVertexArray.emplaceBack(B[X].x,B[X].y),this.indexArray2.emplaceBack(K+X-1,K+X),z.push(B[X].x),z.push(B[X].y);F.vertexLength+=B.length,F.primitiveLength+=B.length}const L=eh.exports(z,P);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(T+L[B],T+L[B+1],T+L[B+2]);b.vertexLength+=x,b.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}Xe("FillBucket",mp,{omit:["layers","patternFeatures"]});const N0=new Ln({"fill-sort-key":new ot(xe.layout_fill["fill-sort-key"])});var U0={paint:new Ln({"fill-antialias":new Qe(xe.paint_fill["fill-antialias"]),"fill-opacity":new ot(xe.paint_fill["fill-opacity"]),"fill-color":new ot(xe.paint_fill["fill-color"]),"fill-outline-color":new ot(xe.paint_fill["fill-outline-color"]),"fill-translate":new Qe(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Qe(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wo(xe.paint_fill["fill-pattern"])}),layout:N0};const V0=gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),$0=gn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:j0}=V0;var Yo={},G0=at,Pg=Ua;function Ua(r,e,i,a,d){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=d,r.readFields(q0,this,e)}function q0(r,e,i){r==1?e.id=i.readVarint():r==2?function(a,d){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=d._keys[a.readVarint()],x=d._values[a.readVarint()];d.properties[y]=x}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function Z0(r){for(var e,i,a=0,d=0,m=r.length,y=m-1;d<m;y=d++)a+=((i=r[y]).x-(e=r[d]).x)*(e.y+i.y);return a}Ua.types=["Unknown","Point","LineString","Polygon"],Ua.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,a=1,d=0,m=0,y=0,x=[];r.pos<i;){if(d<=0){var b=r.readVarint();a=7&b,d=b>>3}if(d--,a===1||a===2)m+=r.readSVarint(),y+=r.readSVarint(),a===1&&(e&&x.push(e),e=[]),e.push(new G0(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&x.push(e),x},Ua.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,a=0,d=0,m=0,y=1/0,x=-1/0,b=1/0,T=-1/0;r.pos<e;){if(a<=0){var z=r.readVarint();i=7&z,a=z>>3}if(a--,i===1||i===2)(d+=r.readSVarint())<y&&(y=d),d>x&&(x=d),(m+=r.readSVarint())<b&&(b=m),m>T&&(T=m);else if(i!==7)throw new Error("unknown command "+i)}return[y,b,x,T]},Ua.prototype.toGeoJSON=function(r,e,i){var a,d,m=this.extent*Math.pow(2,i),y=this.extent*r,x=this.extent*e,b=this.loadGeometry(),T=Ua.types[this.type];function z(B){for(var F=0;F<B.length;F++){var K=B[F];B[F]=[360*(K.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+x)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(a=0;a<b.length;a++)P[a]=b[a][0];z(b=P);break;case 2:for(a=0;a<b.length;a++)z(b[a]);break;case 3:for(b=function(B){var F=B.length;if(F<=1)return[B];for(var K,X,ue=[],fe=0;fe<F;fe++){var le=Z0(B[fe]);le!==0&&(X===void 0&&(X=le<0),X===le<0?(K&&ue.push(K),K=[B[fe]]):K.push(B[fe]))}return K&&ue.push(K),ue}(b),a=0;a<b.length;a++)for(d=0;d<b[a].length;d++)z(b[a][d])}b.length===1?b=b[0]:T="Multi"+T;var L={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(L.id=this.id),L};var H0=Pg,Mg=Dg;function Dg(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(W0,this,e),this.length=this._features.length}function W0(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(a){for(var d=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;d=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return d}(i))}Dg.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new H0(this._pbf,e,this.extent,this._keys,this._values)};var X0=Mg;function K0(r,e,i){if(r===3){var a=new X0(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}Yo.VectorTile=function(r,e){this.layers=r.readFields(K0,{},e)},Yo.VectorTileFeature=Pg,Yo.VectorTileLayer=Mg;const Y0=Yo.VectorTileFeature.types,gp=Math.pow(2,13);function cu(r,e,i,a,d,m,y,x){r.emplaceBack(e,i,2*Math.floor(a*gp)+y,d*gp*2,m*gp*2,Math.round(x))}class yp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Et,this.centroidVertexArray=new nt,this.indexArray=new rr,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new xt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.features=[],this.hasPattern=pp("fill-extrusion",this.layers,i);for(const{feature:d,id:m,index:y,sourceLayerIndex:x}of e){const b=this.layers[0]._featureFilter.needGeometry,T=Ys(d,b);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),T,a))continue;const z={id:m,sourceLayerIndex:x,index:y,geometry:b?T.geometry:Ks(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(fp("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,y,a,{}),i.featureIndex.insert(d,z.geometry,y,x,this.index,!0)}}addFeatures(e,i,a){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,i,a)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j0),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,$0.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,a,d,m){const y={x:0,y:0,vertexCount:0};for(const x of dp(i,500)){let b=0;for(const F of x)b+=F.length;let T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const F of x){if(F.length===0||Q0(F))continue;let K=0;for(let X=0;X<F.length;X++){const ue=F[X];if(X>=1){const fe=F[X-1];if(!J0(ue,fe)){T.vertexLength+4>xt.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const le=ue.sub(fe)._perp()._unit(),de=fe.dist(ue);K+de>32768&&(K=0),cu(this.layoutVertexArray,ue.x,ue.y,le.x,le.y,0,0,K),cu(this.layoutVertexArray,ue.x,ue.y,le.x,le.y,0,1,K),y.x+=2*ue.x,y.y+=2*ue.y,y.vertexCount+=2,K+=de,cu(this.layoutVertexArray,fe.x,fe.y,le.x,le.y,0,0,K),cu(this.layoutVertexArray,fe.x,fe.y,le.x,le.y,0,1,K),y.x+=2*fe.x,y.y+=2*fe.y,y.vertexCount+=2;const Se=T.vertexLength;this.indexArray.emplaceBack(Se,Se+2,Se+1),this.indexArray.emplaceBack(Se+1,Se+2,Se+3),T.vertexLength+=4,T.primitiveLength+=2}}}}if(T.vertexLength+b>xt.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),Y0[e.type]!=="Polygon")continue;const z=[],P=[],L=T.vertexLength;for(const F of x)if(F.length!==0){F!==x[0]&&P.push(z.length/2);for(let K=0;K<F.length;K++){const X=F[K];cu(this.layoutVertexArray,X.x,X.y,0,0,1,1,0),y.x+=X.x,y.y+=X.y,y.vertexCount+=1,z.push(X.x),z.push(X.y)}}const B=eh.exports(z,P);for(let F=0;F<B.length;F+=3)this.indexArray.emplaceBack(L+B[F],L+B[F+2],L+B[F+1]);T.primitiveLength+=B.length/3,T.vertexLength+=b}for(let x=0;x<y.vertexCount;x++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}function J0(r,e){return r.x===e.x&&(r.x<0||r.x>wn)||r.y===e.y&&(r.y<0||r.y>wn)}function Q0(r){return r.every(e=>e.x<0)||r.every(e=>e.x>wn)||r.every(e=>e.y<0)||r.every(e=>e.y>wn)}Xe("FillExtrusionBucket",yp,{omit:["layers","features"]});var e1={paint:new Ln({"fill-extrusion-opacity":new Qe(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ot(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qe(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qe(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wo(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ot(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ot(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qe(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function hu(r,e){return r.x*e.x+r.y*e.y}function Lg(r,e){if(r.length===1){let i=0;const a=e[i++];let d;for(;!d||a.equals(d);)if(d=e[i++],!d)return 1/0;for(;i<e.length;i++){const m=e[i],y=r[0],x=d.sub(a),b=m.sub(a),T=y.sub(a),z=hu(x,x),P=hu(x,b),L=hu(b,b),B=hu(T,x),F=hu(T,b),K=z*L-P*P,X=(L*B-P*F)/K,ue=(z*F-P*B)/K,fe=a.z*(1-X-ue)+d.z*X+m.z*ue;if(isFinite(fe))return fe}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}const t1=gn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:n1}=t1,r1=gn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:i1}=r1,o1=Yo.VectorTileFeature.types,s1=Math.cos(Math.PI/180*37.5),Rg=Math.pow(2,14)/.5;class _p{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new At,this.layoutVertexArray2=new Ut,this.indexArray=new rr,this.programConfigurations=new Xs(e.layers,e.zoom),this.segments=new xt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.hasPattern=pp("line",this.layers,i);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),y=[];for(const{feature:x,id:b,index:T,sourceLayerIndex:z}of e){const P=this.layers[0]._featureFilter.needGeometry,L=Ys(x,P);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a):void 0,F={id:b,properties:x.properties,type:x.type,sourceLayerIndex:z,index:T,geometry:P?L.geometry:Ks(x),patterns:{},sortKey:B};y.push(F)}m&&y.sort((x,b)=>x.sortKey-b.sortKey);for(const x of y){const{geometry:b,index:T,sourceLayerIndex:z}=x;if(this.hasPattern){const P=fp("line",this.layers,x,this.zoom,i);this.patternFeatures.push(P)}else this.addFeature(x,b,T,a,{});i.featureIndex.insert(e[T].feature,b,T,z,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}addFeatures(e,i,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,i1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,n1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,d,m){const y=this.layers[0].layout,x=y.get("line-join").evaluate(e,{}),b=y.get("line-cap"),T=y.get("line-miter-limit"),z=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const P of i)this.addLine(P,e,x,b,T,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}addLine(e,i,a,d,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<e.length-1;ue++)this.totalDistance+=e[ue].dist(e[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=o1[i.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let T=0;for(;T<b-1&&e[T].equals(e[T+1]);)T++;if(b<(x?3:2))return;a==="bevel"&&(m=1.05);const z=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let L,B,F,K,X;this.e1=this.e2=-1,x&&(L=e[b-2],X=e[T].sub(L)._unit()._perp());for(let ue=T;ue<b;ue++){if(F=ue===b-1?x?e[T+1]:void 0:e[ue+1],F&&e[ue].equals(F))continue;X&&(K=X),L&&(B=L),L=e[ue],X=F?F.sub(L)._unit()._perp():K,K=K||X;let fe=K.add(X);fe.x===0&&fe.y===0||fe._unit();const le=K.x*X.x+K.y*X.y,de=fe.x*X.x+fe.y*X.y,Se=de!==0?1/de:1/0,be=2*Math.sqrt(2-2*de),Ze=de<s1&&B&&F,Ye=K.x*X.y-K.y*X.x>0;if(Ze&&ue>T){const Me=L.dist(B);if(Me>2*z){const $e=L.sub(L.sub(B)._mult(z/Me)._round());this.updateDistance(B,$e),this.addCurrentVertex($e,K,0,0,P),B=$e}}const Ve=B&&F;let Be=Ve?a:x?"butt":d;if(Ve&&Be==="round"&&(Se<y?Be="miter":Se<=2&&(Be="fakeround")),Be==="miter"&&Se>m&&(Be="bevel"),Be==="bevel"&&(Se>2&&(Be="flipbevel"),Se<m&&(Be="miter")),B&&this.updateDistance(B,L),Be==="miter")fe._mult(Se),this.addCurrentVertex(L,fe,0,0,P);else if(Be==="flipbevel"){if(Se>100)fe=X.mult(-1);else{const Me=Se*K.add(X).mag()/K.sub(X).mag();fe._perp()._mult(Me*(Ye?-1:1))}this.addCurrentVertex(L,fe,0,0,P),this.addCurrentVertex(L,fe.mult(-1),0,0,P)}else if(Be==="bevel"||Be==="fakeround"){const Me=-Math.sqrt(Se*Se-1),$e=Ye?Me:0,Ne=Ye?0:Me;if(B&&this.addCurrentVertex(L,K,$e,Ne,P),Be==="fakeround"){const Ce=Math.round(180*be/Math.PI/20);for(let rt=1;rt<Ce;rt++){let et=rt/Ce;if(et!==.5){const Wt=et-.5;et+=et*Wt*(et-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Wt*Wt+(.848013+le*(.215638*le-1.06021)))}const vt=X.sub(K)._mult(et)._add(K)._unit()._mult(Ye?-1:1);this.addHalfVertex(L,vt.x,vt.y,!1,Ye,0,P)}}F&&this.addCurrentVertex(L,X,-$e,-Ne,P)}else if(Be==="butt")this.addCurrentVertex(L,fe,0,0,P);else if(Be==="square"){const Me=B?1:-1;this.addCurrentVertex(L,fe,Me,Me,P)}else Be==="round"&&(B&&(this.addCurrentVertex(L,K,0,0,P),this.addCurrentVertex(L,K,1,1,P,!0)),F&&(this.addCurrentVertex(L,X,-1,-1,P,!0),this.addCurrentVertex(L,X,0,0,P)));if(Ze&&ue<b-1){const Me=L.dist(F);if(Me>2*z){const $e=L.add(F.sub(L)._mult(z/Me)._round());this.updateDistance(L,$e),this.addCurrentVertex($e,X,0,0,P),L=$e}}}}addCurrentVertex(e,i,a,d,m,y=!1){const x=i.y*d-i.x,b=-i.y-i.x*d;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,y,!1,a,m),this.addHalfVertex(e,x,b,y,!0,-d,m),this.distance>Rg/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,i,a,d,m,y))}addHalfVertex({x:e,y:i},a,d,m,y,x,b){const T=.5*(this.lineClips?this.scaledDistance*(Rg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(i<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),b.primitiveLength++),y?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}Xe("LineBucket",_p,{omit:["layers","patternFeatures"]});const a1=new Ln({"line-cap":new Qe(xe.layout_line["line-cap"]),"line-join":new ot(xe.layout_line["line-join"]),"line-miter-limit":new Qe(xe.layout_line["line-miter-limit"]),"line-round-limit":new Qe(xe.layout_line["line-round-limit"]),"line-sort-key":new ot(xe.layout_line["line-sort-key"])});var Bg={paint:new Ln({"line-opacity":new ot(xe.paint_line["line-opacity"]),"line-color":new ot(xe.paint_line["line-color"]),"line-translate":new Qe(xe.paint_line["line-translate"]),"line-translate-anchor":new Qe(xe.paint_line["line-translate-anchor"]),"line-width":new ot(xe.paint_line["line-width"]),"line-gap-width":new ot(xe.paint_line["line-gap-width"]),"line-offset":new ot(xe.paint_line["line-offset"]),"line-blur":new ot(xe.paint_line["line-blur"]),"line-dasharray":new Jl(xe.paint_line["line-dasharray"]),"line-pattern":new Wo(xe.paint_line["line-pattern"]),"line-gradient":new Gi(xe.paint_line["line-gradient"])}),layout:a1};const Fg=new class extends ot{possiblyEvaluate(r,e){return e=new Qt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,i,a){return e=Te({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,i,a)}}(Bg.paint.properties["line-width"].specification);function Og(r,e){return e>0?e+2*r:r}Fg.useIntegerZoom=!0;const l1=gn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),u1=gn([{name:"a_projected_pos",components:3,type:"Float32"}],4);gn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const c1=gn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);gn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ng=gn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),h1=gn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function d1(r,e,i){return r.sections.forEach(a=>{a.text=function(d,m,y){const x=m.layout.get("text-transform").evaluate(y,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),Ar.applyArabicShaping&&(d=Ar.applyArabicShaping(d)),d}(a.text,e,i)}),r}gn([{name:"triangle",components:3,type:"Uint16"}]),gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),gn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),gn([{type:"Float32",name:"offsetX"}]),gn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const du={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Rn=24,vp=Gt,Ug=function(r,e,i,a,d){var m,y,x=8*d-a-1,b=(1<<x)-1,T=b>>1,z=-7,P=i?d-1:0,L=i?-1:1,B=r[e+P];for(P+=L,m=B&(1<<-z)-1,B>>=-z,z+=x;z>0;m=256*m+r[e+P],P+=L,z-=8);for(y=m&(1<<-z)-1,m>>=-z,z+=a;z>0;y=256*y+r[e+P],P+=L,z-=8);if(m===0)m=1-T;else{if(m===b)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,a),m-=T}return(B?-1:1)*y*Math.pow(2,m-a)},Vg=function(r,e,i,a,d,m){var y,x,b,T=8*m-d-1,z=(1<<T)-1,P=z>>1,L=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=a?0:m-1,F=a?1:-1,K=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,y=z):(y=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-y))<1&&(y--,b*=2),(e+=y+P>=1?L/b:L*Math.pow(2,1-P))*b>=2&&(y++,b/=2),y+P>=z?(x=0,y=z):y+P>=1?(x=(e*b-1)*Math.pow(2,d),y+=P):(x=e*Math.pow(2,P-1)*Math.pow(2,d),y=0));d>=8;r[i+B]=255&x,B+=F,x/=256,d-=8);for(y=y<<d|x,T+=d;T>0;r[i+B]=255&y,B+=F,y/=256,T-=8);r[i+B-F]|=128*K};function Gt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Gt.Varint=0,Gt.Fixed64=1,Gt.Bytes=2,Gt.Fixed32=5;var Jo,xp=4294967296,$g=1/xp,jg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function mo(r){return r.type===Gt.Bytes?r.readVarint()+r.pos:r.pos+1}function Va(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Gg(r,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var d=i.pos-1;d>=r;d--)i.buf[d+a]=i.buf[d]}function p1(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function f1(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function m1(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function g1(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function y1(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function _1(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function v1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function x1(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function w1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function oh(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function $a(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function qg(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function b1(r,e,i){r===1&&i.readMessage(S1,e)}function S1(r,e,i){if(r===3){const{id:a,bitmap:d,width:m,height:y,left:x,top:b,advance:T}=i.readMessage(E1,{});e.push({id:a,bitmap:new ou({width:m+6,height:y+6},d),metrics:{width:m,height:y,left:x,top:b,advance:T}})}}function E1(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}function Zg(r){let e=0,i=0;for(const y of r)e+=y.w*y.h,i=Math.max(i,y.w);r.sort((y,x)=>x.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let d=0,m=0;for(const y of r)for(let x=a.length-1;x>=0;x--){const b=a[x];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,m=Math.max(m,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===b.w&&y.h===b.h){const T=a.pop();x<a.length&&(a[x]=T)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(a.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}Gt.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),d=a>>3,m=this.pos;this.type=7&a,r(d,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=oh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=qg(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=oh(this.buf,this.pos)+oh(this.buf,this.pos+4)*xp;return this.pos+=8,r},readSFixed64:function(){var r=oh(this.buf,this.pos)+qg(this.buf,this.pos+4)*xp;return this.pos+=8,r},readFloat:function(){var r=Ug(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Ug(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(d,m,y){var x,b,T=y.buf;if(x=(112&(b=T[y.pos++]))>>4,b<128||(x|=(127&(b=T[y.pos++]))<<3,b<128)||(x|=(127&(b=T[y.pos++]))<<10,b<128)||(x|=(127&(b=T[y.pos++]))<<17,b<128)||(x|=(127&(b=T[y.pos++]))<<24,b<128)||(x|=(1&(b=T[y.pos++]))<<31,b<128))return Va(d,x,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&jg?function(i,a,d){return jg.decode(i.subarray(a,d))}(this.buf,e,r):function(i,a,d){for(var m="",y=a;y<d;){var x,b,T,z=i[y],P=null,L=z>239?4:z>223?3:z>191?2:1;if(y+L>d)break;L===1?z<128&&(P=z):L===2?(192&(x=i[y+1]))==128&&(P=(31&z)<<6|63&x)<=127&&(P=null):L===3?(b=i[y+2],(192&(x=i[y+1]))==128&&(192&b)==128&&((P=(15&z)<<12|(63&x)<<6|63&b)<=2047||P>=55296&&P<=57343)&&(P=null)):L===4&&(b=i[y+2],T=i[y+3],(192&(x=i[y+1]))==128&&(192&b)==128&&(192&T)==128&&((P=(15&z)<<18|(63&x)<<12|(63&b)<<6|63&T)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,L=1):P>65535&&(P-=65536,m+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),m+=String.fromCharCode(P),y+=L}return m}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Gt.Bytes)return r.push(this.readVarint(e));var i=mo(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Gt.Bytes)return r.push(this.readSVarint());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Gt.Bytes)return r.push(this.readBoolean());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Gt.Bytes)return r.push(this.readFloat());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Gt.Bytes)return r.push(this.readDouble());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Gt.Bytes)return r.push(this.readFixed32());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Gt.Bytes)return r.push(this.readSFixed32());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Gt.Bytes)return r.push(this.readFixed64());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Gt.Bytes)return r.push(this.readSFixed64());var e=mo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Gt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Gt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Gt.Fixed32)this.pos+=4;else{if(e!==Gt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),$a(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),$a(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),$a(this.buf,-1&r,this.pos),$a(this.buf,Math.floor(r*$g),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),$a(this.buf,-1&r,this.pos),$a(this.buf,Math.floor(r*$g),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var a,d;if(e>=0?(a=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,y,x){x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,x.buf[x.pos]=127&(m>>>=7)}(a,0,i),function(m,y){var x=(7&m)<<4;y.buf[y.pos++]|=x|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(d,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(a,d,m){for(var y,x,b=0;b<d.length;b++){if((y=d.charCodeAt(b))>55295&&y<57344){if(!x){y>56319||b+1===d.length?(a[m++]=239,a[m++]=191,a[m++]=189):x=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(a[m++]=239,a[m++]=191,a[m++]=189,x=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&Gg(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),Vg(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Vg(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var a=this.pos-i;a>=128&&Gg(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,e,i){this.writeTag(r,Gt.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,p1,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,f1,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,y1,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,m1,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,g1,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,_1,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,v1,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,x1,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,w1,e)},writeBytesField:function(r,e){this.writeTag(r,Gt.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Gt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Gt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Gt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Gt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Gt.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Gt.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Gt.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Gt.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Gt.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class wp{constructor(e,{pixelRatio:i,version:a,stretchX:d,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=d,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hg{constructor(e,i){const a={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(i,d,m);const{w:y,h:x}=Zg(m),b=new Gr({width:y||1,height:x||1});for(const T in e){const z=e[T],P=a[T].paddedRect;Gr.copy(z.data,b,{x:0,y:0},{x:P.x+1,y:P.y+1},z.data)}for(const T in i){const z=i[T],P=d[T].paddedRect,L=P.x+1,B=P.y+1,F=z.data.width,K=z.data.height;Gr.copy(z.data,b,{x:0,y:0},{x:L,y:B},z.data),Gr.copy(z.data,b,{x:0,y:K-1},{x:L,y:B-1},{width:F,height:1}),Gr.copy(z.data,b,{x:0,y:0},{x:L,y:B+K},{width:F,height:1}),Gr.copy(z.data,b,{x:F-1,y:0},{x:L-1,y:B},{width:1,height:K}),Gr.copy(z.data,b,{x:0,y:0},{x:L+F,y:B},{width:1,height:K})}this.image=b,this.iconPositions=a,this.patternPositions=d}addImages(e,i,a){for(const d in e){const m=e[d],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};a.push(y),i[d]=new wp(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[d,m]=e.tl;a.update(i.data,void 0,{x:d,y:m})}}Xe("ImagePosition",wp),Xe("ImageAtlas",Hg),l.WritingMode=void 0,(Jo=l.WritingMode||(l.WritingMode={}))[Jo.none=0]="none",Jo[Jo.horizontal=1]="horizontal",Jo[Jo.vertical=2]="vertical",Jo[Jo.horizontalOnly=3]="horizontalOnly";const sh=-17;class pu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new pu;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new pu;return i.imageName=e,i}}class ja{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new ja;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?a.addImageSection(m):a.addTextSection(m,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let i="";for(let a=0;a<e.length;a++){const d=e.charCodeAt(a+1)||null,m=e.charCodeAt(a-1)||null;i+=d&&Uc(d)&&!du[e[a+1]]||m&&Uc(m)&&!du[e[a-1]]||!du[e[a]]?e[a]:du[e[a]]}return i}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&lh[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&lh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new ja;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(pu.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void ze("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(pu.forImage(i)),this.sectionIndex.push(this.sections.length-1)):ze("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ah(r,e,i,a,d,m,y,x,b,T,z,P,L,B,F,K){const X=ja.fromFeature(r,d);let ue;P===l.WritingMode.vertical&&X.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:le}=Ar;if(fe&&X.sections.length===1){ue=[];const be=fe(X.toString(),bp(X,T,m,e,a,B,F));for(const Ze of be){const Ye=new ja;Ye.text=Ze,Ye.sections=X.sections;for(let Ve=0;Ve<Ze.length;Ve++)Ye.sectionIndex.push(0);ue.push(Ye)}}else if(le){ue=[];const be=le(X.text,X.sectionIndex,bp(X,T,m,e,a,B,F));for(const Ze of be){const Ye=new ja;Ye.text=Ze[0],Ye.sectionIndex=Ze[1],Ye.sections=X.sections,ue.push(Ye)}}else ue=function(be,Ze){const Ye=[],Ve=be.text;let Be=0;for(const Me of Ze)Ye.push(be.substring(Be,Me)),Be=Me;return Be<Ve.length&&Ye.push(be.substring(Be,Ve.length)),Ye}(X,bp(X,T,m,e,a,B,F));const de=[],Se={positionedLines:de,text:X.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:P,iconsInText:!1,verticalizable:!1};return function(be,Ze,Ye,Ve,Be,Me,$e,Ne,Ce,rt,et,vt){let Wt=0,tn=sh,bn=0,Zr=0;const Un=Ne==="right"?1:Ne==="left"?0:.5;let yn=0;for(const _n of Be){_n.trim();const $n=_n.getMaxScale(),Wn=($n-1)*Rn,sr={positionedGlyphs:[],lineOffset:0};be.positionedLines[yn]=sr;const xr=sr.positionedGlyphs;let wr=0;if(!_n.length()){tn+=Me,++yn;continue}for(let An=0;An<_n.length();An++){const wt=_n.getSection(An),Dr=_n.getSectionIndex(An),jn=_n.getCharCode(An);let Xn=0,ai=null,Ti=null,ki=null,yo=Rn;const li=!(Ce===l.WritingMode.horizontal||!et&&!Zl(jn)||et&&(lh[jn]||(zn=jn,Ue.Arabic(zn)||Ue["Arabic Supplement"](zn)||Ue["Arabic Extended-A"](zn)||Ue["Arabic Presentation Forms-A"](zn)||Ue["Arabic Presentation Forms-B"](zn))));if(wt.imageName){const Hr=Ve[wt.imageName];if(!Hr)continue;ki=wt.imageName,be.iconsInText=be.iconsInText||!0,Ti=Hr.paddedRect;const br=Hr.displaySize;wt.scale=wt.scale*Rn/vt,ai={width:br[0],height:br[1],left:1,top:-3,advance:li?br[1]:br[0]},Xn=Wn+(Rn-br[1]*wt.scale),yo=ai.advance;const _o=li?br[0]*wt.scale-Rn*$n:br[1]*wt.scale-Rn*$n;_o>0&&_o>wr&&(wr=_o)}else{const Hr=Ye[wt.fontStack],br=Hr&&Hr[jn];if(br&&br.rect)Ti=br.rect,ai=br.metrics;else{const _o=Ze[wt.fontStack],gu=_o&&_o[jn];if(!gu)continue;ai=gu.metrics}Xn=($n-wt.scale)*Rn}li?(be.verticalizable=!0,xr.push({glyph:jn,imageName:ki,x:Wt,y:tn+Xn,vertical:li,scale:wt.scale,fontStack:wt.fontStack,sectionIndex:Dr,metrics:ai,rect:Ti}),Wt+=yo*wt.scale+rt):(xr.push({glyph:jn,imageName:ki,x:Wt,y:tn+Xn,vertical:li,scale:wt.scale,fontStack:wt.fontStack,sectionIndex:Dr,metrics:ai,rect:Ti}),Wt+=ai.advance*wt.scale+rt)}xr.length!==0&&(bn=Math.max(Wt-rt,bn),C1(xr,0,xr.length-1,Un,wr)),Wt=0;const rn=Me*$n+wr;sr.lineOffset=Math.max(wr,Wn),tn+=rn,Zr=Math.max(rn,Zr),++yn}var zn;const Vn=tn-sh,{horizontalAlign:Hn,verticalAlign:vr}=Sp($e);(function(_n,$n,Wn,sr,xr,wr,rn,An,wt){const Dr=($n-Wn)*xr;let jn=0;jn=wr!==rn?-An*sr-sh:(-sr*wt+.5)*rn;for(const Xn of _n)for(const ai of Xn.positionedGlyphs)ai.x+=Dr,ai.y+=jn})(be.positionedLines,Un,Hn,vr,bn,Zr,Me,Vn,Be.length),be.top+=-vr*Vn,be.bottom=be.top+Vn,be.left+=-Hn*bn,be.right=be.left+bn}(Se,e,i,a,ue,y,x,b,P,T,L,K),!function(be){for(const Ze of be)if(Ze.positionedGlyphs.length!==0)return!1;return!0}(de)&&Se}const lh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},T1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Wg(r,e,i,a,d,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Rn/m+d:0}{const y=i[e.fontStack],x=y&&y[r];return x?x.metrics.advance*e.scale+d:0}}function Xg(r,e,i,a){const d=Math.pow(r-e,2);return a?r<e?d/2:2*d:d+Math.abs(i)*i}function k1(r,e,i){let a=0;return r===10&&(a-=1e4),i&&(a+=150),r!==40&&r!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Kg(r,e,i,a,d,m){let y=null,x=Xg(e,i,d,m);for(const b of a){const T=Xg(e-b.x,i,d,m)+b.badness;T<=x&&(y=b,x=T)}return{index:r,x:e,priorBreak:y,badness:x}}function Yg(r){return r?Yg(r.priorBreak).concat(r.index):[]}function bp(r,e,i,a,d,m,y){if(m!=="point")return[];if(!r)return[];const x=[],b=function(L,B,F,K,X,ue){let fe=0;for(let le=0;le<L.length();le++){const de=L.getSection(le);fe+=Wg(L.getCharCode(le),de,K,X,B,ue)}return fe/Math.max(1,Math.ceil(fe/F))}(r,e,i,a,d,y),T=r.text.indexOf("​")>=0;let z=0;for(let L=0;L<r.length();L++){const B=r.getSection(L),F=r.getCharCode(L);if(lh[F]||(z+=Wg(F,B,a,d,e,y)),L<r.length()-1){const K=!((P=F)<11904||!(Ue["Bopomofo Extended"](P)||Ue.Bopomofo(P)||Ue["CJK Compatibility Forms"](P)||Ue["CJK Compatibility Ideographs"](P)||Ue["CJK Compatibility"](P)||Ue["CJK Radicals Supplement"](P)||Ue["CJK Strokes"](P)||Ue["CJK Symbols and Punctuation"](P)||Ue["CJK Unified Ideographs Extension A"](P)||Ue["CJK Unified Ideographs"](P)||Ue["Enclosed CJK Letters and Months"](P)||Ue["Halfwidth and Fullwidth Forms"](P)||Ue.Hiragana(P)||Ue["Ideographic Description Characters"](P)||Ue["Kangxi Radicals"](P)||Ue["Katakana Phonetic Extensions"](P)||Ue.Katakana(P)||Ue["Vertical Forms"](P)||Ue["Yi Radicals"](P)||Ue["Yi Syllables"](P)));(T1[F]||K||B.imageName)&&x.push(Kg(L+1,z,b,x,k1(F,r.getCharCode(L+1),K&&T),!1))}}var P;return Yg(Kg(r.length(),z,b,x,0,!0))}function Sp(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function C1(r,e,i,a,d){if(!a&&!d)return;const m=r[i],y=(r[i].x+m.metrics.advance*m.scale)*a;for(let x=e;x<=i;x++)r[x].x-=y,r[x].y+=d}function I1(r,e,i){const{horizontalAlign:a,verticalAlign:d}=Sp(i),m=e[0]-r.displaySize[0]*a,y=e[1]-r.displaySize[1]*d;return{image:r,top:y,bottom:y+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function Jg(r,e,i,a,d,m){const y=r.image;let x;if(y.content){const X=y.content,ue=y.pixelRatio||1;x=[X[0]/ue,X[1]/ue,y.displaySize[0]-X[2]/ue,y.displaySize[1]-X[3]/ue]}const b=e.left*m,T=e.right*m;let z,P,L,B;i==="width"||i==="both"?(B=d[0]+b-a[3],P=d[0]+T+a[1]):(B=d[0]+(b+T-y.displaySize[0])/2,P=B+y.displaySize[0]);const F=e.top*m,K=e.bottom*m;return i==="height"||i==="both"?(z=d[1]+F-a[0],L=d[1]+K+a[2]):(z=d[1]+(F+K-y.displaySize[1])/2,L=z+y.displaySize[1]),{image:y,top:z,right:P,bottom:L,left:B,collisionPadding:x}}const go=128;function Qg(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Qt(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:d}=i;let m=0;for(;m<a.length&&a[m]<=r;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<r+1;)y++;y=Math.min(a.length-1,y);const x=a[m],b=a[y];return i.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:b,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:b,minSize:i.evaluate(new Qt(x)),maxSize:i.evaluate(new Qt(b)),interpolationType:d}}}class Qo extends at{constructor(e,i,a,d){super(e,i),this.angle=a,d!==void 0&&(this.segment=d)}clone(){return new Qo(this.x,this.y,this.angle,this.segment)}}function ey(r,e,i,a,d){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,x=0;for(;x>-i/2;){if(y--,y<0)return!1;x-=r[y].dist(m),m=r[y]}x+=r[y].dist(r[y+1]),y++;const b=[];let T=0;for(;x<i/2;){const z=r[y],P=r[y+1];if(!P)return!1;let L=r[y-1].angleTo(z)-z.angleTo(P);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:x,angleDelta:L}),T+=L;x-b[0].distance>a;)T-=b.shift().angleDelta;if(T>d)return!1;y++,x+=z.dist(P)}return!0}function ty(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function ny(r,e,i){return r?.6*e*i:0}function ry(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function z1(r,e,i,a,d,m){const y=ny(i,d,m),x=ry(i,a)*m;let b=0;const T=ty(r)/2;for(let z=0;z<r.length-1;z++){const P=r[z],L=r[z+1],B=P.dist(L);if(b+B>T){const F=(T-b)/B,K=Yt(P.x,L.x,F),X=Yt(P.y,L.y,F),ue=new Qo(K,X,L.angleTo(P),z);return ue._round(),!y||ey(r,ue,x,y,e)?ue:void 0}b+=B}}function A1(r,e,i,a,d,m,y,x,b){const T=ny(a,m,y),z=ry(a,d),P=z*y,L=r[0].x===0||r[0].x===b||r[0].y===0||r[0].y===b;return e-P<e/4&&(e=P+e/4),iy(r,L?e/2*x%e:(z/2+2*m)*y*x%e,e,T,i,P,L,!1,b)}function iy(r,e,i,a,d,m,y,x,b){const T=m/2,z=ty(r);let P=0,L=e-i,B=[];for(let F=0;F<r.length-1;F++){const K=r[F],X=r[F+1],ue=K.dist(X),fe=X.angleTo(K);for(;L+i<P+ue;){L+=i;const le=(L-P)/ue,de=Yt(K.x,X.x,le),Se=Yt(K.y,X.y,le);if(de>=0&&de<b&&Se>=0&&Se<b&&L-T>=0&&L+T<=z){const be=new Qo(de,Se,fe,F);be._round(),a&&!ey(r,be,m,a,d)||B.push(be)}}P+=ue}return x||B.length||y||(B=iy(r,P/2,i,a,d,m,y,!0,b)),B}function oy(r,e,i,a,d){const m=[];for(let y=0;y<r.length;y++){const x=r[y];let b;for(let T=0;T<x.length-1;T++){let z=x[T],P=x[T+1];z.x<e&&P.x<e||(z.x<e?z=new at(e,z.y+(e-z.x)/(P.x-z.x)*(P.y-z.y))._round():P.x<e&&(P=new at(e,z.y+(e-z.x)/(P.x-z.x)*(P.y-z.y))._round()),z.y<i&&P.y<i||(z.y<i?z=new at(z.x+(i-z.y)/(P.y-z.y)*(P.x-z.x),i)._round():P.y<i&&(P=new at(z.x+(i-z.y)/(P.y-z.y)*(P.x-z.x),i)._round()),z.x>=a&&P.x>=a||(z.x>=a?z=new at(a,z.y+(a-z.x)/(P.x-z.x)*(P.y-z.y))._round():P.x>=a&&(P=new at(a,z.y+(a-z.x)/(P.x-z.x)*(P.y-z.y))._round()),z.y>=d&&P.y>=d||(z.y>=d?z=new at(z.x+(d-z.y)/(P.y-z.y)*(P.x-z.x),d)._round():P.y>=d&&(P=new at(z.x+(d-z.y)/(P.y-z.y)*(P.x-z.x),d)._round()),b&&z.equals(b[b.length-1])||(b=[z],m.push(b)),b.push(P)))))}}return m}function sy(r,e,i,a){const d=[],m=r.image,y=m.pixelRatio,x=m.paddedRect.w-2,b=m.paddedRect.h-2,T=r.right-r.left,z=r.bottom-r.top,P=m.stretchX||[[0,x]],L=m.stretchY||[[0,b]],B=(Me,$e)=>Me+$e[1]-$e[0],F=P.reduce(B,0),K=L.reduce(B,0),X=x-F,ue=b-K;let fe=0,le=F,de=0,Se=K,be=0,Ze=X,Ye=0,Ve=ue;if(m.content&&a){const Me=m.content;fe=uh(P,0,Me[0]),de=uh(L,0,Me[1]),le=uh(P,Me[0],Me[2]),Se=uh(L,Me[1],Me[3]),be=Me[0]-fe,Ye=Me[1]-de,Ze=Me[2]-Me[0]-le,Ve=Me[3]-Me[1]-Se}const Be=(Me,$e,Ne,Ce)=>{const rt=ch(Me.stretch-fe,le,T,r.left),et=hh(Me.fixed-be,Ze,Me.stretch,F),vt=ch($e.stretch-de,Se,z,r.top),Wt=hh($e.fixed-Ye,Ve,$e.stretch,K),tn=ch(Ne.stretch-fe,le,T,r.left),bn=hh(Ne.fixed-be,Ze,Ne.stretch,F),Zr=ch(Ce.stretch-de,Se,z,r.top),Un=hh(Ce.fixed-Ye,Ve,Ce.stretch,K),yn=new at(rt,vt),zn=new at(tn,vt),Vn=new at(tn,Zr),Hn=new at(rt,Zr),vr=new at(et/y,Wt/y),_n=new at(bn/y,Un/y),$n=e*Math.PI/180;if($n){const xr=Math.sin($n),wr=Math.cos($n),rn=[wr,-xr,xr,wr];yn._matMult(rn),zn._matMult(rn),Hn._matMult(rn),Vn._matMult(rn)}const Wn=Me.stretch+Me.fixed,sr=$e.stretch+$e.fixed;return{tl:yn,tr:zn,bl:Hn,br:Vn,tex:{x:m.paddedRect.x+1+Wn,y:m.paddedRect.y+1+sr,w:Ne.stretch+Ne.fixed-Wn,h:Ce.stretch+Ce.fixed-sr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vr,pixelOffsetBR:_n,minFontScaleX:Ze/y/T,minFontScaleY:Ve/y/z,isSDF:i}};if(a&&(m.stretchX||m.stretchY)){const Me=ay(P,X,F),$e=ay(L,ue,K);for(let Ne=0;Ne<Me.length-1;Ne++){const Ce=Me[Ne],rt=Me[Ne+1];for(let et=0;et<$e.length-1;et++)d.push(Be(Ce,$e[et],rt,$e[et+1]))}}else d.push(Be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:b+1}));return d}function uh(r,e,i){let a=0;for(const d of r)a+=Math.max(e,Math.min(i,d[1]))-Math.max(e,Math.min(i,d[0]));return a}function ay(r,e,i){const a=[{fixed:-1,stretch:0}];for(const[d,m]of r){const y=a[a.length-1];a.push({fixed:d-y.stretch,stretch:y.stretch}),a.push({fixed:d-y.stretch,stretch:y.stretch+(m-d)})}return a.push({fixed:e+1,stretch:i}),a}function ch(r,e,i,a){return r/e*i+a}function hh(r,e,i,a){return r-e*i/a}Xe("Anchor",Qo);class dh{constructor(e,i,a,d,m,y,x,b,T,z){if(this.boxStartIndex=e.length,T){let P=y.top,L=y.bottom;const B=y.collisionPadding;B&&(P-=B[1],L+=B[3]);let F=L-P;F>0&&(F=Math.max(10,F),this.circleDiameter=F)}else{let P=y.top*x-b[0],L=y.bottom*x+b[2],B=y.left*x-b[3],F=y.right*x+b[1];const K=y.collisionPadding;if(K&&(B-=K[0]*x,P-=K[1]*x,F+=K[2]*x,L+=K[3]*x),z){const X=new at(B,P),ue=new at(F,P),fe=new at(B,L),le=new at(F,L),de=z*Math.PI/180;X._rotate(de),ue._rotate(de),fe._rotate(de),le._rotate(de),B=Math.min(X.x,ue.x,fe.x,le.x),F=Math.max(X.x,ue.x,fe.x,le.x),P=Math.min(X.y,ue.y,fe.y,le.y),L=Math.max(X.y,ue.y,fe.y,le.y)}e.emplaceBack(i.x,i.y,B,P,F,L,a,d,m)}this.boxEndIndex=e.length}}class P1{constructor(e=[],i=M1){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,d=i[e];for(;e>0;){const m=e-1>>1,y=i[m];if(a(d,y)>=0)break;i[e]=y,e=m}i[e]=d}_down(e){const{data:i,compare:a}=this,d=this.length>>1,m=i[e];for(;e<d;){let y=1+(e<<1),x=i[y];const b=y+1;if(b<this.length&&a(i[b],x)<0&&(y=b,x=i[b]),a(x,m)>=0)break;i[e]=x,e=y}i[e]=m}}function M1(r,e){return r<e?-1:r>e?1:0}function D1(r,e=1,i=!1){let a=1/0,d=1/0,m=-1/0,y=-1/0;const x=r[0];for(let B=0;B<x.length;B++){const F=x[B];(!B||F.x<a)&&(a=F.x),(!B||F.y<d)&&(d=F.y),(!B||F.x>m)&&(m=F.x),(!B||F.y>y)&&(y=F.y)}const b=Math.min(m-a,y-d);let T=b/2;const z=new P1([],L1);if(b===0)return new at(a,d);for(let B=a;B<m;B+=b)for(let F=d;F<y;F+=b)z.push(new Ga(B+T,F+T,T,r));let P=function(B){let F=0,K=0,X=0;const ue=B[0];for(let fe=0,le=ue.length,de=le-1;fe<le;de=fe++){const Se=ue[fe],be=ue[de],Ze=Se.x*be.y-be.x*Se.y;K+=(Se.x+be.x)*Ze,X+=(Se.y+be.y)*Ze,F+=3*Ze}return new Ga(K/F,X/F,0,B)}(r),L=z.length;for(;z.length;){const B=z.pop();(B.d>P.d||!P.d)&&(P=B,i&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-P.d<=e||(T=B.h/2,z.push(new Ga(B.p.x-T,B.p.y-T,T,r)),z.push(new Ga(B.p.x+T,B.p.y-T,T,r)),z.push(new Ga(B.p.x-T,B.p.y+T,T,r)),z.push(new Ga(B.p.x+T,B.p.y+T,T,r)),L+=4)}return i&&(console.log(`num probes: ${L}`),console.log(`best distance: ${P.d}`)),P.p}function L1(r,e){return e.max-r.max}function Ga(r,e,i,a){this.p=new at(r,e),this.h=i,this.d=function(d,m){let y=!1,x=1/0;for(let b=0;b<m.length;b++){const T=m[b];for(let z=0,P=T.length,L=P-1;z<P;L=z++){const B=T[z],F=T[L];B.y>d.y!=F.y>d.y&&d.x<(F.x-B.x)*(d.y-B.y)/(F.y-B.y)+B.x&&(y=!y),x=Math.min(x,mg(d,B,F))}}return(y?1:-1)*Math.sqrt(x)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const Ep=Number.POSITIVE_INFINITY;function ly(r,e){return e[1]!==Ep?function(i,a,d){let m=0,y=0;switch(a=Math.abs(a),d=Math.abs(d),i){case"top-right":case"top-left":case"top":y=d-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-d}switch(i){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,y]}(r,e[0],e[1]):function(i,a){let d=0,m=0;a<0&&(a=0);const y=a/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-a;break;case"top":m=a-7}switch(i){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=a;break;case"right":d=-a}return[d,m]}(r,e[0])}function Tp(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function R1(r,e,i,a,d,m,y,x,b,T,z){let P=m.textMaxSize.evaluate(e,{});P===void 0&&(P=y);const L=r.layers[0].layout,B=L.get("icon-offset").evaluate(e,{},z),F=cy(i.horizontal),K=y/24,X=r.tilePixelRatio*K,ue=r.tilePixelRatio*P/24,fe=r.tilePixelRatio*x,le=r.tilePixelRatio*L.get("symbol-spacing"),de=L.get("text-padding")*r.tilePixelRatio,Se=function(Ce,rt,et,vt=1){const Wt=Ce.get("icon-padding").evaluate(rt,{},et),tn=Wt&&Wt.values;return[tn[0]*vt,tn[1]*vt,tn[2]*vt,tn[3]*vt]}(L,e,z,r.tilePixelRatio),be=L.get("text-max-angle")/180*Math.PI,Ze=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Ye=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ve=L.get("symbol-placement"),Be=le/2,Me=L.get("icon-text-fit");let $e;a&&Me!=="none"&&(r.allowVerticalPlacement&&i.vertical&&($e=Jg(a,i.vertical,Me,L.get("icon-text-fit-padding"),B,K)),F&&(a=Jg(a,F,Me,L.get("icon-text-fit-padding"),B,K)));const Ne=(Ce,rt)=>{rt.x<0||rt.x>=wn||rt.y<0||rt.y>=wn||function(et,vt,Wt,tn,bn,Zr,Un,yn,zn,Vn,Hn,vr,_n,$n,Wn,sr,xr,wr,rn,An,wt,Dr,jn,Xn,ai){const Ti=et.addToLineVertexArray(vt,Wt);let ki,yo,li,Hr,br=0,_o=0,gu=0,ky=0,Rp=-1,Bp=-1;const vo={};let Cy=In.exports(""),Fp=0,Op=0;if(yn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Fp,Op]=yn.layout.get("text-offset").evaluate(wt,{},Xn).map(Sr=>Sr*Rn):(Fp=yn.layout.get("text-radial-offset").evaluate(wt,{},Xn)*Rn,Op=Ep),et.allowVerticalPlacement&&tn.vertical){const Sr=yn.layout.get("text-rotate").evaluate(wt,{},Xn)+90;li=new dh(zn,vt,Vn,Hn,vr,tn.vertical,_n,$n,Wn,Sr),Un&&(Hr=new dh(zn,vt,Vn,Hn,vr,Un,xr,wr,Wn,Sr))}if(bn){const Sr=yn.layout.get("icon-rotate").evaluate(wt,{}),Xi=yn.layout.get("icon-text-fit")!=="none",yu=sy(bn,Sr,jn,Xi),_u=Un?sy(Un,Sr,jn,Xi):void 0;yo=new dh(zn,vt,Vn,Hn,vr,bn,xr,wr,!1,Sr),br=4*yu.length;const Ay=et.iconSizeData;let ea=null;Ay.kind==="source"?(ea=[go*yn.layout.get("icon-size").evaluate(wt,{})],ea[0]>es&&ze(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Ay.kind==="composite"&&(ea=[go*Dr.compositeIconSizes[0].evaluate(wt,{},Xn),go*Dr.compositeIconSizes[1].evaluate(wt,{},Xn)],(ea[0]>es||ea[1]>es)&&ze(`${et.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),et.addSymbols(et.icon,yu,ea,An,rn,wt,l.WritingMode.none,vt,Ti.lineStartIndex,Ti.lineLength,-1,Xn),Rp=et.icon.placedSymbolArray.length-1,_u&&(_o=4*_u.length,et.addSymbols(et.icon,_u,ea,An,rn,wt,l.WritingMode.vertical,vt,Ti.lineStartIndex,Ti.lineLength,-1,Xn),Bp=et.icon.placedSymbolArray.length-1)}const Iy=Object.keys(tn.horizontal);for(const Sr of Iy){const Xi=tn.horizontal[Sr];if(!ki){Cy=In.exports(Xi.text);const _u=yn.layout.get("text-rotate").evaluate(wt,{},Xn);ki=new dh(zn,vt,Vn,Hn,vr,Xi,_n,$n,Wn,_u)}const yu=Xi.positionedLines.length===1;if(gu+=uy(et,vt,Xi,Zr,yn,Wn,wt,sr,Ti,tn.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,yu?Iy:[Sr],vo,Rp,Dr,Xn),yu)break}tn.vertical&&(ky+=uy(et,vt,tn.vertical,Zr,yn,Wn,wt,sr,Ti,l.WritingMode.vertical,["vertical"],vo,Bp,Dr,Xn));const W1=ki?ki.boxStartIndex:et.collisionBoxArray.length,X1=ki?ki.boxEndIndex:et.collisionBoxArray.length,K1=li?li.boxStartIndex:et.collisionBoxArray.length,Y1=li?li.boxEndIndex:et.collisionBoxArray.length,J1=yo?yo.boxStartIndex:et.collisionBoxArray.length,Q1=yo?yo.boxEndIndex:et.collisionBoxArray.length,ew=Hr?Hr.boxStartIndex:et.collisionBoxArray.length,tw=Hr?Hr.boxEndIndex:et.collisionBoxArray.length;let Ci=-1;const yh=(Sr,Xi)=>Sr&&Sr.circleDiameter?Math.max(Sr.circleDiameter,Xi):Xi;Ci=yh(ki,Ci),Ci=yh(li,Ci),Ci=yh(yo,Ci),Ci=yh(Hr,Ci);const zy=Ci>-1?1:0;zy&&(Ci*=ai/Rn),et.glyphOffsetArray.length>=qa.MAX_GLYPHS&&ze("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wt.sortKey!==void 0&&et.addToSortKeyRanges(et.symbolInstances.length,wt.sortKey),et.symbolInstances.emplaceBack(vt.x,vt.y,vo.right>=0?vo.right:-1,vo.center>=0?vo.center:-1,vo.left>=0?vo.left:-1,vo.vertical||-1,Rp,Bp,Cy,W1,X1,K1,Y1,J1,Q1,ew,tw,Vn,gu,ky,br,_o,zy,0,_n,Fp,Op,Ci)}(r,rt,Ce,i,a,d,$e,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,X,[de,de,de,de],Ze,b,fe,Se,Ye,B,e,m,T,z,y)};if(Ve==="line")for(const Ce of oy(e.geometry,0,0,wn,wn)){const rt=A1(Ce,le,be,i.vertical||F,a,24,ue,r.overscaling,wn);for(const et of rt){const vt=F;vt&&B1(r,vt.text,Be,et)||Ne(Ce,et)}}else if(Ve==="line-center"){for(const Ce of e.geometry)if(Ce.length>1){const rt=z1(Ce,be,i.vertical||F,a,24,ue);rt&&Ne(Ce,rt)}}else if(e.type==="Polygon")for(const Ce of dp(e.geometry,0)){const rt=D1(Ce,16);Ne(Ce[0],new Qo(rt.x,rt.y,0))}else if(e.type==="LineString")for(const Ce of e.geometry)Ne(Ce,new Qo(Ce[0].x,Ce[0].y,0));else if(e.type==="Point")for(const Ce of e.geometry)for(const rt of Ce)Ne([rt],new Qo(rt.x,rt.y,0))}const es=32640;function uy(r,e,i,a,d,m,y,x,b,T,z,P,L,B,F){const K=function(fe,le,de,Se,be,Ze,Ye,Ve){const Be=Se.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Me=[];for(const $e of le.positionedLines)for(const Ne of $e.positionedGlyphs){if(!Ne.rect)continue;const Ce=Ne.rect||{};let rt=4,et=!0,vt=1,Wt=0;const tn=(be||Ve)&&Ne.vertical,bn=Ne.metrics.advance*Ne.scale/2;if(Ve&&le.verticalizable){const rn=(Ne.scale-1)*Rn,An=(Rn-Ne.metrics.width*Ne.scale)/2;Wt=$e.lineOffset/2-(Ne.imageName?-An:rn)}if(Ne.imageName){const rn=Ye[Ne.imageName];et=rn.sdf,vt=rn.pixelRatio,rt=1/vt}const Zr=be?[Ne.x+bn,Ne.y]:[0,0];let Un=be?[0,0]:[Ne.x+bn+de[0],Ne.y+de[1]-Wt],yn=[0,0];tn&&(yn=Un,Un=[0,0]);const zn=(Ne.metrics.left-rt)*Ne.scale-bn+Un[0],Vn=(-Ne.metrics.top-rt)*Ne.scale+Un[1],Hn=zn+Ce.w*Ne.scale/vt,vr=Vn+Ce.h*Ne.scale/vt,_n=new at(zn,Vn),$n=new at(Hn,Vn),Wn=new at(zn,vr),sr=new at(Hn,vr);if(tn){const rn=new at(-bn,bn-sh),An=-Math.PI/2,wt=12-bn,Dr=new at(22-wt,-(Ne.imageName?wt:0)),jn=new at(...yn);_n._rotateAround(An,rn)._add(Dr)._add(jn),$n._rotateAround(An,rn)._add(Dr)._add(jn),Wn._rotateAround(An,rn)._add(Dr)._add(jn),sr._rotateAround(An,rn)._add(Dr)._add(jn)}if(Be){const rn=Math.sin(Be),An=Math.cos(Be),wt=[An,-rn,rn,An];_n._matMult(wt),$n._matMult(wt),Wn._matMult(wt),sr._matMult(wt)}const xr=new at(0,0),wr=new at(0,0);Me.push({tl:_n,tr:$n,bl:Wn,br:sr,tex:Ce,writingMode:le.writingMode,glyphOffset:Zr,sectionIndex:Ne.sectionIndex,isSDF:et,pixelOffsetTL:xr,pixelOffsetBR:wr,minFontScaleX:0,minFontScaleY:0})}return Me}(0,i,x,d,m,y,a,r.allowVerticalPlacement),X=r.textSizeData;let ue=null;X.kind==="source"?(ue=[go*d.layout.get("text-size").evaluate(y,{})],ue[0]>es&&ze(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):X.kind==="composite"&&(ue=[go*B.compositeTextSizes[0].evaluate(y,{},F),go*B.compositeTextSizes[1].evaluate(y,{},F)],(ue[0]>es||ue[1]>es)&&ze(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,K,ue,x,m,y,T,e,b.lineStartIndex,b.lineLength,L,F);for(const fe of z)P[fe]=r.text.placedSymbolArray.length-1;return 4*K.length}function cy(r){for(const e in r)return r[e];return null}function B1(r,e,i,a){const d=r.compareText;if(e in d){const m=d[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<i)return!0}else d[e]=[];return d[e].push(a),!1}const F1=Yo.VectorTileFeature.types,O1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ph(r,e,i,a,d,m,y,x,b,T,z,P,L){const B=x?Math.min(es,Math.round(x[0])):0,F=x?Math.min(es,Math.round(x[1])):0;r.emplaceBack(e,i,Math.round(32*a),Math.round(32*d),m,y,(B<<1)+(b?1:0),F,16*T,16*z,256*P,256*L)}function kp(r,e,i){r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i)}function N1(r){for(const e of r.sections)if($c(e.text))return!0;return!1}class Cp{constructor(e){this.layoutVertexArray=new oi,this.indexArray=new rr,this.programConfigurations=e,this.segments=new xt,this.dynamicLayoutVertexArray=new jr,this.opacityVertexArray=new si,this.placedSymbolArray=new ke}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,a,d){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,l1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,u1.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,O1,!0),this.opacityVertexBuffer.itemSize=1),(a||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Xe("SymbolBuffers",Cp);class Ip{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new xt,this.collisionVertexArray=new Pr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,c1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Xe("CollisionBuffers",Ip);class qa{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sp([]),this.placementViewportMatrix=sp([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qg(this.zoom,i["text-size"]),this.iconSizeData=Qg(this.zoom,i["icon-size"]);const a=this.layers[0].layout,d=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=Ap(a,"text-overlap","text-allow-overlap")!=="never"||Ap(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(y=>l.WritingMode[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new Cp(new Xs(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Cp(new Xs(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Re,this.lineVertexArray=new qe,this.symbolInstances=new Ge}calculateGlyphDependencies(e,i,a,d,m){for(let y=0;y<e.length;y++)if(i[e.charCodeAt(y)]=!0,(a||d)&&m){const x=du[e.charAt(y)];x&&(i[x.charCodeAt(0)]=!0)}}populate(e,i,a){const d=this.layers[0],m=d.layout,y=m.get("text-font"),x=m.get("text-field"),b=m.get("icon-image"),T=(x.value.kind!=="constant"||x.value.value instanceof Q&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),z=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,P=m.get("symbol-sort-key");if(this.features=[],!T&&!z)return;const L=i.iconDependencies,B=i.glyphDependencies,F=i.availableImages,K=new Qt(this.zoom);for(const{feature:X,id:ue,index:fe,sourceLayerIndex:le}of e){const de=d._featureFilter.needGeometry,Se=Ys(X,de);if(!d._featureFilter.filter(K,Se,a))continue;let be,Ze;if(de||(Se.geometry=Ks(X)),T){const Ve=d.getValueAndResolveTokens("text-field",Se,a,F),Be=Q.factory(Ve);N1(Be)&&(this.hasRTLText=!0),(!this.hasRTLText||Zs()==="unavailable"||this.hasRTLText&&Ar.isParsed())&&(be=d1(Be,d,Se))}if(z){const Ve=d.getValueAndResolveTokens("icon-image",Se,a,F);Ze=Ve instanceof oe?Ve:oe.fromString(Ve)}if(!be&&!Ze)continue;const Ye=this.sortFeaturesByKey?P.evaluate(Se,{},a):void 0;if(this.features.push({id:ue,text:be,icon:Ze,index:fe,sourceLayerIndex:le,geometry:Se.geometry,properties:X.properties,type:F1[X.type],sortKey:Ye}),Ze&&(L[Ze.name]=!0),be){const Ve=y.evaluate(Se,{},a).join(","),Be=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const Me of be.sections)if(Me.image)L[Me.image.name]=!0;else{const $e=Da(be.toString()),Ne=Me.fontStack||Ve,Ce=B[Ne]=B[Ne]||{};this.calculateGlyphDependencies(Me.text,Ce,Be,this.allowVerticalPlacement,$e)}}}m.get("symbol-placement")==="line"&&(this.features=function(X){const ue={},fe={},le=[];let de=0;function Se(Ve){le.push(X[Ve]),de++}function be(Ve,Be,Me){const $e=fe[Ve];return delete fe[Ve],fe[Be]=$e,le[$e].geometry[0].pop(),le[$e].geometry[0]=le[$e].geometry[0].concat(Me[0]),$e}function Ze(Ve,Be,Me){const $e=ue[Be];return delete ue[Be],ue[Ve]=$e,le[$e].geometry[0].shift(),le[$e].geometry[0]=Me[0].concat(le[$e].geometry[0]),$e}function Ye(Ve,Be,Me){const $e=Me?Be[0][Be[0].length-1]:Be[0][0];return`${Ve}:${$e.x}:${$e.y}`}for(let Ve=0;Ve<X.length;Ve++){const Be=X[Ve],Me=Be.geometry,$e=Be.text?Be.text.toString():null;if(!$e){Se(Ve);continue}const Ne=Ye($e,Me),Ce=Ye($e,Me,!0);if(Ne in fe&&Ce in ue&&fe[Ne]!==ue[Ce]){const rt=Ze(Ne,Ce,Me),et=be(Ne,Ce,le[rt].geometry);delete ue[Ne],delete fe[Ce],fe[Ye($e,le[et].geometry,!0)]=et,le[rt].geometry=null}else Ne in fe?be(Ne,Ce,Me):Ce in ue?Ze(Ne,Ce,Me):(Se(Ve),ue[Ne]=de-1,fe[Ce]=de-1)}return le.filter(Ve=>Ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((X,ue)=>X.sortKey-ue.sortKey)}update(e,i,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(i[e.segment+1]),m=e.dist(i[e.segment]);const y={};for(let x=e.segment+1;x<i.length;x++)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:d},x<i.length-1&&(d+=i[x+1].dist(i[x]));for(let x=e.segment||0;x>=0;x--)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:m},x>0&&(m+=i[x-1].dist(i[x]));for(let x=0;x<i.length;x++){const b=y[x];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,d,m,y,x,b,T,z,P,L){const B=e.indexArray,F=e.layoutVertexArray,K=e.segments.prepareSegment(4*i.length,F,B,this.canOverlap?y.sortKey:void 0),X=this.glyphOffsetArray.length,ue=K.vertexLength,fe=this.allowVerticalPlacement&&x===l.WritingMode.vertical?Math.PI/2:0,le=y.text&&y.text.sections;for(let de=0;de<i.length;de++){const{tl:Se,tr:be,bl:Ze,br:Ye,tex:Ve,pixelOffsetTL:Be,pixelOffsetBR:Me,minFontScaleX:$e,minFontScaleY:Ne,glyphOffset:Ce,isSDF:rt,sectionIndex:et}=i[de],vt=K.vertexLength,Wt=Ce[1];ph(F,b.x,b.y,Se.x,Wt+Se.y,Ve.x,Ve.y,a,rt,Be.x,Be.y,$e,Ne),ph(F,b.x,b.y,be.x,Wt+be.y,Ve.x+Ve.w,Ve.y,a,rt,Me.x,Be.y,$e,Ne),ph(F,b.x,b.y,Ze.x,Wt+Ze.y,Ve.x,Ve.y+Ve.h,a,rt,Be.x,Me.y,$e,Ne),ph(F,b.x,b.y,Ye.x,Wt+Ye.y,Ve.x+Ve.w,Ve.y+Ve.h,a,rt,Me.x,Me.y,$e,Ne),kp(e.dynamicLayoutVertexArray,b,fe),B.emplaceBack(vt,vt+1,vt+2),B.emplaceBack(vt+1,vt+2,vt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ce[0]),de!==i.length-1&&et===i[de+1].sectionIndex||e.programConfigurations.populatePaintArrays(F.length,y,y.index,{},L,le&&le[et])}e.placedSymbolArray.emplaceBack(b.x,b.y,X,this.glyphOffsetArray.length-X,ue,T,z,b.segment,a?a[0]:0,a?a[1]:0,d[0],d[1],x,0,!1,0,P)}_addCollisionDebugVertex(e,i,a,d,m,y){return i.emplaceBack(0,0),e.emplaceBack(a.x,a.y,d,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,i,a,d,m,y,x){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),T=b.vertexLength,z=m.layoutVertexArray,P=m.collisionVertexArray,L=x.anchorX,B=x.anchorY;this._addCollisionDebugVertex(z,P,y,L,B,new at(e,i)),this._addCollisionDebugVertex(z,P,y,L,B,new at(a,i)),this._addCollisionDebugVertex(z,P,y,L,B,new at(a,d)),this._addCollisionDebugVertex(z,P,y,L,B,new at(e,d)),b.vertexLength+=4;const F=m.indexArray;F.emplaceBack(T,T+1),F.emplaceBack(T+1,T+2),F.emplaceBack(T+2,T+3),F.emplaceBack(T+3,T),b.primitiveLength+=4}addDebugCollisionBoxes(e,i,a,d){for(let m=e;m<i;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,d?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ip(Hi,Ng.members,Si),this.iconCollisionBox=new Ip(Hi,Ng.members,Si);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,a,d,m,y,x,b,T){const z={};for(let P=i;P<a;P++){const L=e.get(P);z.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.textFeatureIndex=L.featureIndex;break}for(let P=d;P<m;P++){const L=e.get(P);z.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalTextFeatureIndex=L.featureIndex;break}for(let P=y;P<x;P++){const L=e.get(P);z.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.iconFeatureIndex=L.featureIndex;break}for(let P=b;P<T;P++){const L=e.get(P);z.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalIconFeatureIndex=L.featureIndex;break}return z}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),d=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),d=[],m=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const b=this.symbolInstances.get(x);d.push(0|Math.round(i*b.anchorX+a*b.anchorY)),m.push(b.featureIndex)}return y.sort((x,b)=>d[x]-d[b]||m[b]-m[x]),y}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((d,m,y)=>{d>=0&&y.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Xe("SymbolBucket",qa,{omit:["layers","collisionBoxArray","features","compareText"]}),qa.MAX_GLYPHS=65535,qa.addDynamicAttributes=kp;const U1=new Ln({"symbol-placement":new Qe(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Qe(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qe(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ot(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Qe(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qe(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Qe(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Qe(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qe(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qe(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ot(xe.layout_symbol["icon-size"]),"icon-text-fit":new Qe(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qe(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ot(xe.layout_symbol["icon-image"]),"icon-rotate":new ot(xe.layout_symbol["icon-rotate"]),"icon-padding":new ot(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Qe(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new ot(xe.layout_symbol["icon-offset"]),"icon-anchor":new ot(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qe(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qe(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qe(xe.layout_symbol["text-rotation-alignment"]),"text-field":new ot(xe.layout_symbol["text-field"]),"text-font":new ot(xe.layout_symbol["text-font"]),"text-size":new ot(xe.layout_symbol["text-size"]),"text-max-width":new ot(xe.layout_symbol["text-max-width"]),"text-line-height":new Qe(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new ot(xe.layout_symbol["text-letter-spacing"]),"text-justify":new ot(xe.layout_symbol["text-justify"]),"text-radial-offset":new ot(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Qe(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new ot(xe.layout_symbol["text-anchor"]),"text-max-angle":new Qe(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Qe(xe.layout_symbol["text-writing-mode"]),"text-rotate":new ot(xe.layout_symbol["text-rotate"]),"text-padding":new Qe(xe.layout_symbol["text-padding"]),"text-keep-upright":new Qe(xe.layout_symbol["text-keep-upright"]),"text-transform":new ot(xe.layout_symbol["text-transform"]),"text-offset":new ot(xe.layout_symbol["text-offset"]),"text-allow-overlap":new Qe(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new Qe(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new Qe(xe.layout_symbol["text-ignore-placement"]),"text-optional":new Qe(xe.layout_symbol["text-optional"])});var zp={paint:new Ln({"icon-opacity":new ot(xe.paint_symbol["icon-opacity"]),"icon-color":new ot(xe.paint_symbol["icon-color"]),"icon-halo-color":new ot(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ot(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ot(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Qe(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qe(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ot(xe.paint_symbol["text-opacity"]),"text-color":new ot(xe.paint_symbol["text-color"],{runtimeType:Dn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ot(xe.paint_symbol["text-halo-color"]),"text-halo-width":new ot(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new ot(xe.paint_symbol["text-halo-blur"]),"text-translate":new Qe(xe.paint_symbol["text-translate"]),"text-translate-anchor":new Qe(xe.paint_symbol["text-translate-anchor"])}),layout:U1};class hy{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Ni,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xe("FormatSectionOverride",hy,{omit:["defaultValue"]});class fh extends ii{constructor(e){super(e,zp)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const d=[];for(const m of a)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,d){const m=this.layout.get(e).evaluate(i,{},a,d),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ds(y.value)||!m?m:function(x,b){return b.replace(/{([^{}]+)}/g,(T,z)=>z in x?String(x[z]):"")}(i.properties,m)}createBucket(e){return new qa(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of zp.paint.overridableProperties){if(!fh.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new hy(i),d=new Ca(a,i.property.specification);let m=null;m=i.value.kind==="constant"||i.value.kind==="source"?new Rs("source",d):new Ul("composite",d,i.value.zoomStops),this.paint._values[e]=new ri(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&fh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),d=zp.paint.properties[i];let m=!1;const y=x=>{for(const b of x)if(d.overrides&&d.overrides.hasOverride(b))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Q)y(a.value.value.sections);else if(a.value.kind==="source"){const x=T=>{m||(T instanceof Je&&me(T.value)===En?y(T.value.sections):T instanceof Ta?y(T.sections):T.eachChild(x))},b=a.value;b._styleExpression&&x(b._styleExpression.expression)}return m}}function Ap(r,e,i){let a="never";const d=r.get(e);return d?a=d:r.get(i)&&(a="always"),a}var V1={paint:new Ln({"background-color":new Qe(xe.paint_background["background-color"]),"background-pattern":new Jl(xe.paint_background["background-pattern"]),"background-opacity":new Qe(xe.paint_background["background-opacity"])})},$1={paint:new Ln({"raster-opacity":new Qe(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qe(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qe(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qe(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Qe(xe.paint_raster["raster-saturation"]),"raster-contrast":new Qe(xe.paint_raster["raster-contrast"]),"raster-resampling":new Qe(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Qe(xe.paint_raster["raster-fade-duration"])})};class j1 extends ii{constructor(e){super(e,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const G1={circle:class extends ii{constructor(r){super(r,w0)}createBucket(r){return new rp(r)}queryRadius(r){const e=r;return ru("circle-radius",this,e)+ru("circle-stroke-width",this,e)+Yc(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y,x){const b=Jc(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,y),T=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),z=this.paint.get("circle-pitch-alignment")==="map",P=z?b:function(B,F){return B.map(K=>bg(K,F))}(b,x),L=z?T*y:T;for(const B of a)for(const F of B){const K=z?F:bg(F,x);let X=L;const ue=Qc([],[F.x,F.y,0,1],x);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?X*=ue[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(X*=m.cameraToCenterDistance/ue[3]),g0(P,K,X))return!0}return!1}},heatmap:class extends ii{constructor(r){super(r,S0),this._updateColorRamp()}createBucket(r){return new Sg(r)}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Tg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends ii{constructor(r){super(r,E0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends ii{constructor(r){super(r,U0)}recalculate(r,e){super.recalculate(r,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new mp(r)}queryRadius(){return Yc(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y){return fg(Jc(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,y),a)}isTileClipped(){return!0}},"fill-extrusion":class extends ii{constructor(r){super(r,e1)}createBucket(r){return new yp(r)}queryRadius(){return Yc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,e,i,a,d,m,y,x){const b=Jc(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,y),T=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),P=function(B,F,K,X){const ue=[];for(const fe of B){const le=[fe.x,fe.y,0,1];Qc(le,le,F),ue.push(new at(le[0]/le[3],le[1]/le[3]))}return ue}(b,x),L=function(B,F,K,X){const ue=[],fe=[],le=X[8]*F,de=X[9]*F,Se=X[10]*F,be=X[11]*F,Ze=X[8]*K,Ye=X[9]*K,Ve=X[10]*K,Be=X[11]*K;for(const Me of B){const $e=[],Ne=[];for(const Ce of Me){const rt=Ce.x,et=Ce.y,vt=X[0]*rt+X[4]*et+X[12],Wt=X[1]*rt+X[5]*et+X[13],tn=X[2]*rt+X[6]*et+X[14],bn=X[3]*rt+X[7]*et+X[15],Zr=tn+Se,Un=bn+be,yn=vt+Ze,zn=Wt+Ye,Vn=tn+Ve,Hn=bn+Be,vr=new at((vt+le)/Un,(Wt+de)/Un);vr.z=Zr/Un,$e.push(vr);const _n=new at(yn/Hn,zn/Hn);_n.z=Vn/Hn,Ne.push(_n)}ue.push($e),fe.push(Ne)}return[ue,fe]}(a,z,T,x);return function(B,F,K){let X=1/0;fg(K,F)&&(X=Lg(K,F[0]));for(let ue=0;ue<F.length;ue++){const fe=F[ue],le=B[ue];for(let de=0;de<fe.length-1;de++){const Se=fe[de],be=[Se,fe[de+1],le[de+1],le[de],Se];pg(K,be)&&(X=Math.min(X,Lg(K,be)))}}return X!==1/0&&X}(L[0],L[1],P)}},line:class extends ii{constructor(r){super(r,Bg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Is,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=Fg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new _p(r)}queryRadius(r){const e=r,i=Og(ru("line-width",this,e),ru("line-gap-width",this,e)),a=ru("line-offset",this,e);return i/2+Math.abs(a)+Yc(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y){const x=Jc(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,y),b=y/2*Og(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),T=this.paint.get("line-offset").evaluate(e,i);return T&&(a=function(z,P){const L=[];for(let B=0;B<z.length;B++){const F=z[B],K=[];for(let X=0;X<F.length;X++){const ue=F[X-1],fe=F[X],le=F[X+1],de=X===0?new at(0,0):fe.sub(ue)._unit()._perp(),Se=X===F.length-1?new at(0,0):le.sub(fe)._unit()._perp(),be=de._add(Se)._unit(),Ze=be.x*Se.x+be.y*Se.y;Ze!==0&&be._mult(1/Ze),K.push(be._mult(P)._add(fe))}L.push(K)}return L}(a,T*y)),function(z,P,L){for(let B=0;B<P.length;B++){const F=P[B];if(z.length>=3){for(let K=0;K<F.length;K++)if(Oa(z,F[K]))return!0}if(y0(z,F,L))return!0}return!1}(x,a,b)}isTileClipped(){return!0}},symbol:fh,background:class extends ii{constructor(r){super(r,V1)}},raster:class extends ii{constructor(r){super(r,$1)}}};class q1{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const dy=63710088e-1;class un{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new un(Ae(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,d=e.lat*i,m=Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos((e.lng-this.lng)*i);return dy*Math.acos(Math.min(m,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new Qs(new un(this.lng-a,this.lat-i),new un(this.lng+a,this.lat+i))}static convert(e){if(e instanceof un)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new un(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new un(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Qs{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof un?new un(e.lng,e.lat):un.convert(e),this}setSouthWest(e){return this._sw=e instanceof un?new un(e.lng,e.lat):un.convert(e),this}extend(e){const i=this._sw,a=this._ne;let d,m;if(e instanceof un)d=e,m=e;else{if(!(e instanceof Qs))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Qs.convert(e)):this.extend(un.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return i||a?(i.lng=Math.min(d.lng,i.lng),i.lat=Math.min(d.lat,i.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new un(d.lng,d.lat),this._ne=new un(m.lng,m.lat)),this}getCenter(){return new un((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new un(this.getWest(),this.getNorth())}getSouthEast(){return new un(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=un.convert(e);let d=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&d}static convert(e){return e instanceof Qs?e:e&&new Qs(e)}}const py=2*Math.PI*dy;function fy(r){return py*Math.cos(r*Math.PI/180)}function my(r){return(180+r)/360}function gy(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function yy(r,e){return r/fy(e)}function Pp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class mh{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=un.convert(e);return new mh(my(a.lng),gy(a.lat),yy(i,a.lat))}toLngLat(){return new un(360*this.x-180,Pp(this.y))}toAltitude(){return this.z*fy(Pp(this.y))}meterInMercatorCoordinateUnits(){return 1/py*(e=Pp(this.y),1/Math.cos(e*Math.PI/180));var e}}function _y(r,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[r*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Mp{constructor(e,i,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||i<0||i>=Math.pow(2,e))throw new Error(`x=${i}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=a,this.key=fu(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,a){const d=(y=this.y,x=this.z,b=_y(256*(m=this.x),256*(y=Math.pow(2,x)-y-1),x),T=_y(256*(m+1),256*(y+1),x),b[0]+","+b[1]+","+T[0]+","+T[1]);var m,y,x,b,T;const z=function(P,L,B){let F,K="";for(let X=P;X>0;X--)F=1<<X-1,K+=(L&F?1:0)+(B&F?2:0);return K}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new at((e.x*i-this.x)*wn,(e.y*i-this.y)*wn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vy{constructor(e,i){this.wrap=e,this.canonical=i,this.key=fu(e,i.z,i.z,i.x,i.y)}}class qr{constructor(e,i,a,d,m){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=i,this.canonical=new Mp(a,+d,+m),this.key=fu(i,e,a,d,m)}clone(){return new qr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new qr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qr(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?fu(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):fu(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new qr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,d=2*this.canonical.y;return[new qr(i,this.wrap,i,a,d),new qr(i,this.wrap,i,a+1,d),new qr(i,this.wrap,i,a,d+1),new qr(i,this.wrap,i,a+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new qr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new qr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new mh(e.x-this.wrap,e.y))}}function fu(r,e,i,a,d){(r*=2)<0&&(r=-1*r-1);const m=1<<i;return(m*m*r+m*d+a).toString(36)+i.toString(36)+e.toString(36)}Xe("CanonicalTileID",Mp),Xe("OverscaledTileID",qr,{omit:["posMatrix"]});class xy{constructor(e,i,a){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return void ze(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const d=this.dim=i.height-2;this.data=new Uint32Array(i.data.buffer),this.encoding=a||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let y=0;y<d;y++){const x=this.get(m,y);x>this.max&&(this.max=x),x<this.min&&(this.min=x)}}get(e,i){const a=new Uint8Array(this.data.buffer),d=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(a[d],a[d+1],a[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,a){return(256*e*256+256*i+a)/10-1e4}_unpackTerrarium(e,i,a){return 256*e+i+a/256-32768}getPixels(){return new Gr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=i*this.dim,m=i*this.dim+this.dim,y=a*this.dim,x=a*this.dim+this.dim;switch(i){case-1:d=m-1;break;case 1:m=d+1}switch(a){case-1:y=x-1;break;case 1:x=y+1}const b=-i*this.dim,T=-a*this.dim;for(let z=y;z<x;z++)for(let P=d;P<m;P++)this.data[this._idx(P,z)]=e.data[this._idx(P+b,z+T)]}}Xe("DEMData",xy);class wy{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class by{constructor(e,i,a,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=a,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(e[i]=this[i]);return e}}class Sy{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new qs(wn,16,0),this.grid3D=new qs(wn,16,0),this.featureIndexArray=new _t,this.promoteId=i}insert(e,i,a,d,m,y){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,d,m);const b=y?this.grid3D:this.grid;for(let T=0;T<i.length;T++){const z=i[T],P=[1/0,1/0,-1/0,-1/0];for(let L=0;L<z.length;L++){const B=z[L];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<wn&&P[1]<wn&&P[2]>=0&&P[3]>=0&&b.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Yo.VectorTile(new vp(this.rawTileData)).layers,this.sourceLayerCoder=new wy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,i,a,d){this.loadVTLayers();const m=e.params||{},y=wn/e.tileSize/e.scale,x=Aa(m.filter),b=e.queryGeometry,T=e.queryPadding*y,z=Ty(b),P=this.grid.query(z.minX-T,z.minY-T,z.maxX+T,z.maxY+T),L=Ty(e.cameraQueryGeometry),B=this.grid3D.query(L.minX-T,L.minY-T,L.maxX+T,L.maxY+T,(X,ue,fe,le)=>function(de,Se,be,Ze,Ye){for(const Be of de)if(Se<=Be.x&&be<=Be.y&&Ze>=Be.x&&Ye>=Be.y)return!0;const Ve=[new at(Se,be),new at(Se,Ye),new at(Ze,Ye),new at(Ze,be)];if(de.length>2){for(const Be of Ve)if(Oa(de,Be))return!0}for(let Be=0;Be<de.length-1;Be++)if(v0(de[Be],de[Be+1],Ve))return!0;return!1}(e.cameraQueryGeometry,X-T,ue-T,fe+T,le+T));for(const X of B)P.push(X);P.sort(Z1);const F={};let K;for(let X=0;X<P.length;X++){const ue=P[X];if(ue===K)continue;K=ue;const fe=this.featureIndexArray.get(ue);let le=null;this.loadMatchingFeature(F,fe.bucketIndex,fe.sourceLayerIndex,fe.featureIndex,x,m.layers,m.availableImages,i,a,d,(de,Se,be)=>(le||(le=Ks(de)),Se.queryIntersectsFeature(b,de,be,le,this.z,e.transform,y,e.pixelPosMatrix)))}return F}loadMatchingFeature(e,i,a,d,m,y,x,b,T,z,P){const L=this.bucketLayerIDs[i];if(y&&!function(X,ue){for(let fe=0;fe<X.length;fe++)if(ue.indexOf(X[fe])>=0)return!0;return!1}(y,L))return;const B=this.sourceLayerCoder.decode(a),F=this.vtLayers[B].feature(d);if(m.needGeometry){const X=Ys(F,!0);if(!m.filter(new Qt(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!m.filter(new Qt(this.tileID.overscaledZ),F))return;const K=this.getId(F,B);for(let X=0;X<L.length;X++){const ue=L[X];if(y&&y.indexOf(ue)<0)continue;const fe=b[ue];if(!fe)continue;let le={};K&&z&&(le=z.getState(fe.sourceLayer||"_geojsonTileLayer",K));const de=Te({},T[ue]);de.paint=Ey(de.paint,fe.paint,F,le,x),de.layout=Ey(de.layout,fe.layout,F,le,x);const Se=!P||P(F,fe,le);if(!Se)continue;const be=new by(F,this.z,this.x,this.y,K);be.layer=de;let Ze=e[ue];Ze===void 0&&(Ze=e[ue]=[]),Ze.push({featureIndex:d,feature:be,intersectionZ:Se})}}lookupSymbolFeatures(e,i,a,d,m,y,x,b){const T={};this.loadVTLayers();const z=Aa(m);for(const P of e)this.loadMatchingFeature(T,a,d,P,z,y,x,b,i);return T}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof a=="boolean"&&(a=Number(a))),a}}function Ey(r,e,i,a,d){return ee(r,(m,y)=>{const x=e instanceof Ws?e.get(y):null;return x&&x.evaluate?x.evaluate(i,a,d):x})}function Ty(r){let e=1/0,i=1/0,a=-1/0,d=-1/0;for(const m of r)e=Math.min(e,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),d=Math.max(d,m.y);return{minX:e,minY:i,maxX:a,maxY:d}}function Z1(r,e){return e-r}var Dp;Xe("FeatureIndex",Sy,{omit:["rawTileData","sourceLayerCoder"]}),l.PerformanceMarkers=void 0,(Dp=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Dp.load="load",Dp.fullLoad="fullLoad";let gh=null,mu=[];const Lp=1e3/30,H1={mark(r){performance.mark(r)},frame(r){const e=r;gh!=null&&mu.push(e-gh),gh=e},clearMetrics(){gh=null,mu=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const r in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure("fullLoadTime",l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,i=mu.length,a=1/(mu.reduce((m,y)=>m+y,0)/i/1e3),d=mu.filter(m=>m>Lp).reduce((m,y)=>m+(y-Lp)/Lp,0);return{loadTime:r,fullLoadTime:e,fps:a,percentDroppedFrames:d/(i+d)*100}}};l.AJAXError=pr,l.ARRAY_TYPE=or,l.Actor=class{constructor(r,e,i){this.target=r,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},bt(["receive","process"],this),this.invoker=new q1(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Fe()?r:window}send(r,e,i,a,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[m]=i);const y=Ir(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:r,hasCallback:!!i,targetMapId:a,mustQueue:d,sourceMapId:this.mapId,data:lo(e,y)},y),{cancel:()=>{i&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(r){const e=r.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[i];const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a()}else Fe()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)}process(){if(!this.taskQueue.length)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){if(e.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(e.error?i($i(e.error)):i(null,$i(e.data)))}else{let i=!1;const a=Ir(this.globalScope)?void 0:[],d=e.hasCallback?(x,b)=>{i=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:x?lo(x):null,data:lo(b,a)},a)}:x=>{i=!0};let m=null;const y=$i(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,y,d);else if(this.parent.getWorkerSource){const x=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,x[0],y.source)[x[1]](y,d)}else d(new Error(`Could not find function ${e.type}`));!i&&m&&m.cancel&&(this.cancelCallbacks[r]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=ou,l.CanonicalTileID=Mp,l.CollisionBoxArray=_e,l.CollisionCircleLayoutArray=class extends A{},l.Color=U,l.DEMData=xy,l.DataConstantProperty=Qe,l.DictionaryCoder=wy,l.EXTENT=wn,l.ErrorEvent=Do,l.EvaluationParameters=Qt,l.Event=_i,l.Evented=vi,l.FeatureIndex=Sy,l.FillBucket=mp,l.FillExtrusionBucket=yp,l.GeoJSONFeature=by,l.ImageAtlas=Hg,l.ImagePosition=wp,l.LineBucket=_p,l.LineStripIndexArray=class extends W{},l.LngLat=un,l.LngLatBounds=Qs,l.MercatorCoordinate=mh,l.ONE_EM=Rn,l.OverscaledTileID=qr,l.PerformanceUtils=H1,l.PosArray=nt,l.Properties=Ln,l.QuadTriangleArray=class extends R{},l.RGBAImage=Gr,l.RasterBoundsArray=class extends h{},l.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},l.ResourceType=gi,l.SegmentVector=xt,l.SymbolBucket=qa,l.Transitionable=qc,l.TriangleIndexArray=rr,l.Uniform1f=po,l.Uniform1i=class extends ho{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},l.Uniform2f=class extends ho{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},l.Uniform3f=class extends ho{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},l.Uniform4f=Ba,l.UniformColor=ug,l.UniformMatrix4f=class extends ho{constructor(r,e){super(r,e),this.current=f0}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},l.UnwrappedTileID=vy,l.ValidationError=Oe,l.ZoomHistory=Gl,l.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r},l.addDynamicAttributes=kp,l.asyncAll=function(r,e,i){if(!r.length)return i(null,[]);let a=r.length;const d=new Array(r.length);let m=null;r.forEach((y,x)=>{e(y,(b,T)=>{b&&(m=b),d[x]=T,--a==0&&i(m,d)})})},l.bezier=ae,l.bindAll=bt,l.cacheEntryPossiblyAdded=function(r){er++,er>Ur&&(r.getActor().send("enforceCacheSizeLimit",Xt),er=0)},l.clamp=q,l.clearTileCache=function(r){const e=caches.delete(lt);r&&e.catch(r).then(()=>r())},l.clipLine=oy,l.clone=function(r){var e=new or(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},l.clone$1=re,l.clone$2=function(r){var e=new or(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},l.collisionCircleLayout=h1,l.config=We,l.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},l.create=function(){var r=new or(16);return or!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},l.create$1=yg,l.createExpression=Ls,l.createFilter=Aa,l.createLayout=gn,l.createStyleLayer=function(r){return r.type==="custom"?new j1(r):new G1[r.type](r)},l.cross=function(r,e,i){var a=e[0],d=e[1],m=e[2],y=i[0],x=i[1],b=i[2];return r[0]=d*b-m*x,r[1]=m*y-a*b,r[2]=a*x-d*y,r},l.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},l.dot$1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},l.ease=ne,l.emitValidationErrors=Ma,l.enforceCacheSizeLimit=function(r){Qn(),ct&&ct.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-r;a++)e.delete(i[a])})})},l.equals=function(r,e){var i=r[0],a=r[1],d=r[2],m=r[3],y=r[4],x=r[5],b=r[6],T=r[7],z=r[8],P=r[9],L=r[10],B=r[11],F=r[12],K=r[13],X=r[14],ue=r[15],fe=e[0],le=e[1],de=e[2],Se=e[3],be=e[4],Ze=e[5],Ye=e[6],Ve=e[7],Be=e[8],Me=e[9],$e=e[10],Ne=e[11],Ce=e[12],rt=e[13],et=e[14],vt=e[15];return Math.abs(i-fe)<=ir*Math.max(1,Math.abs(i),Math.abs(fe))&&Math.abs(a-le)<=ir*Math.max(1,Math.abs(a),Math.abs(le))&&Math.abs(d-de)<=ir*Math.max(1,Math.abs(d),Math.abs(de))&&Math.abs(m-Se)<=ir*Math.max(1,Math.abs(m),Math.abs(Se))&&Math.abs(y-be)<=ir*Math.max(1,Math.abs(y),Math.abs(be))&&Math.abs(x-Ze)<=ir*Math.max(1,Math.abs(x),Math.abs(Ze))&&Math.abs(b-Ye)<=ir*Math.max(1,Math.abs(b),Math.abs(Ye))&&Math.abs(T-Ve)<=ir*Math.max(1,Math.abs(T),Math.abs(Ve))&&Math.abs(z-Be)<=ir*Math.max(1,Math.abs(z),Math.abs(Be))&&Math.abs(P-Me)<=ir*Math.max(1,Math.abs(P),Math.abs(Me))&&Math.abs(L-$e)<=ir*Math.max(1,Math.abs(L),Math.abs($e))&&Math.abs(B-Ne)<=ir*Math.max(1,Math.abs(B),Math.abs(Ne))&&Math.abs(F-Ce)<=ir*Math.max(1,Math.abs(F),Math.abs(Ce))&&Math.abs(K-rt)<=ir*Math.max(1,Math.abs(K),Math.abs(rt))&&Math.abs(X-et)<=ir*Math.max(1,Math.abs(X),Math.abs(et))&&Math.abs(ue-vt)<=ir*Math.max(1,Math.abs(ue),Math.abs(vt))},l.evaluateSizeForFeature=function(r,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:d}){return r.kind==="source"?a/go:r.kind==="composite"?Yt(a/go,d/go,i):e},l.evaluateSizeForZoom=function(r,e){let i=0,a=0;if(r.kind==="constant")a=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:y}=r,x=d?q(gr.interpolationFactor(d,e,m,y),0,1):0;r.kind==="camera"?a=Yt(r.minSize,r.maxSize,x):i=x}return{uSizeT:i,uSize:a}},l.evaluateVariableOffset=ly,l.evented=Yl,l.exported=ei,l.exported$1=On,l.extend=Te,l.filterObject=H,l.fromRotation=function(r,e){var i=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=i,r[2]=0,r[3]=-i,r[4]=a,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},l.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},l.getAnchorAlignment=Sp,l.getAnchorJustification=Tp,l.getArrayBuffer=Mo,l.getImage=Oi,l.getJSON=function(r,e){return Po(Te(r,{type:"json"}),e)},l.getOverlapMode=Ap,l.getRTLTextPluginStatus=Zs,l.getReferrer=Ss,l.getVideo=function(r,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<r.length;a++){const d=window.document.createElement("source");Es(r[a])||(i.crossOrigin="Anonymous"),d.src=r[a],i.appendChild(d)}return{cancel:()=>{}}},l.identity=sp,l.invert=function(r,e){var i=e[0],a=e[1],d=e[2],m=e[3],y=e[4],x=e[5],b=e[6],T=e[7],z=e[8],P=e[9],L=e[10],B=e[11],F=e[12],K=e[13],X=e[14],ue=e[15],fe=i*x-a*y,le=i*b-d*y,de=i*T-m*y,Se=a*b-d*x,be=a*T-m*x,Ze=d*T-m*b,Ye=z*K-P*F,Ve=z*X-L*F,Be=z*ue-B*F,Me=P*X-L*K,$e=P*ue-B*K,Ne=L*ue-B*X,Ce=fe*Ne-le*$e+de*Me+Se*Be-be*Ve+Ze*Ye;return Ce?(r[0]=(x*Ne-b*$e+T*Me)*(Ce=1/Ce),r[1]=(d*$e-a*Ne-m*Me)*Ce,r[2]=(K*Ze-X*be+ue*Se)*Ce,r[3]=(L*be-P*Ze-B*Se)*Ce,r[4]=(b*Be-y*Ne-T*Ve)*Ce,r[5]=(i*Ne-d*Be+m*Ve)*Ce,r[6]=(X*de-F*Ze-ue*le)*Ce,r[7]=(z*Ze-L*de+B*le)*Ce,r[8]=(y*$e-x*Be+T*Ye)*Ce,r[9]=(a*Be-i*$e-m*Ye)*Ce,r[10]=(F*be-K*de+ue*fe)*Ce,r[11]=(P*de-z*be-B*fe)*Ce,r[12]=(x*Ve-y*Me-b*Ye)*Ce,r[13]=(i*Me-a*Ve+d*Ye)*Ce,r[14]=(K*le-F*Se-X*fe)*Ce,r[15]=(z*Se-P*le+L*fe)*Ce,r):null},l.isImageBitmap=Nr,l.isSafari=Ir,l.isWorker=Fe,l.keysDifference=function(r,e){const i=[];for(const a in r)a in e||i.push(a);return i},l.lazyLoadRTLTextPlugin=function(){Ar.isLoading()||Ar.isLoaded()||Zs()!=="deferred"||Gc()},l.makeRequest=Po,l.mapObject=ee,l.mercatorXfromLng=my,l.mercatorYfromLat=gy,l.mercatorZfromAltitude=yy,l.mul=b0,l.mul$1=function(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r[3]=e[3]*i[3],r},l.multiply=_g,l.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},l.normalize=function(r,e){var i=e[0],a=e[1],d=e[2],m=i*i+a*a+d*d;return m>0&&(m=1/Math.sqrt(m)),r[0]=e[0]*m,r[1]=e[1]*m,r[2]=e[2]*m,r},l.number=Yt,l.ortho=function(r,e,i,a,d,m,y){var x=1/(e-i),b=1/(a-d),T=1/(m-y);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*T,r[11]=0,r[12]=(e+i)*x,r[13]=(d+a)*b,r[14]=(y+m)*T,r[15]=1,r},l.parseCacheControl=Mt,l.parseGlyphPbf=function(r){return new vp(r).readFields(b1,[])},l.pbf=vp,l.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=wn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0].layout,i=r.bucket.layers[0]._unevaluatedLayout._values,a={layoutIconSize:i["icon-size"].possiblyEvaluate(new Qt(r.bucket.zoom+1),r.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new Qt(r.bucket.zoom+1),r.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new Qt(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=r.bucket.textSizeData;a.compositeTextSizes=[i["text-size"].possiblyEvaluate(new Qt(b),r.canonical),i["text-size"].possiblyEvaluate(new Qt(T),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=r.bucket.iconSizeData;a.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new Qt(b),r.canonical),i["icon-size"].possiblyEvaluate(new Qt(T),r.canonical)]}const d=e.get("text-line-height")*Rn,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",y=e.get("text-keep-upright"),x=e.get("text-size");for(const b of r.bucket.features){const T=e.get("text-font").evaluate(b,{},r.canonical).join(","),z=x.evaluate(b,{},r.canonical),P=a.layoutTextSize.evaluate(b,{},r.canonical),L=a.layoutIconSize.evaluate(b,{},r.canonical),B={horizontal:{},vertical:void 0},F=b.text;let K,X=[0,0];if(F){const le=F.toString(),de=e.get("text-letter-spacing").evaluate(b,{},r.canonical)*Rn,Se=Jd(le)?de:0,be=e.get("text-anchor").evaluate(b,{},r.canonical),Ze=e.get("text-variable-anchor");if(!Ze){const $e=e.get("text-radial-offset").evaluate(b,{},r.canonical);X=$e?ly(be,[$e*Rn,Ep]):e.get("text-offset").evaluate(b,{},r.canonical).map(Ne=>Ne*Rn)}let Ye=m?"center":e.get("text-justify").evaluate(b,{},r.canonical);const Ve=e.get("symbol-placement"),Be=Ve==="point"?e.get("text-max-width").evaluate(b,{},r.canonical)*Rn:0,Me=()=>{r.bucket.allowVerticalPlacement&&Da(le)&&(B.vertical=ah(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Be,d,be,"left",Se,X,l.WritingMode.vertical,!0,Ve,P,z))};if(!m&&Ze){const $e=Ye==="auto"?Ze.map(Ce=>Tp(Ce)):[Ye];let Ne=!1;for(let Ce=0;Ce<$e.length;Ce++){const rt=$e[Ce];if(!B.horizontal[rt])if(Ne)B.horizontal[rt]=B.horizontal[0];else{const et=ah(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Be,d,"center",rt,Se,X,l.WritingMode.horizontal,!1,Ve,P,z);et&&(B.horizontal[rt]=et,Ne=et.positionedLines.length===1)}}Me()}else{Ye==="auto"&&(Ye=Tp(be));const $e=ah(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Be,d,be,Ye,Se,X,l.WritingMode.horizontal,!1,Ve,P,z);$e&&(B.horizontal[Ye]=$e),Me(),Da(le)&&m&&y&&(B.vertical=ah(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Be,d,be,Ye,Se,X,l.WritingMode.vertical,!1,Ve,P,z))}}let ue=!1;if(b.icon&&b.icon.name){const le=r.imageMap[b.icon.name];le&&(K=I1(r.imagePositions[b.icon.name],e.get("icon-offset").evaluate(b,{},r.canonical),e.get("icon-anchor").evaluate(b,{},r.canonical)),ue=!!le.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ue:r.bucket.sdfIcons!==ue&&ze("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(le.pixelRatio!==r.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const fe=cy(B.horizontal)||B.vertical;r.bucket.iconsInText=!!fe&&fe.iconsInText,(fe||K)&&R1(r.bucket,b,B,K,r.imageMap,a,P,L,X,ue,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},l.perspective=function(r,e,i,a,d){var m,y=1/Math.tan(e/2);return r[0]=y/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+a)*(m=1/(a-d)),r[14]=2*d*a*m):(r[10]=-1,r[14]=-2*a),r},l.pick=function(r,e){const i={};for(let a=0;a<e.length;a++){const d=e[a];d in r&&(i[d]=r[d])}return i},l.plugin=Ar,l.pointGeometry=at,l.polygonIntersectsPolygon=pg,l.potpack=Zg,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Xe,l.registerForPluginStateChange=function(r){return r({pluginStatus:nr,pluginURL:ji}),Yl.on("pluginStateChange",r),r},l.renderColorRamp=Tg,l.rotateX=function(r,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[4],y=e[5],x=e[6],b=e[7],T=e[8],z=e[9],P=e[10],L=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=m*d+T*a,r[5]=y*d+z*a,r[6]=x*d+P*a,r[7]=b*d+L*a,r[8]=T*d-m*a,r[9]=z*d-y*a,r[10]=P*d-x*a,r[11]=L*d-b*a,r},l.rotateZ=function(r,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[0],y=e[1],x=e[2],b=e[3],T=e[4],z=e[5],P=e[6],L=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=m*d+T*a,r[1]=y*d+z*a,r[2]=x*d+P*a,r[3]=b*d+L*a,r[4]=T*d-m*a,r[5]=z*d-y*a,r[6]=P*d-x*a,r[7]=L*d-b*a,r},l.scale=function(r,e,i){var a=i[0],d=i[1],m=i[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*d,r[5]=e[5]*d,r[6]=e[6]*d,r[7]=e[7]*d,r[8]=e[8]*m,r[9]=e[9]*m,r[10]=e[10]*m,r[11]=e[11]*m,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},l.scale$1=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r},l.setCacheLimits=function(r,e){Xt=r,Ur=e},l.setRTLTextPlugin=function(r,e,i=!1){if(nr===Hl||nr===Wl||nr===Xl)throw new Error("setRTLTextPlugin cannot be called multiple times.");ji=ei.resolveURL(r),nr=Hl,Kl=e,Ho(),i||Gc()},l.spec=xe,l.sphericalToCartesian=function([r,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(i),y:r*Math.sin(e)*Math.sin(i),z:r*Math.cos(i)}},l.sqrLen=function(r){var e=r[0],i=r[1];return e*e+i*i},l.sub=function(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r},l.toEvaluationFeature=Ys,l.transformMat3=function(r,e,i){var a=e[0],d=e[1],m=e[2];return r[0]=a*i[0]+d*i[3]+m*i[6],r[1]=a*i[1]+d*i[4]+m*i[7],r[2]=a*i[2]+d*i[5]+m*i[8],r},l.transformMat4=Qc,l.transformMat4$1=function(r,e,i){var a=e[0],d=e[1];return r[0]=i[0]*a+i[4]*d+i[12],r[1]=i[1]*a+i[5]*d+i[13],r},l.translate=function(r,e,i){var a,d,m,y,x,b,T,z,P,L,B,F,K=i[0],X=i[1],ue=i[2];return e===r?(r[12]=e[0]*K+e[4]*X+e[8]*ue+e[12],r[13]=e[1]*K+e[5]*X+e[9]*ue+e[13],r[14]=e[2]*K+e[6]*X+e[10]*ue+e[14],r[15]=e[3]*K+e[7]*X+e[11]*ue+e[15]):(d=e[1],m=e[2],y=e[3],x=e[4],b=e[5],T=e[6],z=e[7],P=e[8],L=e[9],B=e[10],F=e[11],r[0]=a=e[0],r[1]=d,r[2]=m,r[3]=y,r[4]=x,r[5]=b,r[6]=T,r[7]=z,r[8]=P,r[9]=L,r[10]=B,r[11]=F,r[12]=a*K+x*X+P*ue+e[12],r[13]=d*K+b*X+L*ue+e[13],r[14]=m*K+T*X+B*ue+e[14],r[15]=y*K+z*X+F*ue+e[15]),r},l.triggerPluginCompletionEvent=jc,l.unicodeBlockLookup=Ue,l.uniqueId=function(){return Ie++},l.validateCustomStyleLayer=function(r){const e=[],i=r.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateLight=jl,l.validateStyle=Gs,l.vectorTile=Yo,l.warnOnce=ze,l.wrap=Ae}),w(["./shared"],function(l){function N(V){const C=typeof V;if(C==="number"||C==="boolean"||C==="string"||V==null)return JSON.stringify(V);if(Array.isArray(V)){let U="[";for(const Y of V)U+=`${N(Y)},`;return`${U}]`}const M=Object.keys(V).sort();let O="{";for(let U=0;U<M.length;U++)O+=`${JSON.stringify(M[U])}:${N(V[M[U]])},`;return`${O}}`}function j(V){let C="";for(const M of l.refProperties)C+=`/${N(V[M])}`;return C}class ae{constructor(C){this.keyCache={},C&&this.replace(C)}replace(C){this._layerConfigs={},this._layers={},this.update(C,[])}update(C,M){for(const U of C){this._layerConfigs[U.id]=U;const Y=this._layers[U.id]=l.createStyleLayer(U);Y._featureFilter=l.createFilter(Y.filter),this.keyCache[U.id]&&delete this.keyCache[U.id]}for(const U of M)delete this.keyCache[U],delete this._layerConfigs[U],delete this._layers[U];this.familiesBySource={};const O=function(U,Y){const ie={};for(let J=0;J<U.length;J++){const oe=Y&&Y[U[J].id]||j(U[J]);Y&&(Y[U[J].id]=oe);let ge=ie[oe];ge||(ge=ie[oe]=[]),ge.push(U[J])}const Q=[];for(const J in ie)Q.push(ie[J]);return Q}(Object.values(this._layerConfigs),this.keyCache);for(const U of O){const Y=U.map(Ee=>this._layers[Ee.id]),ie=Y[0];if(ie.visibility==="none")continue;const Q=ie.source||"";let J=this.familiesBySource[Q];J||(J=this.familiesBySource[Q]={});const oe=ie.sourceLayer||"_geojsonTileLayer";let ge=J[oe];ge||(ge=J[oe]=[]),ge.push(Y)}}}class ne{constructor(C){const M={},O=[];for(const Q in C){const J=C[Q],oe=M[Q]={};for(const ge in J){const Ee=J[+ge];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const me={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};O.push(me),oe[ge]={rect:me,metrics:Ee.metrics}}}const{w:U,h:Y}=l.potpack(O),ie=new l.AlphaImage({width:U||1,height:Y||1});for(const Q in C){const J=C[Q];for(const oe in J){const ge=J[+oe];if(!ge||ge.bitmap.width===0||ge.bitmap.height===0)continue;const Ee=M[Q][oe].rect;l.AlphaImage.copy(ge.bitmap,ie,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},ge.bitmap)}}this.image=ie,this.positions=M}}l.register("GlyphAtlas",ne);class q{constructor(C){this.tileID=new l.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId}parse(C,M,O,U,Y){this.status="parsing",this.data=C,this.collisionBoxArray=new l.CollisionBoxArray;const ie=new l.DictionaryCoder(Object.keys(C.layers).sort()),Q=new l.FeatureIndex(this.tileID,this.promoteId);Q.bucketLayerIDs=[];const J={},oe={featureIndex:Q,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:O},ge=M.familiesBySource[this.source];for(const ht in ge){const yt=C.layers[ht];if(!yt)continue;yt.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${ht}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const zt=ie.encode(ht),$t=[];for(let Tn=0;Tn<yt.length;Tn++){const Kt=yt.feature(Tn),Nn=Q.getId(Kt,ht);$t.push({feature:Kt,id:Nn,index:Tn,sourceLayerIndex:zt})}for(const Tn of ge[ht]){const Kt=Tn[0];Kt.source!==this.source&&l.warnOnce(`layer.source = ${Kt.source} does not equal this.source = ${this.source}`),Kt.minzoom&&this.zoom<Math.floor(Kt.minzoom)||Kt.maxzoom&&this.zoom>=Kt.maxzoom||Kt.visibility!=="none"&&(Ae(Tn,this.zoom,O),(J[Kt.id]=Kt.createBucket({index:Q.bucketLayerIDs.length,layers:Tn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:zt,sourceID:this.source})).populate($t,oe,this.tileID.canonical),Q.bucketLayerIDs.push(Tn.map(Nn=>Nn.id)))}}let Ee,me,Ke,Je;const je=l.mapObject(oe.glyphDependencies,ht=>Object.keys(ht).map(Number));Object.keys(je).length?U.send("getGlyphs",{uid:this.uid,stacks:je},(ht,yt)=>{Ee||(Ee=ht,me=yt,It.call(this))}):me={};const it=Object.keys(oe.iconDependencies);it.length?U.send("getImages",{icons:it,source:this.source,tileID:this.tileID,type:"icons"},(ht,yt)=>{Ee||(Ee=ht,Ke=yt,It.call(this))}):Ke={};const ut=Object.keys(oe.patternDependencies);function It(){if(Ee)return Y(Ee);if(me&&Ke&&Je){const ht=new ne(me),yt=new l.ImageAtlas(Ke,Je);for(const zt in J){const $t=J[zt];$t instanceof l.SymbolBucket?(Ae($t.layers,this.zoom,O),l.performSymbolLayout({bucket:$t,glyphMap:me,glyphPositions:ht.positions,imageMap:Ke,imagePositions:yt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):$t.hasPattern&&($t instanceof l.LineBucket||$t instanceof l.FillBucket||$t instanceof l.FillExtrusionBucket)&&(Ae($t.layers,this.zoom,O),$t.addFeatures(oe,this.tileID.canonical,yt.patternPositions))}this.status="done",Y(null,{buckets:Object.values(J).filter(zt=>!zt.isEmpty()),featureIndex:Q,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ht.image,imageAtlas:yt,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Ke:null,glyphPositions:this.returnDependencies?ht.positions:null})}}ut.length?U.send("getImages",{icons:ut,source:this.source,tileID:this.tileID,type:"patterns"},(ht,yt)=>{Ee||(Ee=ht,Je=yt,It.call(this))}):Je={},It.call(this)}}function Ae(V,C,M){const O=new l.EvaluationParameters(C);for(const U of V)U.recalculate(O,M)}function Te(V,C){const M=l.getArrayBuffer(V.request,(O,U,Y,ie)=>{O?C(O):U&&C(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(U)),rawData:U,cacheControl:Y,expires:ie})});return()=>{M.cancel(),C()}}class Ie{constructor(C,M,O,U){this.actor=C,this.layerIndex=M,this.availableImages=O,this.loadVectorData=U||Te,this.loading={},this.loaded={}}loadTile(C,M){const O=C.uid;this.loading||(this.loading={});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new l.RequestPerformance(C.request),Y=this.loading[O]=new q(C);Y.abort=this.loadVectorData(C,(ie,Q)=>{if(delete this.loading[O],ie||!Q)return Y.status="done",this.loaded[O]=Y,M(ie);const J=Q.rawData,oe={};Q.expires&&(oe.expires=Q.expires),Q.cacheControl&&(oe.cacheControl=Q.cacheControl);const ge={};if(U){const Ee=U.finish();Ee&&(ge.resourceTiming=JSON.parse(JSON.stringify(Ee)))}Y.vectorTile=Q.vectorTile,Y.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ee,me)=>{if(Ee||!me)return M(Ee);M(null,l.extend({rawTileData:J.slice(0)},me,oe,ge))}),this.loaded=this.loaded||{},this.loaded[O]=Y})}reloadTile(C,M){const O=this.loaded,U=C.uid,Y=this;if(O&&O[U]){const ie=O[U];ie.showCollisionBoxes=C.showCollisionBoxes;const Q=(J,oe)=>{const ge=ie.reloadCallback;ge&&(delete ie.reloadCallback,ie.parse(ie.vectorTile,Y.layerIndex,this.availableImages,Y.actor,ge)),M(J,oe)};ie.status==="parsing"?ie.reloadCallback=Q:ie.status==="done"&&(ie.vectorTile?ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Q):Q())}}abortTile(C,M){const O=this.loading,U=C.uid;O&&O[U]&&O[U].abort&&(O[U].abort(),delete O[U]),M()}removeTile(C,M){const O=this.loaded,U=C.uid;O&&O[U]&&delete O[U],M()}}class bt{constructor(){this.loaded={}}loadTile(C,M){const{uid:O,encoding:U,rawImageData:Y}=C,ie=l.isImageBitmap(Y)?this.getImageData(Y):Y,Q=new l.DEMData(O,ie,U);this.loaded=this.loaded||{},this.loaded[O]=Q,M(null,Q)}getImageData(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);const M=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:M.width,height:M.height},M.data)}removeTile(C){const M=this.loaded,O=C.uid;M&&M[O]&&delete M[O]}}var ee=function V(C,M){var O,U=C&&C.type;if(U==="FeatureCollection")for(O=0;O<C.features.length;O++)V(C.features[O],M);else if(U==="GeometryCollection")for(O=0;O<C.geometries.length;O++)V(C.geometries[O],M);else if(U==="Feature")V(C.geometry,M);else if(U==="Polygon")H(C.coordinates,M);else if(U==="MultiPolygon")for(O=0;O<C.coordinates.length;O++)H(C.coordinates[O],M);return C};function H(V,C){if(V.length!==0){re(V[0],C);for(var M=1;M<V.length;M++)re(V[M],!C)}}function re(V,C){for(var M=0,O=0,U=0,Y=V.length,ie=Y-1;U<Y;ie=U++){var Q=(V[U][0]-V[ie][0])*(V[ie][1]+V[U][1]),J=M+Q;O+=Math.abs(M)>=Math.abs(Q)?M-J+Q:Q-J+M,M=J}M+O>=0!=!!C&&V.reverse()}const we=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ze{constructor(C){this._feature=C,this.extent=l.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))}loadGeometry(){if(this._feature.type===1){const C=[];for(const M of this._feature.geometry)C.push([new l.pointGeometry(M[0],M[1])]);return C}{const C=[];for(const M of this._feature.geometry){const O=[];for(const U of M)O.push(new l.pointGeometry(U[0],U[1]));C.push(O)}return C}}toGeoJSON(C,M,O){return we.call(this,C,M,O)}}class He{constructor(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=C.length,this._features=C}feature(C){return new ze(this._features[C])}}var De={exports:{}},Fe=l.pointGeometry,Mt=l.vectorTile.VectorTileFeature,st=nn;function nn(V,C){this.options=C||{},this.features=V,this.length=V.length}function Mn(V,C){this.id=typeof V.id=="number"?V.id:void 0,this.type=V.type,this.rawGeometry=V.type===1?[V.geometry]:V.geometry,this.properties=V.tags,this.extent=C||4096}nn.prototype.feature=function(V){return new Mn(this.features[V],this.options.extent)},Mn.prototype.loadGeometry=function(){var V=this.rawGeometry;this.geometry=[];for(var C=0;C<V.length;C++){for(var M=V[C],O=[],U=0;U<M.length;U++)O.push(new Fe(M[U][0],M[U][1]));this.geometry.push(O)}return this.geometry},Mn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var V=this.geometry,C=1/0,M=-1/0,O=1/0,U=-1/0,Y=0;Y<V.length;Y++)for(var ie=V[Y],Q=0;Q<ie.length;Q++){var J=ie[Q];C=Math.min(C,J.x),M=Math.max(M,J.x),O=Math.min(O,J.y),U=Math.max(U,J.y)}return[C,O,M,U]},Mn.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var Ir=l.pbf,Nr=st;function ei(V){var C=new Ir;return function(M,O){for(var U in M.layers)O.writeMessage(3,at,M.layers[U])}(V,C),C.finish()}function at(V,C){var M;C.writeVarintField(15,V.version||1),C.writeStringField(1,V.name||""),C.writeVarintField(5,V.extent||4096);var O={keys:[],values:[],keycache:{},valuecache:{}};for(M=0;M<V.length;M++)O.feature=V.feature(M),C.writeMessage(2,hr,O);var U=O.keys;for(M=0;M<U.length;M++)C.writeStringField(3,U[M]);var Y=O.values;for(M=0;M<Y.length;M++)C.writeMessage(4,Xt,Y[M])}function hr(V,C){var M=V.feature;M.id!==void 0&&C.writeVarintField(1,M.id),C.writeMessage(2,We,V),C.writeVarintField(3,M.type),C.writeMessage(4,Vt,M)}function We(V,C){var M=V.feature,O=V.keys,U=V.values,Y=V.keycache,ie=V.valuecache;for(var Q in M.properties){var J=M.properties[Q],oe=Y[Q];if(J!==null){oe===void 0&&(O.push(Q),Y[Q]=oe=O.length-1),C.writeVarint(oe);var ge=typeof J;ge!=="string"&&ge!=="boolean"&&ge!=="number"&&(J=JSON.stringify(J));var Ee=ge+":"+J,me=ie[Ee];me===void 0&&(U.push(J),ie[Ee]=me=U.length-1),C.writeVarint(me)}}}function lt(V,C){return(C<<3)+(7&V)}function ct(V){return V<<1^V>>31}function Vt(V,C){for(var M=V.loadGeometry(),O=V.type,U=0,Y=0,ie=M.length,Q=0;Q<ie;Q++){var J=M[Q],oe=1;O===1&&(oe=J.length),C.writeVarint(lt(1,oe));for(var ge=O===3?J.length-1:J.length,Ee=0;Ee<ge;Ee++){Ee===1&&O!==1&&C.writeVarint(lt(2,ge-1));var me=J[Ee].x-U,Ke=J[Ee].y-Y;C.writeVarint(ct(me)),C.writeVarint(ct(Ke)),U+=me,Y+=Ke}O===3&&C.writeVarint(lt(7,1))}}function Xt(V,C){var M=typeof V;M==="string"?C.writeStringField(1,V):M==="boolean"?C.writeBooleanField(7,V):M==="number"&&(V%1!=0?C.writeDoubleField(3,V):V<0?C.writeSVarintField(6,V):C.writeVarintField(5,V))}function Ur(V,C,M,O,U,Y){if(U-O<=M)return;const ie=O+U>>1;Qn(V,C,ie,O,U,Y%2),Ur(V,C,M,O,ie-1,Y+1),Ur(V,C,M,ie+1,U,Y+1)}function Qn(V,C,M,O,U,Y){for(;U>O;){if(U-O>600){const oe=U-O+1,ge=M-O+1,Ee=Math.log(oe),me=.5*Math.exp(2*Ee/3),Ke=.5*Math.sqrt(Ee*me*(oe-me)/oe)*(ge-oe/2<0?-1:1);Qn(V,C,M,Math.max(O,Math.floor(M-ge*me/oe+Ke)),Math.min(U,Math.floor(M+(oe-ge)*me/oe+Ke)),Y)}const ie=C[2*M+Y];let Q=O,J=U;for(er(V,C,O,M),C[2*U+Y]>ie&&er(V,C,O,U);Q<J;){for(er(V,C,Q,J),Q++,J--;C[2*Q+Y]<ie;)Q++;for(;C[2*J+Y]>ie;)J--}C[2*O+Y]===ie?er(V,C,O,J):(J++,er(V,C,J,U)),J<=M&&(O=J+1),M<=J&&(U=J-1)}}function er(V,C,M,O){On(V,M,O),On(C,2*M,2*O),On(C,2*M+1,2*O+1)}function On(V,C,M){const O=V[C];V[C]=V[M],V[M]=O}function dr(V,C,M,O){const U=V-M,Y=C-O;return U*U+Y*Y}De.exports=ei,De.exports.fromVectorTileJs=ei,De.exports.fromGeojsonVt=function(V,C){C=C||{};var M={};for(var O in V)M[O]=new Nr(V[O].features,C),M[O].name=O,M[O].version=C.version,M[O].extent=C.extent;return ei({layers:M})},De.exports.GeoJSONWrapper=Nr;const Ri=V=>V[0],tr=V=>V[1];class Ao{constructor(C,M=Ri,O=tr,U=64,Y=Float64Array){this.nodeSize=U,this.points=C;const ie=C.length<65536?Uint16Array:Uint32Array,Q=this.ids=new ie(C.length),J=this.coords=new Y(2*C.length);for(let oe=0;oe<C.length;oe++)Q[oe]=oe,J[2*oe]=M(C[oe]),J[2*oe+1]=O(C[oe]);Ur(Q,J,U,0,Q.length-1,0)}range(C,M,O,U){return function(Y,ie,Q,J,oe,ge,Ee){const me=[0,Y.length-1,0],Ke=[];let Je,je;for(;me.length;){const it=me.pop(),ut=me.pop(),It=me.pop();if(ut-It<=Ee){for(let zt=It;zt<=ut;zt++)Je=ie[2*zt],je=ie[2*zt+1],Je>=Q&&Je<=oe&&je>=J&&je<=ge&&Ke.push(Y[zt]);continue}const ht=Math.floor((It+ut)/2);Je=ie[2*ht],je=ie[2*ht+1],Je>=Q&&Je<=oe&&je>=J&&je<=ge&&Ke.push(Y[ht]);const yt=(it+1)%2;(it===0?Q<=Je:J<=je)&&(me.push(It),me.push(ht-1),me.push(yt)),(it===0?oe>=Je:ge>=je)&&(me.push(ht+1),me.push(ut),me.push(yt))}return Ke}(this.ids,this.coords,C,M,O,U,this.nodeSize)}within(C,M,O){return function(U,Y,ie,Q,J,oe){const ge=[0,U.length-1,0],Ee=[],me=J*J;for(;ge.length;){const Ke=ge.pop(),Je=ge.pop(),je=ge.pop();if(Je-je<=oe){for(let yt=je;yt<=Je;yt++)dr(Y[2*yt],Y[2*yt+1],ie,Q)<=me&&Ee.push(U[yt]);continue}const it=Math.floor((je+Je)/2),ut=Y[2*it],It=Y[2*it+1];dr(ut,It,ie,Q)<=me&&Ee.push(U[it]);const ht=(Ke+1)%2;(Ke===0?ie-J<=ut:Q-J<=It)&&(ge.push(je),ge.push(it-1),ge.push(ht)),(Ke===0?ie+J>=ut:Q+J>=It)&&(ge.push(it+1),ge.push(Je),ge.push(ht))}return Ee}(this.ids,this.coords,C,M,O,this.nodeSize)}}const bs={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:V=>V},gi=Math.fround||(pr=new Float32Array(1),V=>(pr[0]=+V,pr[0]));var pr;class Ss{constructor(C){this.options=Oi(Object.create(bs),C),this.trees=new Array(this.options.maxZoom+1)}load(C){const{log:M,minZoom:O,maxZoom:U,nodeSize:Y}=this.options;M&&console.time("total time");const ie=`prepare ${C.length} points`;M&&console.time(ie),this.points=C;let Q=[];for(let J=0;J<C.length;J++)C[J].geometry&&Q.push(Po(C[J],J));this.trees[U+1]=new Ao(Q,Ts,yi,Y,Float32Array),M&&console.timeEnd(ie);for(let J=U;J>=O;J--){const oe=+Date.now();Q=this._cluster(Q,J),this.trees[J]=new Ao(Q,Ts,yi,Y,Float32Array),M&&console.log("z%d: %d clusters in %dms",J,Q.length,+Date.now()-oe)}return M&&console.timeEnd("total time"),this}getClusters(C,M){let O=((C[0]+180)%360+360)%360-180;const U=Math.max(-90,Math.min(90,C[1]));let Y=C[2]===180?180:((C[2]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)O=-180,Y=180;else if(O>Y){const ge=this.getClusters([O,U,180,ie],M),Ee=this.getClusters([-180,U,Y,ie],M);return ge.concat(Ee)}const Q=this.trees[this._limitZoom(M)],J=Q.range(kt(O),ti(ie),kt(Y),ti(U)),oe=[];for(const ge of J){const Ee=Q.points[ge];oe.push(Ee.numPoints?Mo(Ee):this.points[Ee.index])}return oe}getChildren(C){const M=this._getOriginId(C),O=this._getOriginZoom(C),U="No cluster with the specified id.",Y=this.trees[O];if(!Y)throw new Error(U);const ie=Y.points[M];if(!ie)throw new Error(U);const Q=this.options.radius/(this.options.extent*Math.pow(2,O-1)),J=Y.within(ie.x,ie.y,Q),oe=[];for(const ge of J){const Ee=Y.points[ge];Ee.parentId===C&&oe.push(Ee.numPoints?Mo(Ee):this.points[Ee.index])}if(oe.length===0)throw new Error(U);return oe}getLeaves(C,M,O){const U=[];return this._appendLeaves(U,C,M=M||10,O=O||0,0),U}getTile(C,M,O){const U=this.trees[this._limitZoom(C)],Y=Math.pow(2,C),{extent:ie,radius:Q}=this.options,J=Q/ie,oe=(O-J)/Y,ge=(O+1+J)/Y,Ee={features:[]};return this._addTileFeatures(U.range((M-J)/Y,oe,(M+1+J)/Y,ge),U.points,M,O,Y,Ee),M===0&&this._addTileFeatures(U.range(1-J/Y,oe,1,ge),U.points,Y,O,Y,Ee),M===Y-1&&this._addTileFeatures(U.range(0,oe,J/Y,ge),U.points,-1,O,Y,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom(C){let M=this._getOriginZoom(C)-1;for(;M<=this.options.maxZoom;){const O=this.getChildren(C);if(M++,O.length!==1)break;C=O[0].properties.cluster_id}return M}_appendLeaves(C,M,O,U,Y){const ie=this.getChildren(M);for(const Q of ie){const J=Q.properties;if(J&&J.cluster?Y+J.point_count<=U?Y+=J.point_count:Y=this._appendLeaves(C,J.cluster_id,O,U,Y):Y<U?Y++:C.push(Q),C.length===O)break}return Y}_addTileFeatures(C,M,O,U,Y,ie){for(const Q of C){const J=M[Q],oe=J.numPoints;let ge,Ee,me;if(oe)ge=Es(J),Ee=J.x,me=J.y;else{const je=this.points[J.index];ge=je.properties,Ee=kt(je.geometry.coordinates[0]),me=ti(je.geometry.coordinates[1])}const Ke={type:1,geometry:[[Math.round(this.options.extent*(Ee*Y-O)),Math.round(this.options.extent*(me*Y-U))]],tags:ge};let Je;oe?Je=J.id:this.options.generateId?Je=J.index:this.points[J.index].id&&(Je=this.points[J.index].id),Je!==void 0&&(Ke.id=Je),ie.features.push(Ke)}}_limitZoom(C){return Math.max(this.options.minZoom,Math.min(Math.floor(+C),this.options.maxZoom+1))}_cluster(C,M){const O=[],{radius:U,extent:Y,reduce:ie,minPoints:Q}=this.options,J=U/(Y*Math.pow(2,M));for(let oe=0;oe<C.length;oe++){const ge=C[oe];if(ge.zoom<=M)continue;ge.zoom=M;const Ee=this.trees[M+1],me=Ee.within(ge.x,ge.y,J),Ke=ge.numPoints||1;let Je=Ke;for(const je of me){const it=Ee.points[je];it.zoom>M&&(Je+=it.numPoints||1)}if(Je>Ke&&Je>=Q){let je=ge.x*Ke,it=ge.y*Ke,ut=ie&&Ke>1?this._map(ge,!0):null;const It=(oe<<5)+(M+1)+this.points.length;for(const ht of me){const yt=Ee.points[ht];if(yt.zoom<=M)continue;yt.zoom=M;const zt=yt.numPoints||1;je+=yt.x*zt,it+=yt.y*zt,yt.parentId=It,ie&&(ut||(ut=this._map(ge,!0)),ie(ut,this._map(yt)))}ge.parentId=It,O.push(Bi(je/Je,it/Je,It,Je,ut))}else if(O.push(ge),Je>1)for(const je of me){const it=Ee.points[je];it.zoom<=M||(it.zoom=M,O.push(it))}}return O}_getOriginId(C){return C-this.points.length>>5}_getOriginZoom(C){return(C-this.points.length)%32}_map(C,M){if(C.numPoints)return M?Oi({},C.properties):C.properties;const O=this.points[C.index].properties,U=this.options.map(O);return M&&U===O?Oi({},U):U}}function Bi(V,C,M,O,U){return{x:gi(V),y:gi(C),zoom:1/0,id:M,parentId:-1,numPoints:O,properties:U}}function Po(V,C){const[M,O]=V.geometry.coordinates;return{x:gi(kt(M)),y:gi(ti(O)),zoom:1/0,index:C,parentId:-1}}function Mo(V){return{type:"Feature",id:V.id,properties:Es(V),geometry:{type:"Point",coordinates:[(C=V.x,360*(C-.5)),Fi(V.y)]}};var C}function Es(V){const C=V.numPoints,M=C>=1e4?`${Math.round(C/1e3)}k`:C>=1e3?Math.round(C/100)/10+"k":C;return Oi(Oi({},V.properties),{cluster:!0,cluster_id:V.id,point_count:C,point_count_abbreviated:M})}function kt(V){return V/360+.5}function ti(V){const C=Math.sin(V*Math.PI/180),M=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return M<0?0:M>1?1:M}function Fi(V){const C=(180-360*V)*Math.PI/180;return 360*Math.atan(Math.exp(C))/Math.PI-90}function Oi(V,C){for(const M in C)V[M]=C[M];return V}function Ts(V){return V.x}function yi(V){return V.y}function _i(V,C,M,O){for(var U,Y=O,ie=M-C>>1,Q=M-C,J=V[C],oe=V[C+1],ge=V[M],Ee=V[M+1],me=C+3;me<M;me+=3){var Ke=Do(V[me],V[me+1],J,oe,ge,Ee);if(Ke>Y)U=me,Y=Ke;else if(Ke===Y){var Je=Math.abs(me-ie);Je<Q&&(U=me,Q=Je)}}Y>O&&(U-C>3&&_i(V,C,U,O),V[U+2]=Y,M-U>3&&_i(V,U,M,O))}function Do(V,C,M,O,U,Y){var ie=U-M,Q=Y-O;if(ie!==0||Q!==0){var J=((V-M)*ie+(C-O)*Q)/(ie*ie+Q*Q);J>1?(M=U,O=Y):J>0&&(M+=ie*J,O+=Q*J)}return(ie=V-M)*ie+(Q=C-O)*Q}function vi(V,C,M,O){var U={id:V===void 0?null:V,type:C,geometry:M,tags:O,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Y){var ie=Y.geometry,Q=Y.type;if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")xe(Y,ie);else if(Q==="Polygon"||Q==="MultiLineString")for(var J=0;J<ie.length;J++)xe(Y,ie[J]);else if(Q==="MultiPolygon")for(J=0;J<ie.length;J++)for(var oe=0;oe<ie[J].length;oe++)xe(Y,ie[J][oe])}(U),U}function xe(V,C){for(var M=0;M<C.length;M+=3)V.minX=Math.min(V.minX,C[M]),V.minY=Math.min(V.minY,C[M+1]),V.maxX=Math.max(V.maxX,C[M]),V.maxY=Math.max(V.maxY,C[M+1])}function Oe(V,C,M,O){if(C.geometry){var U=C.geometry.coordinates,Y=C.geometry.type,ie=Math.pow(M.tolerance/((1<<M.maxZoom)*M.extent),2),Q=[],J=C.id;if(M.promoteId?J=C.properties[M.promoteId]:M.generateId&&(J=O||0),Y==="Point")to(U,Q);else if(Y==="MultiPoint")for(var oe=0;oe<U.length;oe++)to(U[oe],Q);else if(Y==="LineString")Vr(U,Q,ie,!1);else if(Y==="MultiLineString"){if(M.lineMetrics){for(oe=0;oe<U.length;oe++)Vr(U[oe],Q=[],ie,!1),V.push(vi(J,"LineString",Q,C.properties));return}Ct(U,Q,ie,!1)}else if(Y==="Polygon")Ct(U,Q,ie,!0);else{if(Y!=="MultiPolygon"){if(Y==="GeometryCollection"){for(oe=0;oe<C.geometry.geometries.length;oe++)Oe(V,{id:J,geometry:C.geometry.geometries[oe],properties:C.properties},M,O);return}throw new Error("Input data is not a valid GeoJSON object.")}for(oe=0;oe<U.length;oe++){var ge=[];Ct(U[oe],ge,ie,!0),Q.push(ge)}}V.push(vi(J,Y,Q,C.properties))}}function to(V,C){C.push(zr(V[0])),C.push(fr(V[1])),C.push(0)}function Vr(V,C,M,O){for(var U,Y,ie=0,Q=0;Q<V.length;Q++){var J=zr(V[Q][0]),oe=fr(V[Q][1]);C.push(J),C.push(oe),C.push(0),Q>0&&(ie+=O?(U*oe-J*Y)/2:Math.sqrt(Math.pow(J-U,2)+Math.pow(oe-Y,2))),U=J,Y=oe}var ge=C.length-3;C[2]=1,_i(C,0,ge,M),C[ge+2]=1,C.size=Math.abs(ie),C.start=0,C.end=C.size}function Ct(V,C,M,O){for(var U=0;U<V.length;U++){var Y=[];Vr(V[U],Y,M,O),C.push(Y)}}function zr(V){return V/360+.5}function fr(V){var C=Math.sin(V*Math.PI/180),M=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return M<0?0:M>1?1:M}function mr(V,C,M,O,U,Y,ie,Q){if(O/=C,Y>=(M/=C)&&ie<O)return V;if(ie<M||Y>=O)return null;for(var J=[],oe=0;oe<V.length;oe++){var ge=V[oe],Ee=ge.geometry,me=ge.type,Ke=U===0?ge.minX:ge.minY,Je=U===0?ge.maxX:ge.maxY;if(Ke>=M&&Je<O)J.push(ge);else if(!(Je<M||Ke>=O)){var je=[];if(me==="Point"||me==="MultiPoint")Ni(Ee,je,M,O,U);else if(me==="LineString")Le(Ee,je,M,O,U,!1,Q.lineMetrics);else if(me==="MultiLineString")ft(Ee,je,M,O,U,!1);else if(me==="Polygon")ft(Ee,je,M,O,U,!0);else if(me==="MultiPolygon")for(var it=0;it<Ee.length;it++){var ut=[];ft(Ee[it],ut,M,O,U,!0),ut.length&&je.push(ut)}if(je.length){if(Q.lineMetrics&&me==="LineString"){for(it=0;it<je.length;it++)J.push(vi(ge.id,me,je[it],ge.tags));continue}me!=="LineString"&&me!=="MultiLineString"||(je.length===1?(me="LineString",je=je[0]):me="MultiLineString"),me!=="Point"&&me!=="MultiPoint"||(me=je.length===3?"Point":"MultiPoint"),J.push(vi(ge.id,me,je,ge.tags))}}}return J.length?J:null}function Ni(V,C,M,O,U){for(var Y=0;Y<V.length;Y+=3){var ie=V[Y+U];ie>=M&&ie<=O&&(C.push(V[Y]),C.push(V[Y+1]),C.push(V[Y+2]))}}function Le(V,C,M,O,U,Y,ie){for(var Q,J,oe=gt(V),ge=U===0?Ui:dt,Ee=V.start,me=0;me<V.length-3;me+=3){var Ke=V[me],Je=V[me+1],je=V[me+2],it=V[me+3],ut=V[me+4],It=U===0?Ke:Je,ht=U===0?it:ut,yt=!1;ie&&(Q=Math.sqrt(Math.pow(Ke-it,2)+Math.pow(Je-ut,2))),It<M?ht>M&&(J=ge(oe,Ke,Je,it,ut,M),ie&&(oe.start=Ee+Q*J)):It>O?ht<O&&(J=ge(oe,Ke,Je,it,ut,O),ie&&(oe.start=Ee+Q*J)):Dn(oe,Ke,Je,je),ht<M&&It>=M&&(J=ge(oe,Ke,Je,it,ut,M),yt=!0),ht>O&&It<=O&&(J=ge(oe,Ke,Je,it,ut,O),yt=!0),!Y&&yt&&(ie&&(oe.end=Ee+Q*J),C.push(oe),oe=gt(V)),ie&&(Ee+=Q)}var zt=V.length-3;Ke=V[zt],Je=V[zt+1],je=V[zt+2],(It=U===0?Ke:Je)>=M&&It<=O&&Dn(oe,Ke,Je,je),zt=oe.length-3,Y&&zt>=3&&(oe[zt]!==oe[0]||oe[zt+1]!==oe[1])&&Dn(oe,oe[0],oe[1],oe[2]),oe.length&&C.push(oe)}function gt(V){var C=[];return C.size=V.size,C.start=V.start,C.end=V.end,C}function ft(V,C,M,O,U,Y){for(var ie=0;ie<V.length;ie++)Le(V[ie],C,M,O,U,Y,!1)}function Dn(V,C,M,O){V.push(C),V.push(M),V.push(O)}function Ui(V,C,M,O,U,Y){var ie=(Y-C)/(O-C);return V.push(Y),V.push(M+(U-M)*ie),V.push(1),ie}function dt(V,C,M,O,U,Y){var ie=(Y-M)/(U-M);return V.push(C+(O-C)*ie),V.push(Y),V.push(1),ie}function xi(V,C){for(var M=[],O=0;O<V.length;O++){var U,Y=V[O],ie=Y.type;if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")U=En(Y.geometry,C);else if(ie==="MultiLineString"||ie==="Polygon"){U=[];for(var Q=0;Q<Y.geometry.length;Q++)U.push(En(Y.geometry[Q],C))}else if(ie==="MultiPolygon")for(U=[],Q=0;Q<Y.geometry.length;Q++){for(var J=[],oe=0;oe<Y.geometry[Q].length;oe++)J.push(En(Y.geometry[Q][oe],C));U.push(J)}M.push(vi(Y.id,ie,U,Y.tags))}return M}function En(V,C){var M=[];M.size=V.size,V.start!==void 0&&(M.start=V.start,M.end=V.end);for(var O=0;O<V.length;O+=3)M.push(V[O]+C,V[O+1],V[O+2]);return M}function Lo(V,C){if(V.transformed)return V;var M,O,U,Y=1<<V.z,ie=V.x,Q=V.y;for(M=0;M<V.features.length;M++){var J=V.features[M],oe=J.geometry,ge=J.type;if(J.geometry=[],ge===1)for(O=0;O<oe.length;O+=2)J.geometry.push(mn(oe[O],oe[O+1],C,Y,ie,Q));else for(O=0;O<oe.length;O++){var Ee=[];for(U=0;U<oe[O].length;U+=2)Ee.push(mn(oe[O][U],oe[O][U+1],C,Y,ie,Q));J.geometry.push(Ee)}}return V.transformed=!0,V}function mn(V,C,M,O,U,Y){return[Math.round(M*(V*O-U)),Math.round(M*(C*O-Y))]}function Zn(V,C,M,O,U){for(var Y=C===U.maxZoom?0:U.tolerance/((1<<C)*U.extent),ie={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:M,y:O,z:C,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Q=0;Q<V.length;Q++){ie.numFeatures++,Nt(ie,V[Q],Y,U);var J=V[Q].minX,oe=V[Q].minY,ge=V[Q].maxX,Ee=V[Q].maxY;J<ie.minX&&(ie.minX=J),oe<ie.minY&&(ie.minY=oe),ge>ie.maxX&&(ie.maxX=ge),Ee>ie.maxY&&(ie.maxY=Ee)}return ie}function Nt(V,C,M,O){var U=C.geometry,Y=C.type,ie=[];if(Y==="Point"||Y==="MultiPoint")for(var Q=0;Q<U.length;Q+=3)ie.push(U[Q]),ie.push(U[Q+1]),V.numPoints++,V.numSimplified++;else if(Y==="LineString")Ro(ie,U,V,M,!1,!1);else if(Y==="MultiLineString"||Y==="Polygon")for(Q=0;Q<U.length;Q++)Ro(ie,U[Q],V,M,Y==="Polygon",Q===0);else if(Y==="MultiPolygon")for(var J=0;J<U.length;J++){var oe=U[J];for(Q=0;Q<oe.length;Q++)Ro(ie,oe[Q],V,M,!0,Q===0)}if(ie.length){var ge=C.tags||null;if(Y==="LineString"&&O.lineMetrics){for(var Ee in ge={},C.tags)ge[Ee]=C.tags[Ee];ge.mapbox_clip_start=U.start/U.size,ge.mapbox_clip_end=U.end/U.size}var me={geometry:ie,type:Y==="Polygon"||Y==="MultiPolygon"?3:Y==="LineString"||Y==="MultiLineString"?2:1,tags:ge};C.id!==null&&(me.id=C.id),V.features.push(me)}}function Ro(V,C,M,O,U,Y){var ie=O*O;if(O>0&&C.size<(U?ie:O))M.numPoints+=C.length/3;else{for(var Q=[],J=0;J<C.length;J+=3)(O===0||C[J+2]>ie)&&(M.numSimplified++,Q.push(C[J]),Q.push(C[J+1])),M.numPoints++;U&&function(oe,ge){for(var Ee=0,me=0,Ke=oe.length,Je=Ke-2;me<Ke;Je=me,me+=2)Ee+=(oe[me]-oe[Je])*(oe[me+1]+oe[Je+1]);if(Ee>0===ge)for(me=0,Ke=oe.length;me<Ke/2;me+=2){var je=oe[me],it=oe[me+1];oe[me]=oe[Ke-2-me],oe[me+1]=oe[Ke-1-me],oe[Ke-2-me]=je,oe[Ke-1-me]=it}}(Q,Y),V.push(Q)}}function ni(V,C){var M=(C=this.options=function(U,Y){for(var ie in Y)U[ie]=Y[ie];return U}(Object.create(this.options),C)).debug;if(M&&console.time("preprocess data"),C.maxZoom<0||C.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(C.promoteId&&C.generateId)throw new Error("promoteId and generateId cannot be used together.");var O=function(U,Y){var ie=[];if(U.type==="FeatureCollection")for(var Q=0;Q<U.features.length;Q++)Oe(ie,U.features[Q],Y,Q);else Oe(ie,U.type==="Feature"?U:{geometry:U},Y);return ie}(V,C);this.tiles={},this.tileCoords=[],M&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",C.indexMaxZoom,C.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),O=function(U,Y){var ie=Y.buffer/Y.extent,Q=U,J=mr(U,1,-1-ie,ie,0,-1,2,Y),oe=mr(U,1,1-ie,2+ie,0,-1,2,Y);return(J||oe)&&(Q=mr(U,1,-ie,1+ie,0,-1,2,Y)||[],J&&(Q=xi(J,1).concat(Q)),oe&&(Q=Q.concat(xi(oe,-1)))),Q}(O,C),O.length&&this.splitTile(O,0,0,0),M&&(O.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function no(V,C,M){return 32*((1<<V)*M+C)+V}function ro(V,C){const M=V.tileID.canonical;if(!this._geoJSONIndex)return C(null,null);const O=this._geoJSONIndex.getTile(M.z,M.x,M.y);if(!O)return C(null,null);const U=new He(O.features);let Y=De.exports(U);Y.byteOffset===0&&Y.byteLength===Y.buffer.byteLength||(Y=new Uint8Array(Y)),C(null,{vectorTile:U,rawData:Y.buffer})}ni.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ni.prototype.splitTile=function(V,C,M,O,U,Y,ie){for(var Q=[V,C,M,O],J=this.options,oe=J.debug;Q.length;){O=Q.pop(),M=Q.pop(),C=Q.pop(),V=Q.pop();var ge=1<<C,Ee=no(C,M,O),me=this.tiles[Ee];if(!me&&(oe>1&&console.time("creation"),me=this.tiles[Ee]=Zn(V,C,M,O,J),this.tileCoords.push({z:C,x:M,y:O}),oe)){oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",C,M,O,me.numFeatures,me.numPoints,me.numSimplified),console.timeEnd("creation"));var Ke="z"+C;this.stats[Ke]=(this.stats[Ke]||0)+1,this.total++}if(me.source=V,U){if(C===J.maxZoom||C===U)continue;var Je=1<<U-C;if(M!==Math.floor(Y/Je)||O!==Math.floor(ie/Je))continue}else if(C===J.indexMaxZoom||me.numPoints<=J.indexMaxPoints)continue;if(me.source=null,V.length!==0){oe>1&&console.time("clipping");var je,it,ut,It,ht,yt,zt=.5*J.buffer/J.extent,$t=.5-zt,Tn=.5+zt,Kt=1+zt;je=it=ut=It=null,ht=mr(V,ge,M-zt,M+Tn,0,me.minX,me.maxX,J),yt=mr(V,ge,M+$t,M+Kt,0,me.minX,me.maxX,J),V=null,ht&&(je=mr(ht,ge,O-zt,O+Tn,1,me.minY,me.maxY,J),it=mr(ht,ge,O+$t,O+Kt,1,me.minY,me.maxY,J),ht=null),yt&&(ut=mr(yt,ge,O-zt,O+Tn,1,me.minY,me.maxY,J),It=mr(yt,ge,O+$t,O+Kt,1,me.minY,me.maxY,J),yt=null),oe>1&&console.timeEnd("clipping"),Q.push(je||[],C+1,2*M,2*O),Q.push(it||[],C+1,2*M,2*O+1),Q.push(ut||[],C+1,2*M+1,2*O),Q.push(It||[],C+1,2*M+1,2*O+1)}}},ni.prototype.getTile=function(V,C,M){var O=this.options,U=O.extent,Y=O.debug;if(V<0||V>24)return null;var ie=1<<V,Q=no(V,C=(C%ie+ie)%ie,M);if(this.tiles[Q])return Lo(this.tiles[Q],U);Y>1&&console.log("drilling down to z%d-%d-%d",V,C,M);for(var J,oe=V,ge=C,Ee=M;!J&&oe>0;)oe--,ge=Math.floor(ge/2),Ee=Math.floor(Ee/2),J=this.tiles[no(oe,ge,Ee)];return J&&J.source?(Y>1&&console.log("found parent tile z%d-%d-%d",oe,ge,Ee),Y>1&&console.time("drilling down"),this.splitTile(J.source,oe,ge,Ee,V,C,M),Y>1&&console.timeEnd("drilling down"),this.tiles[Q]?Lo(this.tiles[Q],U):null):null};class Bo extends Ie{constructor(C,M,O,U){super(C,M,O,ro),U&&(this.loadGeoJSON=U)}loadData(C,M){var O;(O=this._pendingRequest)===null||O===void 0||O.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new l.RequestPerformance(C.request);this._pendingCallback=M,this._pendingRequest=this.loadGeoJSON(C,(Y,ie)=>{if(delete this._pendingCallback,delete this._pendingRequest,Y||!ie)return M(Y);if(typeof ie!="object")return M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));{ee(ie,!0);try{if(C.filter){const J=l.createExpression(C.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(ge=>`${ge.key}: ${ge.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(ge=>J.value.evaluate({zoom:0},ge))}}this._geoJSONIndex=C.cluster?new Ss(function({superclusterOptions:J,clusterProperties:oe}){if(!oe||!J)return J;const ge={},Ee={},me={accumulated:null,zoom:0},Ke={properties:null},Je=Object.keys(oe);for(const je of Je){const[it,ut]=oe[je],It=l.createExpression(ut),ht=l.createExpression(typeof it=="string"?[it,["accumulated"],["get",je]]:it);ge[je]=It.value,Ee[je]=ht.value}return J.map=je=>{Ke.properties=je;const it={};for(const ut of Je)it[ut]=ge[ut].evaluate(me,Ke);return it},J.reduce=(je,it)=>{Ke.properties=it;for(const ut of Je)me.accumulated=je[ut],je[ut]=Ee[ut].evaluate(me,Ke)},J}(C)).load(ie.features):function(J,oe){return new ni(J,oe)}(ie,C.geojsonVtOptions)}catch(J){return M(J)}this.loaded={};const Q={};if(U){const J=U.finish();J&&(Q.resourceTiming={},Q.resourceTiming[C.source]=JSON.parse(JSON.stringify(J)))}M(null,Q)}})}reloadTile(C,M){const O=this.loaded;return O&&O[C.uid]?super.reloadTile(C,M):this.loadTile(C,M)}loadGeoJSON(C,M){if(C.request)return l.getJSON(C.request,M);if(typeof C.data=="string")try{M(null,JSON.parse(C.data))}catch{M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`))}else M(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(C,M){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),M()}getClusterExpansionZoom(C,M){try{M(null,this._geoJSONIndex.getClusterExpansionZoom(C.clusterId))}catch(O){M(O)}}getClusterChildren(C,M){try{M(null,this._geoJSONIndex.getChildren(C.clusterId))}catch(O){M(O)}}getClusterLeaves(C,M){try{M(null,this._geoJSONIndex.getLeaves(C.clusterId,C.limit,C.offset))}catch(O){M(O)}}}class io{constructor(C){this.self=C,this.actor=new l.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ie,geojson:Bo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(M,O)=>{if(this.workerSourceTypes[M])throw new Error(`Worker source with name "${M}" already registered.`);this.workerSourceTypes[M]=O},this.self.registerRTLTextPlugin=M=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=M.applyArabicShaping,l.plugin.processBidirectionalText=M.processBidirectionalText,l.plugin.processStyledBidirectionalText=M.processStyledBidirectionalText}}setReferrer(C,M){this.referrer=M}setImages(C,M,O){this.availableImages[C]=M;for(const U in this.workerSources[C]){const Y=this.workerSources[C][U];for(const ie in Y)Y[ie].availableImages=M}O()}setLayers(C,M,O){this.getLayerIndex(C).replace(M),O()}updateLayers(C,M,O){this.getLayerIndex(C).update(M.layers,M.removedIds),O()}loadTile(C,M,O){this.getWorkerSource(C,M.type,M.source).loadTile(M,O)}loadDEMTile(C,M,O){this.getDEMWorkerSource(C,M.source).loadTile(M,O)}reloadTile(C,M,O){this.getWorkerSource(C,M.type,M.source).reloadTile(M,O)}abortTile(C,M,O){this.getWorkerSource(C,M.type,M.source).abortTile(M,O)}removeTile(C,M,O){this.getWorkerSource(C,M.type,M.source).removeTile(M,O)}removeDEMTile(C,M){this.getDEMWorkerSource(C,M.source).removeTile(M)}removeSource(C,M,O){if(!this.workerSources[C]||!this.workerSources[C][M.type]||!this.workerSources[C][M.type][M.source])return;const U=this.workerSources[C][M.type][M.source];delete this.workerSources[C][M.type][M.source],U.removeSource!==void 0?U.removeSource(M,O):O()}loadWorkerSource(C,M,O){try{this.self.importScripts(M.url),O()}catch(U){O(U.toString())}}syncRTLPluginState(C,M,O){try{l.plugin.setState(M);const U=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&U!=null){this.self.importScripts(U);const Y=l.plugin.isParsed();O(Y?void 0:new Error(`RTL Text Plugin failed to import scripts from ${U}`),Y)}}catch(U){O(U.toString())}}getAvailableImages(C){let M=this.availableImages[C];return M||(M=[]),M}getLayerIndex(C){let M=this.layerIndexes[C];return M||(M=this.layerIndexes[C]=new ae),M}getWorkerSource(C,M,O){if(this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][M]||(this.workerSources[C][M]={}),!this.workerSources[C][M][O]){const U={send:(Y,ie,Q)=>{this.actor.send(Y,ie,Q,C)}};this.workerSources[C][M][O]=new this.workerSourceTypes[M](U,this.getLayerIndex(C),this.getAvailableImages(C))}return this.workerSources[C][M][O]}getDEMWorkerSource(C,M){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][M]||(this.demWorkerSources[C][M]=new bt),this.demWorkerSources[C][M]}enforceCacheSizeLimit(C,M){l.enforceCacheSizeLimit(M)}}return l.isWorker()&&(self.worker=new io(self)),io}),w(["./shared"],function(l){var N=j;function j(h){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,p,g=new Blob([""],{type:"text/javascript"}),v=URL.createObjectURL(g);try{p=new Worker(v),c=!0}catch{c=!1}return p&&p.terminate(),URL.revokeObjectURL(v),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var p=c.getContext("2d");if(!p)return!1;var g=p.getImageData(0,0,1,1);return g&&g.width===c.width}()?(ae[s=t&&t.failIfMajorPerformanceCaveat]===void 0&&(ae[s]=function(c){var p,g=function(v){var S=document.createElement("canvas"),E=Object.create(j.webGLContextAttributes);return E.failIfMajorPerformanceCaveat=v,S.getContext("webgl",E)||S.getContext("experimental-webgl",E)}(c);if(!g)return!1;try{p=g.createShader(g.VERTEX_SHADER)}catch{return!1}return!(!p||g.isContextLost())&&(g.shaderSource(p,"void main() {}"),g.compileShader(p),g.getShaderParameter(p,g.COMPILE_STATUS)===!0)}(s)),ae[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(h)}var ae={};function ne(h,t){if(Array.isArray(h)){if(!Array.isArray(t)||h.length!==t.length)return!1;for(let s=0;s<h.length;s++)if(!ne(h[s],t[s]))return!1;return!0}if(typeof h=="object"&&h!==null&&t!==null){if(typeof t!="object"||Object.keys(h).length!==Object.keys(t).length)return!1;for(const s in h)if(!ne(h[s],t[s]))return!1;return!0}return h===t}j.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class q{static testProp(t){if(!q.docStyle)return t[0];for(let s=0;s<t.length;s++)if(t[s]in q.docStyle)return t[s];return t[0]}static create(t,s,c){const p=window.document.createElement(t);return s!==void 0&&(p.className=s),c&&c.appendChild(p),p}static createNS(t,s){return window.document.createElementNS(t,s)}static disableDrag(){q.docStyle&&q.selectProp&&(q.userSelect=q.docStyle[q.selectProp],q.docStyle[q.selectProp]="none")}static enableDrag(){q.docStyle&&q.selectProp&&(q.docStyle[q.selectProp]=q.userSelect)}static setTransform(t,s){t.style[q.transformProp]=s}static addEventListener(t,s,c,p={}){t.addEventListener(s,c,"passive"in p?p:p.capture)}static removeEventListener(t,s,c,p={}){t.removeEventListener(s,c,"passive"in p?p:p.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",q.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",q.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",q.suppressClickInternal,!0)},0)}static mousePos(t,s){const c=t.getBoundingClientRect();return new l.pointGeometry(s.clientX-c.left-t.clientLeft,s.clientY-c.top-t.clientTop)}static touchPos(t,s){const c=t.getBoundingClientRect(),p=[];for(let g=0;g<s.length;g++)p.push(new l.pointGeometry(s[g].clientX-c.left-t.clientLeft,s[g].clientY-c.top-t.clientTop));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}q.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,q.selectProp=q.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),q.transformProp=q.testProp(["transform","WebkitTransform"]);class Ae{constructor(t){this._transformRequestFn=t}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}normalizeSpriteURL(t,s,c){const p=function(g){const v=g.match(Te);if(!v)throw new Error(`Unable to parse URL "${g}"`);return{protocol:v[1],authority:v[2],path:v[3]||"/",params:v[4]?v[4].split("&"):[]}}(t);return p.path+=`${s}${c}`,function(g){const v=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${v}`}(p)}setTransformRequest(t){this._transformRequestFn=t}}const Te=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class Ie{constructor(t,s,c,p){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(s,p)}update(t,s,c){const{width:p,height:g}=t,v=!(this.size&&this.size[0]===p&&this.size[1]===g||c),{context:S}=this,{gl:E}=S;if(this.useMipmap=Boolean(s&&s.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),v)this.size=[p,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.isImageBitmap(t)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,t):E.texImage2D(E.TEXTURE_2D,0,this.format,p,g,0,this.format,E.UNSIGNED_BYTE,t.data);else{const{x:k,y:A}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.isImageBitmap(t)?E.texSubImage2D(E.TEXTURE_2D,0,k,A,E.RGBA,E.UNSIGNED_BYTE,t):E.texSubImage2D(E.TEXTURE_2D,0,k,A,p,g,E.RGBA,E.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(t,s,c){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),c!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,c||t),this.filter=t),s!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function bt(h){const{userImage:t}=h;return!!(t&&t.render&&t.render())&&(h.data.replace(new Uint8Array(t.data.buffer)),!0)}class ee extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,c);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,s){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let c=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,s){if(!t)return!0;let c=0;for(const p of t){if(p[0]<c||p[1]<p[0]||s<p[1])return!1;c=p[1]}return!0}_validateContent(t,s){return!(t&&(t.length!==4||t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,s){const c=this.images[t];if(c.data.width!==s.data.width||c.data.height!==s.data.height)throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=c.version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let c=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const c={};for(const p of t){this.images[p]||this.fire(new l.Event("styleimagemissing",{id:p}));const g=this.images[p];g?c[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:l.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],c=this.getImage(t);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new l.ImagePosition(p,c);this.patterns[t]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ie(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const g in this.patterns)t.push(this.patterns[g].bin);const{w:s,h:c}=l.potpack(t),p=this.atlasImage;p.resize({width:s||1,height:c||1});for(const g in this.patterns){const{bin:v}=this.patterns[g],S=v.x+1,E=v.y+1,k=this.images[g].data,A=k.width,D=k.height;l.RGBAImage.copy(k,p,{x:0,y:0},{x:S,y:E},{width:A,height:D}),l.RGBAImage.copy(k,p,{x:0,y:D-1},{x:S,y:E-1},{width:A,height:1}),l.RGBAImage.copy(k,p,{x:0,y:0},{x:S,y:E+D},{width:A,height:1}),l.RGBAImage.copy(k,p,{x:A-1,y:0},{x:S-1,y:E},{width:1,height:D}),l.RGBAImage.copy(k,p,{x:0,y:0},{x:S+A,y:E},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.images[s];c||l.warnOnce(`Image with ID: "${s}" was not found`),bt(c)&&this.updateImage(s,c)}}}const H=1e20;function re(h,t,s,c,p,g,v,S,E){for(let k=t;k<t+c;k++)we(h,s*g+k,g,p,v,S,E);for(let k=s;k<s+p;k++)we(h,k*g+t,1,c,v,S,E)}function we(h,t,s,c,p,g,v){g[0]=0,v[0]=-H,v[1]=H,p[0]=h[t];for(let S=1,E=0,k=0;S<c;S++){p[S]=h[t+S*s];const A=S*S;do{const D=g[E];k=(p[S]-p[D]+A-D*D)/(S-D)/2}while(k<=v[E]&&--E>-1);E++,g[E]=S,v[E]=k,v[E+1]=H}for(let S=0,E=0;S<c;S++){for(;v[E+1]<S;)E++;const k=g[E],A=S-k;h[t+S*s]=p[k]+A*A}}class ze{constructor(t,s){this.requestManager=t,this.localIdeographFontFamily=s,this.entries={}}setURL(t){this.url=t}getGlyphs(t,s){const c=[];for(const p in t)for(const g of t[p])c.push({stack:p,id:g});l.asyncAll(c,({stack:p,id:g},v)=>{let S=this.entries[p];S||(S=this.entries[p]={glyphs:{},requests:{},ranges:{}});let E=S.glyphs[g];if(E!==void 0)return void v(null,{stack:p,id:g,glyph:E});if(E=this._tinySDF(S,p,g),E)return S.glyphs[g]=E,void v(null,{stack:p,id:g,glyph:E});const k=Math.floor(g/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(S.ranges[k])return void v(null,{stack:p,id:g,glyph:E});let A=S.requests[k];A||(A=S.requests[k]=[],ze.loadGlyphRange(p,k,this.url,this.requestManager,(D,R)=>{if(R){for(const Z in R)this._doesCharSupportLocalGlyph(+Z)||(S.glyphs[+Z]=R[+Z]);S.ranges[k]=!0}for(const Z of A)Z(D,R);delete S.requests[k]})),A.push((D,R)=>{D?v(D):R&&v(null,{stack:p,id:g,glyph:R[g]||null})})},(p,g)=>{if(p)s(p);else if(g){const v={};for(const{stack:S,id:E,glyph:k}of g)(v[S]||(v[S]={}))[E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};s(null,v)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](t)||l.unicodeBlockLookup["Hangul Syllables"](t)||l.unicodeBlockLookup.Hiragana(t)||l.unicodeBlockLookup.Katakana(t))}_tinySDF(t,s,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let g=t.tinySDF;if(!g){let S="400";/bold/i.test(s)?S="900":/medium/i.test(s)?S="500":/light/i.test(s)&&(S="200"),g=t.tinySDF=new ze.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:S})}const v=g.draw(String.fromCharCode(c));return{id:c,bitmap:new l.AlphaImage({width:v.width||30,height:v.height||30},v.data),metrics:{width:v.glyphWidth||24,height:v.glyphHeight||24,left:v.glyphLeft||0,top:v.glyphTop-27||-8,advance:v.glyphAdvance||24}}}}ze.loadGlyphRange=function(h,t,s,c,p){const g=256*t,v=g+255,S=c.transformRequest(s.replace("{fontstack}",h).replace("{range}",`${g}-${v}`),l.ResourceType.Glyphs);l.getArrayBuffer(S,(E,k)=>{if(E)p(E);else if(k){const A={};for(const D of l.parseGlyphPbf(k))A[D.id]=D;p(null,A)}})},ze.TinySDF=class{constructor({fontSize:h=24,buffer:t=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=s;const S=this.size=h+4*t,E=this._createCanvas(S),k=this.ctx=E.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${g} ${h}px ${p}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(h){const t=document.createElement("canvas");return t.width=t.height=h,t}draw(h){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(h),v=Math.ceil(s),S=Math.min(this.size-this.buffer,Math.ceil(g-p)),E=Math.min(this.size-this.buffer,v+Math.ceil(c)),k=S+2*this.buffer,A=E+2*this.buffer,D=Math.max(k*A,0),R=new Uint8ClampedArray(D),Z={data:R,width:k,height:A,glyphWidth:S,glyphHeight:E,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(S===0||E===0)return Z;const{ctx:$,buffer:G,gridInner:te,gridOuter:se}=this;$.clearRect(G,G,S,E),$.fillText(h,G,G+v);const ce=$.getImageData(G,G,S,E);se.fill(H,0,D),te.fill(0,0,D);for(let W=0;W<E;W++)for(let pe=0;pe<S;pe++){const he=ce.data[4*(W*S+pe)+3]/255;if(he===0)continue;const _e=(W+G)*k+pe+G;if(he===1)se[_e]=0,te[_e]=H;else{const ve=.5-he;se[_e]=ve>0?ve*ve:0,te[_e]=ve<0?ve*ve:0}}re(se,0,0,k,A,k,this.f,this.v,this.z),re(te,G,G,S,E,k,this.f,this.v,this.z);for(let W=0;W<D;W++){const pe=Math.sqrt(se[W])-Math.sqrt(te[W]);R[W]=Math.round(255-255*(pe/this.radius+this.cutoff))}return Z}};const He=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(h,t){return l.sphericalToCartesian(h.expression.evaluate(t))}interpolate(h,t,s){return{x:l.number(h.x,t.x,s),y:l.number(h.y,t.y,s),z:l.number(h.z,t.z,s)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)}),De="-transition";class Fe extends l.Evented{constructor(t){super(),this._transitionable=new l.Transitionable(He),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(l.validateLight,t,s))for(const c in t){const p=t[c];c.endsWith(De)?this._transitionable.setTransition(c.slice(0,-De.length),p):this._transitionable.setValue(c,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,c){return(!c||c.validate!==!1)&&l.emitValidationErrors(this,t.call(l.validateStyle,l.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Mt{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,s){const c=t.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,s)),this.dashEntry[c]}getDashRanges(t,s,c){const p=[];let g=t.length%2==1?-t[t.length-1]*c:0,v=t[0]*c,S=!0;p.push({left:g,right:v,isDash:S,zeroLength:t[0]===0});let E=t[0];for(let k=1;k<t.length;k++){S=!S;const A=t[k];g=E*c,E+=A,v=E*c,p.push({left:g,right:v,isDash:S,zeroLength:A===0})}return p}addRoundDash(t,s,c){const p=s/2;for(let g=-c;g<=c;g++){const v=this.width*(this.nextRow+c+g);let S=0,E=t[S];for(let k=0;k<this.width;k++){k/E.right>1&&(E=t[++S]);const A=Math.abs(k-E.left),D=Math.abs(k-E.right),R=Math.min(A,D);let Z;const $=g/c*(p+1);if(E.isDash){const G=p-Math.abs($);Z=Math.sqrt(R*R+G*G)}else Z=p-Math.sqrt(R*R+$*$);this.data[v+k]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(t){for(let S=t.length-1;S>=0;--S){const E=t[S],k=t[S+1];E.zeroLength?t.splice(S,1):k&&k.isDash===E.isDash&&(k.left=E.left,t.splice(S,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const p=this.width*this.nextRow;let g=0,v=t[g];for(let S=0;S<this.width;S++){S/v.right>1&&(v=t[++g]);const E=Math.abs(S-v.left),k=Math.abs(S-v.right),A=Math.min(E,k);this.data[p+S]=Math.max(0,Math.min(255,(v.isDash?A:-A)+128))}}addDash(t,s){const c=s?7:0,p=2*c+1;if(this.nextRow+p>this.height)return l.warnOnce("LineAtlas out of space"),null;let g=0;for(let S=0;S<t.length;S++)g+=t[S];if(g!==0){const S=this.width/g,E=this.getDashRanges(t,this.width,S);s?this.addRoundDash(E,S,c):this.addRegularDash(E)}const v={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:g};return this.nextRow+=p,this.dirty=!0,v}bind(t){const s=t.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class st{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const c=this.workerPool.acquire(this.id);for(let p=0;p<c.length;p++){const g=new st.Actor(c[p],s,this.id);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,s,c){l.asyncAll(this.actors,(p,g)=>{p.send(t,s,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function nn(h,t,s){const c=function(p,g){if(p)return s(p);if(g){const v=l.pick(l.extend(g,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(S=>S.id)),s(null,v)}};return h.url?l.getJSON(t.transformRequest(h.url,l.ResourceType.Source),c):l.exported.frame(()=>c(null,h))}st.Actor=l.Actor;class Mn{constructor(t,s,c){this.bounds=l.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),c=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*s),g=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*s),v=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=c&&t.x<g&&t.y>=p&&t.y<v}}class Ir extends l.Evented{constructor(t,s,c,p){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(s,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nn(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new l.ErrorEvent(t)):s&&(l.extend(this,s),s.bounds&&(this.tileBounds=new Mn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,l.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(v,S){return delete t.request,t.aborted?s(null):v&&v.status!==404?s(v):(S&&S.resourceTiming&&(t.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&t.setExpiryData(S),t.loadVectorData(S,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=s:t.request=t.actor.send("reloadTile",p,g.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",p,g.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Nr extends l.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},s),l.extend(this,l.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nn(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new l.ErrorEvent(t)):s&&(l.extend(this,s),s.bounds&&(this.tileBounds=new Mn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),(p,g,v)=>{if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(p)t.state="errored",s(p);else if(g){this.map._refreshExpiredTiles&&t.setExpiryData(v);const S=this.map.painter.context,E=S.gl;t.texture=this.map.painter.getTileTexture(g.width),t.texture?t.texture.update(g,{useMipmap:!0}):(t.texture=new Ie(S,g,E.RGBA,{useMipmap:!0}),t.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),S.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax)),t.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),s(null)}})}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}let ei;class at extends Nr{constructor(t,s,c,p){super(t,s,c,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(g,v){g&&(t.state="errored",s(g)),v&&(t.dem=v,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",s(null))}t.request=l.getImage(this.map._requestManager.transformRequest(c,l.ResourceType.Tile),function(g,v){if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(g)t.state="errored",s(g);else if(v){this.map._refreshExpiredTiles&&t.setExpiryData(v),delete v.cacheControl,delete v.expires;const S=l.isImageBitmap(v)&&(ei==null&&(ei=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ei)?v:l.exported.getImageData(v,1),E={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:S,encoding:this.encoding};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",E,p.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const s=t.canonical,c=Math.pow(2,s.z),p=(s.x-1+c)%c,g=s.x===0?t.wrap-1:t.wrap,v=(s.x+1+c)%c,S=s.x+1===c?t.wrap+1:t.wrap,E={};return E[new l.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,S,s.z,v,s.y).key]={backfilled:!1},s.y>0&&(E[new l.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y-1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,S,s.z,v,s.y-1).key]={backfilled:!1}),s.y+1<c&&(E[new l.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y+1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,S,s.z,v,s.y+1).key]={backfilled:!1}),E}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class hr extends l.Evented{constructor(t,s,c,p){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=s.data,this._options=l.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const g=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*g,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*g,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.EXTENT,radius:(s.clusterRadius||50)*g,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData("content"),this}getClusterExpansionZoom(t,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},s),this}getClusterChildren(t,s){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},s),this}getClusterLeaves(t,s,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:s,offset:c},p),this}_updateWorkerData(t){const s=l.extend({},this.workerOptions),c=this._data;typeof c=="string"?(s.request=this.map._requestManager.transformRequest(l.exported.resolveURL(c),l.ResourceType.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(c),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source",sourceDataType:t}));let v=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.ErrorEvent(p));const S={dataType:"source",sourceDataType:t};this._collectResourceTiming&&v&&v.length>0&&l.extend(S,{resourceTiming:v}),this.fire(new l.Event("data",S))})}loaded(){return this._pendingLoads===0}loadTile(t,s){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,p,(g,v)=>(delete t.request,t.unloadVectorData(),t.aborted?s(null):g?s(g):(t.loadVectorData(v,this.map.painter,c==="reloadTile"),s(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var We=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class lt extends l.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(t,s){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(c,p)=>{this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):p&&(this.image=p,t&&(this.coordinates=t),s&&s(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(t){this.coordinates=t;const s=t.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(p){let g=1/0,v=1/0,S=-1/0,E=-1/0;for(const R of p)g=Math.min(g,R.x),v=Math.min(v,R.y),S=Math.max(S,R.x),E=Math.max(E,R.y);const k=Math.max(S-g,E-v),A=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),D=Math.pow(2,A);return new l.CanonicalTileID(A,Math.floor((g+S)/2*D),Math.floor((v+E)/2*D))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ie(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ct extends lt{constructor(t,s,c,p){super(t,s,c,p),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const s of t.urls)this.urls.push(this.map._requestManager.transformRequest(s,l.ResourceType.Source).url);l.getVideo(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new l.ErrorEvent(s)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const s=this.video.seekable;t<s.start(0)||t>s.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new Ie(t,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Vt extends lt{constructor(t,s,c,p){super(t,s,c,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ie(s,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Xt={vector:Ir,raster:Nr,"raster-dem":at,geojson:hr,video:ct,image:lt,canvas:Vt};function Ur(h,t){const s=l.create();return l.translate(s,s,[1,1,0]),l.scale(s,s,[.5*h.width,.5*h.height,1]),l.multiply(s,s,h.calculatePosMatrix(t.toUnwrapped()))}function Qn(h,t,s,c,p,g){const v=function(D,R,Z){if(D)for(const $ of D){const G=R[$];if(G&&G.source===Z&&G.type==="fill-extrusion")return!0}else for(const $ in R){const G=R[$];if(G.source===Z&&G.type==="fill-extrusion")return!0}return!1}(p&&p.layers,t,h.id),S=g.maxPitchScaleFactor(),E=h.tilesIn(c,S,v);E.sort(er);const k=[];for(const D of E)k.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(t,s,h._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,p,g,S,Ur(h.transform,D.tileID))});const A=function(D){const R={},Z={};for(const $ of D){const G=$.queryResults,te=$.wrappedTileID,se=Z[te]=Z[te]||{};for(const ce in G){const W=G[ce],pe=se[ce]=se[ce]||{},he=R[ce]=R[ce]||[];for(const _e of W)pe[_e.featureIndex]||(pe[_e.featureIndex]=!0,he.push(_e))}}return R}(k);for(const D in A)A[D].forEach(R=>{const Z=R.feature,$=h.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=$});return A}function er(h,t){const s=h.tileID,c=t.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}class On{constructor(t,s){this.tileID=t,this.uid=l.uniqueId(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const s=t+this.timeAdded;s<l.exported.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.textures.forEach(s=>t.saveTileTexture(s)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(t,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(p,g){const v={};if(!g)return v;for(const S of p){const E=S.layerIds.map(k=>g.getLayer(k)).filter(Boolean);if(E.length!==0){S.layers=E,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(k=>E.filter(A=>A.id===k)[0]));for(const k of E)v[k.id]=S}}return v}(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof l.SymbolBucket&&g.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ie(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ie(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,c,p,g,v,S,E,k,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:v,tileSize:this.tileSize,pixelPosMatrix:A,transform:E,params:S,queryPadding:this.queryPadding*k},t,s,c):{}}querySourceFeatures(t,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),g=s?s.sourceLayer:"",v=p._geojsonTileLayer||p[g];if(!v)return;const S=l.createFilter(s&&s.filter),{z:E,x:k,y:A}=this.tileID.canonical,D={z:E,x:k,y:A};for(let R=0;R<v.length;R++){const Z=v.feature(R);if(S.needGeometry){const te=l.toEvaluationFeature(Z,!0);if(!S.filter(new l.EvaluationParameters(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!S.filter(new l.EvaluationParameters(this.tileID.overscaledZ),Z))continue;const $=c.getId(Z,g),G=new l.GeoJSONFeature(Z,E,k,A,$);G.tile=D,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const c=l.parseCacheControl(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const g=this.expirationTime-s;g?this.expirationTime=c+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",S=c[v],E=t[v];if(!S||!E||Object.keys(E).length===0)continue;g.update(E,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=s&&s.style&&s.style.getLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=l.exported.now()+t}setDependencies(t,s){const c={};for(const p of s)c[p]=!0;this.dependencies[t]=c}hasDependency(t,s){for(const c of t){const p=this.dependencies[c];if(p){for(const g of s)if(p[g])return!0}}return!1}}class dr{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,c){const p=t.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:s,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},c)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const c=t.wrapped().key,p=s===void 0?0:this.data[c].indexOf(s),g=this.data[c][p];return this.data[c].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const c in this.data)for(const p of this.data[c])t(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class Ri{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,c){const p=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][p]=this.stateChanges[t][p]||{},l.extend(this.stateChanges[t][p],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const g in this.state[t])g!==p&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][p]===null){this.deletedStates[t][p]={};for(const g in this.state[t][p])c[g]||(this.deletedStates[t][p][g]=null)}else for(const g in c)this.deletedStates[t]&&this.deletedStates[t][p]&&this.deletedStates[t][p][g]===null&&delete this.deletedStates[t][p][g]}removeFeatureState(t,s,c){if(this.deletedStates[t]===null)return;const p=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&s!==void 0)this.deletedStates[t][p]!==null&&(this.deletedStates[t][p]=this.deletedStates[t][p]||{},this.deletedStates[t][p][c]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][p])for(c in this.deletedStates[t][p]={},this.stateChanges[t][p])this.deletedStates[t][p][c]=null;else this.deletedStates[t][p]=null;else this.deletedStates[t]=null}getState(t,s){const c=String(s),p=l.extend({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const g=this.deletedStates[t][s];if(g===null)return{};for(const v in g)delete p[v]}return p}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),l.extend(this.state[p][v],this.stateChanges[p][v]),g[v]=this.state[p][v];c[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const v in this.state[p])g[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(this.deletedStates[p][v]===null)this.state[p][v]={};else for(const S of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][S];g[v]=this.state[p][v]}c[p]=c[p]||{},l.extend(c[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in t)t[p].setFeatureState(c,s)}}class tr extends l.Evented{constructor(t,s,c){super(),this.id=t,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,g,v,S){const E=new Xt[g.type](p,g,v,S);if(E.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${E.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],E),E}(t,s,c,this),this._tiles={},this._cache=new dr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ri}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,s){return this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new l.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Ao).map(t=>t.key)}getRenderableIds(t){const s=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&s.push(this._tiles[c]);return t?s.sort((c,p)=>{const g=c.tileID,v=p.tileID,S=new l.pointGeometry(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new l.pointGeometry(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-v.overscaledZ||E.y-S.y||E.x-S.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Ao).map(c=>c.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,s){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,t,s)))}_tileLoaded(t,s,c,p){if(p)return t.state="errored",void(p.status!==404?this._source.fire(new l.ErrorEvent(p,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=l.exported.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const g=s[p];if(t.neighboringTiles&&t.neighboringTiles[g]){const v=this.getTileByID(g);c(t,v),c(v,t)}}function c(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let v=g.tileID.canonical.x-p.tileID.canonical.x;const S=g.tileID.canonical.y-p.tileID.canonical.y,E=Math.pow(2,p.tileID.canonical.z),k=g.tileID.key;v===0&&S===0||Math.abs(S)>1||(Math.abs(v)>1&&(Math.abs(v+E)===1?v+=E:Math.abs(v-E)===1&&(v-=E)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,v,S),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,c,p){for(const g in this._tiles){let v=this._tiles[g];if(p[g]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>c)continue;let S=v.tileID;for(;v&&v.tileID.overscaledZ>s+1;){const k=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[k.key],v&&v.hasData()&&(S=k)}let E=S;for(;E.overscaledZ>s;)if(E=E.scaledTo(E.overscaledZ-1),t[E.key]){p[S.key]=S;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=t.overscaledZ-1;c>=s;c--){const p=t.scaledTo(c),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const s=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,p=Math.floor(s*c*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const c={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),c[g.tileID.key]=g}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(t,s){if(this.transform=t,this.terrain=s,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new l.OverscaledTileID(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(k=>this._source.hasTile(k)))):c=[];const p=t.coveringZoomLevel(this._source),g=Math.max(p-tr.maxOverzooming,this._source.minzoom),v=Math.max(p+tr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const A of c)if(A.canonical.z>this._source.minzoom){const D=A.scaledTo(A.canonical.z-1);k[D.key]=D;const R=A.scaledTo(Math.max(this._source.minzoom,Math.min(A.canonical.z,5)));k[R.key]=R}c=c.concat(Object.values(k))}const S=this._updateRetainedTiles(c,p);if(bs(this._source.type)){const k={},A={},D=Object.keys(S);for(const R of D){const Z=S[R],$=this._tiles[R];if(!$||$.fadeEndTime&&$.fadeEndTime<=l.exported.now())continue;const G=this.findLoadedParent(Z,g);G&&(this._addTile(G.tileID),k[G.tileID.key]=G.tileID),A[R]=Z}this._retainLoadedChildren(A,p,v,S);for(const R in k)S[R]||(this._coveredTiles[R]=!0,S[R]=k[R]);if(s){const R={},Z={};for(const $ of c)this._tiles[$.key].hasData()?R[$.key]=$:Z[$.key]=$;for(const $ in Z){const G=Z[$].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(R[G[0].key]=S[G[0].key]=G[0],R[G[1].key]=S[G[1].key]=G[1],R[G[2].key]=S[G[2].key]=G[2],R[G[3].key]=S[G[3].key]=G[3],delete Z[$])}for(const $ in Z){const G=this.findLoadedParent(Z[$],this._source.minzoom);if(G){R[G.tileID.key]=S[G.tileID.key]=G.tileID;for(const te in R)R[te].isChildOf(G.tileID)&&delete R[te]}}for(const $ in this._tiles)R[$]||(this._coveredTiles[$]=!0)}}for(const k in S)this._tiles[k].clearFadeHold();const E=l.keysDifference(this._tiles,S);for(const k of E){const A=this._tiles[k];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,s){const c={},p={},g=Math.max(s-tr.maxOverzooming,this._source.minzoom),v=Math.max(s+tr.maxUnderzooming,this._source.minzoom),S={};for(const E of t){const k=this._addTile(E);c[E.key]=E,k.hasData()||s<this._source.maxzoom&&(S[E.key]=E)}this._retainLoadedChildren(S,s,v,c);for(const E of t){let k=this._tiles[E.key];if(k.hasData())continue;if(s+1>this._source.maxzoom){const D=E.children(this._source.maxzoom)[0],R=this.getTile(D);if(R&&R.hasData()){c[D.key]=D;continue}}else{const D=E.children(this._source.maxzoom);if(c[D[0].key]&&c[D[1].key]&&c[D[2].key]&&c[D[3].key])continue}let A=k.wasRequested();for(let D=E.overscaledZ-1;D>=g;--D){const R=E.scaledTo(D);if(p[R.key]||(p[R.key]=!0,k=this.getTile(R),!k&&A&&(k=this._addTile(R)),k&&(c[R.key]=R,A=k.wasRequested(),k.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let c,p=this._tiles[t].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;p=g}for(const g of s)this._loadedParentTiles[g]=c}}_addTile(t){let s=this._tiles[t.key];if(s)return s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const c=s;return s||(s=new On(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))),s.uses++,this._tiles[t.key]=s,c||this._source.fire(new l.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=s.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,s,c){const p=[],g=this.transform;if(!g)return p;const v=c?g.getCameraQueryGeometry(t):t,S=t.map($=>g.pointCoordinate($,this.terrain)),E=v.map($=>g.pointCoordinate($,this.terrain)),k=this.getIds();let A=1/0,D=1/0,R=-1/0,Z=-1/0;for(const $ of E)A=Math.min(A,$.x),D=Math.min(D,$.y),R=Math.max(R,$.x),Z=Math.max(Z,$.y);for(let $=0;$<k.length;$++){const G=this._tiles[k[$]];if(G.holdingForFade())continue;const te=G.tileID,se=Math.pow(2,g.zoom-G.tileID.overscaledZ),ce=s*G.queryPadding*l.EXTENT/G.tileSize/se,W=[te.getTilePoint(new l.MercatorCoordinate(A,D)),te.getTilePoint(new l.MercatorCoordinate(R,Z))];if(W[0].x-ce<l.EXTENT&&W[0].y-ce<l.EXTENT&&W[1].x+ce>=0&&W[1].y+ce>=0){const pe=S.map(_e=>te.getTilePoint(_e)),he=E.map(_e=>te.getTilePoint(_e));p.push({tile:G,tileID:te,queryGeometry:pe,cameraQueryGeometry:he,scale:se})}}return p}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(bs(this._source.type))for(const t in this._tiles){const s=this._tiles[t];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=l.exported.now())return!0}return!1}setFeatureState(t,s,c){this._state.updateState(t=t||"_geojsonTileLayer",s,c)}removeFeatureState(t,s,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,c)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,c){const p=this._tiles[t];p&&p.setDependencies(s,c)}reloadTilesForDependencies(t,s){for(const c in this._tiles)this._tiles[c].hasDependency(t,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,s))}}function Ao(h,t){const s=Math.abs(2*h.wrap)-+(h.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return h.overscaledZ-t.overscaledZ||c-s||t.canonical.y-h.canonical.y||t.canonical.x-h.canonical.x}function bs(h){return h==="raster"||h==="image"||h==="video"}tr.maxOverzooming=10,tr.maxUnderzooming=3;const gi="mapboxgl_preloaded_worker_pool";class pr{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<pr.workerCount;)this.workers.push(new Worker(uo.workerUrl));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[gi]}numActive(){return Object.keys(this.active).length}}const Ss=Math.floor(l.exported.hardwareConcurrency/2);let Bi;function Po(){return Bi||(Bi=new pr),Bi}function Mo(h,t){const s={};for(const c in h)c!=="ref"&&(s[c]=h[c]);return l.refProperties.forEach(c=>{c in t&&(s[c]=t[c])}),s}function Es(h){h=h.slice();const t=Object.create(null);for(let s=0;s<h.length;s++)t[h[s].id]=h[s];for(let s=0;s<h.length;s++)"ref"in h[s]&&(h[s]=Mo(h[s],t[h[s].ref]));return h}pr.workerCount=Math.max(Math.min(Ss,6),1);const kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ti(h,t,s){s.push({command:kt.addSource,args:[h,t[h]]})}function Fi(h,t,s){t.push({command:kt.removeSource,args:[h]}),s[h]=!0}function Oi(h,t,s,c){Fi(h,s,c),ti(h,t,s)}function Ts(h,t,s){let c;for(c in h[s])if(Object.prototype.hasOwnProperty.call(h[s],c)&&c!=="data"&&!ne(h[s][c],t[s][c]))return!1;for(c in t[s])if(Object.prototype.hasOwnProperty.call(t[s],c)&&c!=="data"&&!ne(h[s][c],t[s][c]))return!1;return!0}function yi(h,t,s,c,p,g){let v;for(v in t=t||{},h=h||{})Object.prototype.hasOwnProperty.call(h,v)&&(ne(h[v],t[v])||s.push({command:g,args:[c,v,t[v],p]}));for(v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(h,v)&&(ne(h[v],t[v])||s.push({command:g,args:[c,v,t[v],p]}))}function _i(h){return h.id}function Do(h,t){return h[t.id]=t,h}class vi{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.clamp(t,0,1);let s=1,c=this._distances[s];const p=t*this.paddedLength+this.padding;for(;c<p&&s<this._distances.length;)c=this._distances[++s];const g=s-1,v=this._distances[g],S=c-v,E=S>0?(p-v)/S:0;return this.points[g].mult(1-E).add(this.points[s].mult(E))}}function xe(h,t){let s=!0;return h==="always"||h!=="never"&&t!=="never"||(s=!1),s}class Oe{constructor(t,s,c){const p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(s/c);for(let v=0;v<this.xCellCount*this.yCellCount;v++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,c,p,g){this._forEachCell(s,c,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(t,s,c,p){this._forEachCell(s-p,c-p,s+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(c),this.circles.push(p)}_insertBoxCell(t,s,c,p,g,v){this.boxCells[g].push(v)}_insertCircleCell(t,s,c,p,g,v){this.circleCells[g].push(v)}_query(t,s,c,p,g,v,S){if(c<0||t>this.width||p<0||s>this.height)return[];const E=[];if(t<=0&&s<=0&&this.width<=c&&this.height<=p){if(g)return[{key:null,x1:t,y1:s,x2:c,y2:p}];for(let k=0;k<this.boxKeys.length;k++)E.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const A=this.circles[3*k],D=this.circles[3*k+1],R=this.circles[3*k+2];E.push({key:this.circleKeys[k],x1:A-R,y1:D-R,x2:A+R,y2:D+R})}}else this._forEachCell(t,s,c,p,this._queryCell,E,{hitTest:g,overlapMode:v,seenUids:{box:{},circle:{}}},S);return E}query(t,s,c,p){return this._query(t,s,c,p,!1,null)}hitTest(t,s,c,p,g,v){return this._query(t,s,c,p,!0,g,v).length>0}hitTestCircle(t,s,c,p,g){const v=t-c,S=t+c,E=s-c,k=s+c;if(S<0||v>this.width||k<0||E>this.height)return!1;const A=[];return this._forEachCell(v,E,S,k,this._queryCellCircle,A,{hitTest:!0,overlapMode:p,circle:{x:t,y:s,radius:c},seenUids:{box:{},circle:{}}},g),A.length>0}_queryCell(t,s,c,p,g,v,S,E){const{seenUids:k,hitTest:A,overlapMode:D}=S,R=this.boxCells[g];if(R!==null){const $=this.bboxes;for(const G of R)if(!k.box[G]){k.box[G]=!0;const te=4*G,se=this.boxKeys[G];if(t<=$[te+2]&&s<=$[te+3]&&c>=$[te+0]&&p>=$[te+1]&&(!E||E(se))&&(!A||!xe(D,se.overlapMode))&&(v.push({key:se,x1:$[te],y1:$[te+1],x2:$[te+2],y2:$[te+3]}),A))return!0}}const Z=this.circleCells[g];if(Z!==null){const $=this.circles;for(const G of Z)if(!k.circle[G]){k.circle[G]=!0;const te=3*G,se=this.circleKeys[G];if(this._circleAndRectCollide($[te],$[te+1],$[te+2],t,s,c,p)&&(!E||E(se))&&(!A||!xe(D,se.overlapMode))){const ce=$[te],W=$[te+1],pe=$[te+2];if(v.push({key:se,x1:ce-pe,y1:W-pe,x2:ce+pe,y2:W+pe}),A)return!0}}}return!1}_queryCellCircle(t,s,c,p,g,v,S,E){const{circle:k,seenUids:A,overlapMode:D}=S,R=this.boxCells[g];if(R!==null){const $=this.bboxes;for(const G of R)if(!A.box[G]){A.box[G]=!0;const te=4*G,se=this.boxKeys[G];if(this._circleAndRectCollide(k.x,k.y,k.radius,$[te+0],$[te+1],$[te+2],$[te+3])&&(!E||E(se))&&!xe(D,se.overlapMode))return v.push(!0),!0}}const Z=this.circleCells[g];if(Z!==null){const $=this.circles;for(const G of Z)if(!A.circle[G]){A.circle[G]=!0;const te=3*G,se=this.circleKeys[G];if(this._circlesCollide($[te],$[te+1],$[te+2],k.x,k.y,k.radius)&&(!E||E(se))&&!xe(D,se.overlapMode))return v.push(!0),!0}}}_forEachCell(t,s,c,p,g,v,S,E){const k=this._convertToXCellCoord(t),A=this._convertToYCellCoord(s),D=this._convertToXCellCoord(c),R=this._convertToYCellCoord(p);for(let Z=k;Z<=D;Z++)for(let $=A;$<=R;$++)if(g.call(this,t,s,c,p,this.xCellCount*$+Z,v,S,E))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,c,p,g,v){const S=p-t,E=g-s,k=c+v;return k*k>S*S+E*E}_circleAndRectCollide(t,s,c,p,g,v,S){const E=(v-p)/2,k=Math.abs(t-(p+E));if(k>E+c)return!1;const A=(S-g)/2,D=Math.abs(s-(g+A));if(D>A+c)return!1;if(k<=E||D<=A)return!0;const R=k-E,Z=D-A;return R*R+Z*Z<=c*c}}function to(h,t,s,c,p){const g=l.create();return t?(l.scale(g,g,[1/p,1/p,1]),s||l.rotateZ(g,g,c.angle)):l.multiply(g,c.labelPlaneMatrix,h),g}function Vr(h,t,s,c,p){if(t){const g=l.clone(h);return l.scale(g,g,[p,p,1]),s||l.rotateZ(g,g,-c.angle),g}return c.glCoordMatrix}function Ct(h,t,s){let c;s?(c=[h.x,h.y,s(h.x,h.y),1],l.transformMat4(c,c,t)):(c=[h.x,h.y,0,1],xi(c,c,t));const p=c[3];return{point:new l.pointGeometry(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function zr(h,t){return .5+h/t*.5}function fr(h,t){const s=h[0]/h[3],c=h[1]/h[3];return s>=-t[0]&&s<=t[0]&&c>=-t[1]&&c<=t[1]}function mr(h,t,s,c,p,g,v,S,E,k){const A=c?h.textSizeData:h.iconSizeData,D=l.evaluateSizeForZoom(A,s.transform.zoom),R=[256/s.width*2+1,256/s.height*2+1],Z=c?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Z.clear();const $=h.lineVertexArray,G=c?h.text.placedSymbolArray:h.icon.placedSymbolArray,te=s.transform.width/s.transform.height;let se=!1;for(let ce=0;ce<G.length;ce++){const W=G.get(ce);if(W.hidden||W.writingMode===l.WritingMode.vertical&&!se){dt(W.numGlyphs,Z);continue}let pe;if(se=!1,k?(pe=[W.anchorX,W.anchorY,k(W.anchorX,W.anchorY),1],l.transformMat4(pe,pe,t)):(pe=[W.anchorX,W.anchorY,0,1],xi(pe,pe,t)),!fr(pe,R)){dt(W.numGlyphs,Z);continue}const he=zr(s.transform.cameraToCenterDistance,pe[3]),_e=l.evaluateSizeForFeature(A,D,W),ve=v?_e/he:_e*he,ke=new l.pointGeometry(W.anchorX,W.anchorY),ye=Ct(ke,p,k).point,Ge={},Re=gt(W,ve,!1,S,t,p,g,h.glyphOffsetArray,$,Z,ye,ke,Ge,te,E,k);se=Re.useVertical,(Re.notEnoughRoom||se||Re.needsFlipping&&gt(W,ve,!0,S,t,p,g,h.glyphOffsetArray,$,Z,ye,ke,Ge,te,E,k).notEnoughRoom)&&dt(W.numGlyphs,Z)}c?h.text.dynamicLayoutVertexBuffer.updateData(Z):h.icon.dynamicLayoutVertexBuffer.updateData(Z)}function Ni(h,t,s,c,p,g,v,S,E,k,A,D,R){const Z=S.glyphStartIndex+S.numGlyphs,$=S.lineStartIndex,G=S.lineStartIndex+S.lineLength,te=t.getoffsetX(S.glyphStartIndex),se=t.getoffsetX(Z-1),ce=Dn(h*te,s,c,p,g,v,S.segment,$,G,E,k,A,D,R);if(!ce)return null;const W=Dn(h*se,s,c,p,g,v,S.segment,$,G,E,k,A,D,R);return W?{first:ce,last:W}:null}function Le(h,t,s,c){return h===l.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*c?{useVertical:!0}:(h===l.WritingMode.vertical?t.y<s.y:t.x>s.x)?{needsFlipping:!0}:null}function gt(h,t,s,c,p,g,v,S,E,k,A,D,R,Z,$,G){const te=t/24,se=h.lineOffsetX*te,ce=h.lineOffsetY*te;let W;if(h.numGlyphs>1){const pe=h.glyphStartIndex+h.numGlyphs,he=h.lineStartIndex,_e=h.lineStartIndex+h.lineLength,ve=Ni(te,S,se,ce,s,A,D,h,E,g,R,$,G);if(!ve)return{notEnoughRoom:!0};const ke=Ct(ve.first.point,v,G).point,ye=Ct(ve.last.point,v,G).point;if(c&&!s){const Ge=Le(h.writingMode,ke,ye,Z);if(Ge)return Ge}W=[ve.first];for(let Ge=h.glyphStartIndex+1;Ge<pe-1;Ge++)W.push(Dn(te*S.getoffsetX(Ge),se,ce,s,A,D,h.segment,he,_e,E,g,R,$,G));W.push(ve.last)}else{if(c&&!s){const he=Ct(D,p,G).point,_e=h.lineStartIndex+h.segment+1,ve=new l.pointGeometry(E.getx(_e),E.gety(_e)),ke=Ct(ve,p,G),ye=ke.signedDistanceFromCamera>0?ke.point:ft(D,ve,he,1,p,G),Ge=Le(h.writingMode,he,ye,Z);if(Ge)return Ge}const pe=Dn(te*S.getoffsetX(h.glyphStartIndex),se,ce,s,A,D,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,E,g,R,$,G);if(!pe)return{notEnoughRoom:!0};W=[pe]}for(const pe of W)l.addDynamicAttributes(k,pe.point,pe.angle);return{}}function ft(h,t,s,c,p,g){const v=Ct(h.add(h.sub(t)._unit()),p,g).point,S=s.sub(v);return s.add(S._mult(c/S.mag()))}function Dn(h,t,s,c,p,g,v,S,E,k,A,D,R,Z){const $=c?h-t:h+t;let G=$>0?1:-1,te=0;c&&(G*=-1,te=Math.PI),G<0&&(te+=Math.PI);let se=G>0?S+v:S+v+1,ce=p,W=p,pe=0,he=0;const _e=Math.abs($),ve=[];for(;pe+he<=_e;){if(se+=G,se<S||se>=E)return null;if(W=ce,ve.push(ce),ce=D[se],ce===void 0){const qe=new l.pointGeometry(k.getx(se),k.gety(se)),mt=Ct(qe,A,Z);if(mt.signedDistanceFromCamera>0)ce=D[se]=mt.point;else{const _t=se-G;ce=ft(pe===0?g:new l.pointGeometry(k.getx(_t),k.gety(_t)),qe,W,_e-pe+1,A,Z)}}pe+=he,he=W.dist(ce)}const ke=(_e-pe)/he,ye=ce.sub(W),Ge=ye.mult(ke)._add(W);Ge._add(ye._unit()._perp()._mult(s*G));const Re=te+Math.atan2(ce.y-W.y,ce.x-W.x);return ve.push(Ge),{point:Ge,angle:R?Re:0,path:ve}}const Ui=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function dt(h,t){for(let s=0;s<h;s++){const c=t.length;t.resize(c+4),t.float32.set(Ui,3*c)}}function xi(h,t,s){const c=t[0],p=t[1];return h[0]=s[0]*c+s[4]*p+s[12],h[1]=s[1]*c+s[5]*p+s[13],h[3]=s[3]*c+s[7]*p+s[15],h}const En=100;class Lo{constructor(t,s=new Oe(t.width+200,t.height+200,25),c=new Oe(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+En,this.screenBottomBoundary=t.height+En,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,s,c,p,g,v){const S=this.projectAndGetPerspectiveRatio(p,t.anchorPointX,t.anchorPointY,v),E=c*S.perspectiveRatio,k=t.x1*E+S.point.x,A=t.y1*E+S.point.y,D=t.x2*E+S.point.x,R=t.y2*E+S.point.y;return!this.isInsideGrid(k,A,D,R)||s!=="always"&&this.grid.hitTest(k,A,D,R,s,g)||S.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,A,D,R],offscreen:this.isOffscreen(k,A,D,R)}}placeCollisionCircles(t,s,c,p,g,v,S,E,k,A,D,R,Z,$){const G=[],te=new l.pointGeometry(s.anchorX,s.anchorY),se=Ct(te,v,$),ce=zr(this.transform.cameraToCenterDistance,se.signedDistanceFromCamera),W=(A?g/ce:g*ce)/l.ONE_EM,pe=Ct(te,S,$).point,he=Ni(W,p,s.lineOffsetX*W,s.lineOffsetY*W,!1,pe,te,s,c,S,{},!1,$);let _e=!1,ve=!1,ke=!0;if(he){const ye=.5*R*ce+Z,Ge=new l.pointGeometry(-100,-100),Re=new l.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),qe=new vi,mt=he.first,_t=he.last;let nt=[];for(let Et=mt.path.length-1;Et>=1;Et--)nt.push(mt.path[Et]);for(let Et=1;Et<_t.path.length;Et++)nt.push(_t.path[Et]);const Bt=2.5*ye;if(E){const Et=nt.map(At=>Ct(At,E,$));nt=Et.some(At=>At.signedDistanceFromCamera<=0)?[]:Et.map(At=>At.point)}let Ft=[];if(nt.length>0){const Et=nt[0].clone(),At=nt[0].clone();for(let Ut=1;Ut<nt.length;Ut++)Et.x=Math.min(Et.x,nt[Ut].x),Et.y=Math.min(Et.y,nt[Ut].y),At.x=Math.max(At.x,nt[Ut].x),At.y=Math.max(At.y,nt[Ut].y);Ft=Et.x>=Ge.x&&At.x<=Re.x&&Et.y>=Ge.y&&At.y<=Re.y?[nt]:At.x<Ge.x||Et.x>Re.x||At.y<Ge.y||Et.y>Re.y?[]:l.clipLine([nt],Ge.x,Ge.y,Re.x,Re.y)}for(const Et of Ft){qe.reset(Et,.25*ye);let At=0;At=qe.length<=.5*ye?1:Math.ceil(qe.paddedLength/Bt)+1;for(let Ut=0;Ut<At;Ut++){const kn=Ut/Math.max(At-1,1),oi=qe.lerp(kn),jr=oi.x+En,si=oi.y+En;G.push(jr,si,ye,0);const Hi=jr-ye,Pr=si-ye,rr=jr+ye,Si=si+ye;if(ke=ke&&this.isOffscreen(Hi,Pr,rr,Si),ve=ve||this.isInsideGrid(Hi,Pr,rr,Si),t!=="always"&&this.grid.hitTestCircle(jr,si,ye,t,D)&&(_e=!0,!k))return{circles:[],offscreen:!1,collisionDetected:_e}}}}return{circles:!k&&_e||!ve||ce<this.perspectiveRatioCutoff?[]:G,offscreen:ke,collisionDetected:_e}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,p=1/0,g=-1/0,v=-1/0;for(const A of t){const D=new l.pointGeometry(A.x+En,A.y+En);c=Math.min(c,D.x),p=Math.min(p,D.y),g=Math.max(g,D.x),v=Math.max(v,D.y),s.push(D)}const S=this.grid.query(c,p,g,v).concat(this.ignoredGrid.query(c,p,g,v)),E={},k={};for(const A of S){const D=A.key;if(E[D.bucketInstanceId]===void 0&&(E[D.bucketInstanceId]={}),E[D.bucketInstanceId][D.featureIndex])continue;const R=[new l.pointGeometry(A.x1,A.y1),new l.pointGeometry(A.x2,A.y1),new l.pointGeometry(A.x2,A.y2),new l.pointGeometry(A.x1,A.y2)];l.polygonIntersectsPolygon(s,R)&&(E[D.bucketInstanceId][D.featureIndex]=!0,k[D.bucketInstanceId]===void 0&&(k[D.bucketInstanceId]=[]),k[D.bucketInstanceId].push(D.featureIndex))}return k}insertCollisionBox(t,s,c,p,g,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:s},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,c,p,g,v){const S=c?this.ignoredGrid:this.grid,E={bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:s};for(let k=0;k<t.length;k+=4)S.insertCircle(E,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,s,c,p){let g;return p?(g=[s,c,p(s,c),1],l.transformMat4(g,g,t)):(g=[s,c,0,1],xi(g,g,t)),{point:new l.pointGeometry((g[0]/g[3]+1)/2*this.transform.width+En,(-g[1]/g[3]+1)/2*this.transform.height+En),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(t,s,c,p){return c<En||t>=this.screenRightBoundary||p<En||s>this.screenBottomBoundary}isInsideGrid(t,s,c,p){return c>=0&&t<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=l.identity([]);return l.translate(t,t,[-100,-100,0]),t}}function mn(h,t,s){return t*(l.EXTENT/(h.tileSize*Math.pow(2,s-h.tileID.overscaledZ)))}class Zn{constructor(t,s,c,p){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Nt{constructor(t,s,c,p,g){this.text=new Zn(t?t.text:null,s,c,g),this.icon=new Zn(t?t.icon:null,s,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ro{constructor(t,s,c){this.text=t,this.icon=s,this.skipFade=c}}class ni{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class no{constructor(t,s,c,p,g){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=g}}class ro{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[t]}}function Bo(h,t,s,c,p){const{horizontalAlign:g,verticalAlign:v}=l.getAnchorAlignment(h),S=-(g-.5)*t,E=-(v-.5)*s,k=l.evaluateVariableOffset(h,c);return new l.pointGeometry(S+k[0]*p,E+k[1]*p)}function io(h,t,s,c,p,g){const{x1:v,x2:S,y1:E,y2:k,anchorPointX:A,anchorPointY:D}=h,R=new l.pointGeometry(t,s);return c&&R._rotate(p?g:-g),{x1:v+R.x,y1:E+R.y,x2:S+R.x,y2:k+R.y,anchorPointX:A,anchorPointY:D}}class V{constructor(t,s,c,p,g){this.transform=t.clone(),this.terrain=s,this.collisionIndex=new Lo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new ro(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,c,p){const g=c.getBucket(s),v=c.latestFeatureIndex;if(!g||!v||s.id!==g.layerIds[0])return;const S=c.collisionBoxArray,E=g.layers[0].layout,k=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),A=c.tileSize/l.EXTENT,D=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),R=E.get("text-pitch-alignment")==="map",Z=E.get("text-rotation-alignment")==="map",$=mn(c,1,this.transform.zoom),G=to(D,R,Z,this.transform,$);let te=null;if(R){const ce=Vr(D,R,Z,this.transform,$);te=l.multiply([],this.transform.labelPlaneMatrix,ce)}this.retainedQueryData[g.bucketInstanceId]=new no(g.bucketInstanceId,v,g.sourceLayerIndex,g.index,c.tileID);const se={bucket:g,layout:E,posMatrix:D,textLabelPlaneMatrix:G,labelToScreenMatrix:te,scale:k,textPixelRatio:A,holdingForFade:c.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(const ce of g.sortKeyRanges){const{sortKey:W,symbolInstanceStart:pe,symbolInstanceEnd:he}=ce;t.push({sortKey:W,symbolInstanceStart:pe,symbolInstanceEnd:he,parameters:se})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:se})}attemptAnchorPlacement(t,s,c,p,g,v,S,E,k,A,D,R,Z,$,G,te){const se=[R.textOffset0,R.textOffset1],ce=Bo(t,c,p,se,g),W=this.collisionIndex.placeCollisionBox(io(s,ce.x,ce.y,v,S,this.transform.angle),D,E,k,A.predicate,te);if((!G||this.collisionIndex.placeCollisionBox(io(G,ce.x,ce.y,v,S,this.transform.angle),D,E,k,A.predicate,te).box.length!==0)&&W.box.length>0){let pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[R.crossTileID].anchor),R.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[R.crossTileID]={textOffset:se,width:c,height:p,anchor:t,textBoxScale:g,prevAnchor:pe},this.markUsedJustification(Z,t,R,$),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,$,R),this.placedOrientations[R.crossTileID]=$),{shift:ce,placedGlyphBoxes:W}}}placeLayerBucketPart(t,s,c){const{bucket:p,layout:g,posMatrix:v,textLabelPlaneMatrix:S,labelToScreenMatrix:E,textPixelRatio:k,holdingForFade:A,collisionBoxArray:D,partiallyEvaluatedTextSize:R,collisionGroup:Z}=t.parameters,$=g.get("text-optional"),G=g.get("icon-optional"),te=l.getOverlapMode(g,"text-overlap","text-allow-overlap"),se=te==="always",ce=l.getOverlapMode(g,"icon-overlap","icon-allow-overlap"),W=ce==="always",pe=g.get("text-rotation-alignment")==="map",he=g.get("text-pitch-alignment")==="map",_e=g.get("icon-text-fit")!=="none",ve=g.get("symbol-z-order")==="viewport-y",ke=se&&(W||!p.hasIconData()||G),ye=W&&(se||!p.hasTextData()||$);!p.collisionArrays&&D&&p.deserializeCollisionBoxes(D);const Ge=(Re,qe)=>{if(s[Re.crossTileID])return;if(A)return void(this.placements[Re.crossTileID]=new Ro(!1,!1,!1));let mt=!1,_t=!1,nt=!0,Bt=null,Ft={box:null,offscreen:null},Et={box:null,offscreen:null},At=null,Ut=null,kn=null,oi=0,jr=0,si=0;qe.textFeatureIndex?oi=qe.textFeatureIndex:Re.useRuntimeCollisionCircles&&(oi=Re.featureIndex),qe.verticalTextFeatureIndex&&(jr=qe.verticalTextFeatureIndex);const Hi=this.retainedQueryData[p.bucketInstanceId].tileID,Pr=this.terrain?(xn,xt)=>this.terrain.getElevation(Hi,xn,xt):null;for(const xn of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const xt=qe[xn];xt&&(xt.elevation=Pr?Pr(xt.anchorPointX,xt.anchorPointY):0)}const rr=qe.textBox;if(rr){const xn=Rt=>{let Cn=l.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Rt&&this.prevPlacement){const In=this.prevPlacement.placedOrientations[Re.crossTileID];In&&(this.placedOrientations[Re.crossTileID]=In,Cn=In,this.markUsedOrientation(p,Cn,Re))}return Cn},xt=(Rt,Cn)=>{if(p.allowVerticalPlacement&&Re.numVerticalGlyphVertices>0&&qe.verticalTextBox){for(const In of p.writingModes)if(In===l.WritingMode.vertical?(Ft=Cn(),Et=Ft):Ft=Rt(),Ft&&Ft.box&&Ft.box.length)break}else Ft=Rt()};if(g.get("text-variable-anchor")){let Rt=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Re.crossTileID]){const en=this.prevPlacement.variableOffsets[Re.crossTileID];Rt.indexOf(en.anchor)>0&&(Rt=Rt.filter(Mr=>Mr!==en.anchor),Rt.unshift(en.anchor))}const Cn=(en,Mr,co)=>{const eu=en.x2-en.x1,Xo=en.y2-en.y1,Xc=Re.textBoxScale,tu=_e&&ce==="never"?Mr:null;let Wi={box:[],offscreen:!1};const ho=te!=="never"?2*Rt.length:Rt.length;for(let po=0;po<ho;++po){const Ba=this.attemptAnchorPlacement(Rt[po%Rt.length],en,eu,Xo,Xc,pe,he,k,v,Z,po>=Rt.length?te:"never",Re,p,co,tu,Pr);if(Ba&&(Wi=Ba.placedGlyphBoxes,Wi&&Wi.box&&Wi.box.length)){mt=!0,Bt=Ba.shift;break}}return Wi};xt(()=>Cn(rr,qe.iconBox,l.WritingMode.horizontal),()=>{const en=qe.verticalTextBox;return p.allowVerticalPlacement&&!(Ft&&Ft.box&&Ft.box.length)&&Re.numVerticalGlyphVertices>0&&en?Cn(en,qe.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),Ft&&(mt=Ft.box,nt=Ft.offscreen);const In=xn(Ft&&Ft.box);if(!mt&&this.prevPlacement){const en=this.prevPlacement.variableOffsets[Re.crossTileID];en&&(this.variableOffsets[Re.crossTileID]=en,this.markUsedJustification(p,en.anchor,Re,In))}}else{const Rt=(Cn,In)=>{const en=this.collisionIndex.placeCollisionBox(Cn,te,k,v,Z.predicate,Pr);return en&&en.box&&en.box.length&&(this.markUsedOrientation(p,In,Re),this.placedOrientations[Re.crossTileID]=In),en};xt(()=>Rt(rr,l.WritingMode.horizontal),()=>{const Cn=qe.verticalTextBox;return p.allowVerticalPlacement&&Re.numVerticalGlyphVertices>0&&Cn?Rt(Cn,l.WritingMode.vertical):{box:null,offscreen:null}}),xn(Ft&&Ft.box&&Ft.box.length)}}if(At=Ft,mt=At&&At.box&&At.box.length>0,nt=At&&At.offscreen,Re.useRuntimeCollisionCircles){const xn=p.text.placedSymbolArray.get(Re.centerJustifiedTextSymbolIndex),xt=l.evaluateSizeForFeature(p.textSizeData,R,xn),Rt=g.get("text-padding");Ut=this.collisionIndex.placeCollisionCircles(te,xn,p.lineVertexArray,p.glyphOffsetArray,xt,v,S,E,c,he,Z.predicate,Re.collisionCircleDiameter,Rt,Pr),Ut.circles.length&&Ut.collisionDetected&&!c&&l.warnOnce("Collisions detected, but collision boxes are not shown"),mt=se||Ut.circles.length>0&&!Ut.collisionDetected,nt=nt&&Ut.offscreen}if(qe.iconFeatureIndex&&(si=qe.iconFeatureIndex),qe.iconBox){const xn=xt=>{const Rt=_e&&Bt?io(xt,Bt.x,Bt.y,pe,he,this.transform.angle):xt;return this.collisionIndex.placeCollisionBox(Rt,ce,k,v,Z.predicate,Pr)};Et&&Et.box&&Et.box.length&&qe.verticalIconBox?(kn=xn(qe.verticalIconBox),_t=kn.box.length>0):(kn=xn(qe.iconBox),_t=kn.box.length>0),nt=nt&&kn.offscreen}const Si=$||Re.numHorizontalGlyphVertices===0&&Re.numVerticalGlyphVertices===0,Ra=G||Re.numIconVertices===0;if(Si||Ra?Ra?Si||(_t=_t&&mt):mt=_t&&mt:_t=mt=_t&&mt,mt&&At&&At.box&&this.collisionIndex.insertCollisionBox(At.box,te,g.get("text-ignore-placement"),p.bucketInstanceId,Et&&Et.box&&jr?jr:oi,Z.ID),_t&&kn&&this.collisionIndex.insertCollisionBox(kn.box,ce,g.get("icon-ignore-placement"),p.bucketInstanceId,si,Z.ID),Ut&&(mt&&this.collisionIndex.insertCollisionCircles(Ut.circles,te,g.get("text-ignore-placement"),p.bucketInstanceId,oi,Z.ID),c)){const xn=p.bucketInstanceId;let xt=this.collisionCircleArrays[xn];xt===void 0&&(xt=this.collisionCircleArrays[xn]=new ni);for(let Rt=0;Rt<Ut.circles.length;Rt+=4)xt.circles.push(Ut.circles[Rt+0]),xt.circles.push(Ut.circles[Rt+1]),xt.circles.push(Ut.circles[Rt+2]),xt.circles.push(Ut.collisionDetected?1:0)}if(Re.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Re.crossTileID]=new Ro(mt||ke,_t||ye,nt||p.justReloaded),s[Re.crossTileID]=!0};if(ve){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Re=p.getSortedSymbolIndexes(this.transform.angle);for(let qe=Re.length-1;qe>=0;--qe){const mt=Re[qe];Ge(p.symbolInstances.get(mt),p.collisionArrays[mt])}}else for(let Re=t.symbolInstanceStart;Re<t.symbolInstanceEnd;Re++)Ge(p.symbolInstances.get(Re),p.collisionArrays[Re]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[p.bucketInstanceId];l.invert(Re.invProjMatrix,v),Re.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(t,s,c,p){let g;g=p===l.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(s)];const v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const S of v)S>=0&&(t.text.placedSymbolArray.get(S).crossTileID=g>=0&&S!==g?0:c.crossTileID)}markUsedOrientation(t,s,c){const p=s===l.WritingMode.horizontal||s===l.WritingMode.horizontalOnly?s:0,g=s===l.WritingMode.vertical?s:0,v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const S of v)t.text.placedSymbolArray.get(S).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(t):1,g=s?s.opacities:{},v=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(const E in this.placements){const k=this.placements[E],A=g[E];A?(this.opacities[E]=new Nt(A,p,k.text,k.icon),c=c||k.text!==A.text.placed||k.icon!==A.icon.placed):(this.opacities[E]=new Nt(null,p,k.text,k.icon,k.skipFade),c=c||k.text||k.icon)}for(const E in g){const k=g[E];if(!this.opacities[E]){const A=new Nt(k,p,!1,!1);A.isHidden()||(this.opacities[E]=A,c=c||k.text.placed||k.icon.placed)}}for(const E in v)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=v[E]);for(const E in S)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=S[E]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const c={};for(const p of s){const g=p.getBucket(t);g&&p.latestFeatureIndex&&t.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,p.collisionBoxArray)}}updateBucketOpacities(t,s,c){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0].layout,g=new Nt(null,0,!1,!1,!0),v=p.get("text-allow-overlap"),S=p.get("icon-allow-overlap"),E=p.get("text-variable-anchor"),k=p.get("text-rotation-alignment")==="map",A=p.get("text-pitch-alignment")==="map",D=p.get("icon-text-fit")!=="none",R=new Nt(null,0,v&&(S||!t.hasIconData()||p.get("icon-optional")),S&&(v||!t.hasTextData()||p.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const Z=($,G,te)=>{for(let se=0;se<G/4;se++)$.opacityVertexArray.emplaceBack(te)};for(let $=0;$<t.symbolInstances.length;$++){const G=t.symbolInstances.get($),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:se,crossTileID:ce}=G;let W=this.opacities[ce];s[ce]?W=g:W||(W=R,this.opacities[ce]=W),s[ce]=!0;const pe=G.numIconVertices>0,he=this.placedOrientations[G.crossTileID],_e=he===l.WritingMode.vertical,ve=he===l.WritingMode.horizontal||he===l.WritingMode.horizontalOnly;if(te>0||se>0){const ke=oe(W.text);Z(t.text,te,_e?ge:ke),Z(t.text,se,ve?ge:ke);const ye=W.text.isHidden();[G.rightJustifiedTextSymbolIndex,G.centerJustifiedTextSymbolIndex,G.leftJustifiedTextSymbolIndex].forEach(qe=>{qe>=0&&(t.text.placedSymbolArray.get(qe).hidden=ye||_e?1:0)}),G.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(G.verticalPlacedTextSymbolIndex).hidden=ye||ve?1:0);const Ge=this.variableOffsets[G.crossTileID];Ge&&this.markUsedJustification(t,Ge.anchor,G,he);const Re=this.placedOrientations[G.crossTileID];Re&&(this.markUsedJustification(t,"left",G,Re),this.markUsedOrientation(t,Re,G))}if(pe){const ke=oe(W.icon),ye=!(D&&G.verticalPlacedIconSymbolIndex&&_e);G.placedIconSymbolIndex>=0&&(Z(t.icon,G.numIconVertices,ye?ke:ge),t.icon.placedSymbolArray.get(G.placedIconSymbolIndex).hidden=W.icon.isHidden()),G.verticalPlacedIconSymbolIndex>=0&&(Z(t.icon,G.numVerticalIconVertices,ye?ge:ke),t.icon.placedSymbolArray.get(G.verticalPlacedIconSymbolIndex).hidden=W.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const ke=t.collisionArrays[$];if(ke){let ye=new l.pointGeometry(0,0);if(ke.textBox||ke.verticalTextBox){let Re=!0;if(E){const qe=this.variableOffsets[ce];qe?(ye=Bo(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textBoxScale),k&&ye._rotate(A?this.transform.angle:-this.transform.angle)):Re=!1}ke.textBox&&C(t.textCollisionBox.collisionVertexArray,W.text.placed,!Re||_e,ye.x,ye.y),ke.verticalTextBox&&C(t.textCollisionBox.collisionVertexArray,W.text.placed,!Re||ve,ye.x,ye.y)}const Ge=Boolean(!ve&&ke.verticalIconBox);ke.iconBox&&C(t.iconCollisionBox.collisionVertexArray,W.icon.placed,Ge,D?ye.x:0,D?ye.y:0),ke.verticalIconBox&&C(t.iconCollisionBox.collisionVertexArray,W.icon.placed,!Ge,D?ye.x:0,D?ye.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const $=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=$.invProjMatrix,t.placementViewportMatrix=$.viewportMatrix,t.collisionCircleArray=$.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function C(h,t,s,c,p){h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0)}const M=Math.pow(2,25),O=Math.pow(2,24),U=Math.pow(2,17),Y=Math.pow(2,16),ie=Math.pow(2,9),Q=Math.pow(2,8),J=Math.pow(2,1);function oe(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const t=h.placed?1:0,s=Math.floor(127*h.opacity);return s*M+t*O+s*U+t*Y+s*ie+t*Q+s*J+t}const ge=0;class Ee{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,c,p,g){const v=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(v,p,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((S,E)=>S.sortKey-E.sortKey));this._currentPartIndex<v.length;)if(s.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,g())return!0;return!1}}class me{constructor(t,s,c,p,g,v,S,E){this.placement=new V(t,s,v,S,E),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,s,c){const p=l.exported.now(),g=()=>{const v=l.exported.now()-p;return!this._forceFullPlacement&&v>2};for(;this._currentPlacementIndex>=0;){const v=s[t[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=S)&&(!v.maxzoom||v.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Ee(v)),this._inProgressLayer.continuePlacement(c[v.source],this.placement,this._showCollisionBoxes,v,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ke=512/l.EXTENT/2;class Je{constructor(t,s,c){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(let p=0;p<s.length;p++){const g=s.get(p),v=g.key;this.indexedSymbolInstances[v]||(this.indexedSymbolInstances[v]=[]),this.indexedSymbolInstances[v].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,t)})}}getScaledCoordinates(t,s){const c=Ke/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*l.EXTENT+t.anchorX)*c),y:Math.floor((s.canonical.y*l.EXTENT+t.anchorY)*c)}}findMatches(t,s,c){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let g=0;g<t.length;g++){const v=t.get(g);if(v.crossTileID)continue;const S=this.indexedSymbolInstances[v.key];if(!S)continue;const E=this.getScaledCoordinates(v,s);for(const k of S)if(Math.abs(k.coord.x-E.x)<=p&&Math.abs(k.coord.y-E.y)<=p&&!c[k.crossTileID]){c[k.crossTileID]=!0,v.crossTileID=k.crossTileID;break}}}}class je{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class it{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const c in this.indexes){const p=this.indexes[c],g={};for(const v in p){const S=p[v];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),g[S.tileID.key]=S}this.indexes[c]=g}this.lng=t}addBucket(t,s,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let g=0;g<s.symbolInstances.length;g++)s.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const p=this.usedCrossTileIDs[t.overscaledZ];for(const g in this.indexes){const v=this.indexes[g];if(Number(g)>t.overscaledZ)for(const S in v){const E=v[S];E.tileID.isChildOf(t)&&E.findMatches(s.symbolInstances,t,p)}else{const S=v[t.scaledTo(Number(g)).key];S&&S.findMatches(s.symbolInstances,t,p)}}for(let g=0;g<s.symbolInstances.length;g++){const v=s.symbolInstances.get(g);v.crossTileID||(v.crossTileID=c.generate(),p[v.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Je(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const c in s.indexedSymbolInstances)for(const p of s.indexedSymbolInstances[c])delete this.usedCrossTileIDs[t][p.crossTileID]}removeStaleBuckets(t){let s=!1;for(const c in this.indexes){const p=this.indexes[c];for(const g in p)t[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[g]),delete p[g],s=!0)}return s}}class ut{constructor(){this.layerIndexes={},this.crossTileIDs=new je,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,c){let p=this.layerIndexes[t.id];p===void 0&&(p=this.layerIndexes[t.id]=new it);let g=!1;const v={};p.handleWrapJump(c);for(const S of s){const E=S.getBucket(t);E&&t.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(S.tileID,E,this.crossTileIDs)&&(g=!0),v[E.bucketInstanceId]=!0)}return p.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(t){const s={};t.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}var It=l.createLayout([{name:"a_pos",type:"Int16",components:2}]);class ht extends l.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=t._cache.max,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const t in this._tiles){const s=this._tiles[t];s.textures.forEach(c=>c.destroy()),s.textures=[]}}update(t,s){this.sourceCache.update(t,s),this._renderableTilesKeys=[];for(const c of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),l.ortho(c.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[c.key]=new On(c,this.tileSize))}removeOutdated(t){const s={};this.renderHistory=this.renderHistory.filter((c,p)=>this.renderHistory.indexOf(c)===p).slice(0,this.renderHistorySize);for(const c of this._renderableTilesKeys)s[c]=!0;for(const c of this.renderHistory)s[c]=!0;for(const c in this._tiles)s[c]||(this._tiles[c].clearTextures(t),delete this._tiles[c])}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const s={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16),l.ortho(g.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),s[c]=g}else if(p.canonical.isChildOf(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const v=p.canonical.z-t.canonical.z,S=p.canonical.x-(p.canonical.x>>v<<v),E=p.canonical.y-(p.canonical.y>>v<<v),k=l.EXTENT>>v;l.ortho(g.posMatrix,0,k,0,k,0,1),l.translate(g.posMatrix,g.posMatrix,[-S*k,-E*k,0]),s[c]=g}else if(t.canonical.isChildOf(p.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const v=t.canonical.z-p.canonical.z,S=t.canonical.x-(t.canonical.x>>v<<v),E=t.canonical.y-(t.canonical.y>>v<<v),k=l.EXTENT>>v;l.ortho(g.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(g.posMatrix,g.posMatrix,[S*k,E*k,0]),l.scale(g.posMatrix,g.posMatrix,[1/2**v,1/2**v,0]),s[c]=g}}return s}getSourceTile(t,s){const c=this.sourceCache._source;let p=t.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!g||!g.dem)&&s)for(;p>=c.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(t.scaledTo(p--).key);return g}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(s=>s.timeLoaded>=t)}}class yt{constructor(t,s,c){this.style=t,this.sourceCache=new ht(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.elevationOffset=typeof c.elevationOffset=="number"?c.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(t,s,c,p=l.EXTENT){if(!(s>=0&&s<p&&c>=0&&c<p))return this.elevationOffset;let g=0;const v=this.getTerrainData(t);if(v.tile&&v.tile.dem){const S=l.transformMat4$1([],[s/p*l.EXTENT,c/p*l.EXTENT],v.u_terrain_matrix),E=[S[0]*v.tile.dem.dim,S[1]*v.tile.dem.dim],k=[Math.floor(E[0]),Math.floor(E[1])],A=v.tile.dem.get(k[0],k[1]),D=v.tile.dem.get(k[0],k[1]+1),R=v.tile.dem.get(k[0]+1,k[1]),Z=v.tile.dem.get(k[0]+1,k[1]+1);g=l.number(l.number(A,D,E[0]-k[0]),l.number(R,Z,E[0]-k[0]),E[1]-k[1])}return g}rememberForRerender(t,s){for(const c in this.sourceCache._tiles){const p=this.sourceCache._tiles[c];(p.tileID.equals(s)||p.tileID.isChildOf(s))&&(t===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[t]=this._rerender[t]||{},this._rerender[t][p.tileID.key]=!0)}}needsRerender(t,s){return this._rerender[t]&&this._rerender[t][s.key]}clearRerenderCache(){this._rerender={}}getElevation(t,s,c,p=l.EXTENT){return(this.getDEMElevation(t,s,c,p)+this.elevationOffset)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const p=this.style.map.painter.context,g=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ie(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ie(p,new l.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const s=this.sourceCache.getSourceTile(t,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.style.map.painter.context;s.demTexture=this.style.map.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new Ie(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let g=t.canonical.z-s.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=p?g=t.canonical.z-p:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=t.canonical.x-(t.canonical.x>>g<<g),S=t.canonical.y-(t.canonical.y>>g<<g),E=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<g),1/(l.EXTENT<<g),0]);l.translate(E,E,[v*l.EXTENT,S*l.EXTENT,0]),this._demMatrixCache[t.key]={matrix:E,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getRTTFramebuffer(){const t=this.style.map.painter;if(!this._rttFramebuffer){const s=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=t.context.createFramebuffer(s,s,!0),this._rttFramebuffer.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,s,s))}return this._rttFramebuffer}getFramebuffer(t){const s=this.style.map.painter,c=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ie(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ie(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,p,!0),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,v=0;g<this._coordsTextureSize;g++)for(let S=0;S<this._coordsTextureSize;S++,v+=4)s[v+0]=255&S,s[v+1]=255&g,s[v+2]=S>>8<<4|g>>8,s[v+3]=0;const c=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new Ie(t,c,t.gl.RGBA,{premultiply:!1});return p.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(t){const s=new Uint8Array(4),c=this.style.map.painter,p=c.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(t.x,c.height/devicePixelRatio-t.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),p.bindFramebuffer.set(null);const v=s[0]+(s[2]>>4<<8),S=s[1]+((15&s[2])<<8),E=this.coordsIndex[255-s[3]],k=E&&this.sourceCache.getTileByID(E);if(!k)return null;const A=this._coordsTextureSize,D=(1<<k.tileID.canonical.z)*A;return new l.MercatorCoordinate((k.tileID.canonical.x*A+v)/D,(k.tileID.canonical.y*A+S)/D,this.getElevation(k.tileID,v,S,A))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.style.map.painter.context,s=new l.PosArray,c=new l.TriangleIndexArray,p=this.meshSize,g=l.EXTENT/p,v=p*p;for(let S=0;S<=p;S++)for(let E=0;E<=p;E++)s.emplaceBack(E*g,S*g);for(let S=0;S<v;S+=p+1)for(let E=0;E<p;E++)c.emplaceBack(E+S,p+E+S+1,p+E+S+2),c.emplaceBack(E+S,p+E+S+2,E+S+1);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(s,It.members),segments:l.SegmentVector.simpleSegment(0,0,s.length,c.length)},this._mesh}getMinMaxElevation(t){const s=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=(s.dem.min+this.elevationOffset)*this.exaggeration,c.maxElevation=(s.dem.max+this.elevationOffset)*this.exaggeration),c}}const zt=(h,t)=>l.emitValidationErrors(h,t&&t.filter(s=>s.identifier!=="source.canvas")),$t=l.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Tn=l.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),Kt=function(){const h={},t=l.spec.$version;for(const s in l.spec.$root){const c=l.spec.$root[s];if(c.required){let p=null;p=s==="version"?t:c.type==="array"?[]:{},p!=null&&(h[s]=p)}}return h}();class Nn extends l.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new st(Po(),this),this.imageManager=new ee,this.imageManager.setEventedParent(this),this.glyphManager=new ze(t._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Mt(256,512),this.crossTileSymbolIndex=new ut,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const c=this;this._rtlTextPluginCallback=Nn.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(g,v)=>{if(l.triggerPluginCompletionEvent(g),v&&v.every(S=>S))for(const S in c.sourceCaches)c.sourceCaches[S].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const g=this.sourceCaches[p.sourceId];if(!g)return;const v=g.getSource();if(v&&v.vectorLayerIds)for(const S in this._layers){const E=this._layers[S];E.source===v.id&&this._validateLayer(E)}})}loadURL(t,s={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const c=typeof s.validate!="boolean"||s.validate,p=this.map._requestManager.transformRequest(t,l.ResourceType.Style);this._request=l.getJSON(p,(g,v)=>{this._request=null,g?this.fire(new l.ErrorEvent(g)):v&&this._load(v,c)})}loadJSON(t,s={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(t,s.validate!==!1)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Kt,!1)}_load(t,s){if(s&&zt(this,l.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t;for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);const c=Es(this.stylesheet.layers);this._order=c.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of c)p=l.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Fe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}_loadSprite(t){this._spriteRequest=function(s,c,p,g){let v,S,E;const k=p>1?"@2x":"";let A=l.getJSON(c.transformRequest(c.normalizeSpriteURL(s,k,".json"),l.ResourceType.SpriteJSON),(Z,$)=>{A=null,E||(E=Z,v=$,R())}),D=l.getImage(c.transformRequest(c.normalizeSpriteURL(s,k,".png"),l.ResourceType.SpriteImage),(Z,$)=>{D=null,E||(E=Z,S=$,R())});function R(){if(E)g(E);else if(v&&S){const Z=l.exported.getImageData(S),$={};for(const G in v){const{width:te,height:se,x:ce,y:W,sdf:pe,pixelRatio:he,stretchX:_e,stretchY:ve,content:ke}=v[G],ye=new l.RGBAImage({width:te,height:se});l.RGBAImage.copy(Z,ye,{x:ce,y:W},{x:0,y:0},{width:te,height:se}),$[G]={data:ye,pixelRatio:he,sdf:pe,stretchX:_e,stretchY:ve,content:ke}}g(null,$)}}return{cancel(){A&&(A.cancel(),A=null),D&&(D.cancel(),D=null)}}}(t,this.map._requestManager,this.map.getPixelRatio(),(s,c)=>{if(this._spriteRequest=null,s)this.fire(new l.ErrorEvent(s));else if(c)for(const p in c)this.imageManager.addImage(p,c[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(t){const s=this.sourceCaches[t.source];if(!s)return;const c=t.sourceLayer;if(!c)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const s=[];for(const c of t){const p=this._layers[c];p.type!=="custom"&&s.push(p.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(const v in this._updatedSources){const S=this._updatedSources[v];if(S==="reload")this._reloadSource(v);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(v)}}this._updateTilesForChangedImages();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const g=this.sourceCaches[p];c[p]=g.used,g.used=!1}for(const p of this._order){const g=this._layers[p];g.recalculate(t,this._availableImages),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const p in c){const g=this.sourceCaches[p];c[p]!==g.used&&g.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(t),this.z=t.zoom,s&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(t){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),t){const s=this.sourceCaches[t.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);this.terrain=new yt(this,s,t),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=c=>{c.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=c=>{c.tile&&(c.sourceId===t.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(c.sourceId,c.tile.tileID)):c.source.type==="geojson"&&this.terrain.rememberForRerender(c.sourceId,c.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new l.Event("terrain",{terrain:t}))}setState(t){if(this._checkLoaded(),zt(this,l.validateStyle(t)))return!1;(t=l.clone$1(t)).layers=Es(t.layers);const s=function(p,g){if(!p)return[{command:kt.setStyle,args:[g]}];let v=[];try{if(!ne(p.version,g.version))return[{command:kt.setStyle,args:[g]}];ne(p.center,g.center)||v.push({command:kt.setCenter,args:[g.center]}),ne(p.zoom,g.zoom)||v.push({command:kt.setZoom,args:[g.zoom]}),ne(p.bearing,g.bearing)||v.push({command:kt.setBearing,args:[g.bearing]}),ne(p.pitch,g.pitch)||v.push({command:kt.setPitch,args:[g.pitch]}),ne(p.sprite,g.sprite)||v.push({command:kt.setSprite,args:[g.sprite]}),ne(p.glyphs,g.glyphs)||v.push({command:kt.setGlyphs,args:[g.glyphs]}),ne(p.transition,g.transition)||v.push({command:kt.setTransition,args:[g.transition]}),ne(p.light,g.light)||v.push({command:kt.setLight,args:[g.light]});const S={},E=[];(function(A,D,R,Z){let $;for($ in D=D||{},A=A||{})Object.prototype.hasOwnProperty.call(A,$)&&(Object.prototype.hasOwnProperty.call(D,$)||Fi($,R,Z));for($ in D)Object.prototype.hasOwnProperty.call(D,$)&&(Object.prototype.hasOwnProperty.call(A,$)?ne(A[$],D[$])||(A[$].type==="geojson"&&D[$].type==="geojson"&&Ts(A,D,$)?R.push({command:kt.setGeoJSONSourceData,args:[$,D[$].data]}):Oi($,D,R,Z)):ti($,D,R))})(p.sources,g.sources,E,S);const k=[];p.layers&&p.layers.forEach(A=>{S[A.source]?v.push({command:kt.removeLayer,args:[A.id]}):k.push(A)}),v=v.concat(E),function(A,D,R){D=D||[];const Z=(A=A||[]).map(_i),$=D.map(_i),G=A.reduce(Do,{}),te=D.reduce(Do,{}),se=Z.slice(),ce=Object.create(null);let W,pe,he,_e,ve,ke,ye;for(W=0,pe=0;W<Z.length;W++)he=Z[W],Object.prototype.hasOwnProperty.call(te,he)?pe++:(R.push({command:kt.removeLayer,args:[he]}),se.splice(se.indexOf(he,pe),1));for(W=0,pe=0;W<$.length;W++)he=$[$.length-1-W],se[se.length-1-W]!==he&&(Object.prototype.hasOwnProperty.call(G,he)?(R.push({command:kt.removeLayer,args:[he]}),se.splice(se.lastIndexOf(he,se.length-pe),1)):pe++,ke=se[se.length-W],R.push({command:kt.addLayer,args:[te[he],ke]}),se.splice(se.length-W,0,he),ce[he]=!0);for(W=0;W<$.length;W++)if(he=$[W],_e=G[he],ve=te[he],!ce[he]&&!ne(_e,ve))if(ne(_e.source,ve.source)&&ne(_e["source-layer"],ve["source-layer"])&&ne(_e.type,ve.type)){for(ye in yi(_e.layout,ve.layout,R,he,null,kt.setLayoutProperty),yi(_e.paint,ve.paint,R,he,null,kt.setPaintProperty),ne(_e.filter,ve.filter)||R.push({command:kt.setFilter,args:[he,ve.filter]}),ne(_e.minzoom,ve.minzoom)&&ne(_e.maxzoom,ve.maxzoom)||R.push({command:kt.setLayerZoomRange,args:[he,ve.minzoom,ve.maxzoom]}),_e)Object.prototype.hasOwnProperty.call(_e,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?yi(_e[ye],ve[ye],R,he,ye.slice(6),kt.setPaintProperty):ne(_e[ye],ve[ye])||R.push({command:kt.setLayerProperty,args:[he,ye,ve[ye]]}));for(ye in ve)Object.prototype.hasOwnProperty.call(ve,ye)&&!Object.prototype.hasOwnProperty.call(_e,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?yi(_e[ye],ve[ye],R,he,ye.slice(6),kt.setPaintProperty):ne(_e[ye],ve[ye])||R.push({command:kt.setLayerProperty,args:[he,ye,ve[ye]]}))}else R.push({command:kt.removeLayer,args:[he]}),ke=se[se.lastIndexOf(he)+1],R.push({command:kt.addLayer,args:[ve,ke]})}(k,g.layers,v)}catch(S){console.warn("Unable to compute style diff:",S),v=[{command:kt.setStyle,args:[g]}]}return v}(this.serialize(),t).filter(p=>!(p.command in Tn));if(s.length===0)return!1;const c=s.filter(p=>!(p.command in $t));if(c.length>0)throw new Error(`Unimplemented: ${c.map(p=>p.command).join(", ")}.`);return s.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=t,!0}addImage(t,s){if(this.getImage(t))return this.fire(new l.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,s),this._afterImageUpdated(t)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,s,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.validateStyle.source,`sources.${t}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[t]=new tr(t,s,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:t})),p.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new l.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],s.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,s){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,s,c={}){this._checkLoaded();const p=t.id;if(this.getLayer(p))return void this.fire(new l.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let g;if(t.type==="custom"){if(zt(this,l.validateCustomStyleLayer(t)))return;g=l.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(p,t.source),t=l.clone$1(t),t=l.extend(t,{source:p})),this._validate(l.validateStyle.layer,`layers.${p}`,t,{arrayIndex:-1},c))return;g=l.createStyleLayer(t),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[g.id]=g.serialize()}const v=s?this._order.indexOf(s):this._order.length;if(s&&v===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(v,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){const S=this._removedLayers[p];delete this._removedLayers[p],S.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const c=this._order.indexOf(t);this._order.splice(c,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${s}".`))):(this._order.splice(p,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));s.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,s,c){this._checkLoaded();const p=this.getLayer(t);p?p.minzoom===s&&p.maxzoom===c||(s!=null&&(p.minzoom=s),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,s,c={}){this._checkLoaded();const p=this.getLayer(t);if(p){if(!ne(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(l.validateStyle.filter,`layers.${p.id}.filter`,s,null,c)||(p.filter=l.clone$1(s),this._updateLayer(p)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,s,c,p={}){this._checkLoaded();const g=this.getLayer(t);g?ne(g.getLayoutProperty(s),c)||(g.setLayoutProperty(s,c,p),this._updateLayer(g)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,s){const c=this.getLayer(t);if(c)return c.getLayoutProperty(s);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,s,c,p={}){this._checkLoaded();const g=this.getLayer(t);g?ne(g.getPaintProperty(s),c)||(g.setPaintProperty(s,c,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,s){return this.getLayer(t).getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const c=t.source,p=t.sourceLayer,g=this.sourceCaches[c];if(g===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const v=g.getSource().type;v==="geojson"&&p?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||p?(t.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,t.id,s)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,s){this._checkLoaded();const c=t.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const g=p.getSource().type,v=g==="vector"?t.sourceLayer:void 0;g!=="vector"||v?s&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(v,t.id,s):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const s=t.source,c=t.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,t.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,t=>t.serialize()),layers:this._serializeLayers(this._order)},t=>t!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const s=v=>this._layers[v].type==="fill-extrusion",c={},p=[];for(let v=this._order.length-1;v>=0;v--){const S=this._order[v];if(s(S)){c[S]=v;for(const E of t){const k=E[S];if(k)for(const A of k)p.push(A)}}}p.sort((v,S)=>S.intersectionZ-v.intersectionZ);const g=[];for(let v=this._order.length-1;v>=0;v--){const S=this._order[v];if(s(S))for(let E=p.length-1;E>=0;E--){const k=p[E].feature;if(c[k.layer.id]<v)break;g.push(k),p.pop()}else for(const E of t){const k=E[S];if(k)for(const A of k)g.push(A.feature)}}return g}queryRenderedFeatures(t,s,c){s&&s.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const v of s.layers){const S=this._layers[v];if(!S)return this.fire(new l.ErrorEvent(new Error(`The layer '${v}' does not exist in the map's style and cannot be queried for features.`))),[];p[S.source]=!0}}const g=[];s.availableImages=this._availableImages;for(const v in this.sourceCaches)s.layers&&!p[v]||g.push(Qn(this.sourceCaches[v],this._layers,this._serializedLayers,t,s,c));return this.placement&&g.push(function(v,S,E,k,A,D,R){const Z={},$=D.queryRenderedSymbols(k),G=[];for(const te of Object.keys($).map(Number))G.push(R[te]);G.sort(er);for(const te of G){const se=te.featureIndex.lookupSymbolFeatures($[te.bucketInstanceId],S,te.bucketIndex,te.sourceLayerIndex,A.filter,A.layers,A.availableImages,v);for(const ce in se){const W=Z[ce]=Z[ce]||[],pe=se[ce];pe.sort((he,_e)=>{const ve=te.featureSortOrder;if(ve){const ke=ve.indexOf(he.featureIndex);return ve.indexOf(_e.featureIndex)-ke}return _e.featureIndex-he.featureIndex});for(const he of pe)W.push(he)}}for(const te in Z)Z[te].forEach(se=>{const ce=se.feature,W=E[v[te].source].getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=W});return Z}(this._layers,this._serializedLayers,this.sourceCaches,t,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(t,s){s&&s.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[t];return c?function(p,g){const v=p.getRenderableIds().map(k=>p.getTileByID(k)),S=[],E={};for(let k=0;k<v.length;k++){const A=v[k],D=A.tileID.canonical.key;E[D]||(E[D]=!0,A.querySourceFeatures(S,g))}return S}(c,s):[]}addSourceType(t,s,c){return Nn.getSourceType(t)?c(new Error(`A source type called "${t}" already exists.`)):(Nn.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const v in t)if(!ne(t[v],c[v])){p=!0;break}if(!p)return;const g={now:l.exported.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(g)}_validate(t,s,c,p,g={}){return(!g||g.validate!==!1)&&zt(this,t.call(l.validateStyle,l.extend({key:s,style:this.serialize(),value:c,styleSpec:l.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const s=this.sourceCaches[t];s.setEventedParent(null),s.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const s in this.sourceCaches)this.sourceCaches[s].update(t,this.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,s,c,p,g=!1){let v=!1,S=!1;const E={};for(const k of this._order){const A=this._layers[k];if(A.type!=="symbol")continue;if(!E[A.source]){const R=this.sourceCaches[A.source];E[A.source]=R.getRenderableIds(!0).map(Z=>R.getTileByID(Z)).sort((Z,$)=>$.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan($.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(A,E[A.source],t.center.lng);v=v||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),t.zoom))&&(this.pauseablePlacement=new me(t,this.terrain,this._order,g,s,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),S=!0),v&&this.pauseablePlacement.placement.setStale()),S||v)for(const k of this._order){const A=this._layers[k];A.type==="symbol"&&this.placement.updateLayerOpacities(A,E[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,c){this.imageManager.getImages(s.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(t,s,c){this.glyphManager.getGlyphs(s.stacks,c)}getResource(t,s,c){return l.makeRequest(s,c)}}Nn.getSourceType=function(h){return Xt[h]},Nn.setSourceType=function(h,t){Xt[h]=t},Nn.registerForPluginStateChange=l.registerForPluginStateChange;var Fo="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const ks={prelude:jt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:jt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:jt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:jt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:jt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:jt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:jt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:jt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:jt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:jt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:jt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:jt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:jt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:jt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:jt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:jt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:jt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:jt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:jt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:jt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:jt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:jt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:jt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:jt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:jt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:jt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Fo),terrainDepth:jt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Fo),terrainCoords:jt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Fo)};function jt(h,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=g?g.concat(p):p,S={};return{fragmentSource:h=h.replace(s,(E,k,A,D,R)=>(S[R]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${A} ${D} ${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = u_${R};
#endif
`)),vertexSource:t=t.replace(s,(E,k,A,D,R)=>{const Z=D==="float"?"vec2":"vec4",$=R.match(/color/)?"color":Z;return S[R]?k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${Z} a_${R};
varying ${A} ${D} ${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${Z} a_${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = a_${R};
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${A} ${D} ${R} = u_${R};
#endif
`}),staticAttributes:c,staticUniforms:v}}class bl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,c,p,g,v,S,E,k){this.context=t;let A=this.boundPaintVertexBuffers.length!==p.length;for(let D=0;!A&&D<p.length;D++)this.boundPaintVertexBuffers[D]!==p[D]&&(A=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===c&&!A&&this.boundIndexBuffer===g&&this.boundVertexOffset===v&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===E&&this.boundDynamicVertexBuffer3===k?(t.bindVertexArrayOES.set(this.vao),S&&S.bind(),g&&g.dynamicDraw&&g.bind(),E&&E.bind(),k&&k.bind()):this.freshBind(s,c,p,g,v,S,E,k)}freshBind(t,s,c,p,g,v,S,E){let k;const A=t.numAttributes,D=this.context,R=D.gl;if(D.extVertexArrayObject)this.vao&&this.destroy(),this.vao=D.extVertexArrayObject.createVertexArrayOES(),D.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=E;else{k=D.currentNumAttributes||0;for(let Z=A;Z<k;Z++)R.disableVertexAttribArray(Z)}s.enableAttributes(R,t);for(const Z of c)Z.enableAttributes(R,t);v&&v.enableAttributes(R,t),S&&S.enableAttributes(R,t),E&&E.enableAttributes(R,t),s.bind(),s.setVertexAttribPointers(R,t,g);for(const Z of c)Z.bind(),Z.setVertexAttribPointers(R,t,g);v&&(v.bind(),v.setVertexAttribPointers(R,t,g)),p&&p.bind(),S&&(S.bind(),S.setVertexAttribPointers(R,t,g)),E&&(E.bind(),E.setVertexAttribPointers(R,t,g)),D.currentNumAttributes=A}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Sl(h){const t=[];for(let s=0;s<h.length;s++){if(h[s]===null)continue;const c=h[s].split(" ");t.push(c.pop())}return t}class hc{constructor(t,s,c,p,g,v,S){const E=t.gl;this.program=E.createProgram();const k=Sl(c.staticAttributes),A=p?p.getBinderAttributes():[],D=k.concat(A),R=ks.prelude.staticUniforms?Sl(ks.prelude.staticUniforms):[],Z=c.staticUniforms?Sl(c.staticUniforms):[],$=p?p.getBinderUniforms():[],G=R.concat(Z).concat($),te=[];for(const ve of G)te.indexOf(ve)<0&&te.push(ve);const se=p?p.defines():[];v&&se.push("#define OVERDRAW_INSPECTOR;"),S&&se.push("#define TERRAIN3D;");const ce=se.concat(ks.prelude.fragmentSource,c.fragmentSource).join(`
`),W=se.concat(ks.prelude.vertexSource,c.vertexSource).join(`
`),pe=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(pe,ce),E.compileShader(pe),E.attachShader(this.program,pe);const he=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(he,W),E.compileShader(he),E.attachShader(this.program,he),this.attributes={};const _e={};this.numAttributes=D.length;for(let ve=0;ve<this.numAttributes;ve++)D[ve]&&(E.bindAttribLocation(this.program,ve,D[ve]),this.attributes[D[ve]]=ve);E.linkProgram(this.program),E.deleteShader(he),E.deleteShader(pe);for(let ve=0;ve<te.length;ve++){const ke=te[ve];if(ke&&!_e[ke]){const ye=E.getUniformLocation(this.program,ke);ye&&(_e[ke]=ye)}}this.fixedUniforms=g(t,_e),this.terrainUniforms=((ve,ke)=>({u_depth:new l.Uniform1i(ve,ke.u_depth),u_terrain:new l.Uniform1i(ve,ke.u_terrain),u_terrain_dim:new l.Uniform1f(ve,ke.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(ve,ke.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(ve,ke.u_terrain_unpack),u_terrain_offset:new l.Uniform1f(ve,ke.u_terrain_offset),u_terrain_exaggeration:new l.Uniform1f(ve,ke.u_terrain_exaggeration)}))(t,_e),this.binderUniforms=p?p.getUniforms(t,_e):[]}draw(t,s,c,p,g,v,S,E,k,A,D,R,Z,$,G,te,se,ce){const W=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(p),t.setColorMode(g),t.setCullFace(v),E){t.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,E.depthTexture),t.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,E.texture);for(const he in this.terrainUniforms)this.terrainUniforms[he].set(E[he])}for(const he in this.fixedUniforms)this.fixedUniforms[he].set(S[he]);G&&G.setUniforms(t,this.binderUniforms,Z,{zoom:$});let pe=0;switch(s){case W.LINES:pe=2;break;case W.TRIANGLES:pe=3;break;case W.LINE_STRIP:pe=1}for(const he of R.get()){const _e=he.vaos||(he.vaos={});(_e[k]||(_e[k]=new bl)).bind(t,this,A,G?G.getPaintVertexBuffers():[],D,he.vertexOffset,te,se,ce),W.drawElements(s,he.primitiveLength*pe,W.UNSIGNED_SHORT,he.primitiveOffset*pe*2)}}}function dc(h,t,s){const c=1/mn(s,1,t.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,t.transform.tileZoom)/p,v=g*(s.tileID.canonical.x+s.tileID.wrap*p),S=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[v>>16,S>>16],u_pixel_coord_lower:[65535&v,65535&S]}}const El=(h,t,s,c)=>{const p=t.style.light,g=p.properties.get("position"),v=[g.x,g.y,g.z],S=l.create$1();p.properties.get("anchor")==="viewport"&&l.fromRotation(S,-t.transform.angle),l.transformMat3(v,v,S);const E=p.properties.get("color");return{u_matrix:h,u_lightpos:v,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+s,u_opacity:c}},Rd=(h,t,s,c,p,g,v)=>l.extend(El(h,t,s,c),dc(g,t,v),{u_height_factor:-Math.pow(2,p.overscaledZ)/v.tileSize/8}),ga=h=>({u_matrix:h}),Tl=(h,t,s,c)=>l.extend(ga(h),dc(s,t,c)),pc=(h,t)=>({u_matrix:h,u_world:t}),fc=(h,t,s,c,p)=>l.extend(Tl(h,t,s,c),{u_world:p}),mc=(h,t,s,c)=>{const p=h.transform;let g,v;if(c.paint.get("circle-pitch-alignment")==="map"){const S=mn(s,1,p.zoom);g=!0,v=[S,S]}else g=!1,v=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(t.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:v}},oo=(h,t,s)=>{const c=mn(s,1,t.zoom),p=Math.pow(2,t.zoom-s.tileID.overscaledZ),g=s.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*p),t.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:g}},Cs=(h,t,s=1)=>({u_matrix:h,u_color:t,u_overlay:0,u_overlay_scale:s}),Oo=h=>({u_matrix:h}),ya=(h,t,s,c)=>({u_matrix:h,u_extrude_scale:mn(t,1,s),u_intensity:c});function _a(h,t){const s=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new l.MercatorCoordinate(0,c/s).toLngLat().lat,new l.MercatorCoordinate(0,(c+1)/s).toLngLat().lat]}const No=(h,t,s,c)=>{const p=h.transform;return{u_matrix:zs(h,t,s,c),u_ratio:1/mn(t,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},kl=(h,t,s,c,p)=>l.extend(No(h,t,s,p),{u_image:0,u_image_height:c}),va=(h,t,s,c,p)=>{const g=h.transform,v=Yt(t,g);return{u_matrix:zs(h,t,s,p),u_texsize:t.imageAtlasTexture.size,u_ratio:1/mn(t,1,g.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[v,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Is=(h,t,s,c,p,g)=>{const v=h.lineAtlas,S=Yt(t,h.transform),E=s.layout.get("line-cap")==="round",k=v.getDash(c.from,E),A=v.getDash(c.to,E),D=k.width*p.fromScale,R=A.width*p.toScale;return l.extend(No(h,t,s,g),{u_patternscale_a:[S/D,-k.height/2],u_patternscale_b:[S/R,-A.height/2],u_sdfgamma:v.width/(256*Math.min(D,R)*h.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:A.y,u_mix:p.t})};function Yt(h,t){return 1/mn(h,1,t.tileZoom)}function zs(h,t,s,c){return h.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const gc=(h,t,s,c,p)=>{return{u_matrix:h,u_tl_parent:t,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(v=p.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=p.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:yc(p.paint.get("raster-hue-rotate"))};var g,v};function yc(h){h*=Math.PI/180;const t=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Cl=(h,t,s,c,p,g,v,S,E,k)=>{const A=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:A.cameraToCenterDistance,u_pitch:A.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:A.width/A.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:v,u_coord_matrix:S,u_is_text:+E,u_pitch_with_map:+c,u_texsize:k,u_texture:0}},xa=(h,t,s,c,p,g,v,S,E,k,A)=>{const D=p.transform;return l.extend(Cl(h,t,s,c,p,g,v,S,E,k),{u_gamma_scale:c?Math.cos(D._pitch)*D.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+A})},_c=(h,t,s,c,p,g,v,S,E,k)=>l.extend(xa(h,t,s,c,p,g,v,S,!0,E,!0),{u_texsize_icon:k,u_texture_icon:1}),Bd=(h,t,s)=>({u_matrix:h,u_opacity:t,u_color:s}),Fd=(h,t,s,c,p,g)=>l.extend(function(v,S,E,k){const A=E.imageManager.getPattern(v.from.toString()),D=E.imageManager.getPattern(v.to.toString()),{width:R,height:Z}=E.imageManager.getPixelSize(),$=Math.pow(2,k.tileID.overscaledZ),G=k.tileSize*Math.pow(2,E.transform.tileZoom)/$,te=G*(k.tileID.canonical.x+k.tileID.wrap*$),se=G*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:A.tl,u_pattern_br_a:A.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[R,Z],u_mix:S.t,u_pattern_size_a:A.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/mn(k,1,E.transform.tileZoom),u_pixel_coord_upper:[te>>16,se>>16],u_pixel_coord_lower:[65535&te,65535&se]}}(c,g,s,p),{u_matrix:h,u_opacity:t}),Il={fillExtrusion:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_lightpos:new l.Uniform3f(h,t.u_lightpos),u_lightintensity:new l.Uniform1f(h,t.u_lightintensity),u_lightcolor:new l.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new l.Uniform1f(h,t.u_vertical_gradient),u_opacity:new l.Uniform1f(h,t.u_opacity)}),fillExtrusionPattern:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_lightpos:new l.Uniform3f(h,t.u_lightpos),u_lightintensity:new l.Uniform1f(h,t.u_lightintensity),u_lightcolor:new l.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new l.Uniform1f(h,t.u_vertical_gradient),u_height_factor:new l.Uniform1f(h,t.u_height_factor),u_image:new l.Uniform1i(h,t.u_image),u_texsize:new l.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(h,t.u_scale),u_fade:new l.Uniform1f(h,t.u_fade),u_opacity:new l.Uniform1f(h,t.u_opacity)}),fill:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix)}),fillPattern:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_image:new l.Uniform1i(h,t.u_image),u_texsize:new l.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(h,t.u_scale),u_fade:new l.Uniform1f(h,t.u_fade)}),fillOutline:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_world:new l.Uniform2f(h,t.u_world)}),fillOutlinePattern:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_world:new l.Uniform2f(h,t.u_world),u_image:new l.Uniform1i(h,t.u_image),u_texsize:new l.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(h,t.u_scale),u_fade:new l.Uniform1f(h,t.u_fade)}),circle:(h,t)=>({u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(h,t.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(h,t.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(h,t.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(h,t.u_matrix)}),collisionBox:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(h,t.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(h,t.u_extrude_scale),u_overscale_factor:new l.Uniform1f(h,t.u_overscale_factor)}),collisionCircle:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_inv_matrix:new l.UniformMatrix4f(h,t.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(h,t.u_viewport_size)}),debug:(h,t)=>({u_color:new l.UniformColor(h,t.u_color),u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_overlay:new l.Uniform1i(h,t.u_overlay),u_overlay_scale:new l.Uniform1f(h,t.u_overlay_scale)}),clippingMask:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix)}),heatmap:(h,t)=>({u_extrude_scale:new l.Uniform1f(h,t.u_extrude_scale),u_intensity:new l.Uniform1f(h,t.u_intensity),u_matrix:new l.UniformMatrix4f(h,t.u_matrix)}),heatmapTexture:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_world:new l.Uniform2f(h,t.u_world),u_image:new l.Uniform1i(h,t.u_image),u_color_ramp:new l.Uniform1i(h,t.u_color_ramp),u_opacity:new l.Uniform1f(h,t.u_opacity)}),hillshade:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_image:new l.Uniform1i(h,t.u_image),u_latrange:new l.Uniform2f(h,t.u_latrange),u_light:new l.Uniform2f(h,t.u_light),u_shadow:new l.UniformColor(h,t.u_shadow),u_highlight:new l.UniformColor(h,t.u_highlight),u_accent:new l.UniformColor(h,t.u_accent)}),hillshadePrepare:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_image:new l.Uniform1i(h,t.u_image),u_dimension:new l.Uniform2f(h,t.u_dimension),u_zoom:new l.Uniform1f(h,t.u_zoom),u_unpack:new l.Uniform4f(h,t.u_unpack)}),line:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_ratio:new l.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(h,t.u_units_to_pixels)}),lineGradient:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_ratio:new l.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(h,t.u_units_to_pixels),u_image:new l.Uniform1i(h,t.u_image),u_image_height:new l.Uniform1f(h,t.u_image_height)}),linePattern:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_texsize:new l.Uniform2f(h,t.u_texsize),u_ratio:new l.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_image:new l.Uniform1i(h,t.u_image),u_units_to_pixels:new l.Uniform2f(h,t.u_units_to_pixels),u_scale:new l.Uniform3f(h,t.u_scale),u_fade:new l.Uniform1f(h,t.u_fade)}),lineSDF:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_ratio:new l.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(h,t.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(h,t.u_patternscale_a),u_patternscale_b:new l.Uniform2f(h,t.u_patternscale_b),u_sdfgamma:new l.Uniform1f(h,t.u_sdfgamma),u_image:new l.Uniform1i(h,t.u_image),u_tex_y_a:new l.Uniform1f(h,t.u_tex_y_a),u_tex_y_b:new l.Uniform1f(h,t.u_tex_y_b),u_mix:new l.Uniform1f(h,t.u_mix)}),raster:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_tl_parent:new l.Uniform2f(h,t.u_tl_parent),u_scale_parent:new l.Uniform1f(h,t.u_scale_parent),u_buffer_scale:new l.Uniform1f(h,t.u_buffer_scale),u_fade_t:new l.Uniform1f(h,t.u_fade_t),u_opacity:new l.Uniform1f(h,t.u_opacity),u_image0:new l.Uniform1i(h,t.u_image0),u_image1:new l.Uniform1i(h,t.u_image1),u_brightness_low:new l.Uniform1f(h,t.u_brightness_low),u_brightness_high:new l.Uniform1f(h,t.u_brightness_high),u_saturation_factor:new l.Uniform1f(h,t.u_saturation_factor),u_contrast_factor:new l.Uniform1f(h,t.u_contrast_factor),u_spin_weights:new l.Uniform3f(h,t.u_spin_weights)}),symbolIcon:(h,t)=>({u_is_size_zoom_constant:new l.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(h,t.u_size_t),u_size:new l.Uniform1f(h,t.u_size),u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(h,t.u_pitch),u_rotate_symbol:new l.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(h,t.u_fade_change),u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new l.Uniform1i(h,t.u_is_text),u_pitch_with_map:new l.Uniform1i(h,t.u_pitch_with_map),u_texsize:new l.Uniform2f(h,t.u_texsize),u_texture:new l.Uniform1i(h,t.u_texture)}),symbolSDF:(h,t)=>({u_is_size_zoom_constant:new l.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(h,t.u_size_t),u_size:new l.Uniform1f(h,t.u_size),u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(h,t.u_pitch),u_rotate_symbol:new l.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(h,t.u_fade_change),u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new l.Uniform1i(h,t.u_is_text),u_pitch_with_map:new l.Uniform1i(h,t.u_pitch_with_map),u_texsize:new l.Uniform2f(h,t.u_texsize),u_texture:new l.Uniform1i(h,t.u_texture),u_gamma_scale:new l.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(h,t.u_is_halo)}),symbolTextAndIcon:(h,t)=>({u_is_size_zoom_constant:new l.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(h,t.u_size_t),u_size:new l.Uniform1f(h,t.u_size),u_camera_to_center_distance:new l.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(h,t.u_pitch),u_rotate_symbol:new l.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(h,t.u_fade_change),u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new l.Uniform1i(h,t.u_is_text),u_pitch_with_map:new l.Uniform1i(h,t.u_pitch_with_map),u_texsize:new l.Uniform2f(h,t.u_texsize),u_texsize_icon:new l.Uniform2f(h,t.u_texsize_icon),u_texture:new l.Uniform1i(h,t.u_texture),u_texture_icon:new l.Uniform1i(h,t.u_texture_icon),u_gamma_scale:new l.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(h,t.u_is_halo)}),background:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_opacity:new l.Uniform1f(h,t.u_opacity),u_color:new l.UniformColor(h,t.u_color)}),backgroundPattern:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_opacity:new l.Uniform1f(h,t.u_opacity),u_image:new l.Uniform1i(h,t.u_image),u_pattern_tl_a:new l.Uniform2f(h,t.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(h,t.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(h,t.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(h,t.u_pattern_br_b),u_texsize:new l.Uniform2f(h,t.u_texsize),u_mix:new l.Uniform1f(h,t.u_mix),u_pattern_size_a:new l.Uniform2f(h,t.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(h,t.u_pattern_size_b),u_scale_a:new l.Uniform1f(h,t.u_scale_a),u_scale_b:new l.Uniform1f(h,t.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(h,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(h,t.u_tile_units_to_pixels)}),terrain:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_texture:new l.Uniform1i(h,t.u_texture)}),terrainDepth:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix)}),terrainCoords:(h,t)=>({u_matrix:new l.UniformMatrix4f(h,t.u_matrix),u_texture:new l.Uniform1i(h,t.u_texture),u_terrain_coords_id:new l.Uniform1f(h,t.u_terrain_coords_id)})};class zl{constructor(t,s,c){this.context=t;const p=t.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Al={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Pl{constructor(t,s,c,p){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let c=0;c<this.attributes.length;c++){const p=s.attributes[this.attributes[c].name];p!==void 0&&t.enableVertexAttribArray(p)}}setVertexAttribPointers(t,s,c){for(let p=0;p<this.attributes.length;p++){const g=this.attributes[p],v=s.attributes[g.name];v!==void 0&&t.vertexAttribPointer(v,g.components,t[Al[g.type]],!1,this.itemSize,g.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Dt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class vc extends Dt{getDefault(){return l.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Od extends Dt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class As extends Dt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ps extends Dt{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class xc extends Dt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class gr extends Dt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ml extends Dt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class wa extends Dt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ba extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Dl extends Dt{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ll extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class Sa extends Dt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Rl extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class Bl extends Dt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ea extends Dt{getDefault(){return l.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class wc extends Dt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class bc extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class Uo extends Dt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Nd extends Dt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Ud extends Dt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Vd extends Dt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class $d extends Dt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class jd extends Dt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Gd extends Dt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Fl extends Dt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ta extends Dt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ol extends Dt{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Nl extends Dt{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class Vo extends Dt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Sc extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ec extends Dt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class ka extends Dt{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class so extends ka{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Tc extends ka{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class $o{constructor(t,s,c,p){this.context=t,this.width=s,this.height=c;const g=t.gl,v=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new so(t,v),p&&(this.depthAttachment=new Tc(t,v)),g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Ht{constructor(t,s,c){this.blendFunction=t,this.blendColor=s,this.mask=c}}Ht.Replace=[1,0],Ht.disabled=new Ht(Ht.Replace,l.Color.transparent,[!1,!1,!1,!1]),Ht.unblended=new Ht(Ht.Replace,l.Color.transparent,[!0,!0,!0,!0]),Ht.alphaBlended=new Ht([1,771],l.Color.transparent,[!0,!0,!0,!0]);class kc{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new vc(this),this.clearDepth=new Od(this),this.clearStencil=new As(this),this.colorMask=new Ps(this),this.depthMask=new xc(this),this.stencilMask=new gr(this),this.stencilFunc=new Ml(this),this.stencilOp=new wa(this),this.stencilTest=new ba(this),this.depthRange=new Dl(this),this.depthTest=new Ll(this),this.depthFunc=new Sa(this),this.blend=new Rl(this),this.blendFunc=new Bl(this),this.blendColor=new Ea(this),this.blendEquation=new wc(this),this.cullFace=new bc(this),this.cullFaceSide=new Uo(this),this.frontFace=new Nd(this),this.program=new Ud(this),this.activeTexture=new Vd(this),this.viewport=new $d(this),this.bindFramebuffer=new jd(this),this.bindRenderbuffer=new Gd(this),this.bindTexture=new Fl(this),this.bindVertexBuffer=new Ta(this),this.bindElementBuffer=new Ol(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Nl(this),this.pixelStoreUnpack=new Vo(this),this.pixelStoreUnpackPremultiplyAlpha=new Sc(this),this.pixelStoreUnpackFlipY=new Ec(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new zl(this,t,s)}createVertexBuffer(t,s,c){return new Pl(this,t,s,c)}createRenderbuffer(t,s,c){const p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,t,s,c),this.bindRenderbuffer.set(null),g}createFramebuffer(t,s,c){return new $o(this,t,s,c)}clear({color:t,depth:s}){const c=this.gl;let p=0;t&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){ne(t.blendFunction,Ht.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class St{constructor(t,s,c){this.func=t,this.mask=s,this.range=c}}St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);const Lt=7680;class qt{constructor(t,s,c,p,g,v){this.test=t,this.ref=s,this.mask=c,this.fail=p,this.depthFail=g,this.pass=v}}qt.disabled=new qt({func:519,mask:0},0,0,Lt,Lt,Lt);class Jt{constructor(t,s,c){this.enable=t,this.mode=s,this.frontFace=c}}let Ms;function jo(h,t,s,c,p,g,v){const S=h.context,E=S.gl,k=h.useProgram("collisionBox"),A=[];let D=0,R=0;for(let W=0;W<c.length;W++){const pe=c[W],he=t.getTile(pe),_e=he.getBucket(s);if(!_e)continue;let ve=pe.posMatrix;p[0]===0&&p[1]===0||(ve=h.translatePosMatrix(pe.posMatrix,he,p,g));const ke=v?_e.textCollisionBox:_e.iconCollisionBox,ye=_e.collisionCircleArray;if(ye.length>0){const Ge=l.create(),Re=ve;l.mul(Ge,_e.placementInvProjMatrix,h.transform.glCoordMatrix),l.mul(Ge,Ge,_e.placementViewportMatrix),A.push({circleArray:ye,circleOffset:R,transform:Re,invTransform:Ge,coord:pe}),D+=ye.length/4,R=D}ke&&k.draw(S,E.LINES,St.disabled,qt.disabled,h.colorModeForRenderPass(),Jt.disabled,oo(ve,h.transform,he),h.style.terrain&&h.style.terrain.getTerrainData(pe),s.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,h.transform.zoom,null,null,ke.collisionVertexBuffer)}if(!v||!A.length)return;const Z=h.useProgram("collisionCircle"),$=new l.CollisionCircleLayoutArray;$.resize(4*D),$._trim();let G=0;for(const W of A)for(let pe=0;pe<W.circleArray.length/4;pe++){const he=4*pe,_e=W.circleArray[he+0],ve=W.circleArray[he+1],ke=W.circleArray[he+2],ye=W.circleArray[he+3];$.emplace(G++,_e,ve,ke,ye,0),$.emplace(G++,_e,ve,ke,ye,1),$.emplace(G++,_e,ve,ke,ye,2),$.emplace(G++,_e,ve,ke,ye,3)}(!Ms||Ms.length<2*D)&&(Ms=function(W){const pe=2*W,he=new l.QuadTriangleArray;he.resize(pe),he._trim();for(let _e=0;_e<pe;_e++){const ve=6*_e;he.uint16[ve+0]=4*_e+0,he.uint16[ve+1]=4*_e+1,he.uint16[ve+2]=4*_e+2,he.uint16[ve+3]=4*_e+2,he.uint16[ve+4]=4*_e+3,he.uint16[ve+5]=4*_e+0}return he}(D));const te=S.createIndexBuffer(Ms,!0),se=S.createVertexBuffer($,l.collisionCircleLayout.members,!0);for(const W of A){const pe={u_matrix:W.transform,u_inv_matrix:W.invTransform,u_camera_to_center_distance:(ce=h.transform).cameraToCenterDistance,u_viewport_size:[ce.width,ce.height]};Z.draw(S,E.TRIANGLES,St.disabled,qt.disabled,h.colorModeForRenderPass(),Jt.disabled,pe,h.style.terrain&&h.style.terrain.getTerrainData(W.coord),s.id,se,te,l.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,h.transform.zoom,null,null,null)}var ce;se.destroy(),te.destroy()}Jt.disabled=new Jt(!1,1029,2305),Jt.backCCW=new Jt(!0,1029,2305);const qd=l.identity(new Float32Array(16));function Zd(h,t,s,c,p,g){const{horizontalAlign:v,verticalAlign:S}=l.getAnchorAlignment(h),E=-(v-.5)*t,k=-(S-.5)*s,A=l.evaluateVariableOffset(h,c);return new l.pointGeometry((E/p+A[0])*g,(k/p+A[1])*g)}function Cc(h,t,s,c,p,g,v,S,E,k,A){const D=h.text.placedSymbolArray,R=h.text.dynamicLayoutVertexArray,Z=h.icon.dynamicLayoutVertexArray,$={};R.clear();for(let G=0;G<D.length;G++){const te=D.get(G),se=h.allowVerticalPlacement&&!te.placedOrientation,ce=te.hidden||!te.crossTileID||se?null:c[te.crossTileID];if(ce){const W=new l.pointGeometry(te.anchorX,te.anchorY),pe=Ct(W,s?v:g,A),he=zr(p.cameraToCenterDistance,pe.signedDistanceFromCamera);let _e=l.evaluateSizeForFeature(h.textSizeData,E,te)*he/l.ONE_EM;s&&(_e*=h.tilePixelRatio/S);const{width:ve,height:ke,anchor:ye,textOffset:Ge,textBoxScale:Re}=ce,qe=Zd(ye,ve,ke,Ge,Re,_e),mt=s?Ct(W.add(qe),g,A).point:pe.point.add(t?qe.rotate(-p.angle):qe),_t=h.allowVerticalPlacement&&te.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let nt=0;nt<te.numGlyphs;nt++)l.addDynamicAttributes(R,mt,_t);k&&te.associatedIconIndex>=0&&($[te.associatedIconIndex]={shiftedAnchor:mt,angle:_t})}else dt(te.numGlyphs,R)}if(k){Z.clear();const G=h.icon.placedSymbolArray;for(let te=0;te<G.length;te++){const se=G.get(te);if(se.hidden)dt(se.numGlyphs,Z);else{const ce=$[te];if(ce)for(let W=0;W<se.numGlyphs;W++)l.addDynamicAttributes(Z,ce.shiftedAnchor,ce.angle);else dt(se.numGlyphs,Z)}}h.icon.dynamicLayoutVertexBuffer.updateData(Z)}h.text.dynamicLayoutVertexBuffer.updateData(R)}function Hd(h,t,s){return s.iconsInText&&t?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Ca(h,t,s,c,p,g,v,S,E,k,A,D){const R=h.context,Z=R.gl,$=h.transform,G=S==="map",te=E==="map",se=S!=="viewport"&&s.layout.get("symbol-placement")!=="point",ce=G&&!te&&!se,W=!s.layout.get("symbol-sort-key").isConstant();let pe=!1;const he=h.depthModeForSublayer(0,St.ReadOnly),_e=s.layout.get("text-variable-anchor"),ve=[];for(const ke of c){const ye=t.getTile(ke),Ge=ye.getBucket(s);if(!Ge)continue;const Re=p?Ge.text:Ge.icon;if(!Re||!Re.segments.get().length)continue;const qe=Re.programConfigurations.get(s.id),mt=p||Ge.sdfIcons,_t=p?Ge.textSizeData:Ge.iconSizeData,nt=te||$.pitch!==0,Bt=h.useProgram(Hd(mt,p,Ge),qe),Ft=l.evaluateSizeForZoom(_t,$.zoom),Et=h.style.terrain&&h.style.terrain.getTerrainData(ke);let At,Ut,kn,oi,jr=[0,0],si=null;if(p){if(Ut=ye.glyphAtlasTexture,kn=Z.LINEAR,At=ye.glyphAtlasTexture.size,Ge.iconsInText){jr=ye.imageAtlasTexture.size,si=ye.imageAtlasTexture;const Mr=_t.kind==="composite"||_t.kind==="camera";oi=nt||h.options.rotating||h.options.zooming||Mr?Z.LINEAR:Z.NEAREST}}else{const Mr=s.layout.get("icon-size").constantOr(0)!==1||Ge.iconsNeedLinear;Ut=ye.imageAtlasTexture,kn=mt||h.options.rotating||h.options.zooming||Mr||nt?Z.LINEAR:Z.NEAREST,At=ye.imageAtlasTexture.size}const Hi=mn(ye,1,h.transform.zoom),Pr=to(ke.posMatrix,te,G,h.transform,Hi),rr=Vr(ke.posMatrix,te,G,h.transform,Hi),Si=_e&&Ge.hasTextData(),Ra=s.layout.get("icon-text-fit")!=="none"&&Si&&Ge.hasIconData();if(se){const Mr=h.style.terrain?(eu,Xo)=>h.style.terrain.getElevation(ke,eu,Xo):null,co=s.layout.get("text-rotation-alignment")==="map";mr(Ge,ke.posMatrix,h,p,Pr,rr,te,k,co,Mr)}const xn=h.translatePosMatrix(ke.posMatrix,ye,g,v),xt=se||p&&_e||Ra?qd:Pr,Rt=h.translatePosMatrix(rr,ye,g,v,!0),Cn=mt&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let In;In=mt?Ge.iconsInText?_c(_t.kind,Ft,ce,te,h,xn,xt,Rt,At,jr):xa(_t.kind,Ft,ce,te,h,xn,xt,Rt,p,At,!0):Cl(_t.kind,Ft,ce,te,h,xn,xt,Rt,p,At);const en={program:Bt,buffers:Re,uniformValues:In,atlasTexture:Ut,atlasTextureIcon:si,atlasInterpolation:kn,atlasInterpolationIcon:oi,isSDF:mt,hasHalo:Cn};if(W&&Ge.canOverlap){pe=!0;const Mr=Re.segments.get();for(const co of Mr)ve.push({segments:new l.SegmentVector([co]),sortKey:co.sortKey,state:en,terrainData:Et})}else ve.push({segments:Re.segments,sortKey:0,state:en,terrainData:Et})}pe&&ve.sort((ke,ye)=>ke.sortKey-ye.sortKey);for(const ke of ve){const ye=ke.state;if(R.activeTexture.set(Z.TEXTURE0),ye.atlasTexture.bind(ye.atlasInterpolation,Z.CLAMP_TO_EDGE),ye.atlasTextureIcon&&(R.activeTexture.set(Z.TEXTURE1),ye.atlasTextureIcon&&ye.atlasTextureIcon.bind(ye.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),ye.isSDF){const Ge=ye.uniformValues;ye.hasHalo&&(Ge.u_is_halo=1,Ds(ye.buffers,ke.segments,s,h,ye.program,he,A,D,Ge,ke.terrainData)),Ge.u_is_halo=0}Ds(ye.buffers,ke.segments,s,h,ye.program,he,A,D,ye.uniformValues,ke.terrainData)}}function Ds(h,t,s,c,p,g,v,S,E,k){const A=c.context;p.draw(A,A.gl.TRIANGLES,g,v,S,Jt.disabled,E,k,s.id,h.layoutVertexBuffer,h.indexBuffer,t,s.paint,c.transform.zoom,h.programConfigurations.get(s.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function Ls(h,t,s,c,p,g,v){const S=h.context.gl,E=s.paint.get("fill-pattern"),k=E&&E.constantOr(1),A=s.getCrossfadeParameters();let D,R,Z,$,G;v?(R=k&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=S.LINES):(R=k?"fillPattern":"fill",D=S.TRIANGLES);for(const te of c){const se=t.getTile(te);if(k&&!se.patternsLoaded())continue;const ce=se.getBucket(s);if(!ce)continue;const W=ce.programConfigurations.get(s.id),pe=h.useProgram(R,W),he=h.style.terrain&&h.style.terrain.getTerrainData(te);k&&(h.context.activeTexture.set(S.TEXTURE0),se.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),W.updatePaintBuffers(A));const _e=E.constantOr(null);if(_e&&se.imageAtlas){const ye=se.imageAtlas,Ge=ye.patternPositions[_e.to.toString()],Re=ye.patternPositions[_e.from.toString()];Ge&&Re&&W.setConstantPatternPositions(Ge,Re)}const ve=he?te:null,ke=h.translatePosMatrix(ve?ve.posMatrix:te.posMatrix,se,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(v){$=ce.indexBuffer2,G=ce.segments2;const ye=[S.drawingBufferWidth,S.drawingBufferHeight];Z=R==="fillOutlinePattern"&&k?fc(ke,h,A,se,ye):pc(ke,ye)}else $=ce.indexBuffer,G=ce.segments,Z=k?Tl(ke,h,A,se):ga(ke);pe.draw(h.context,D,p,h.stencilModeForClipping(te),g,Jt.disabled,Z,he,s.id,ce.layoutVertexBuffer,$,G,s.paint,h.transform.zoom,W)}}function Rs(h,t,s,c,p,g,v){const S=h.context,E=S.gl,k=s.paint.get("fill-extrusion-pattern"),A=k.constantOr(1),D=s.getCrossfadeParameters(),R=s.paint.get("fill-extrusion-opacity");for(const Z of c){const $=t.getTile(Z),G=$.getBucket(s);if(!G)continue;const te=h.style.terrain&&h.style.terrain.getTerrainData(Z),se=G.programConfigurations.get(s.id),ce=h.useProgram(A?"fillExtrusionPattern":"fillExtrusion",se);A&&(h.context.activeTexture.set(E.TEXTURE0),$.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),se.updatePaintBuffers(D));const W=k.constantOr(null);if(W&&$.imageAtlas){const ve=$.imageAtlas,ke=ve.patternPositions[W.to.toString()],ye=ve.patternPositions[W.from.toString()];ke&&ye&&se.setConstantPatternPositions(ke,ye)}const pe=h.translatePosMatrix(Z.posMatrix,$,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),he=s.paint.get("fill-extrusion-vertical-gradient"),_e=A?Rd(pe,h,he,R,Z,D,$):El(pe,h,he,R);ce.draw(S,S.gl.TRIANGLES,p,g,v,Jt.backCCW,_e,te,s.id,G.layoutVertexBuffer,G.indexBuffer,G.segments,s.paint,h.transform.zoom,se,h.style.terrain&&G.centroidVertexBuffer)}}function Ul(h,t,s,c,p,g,v){const S=h.context,E=S.gl,k=s.fbo;if(!k)return;const A=h.useProgram("hillshade"),D=h.style.terrain&&h.style.terrain.getTerrainData(t);S.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,k.colorAttachment.get()),A.draw(S,E.TRIANGLES,p,g,v,Jt.disabled,((R,Z,$,G)=>{const te=$.paint.get("hillshade-shadow-color"),se=$.paint.get("hillshade-highlight-color"),ce=$.paint.get("hillshade-accent-color");let W=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(W-=R.transform.angle);const pe=!R.options.moving;return{u_matrix:G?G.posMatrix:R.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),pe),u_image:0,u_latrange:_a(0,Z.tileID),u_light:[$.paint.get("hillshade-exaggeration"),W],u_shadow:te,u_highlight:se,u_accent:ce}})(h,s,c,D?t:null),D,c.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function Ic(h,t,s,c,p,g){const v=h.context,S=v.gl,E=t.dem;if(E&&E.data){const k=E.dim,A=E.stride,D=E.getPixels();if(v.activeTexture.set(S.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||h.getTileTexture(A),t.demTexture){const Z=t.demTexture;Z.update(D,{premultiply:!1}),Z.bind(S.NEAREST,S.CLAMP_TO_EDGE)}else t.demTexture=new Ie(v,D,S.RGBA,{premultiply:!1}),t.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);v.activeTexture.set(S.TEXTURE0);let R=t.fbo;if(!R){const Z=new Ie(v,{width:k,height:k,data:null},S.RGBA);Z.bind(S.LINEAR,S.CLAMP_TO_EDGE),R=t.fbo=v.createFramebuffer(k,k,!0),R.colorAttachment.set(Z.texture)}v.bindFramebuffer.set(R.framebuffer),v.viewport.set([0,0,k,k]),h.useProgram("hillshadePrepare").draw(v,S.TRIANGLES,c,p,g,Jt.disabled,((Z,$)=>{const G=$.stride,te=l.create();return l.ortho(te,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(te,te,[0,-l.EXTENT,0]),{u_matrix:te,u_image:1,u_dimension:[G,G],u_zoom:Z.overscaledZ,u_unpack:$.getUnpackVector()}})(t.tileID,E),null,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function Ia(h,t,s,c,p,g){const v=c.paint.get("raster-fade-duration");if(!g&&v>0){const S=l.exported.now(),E=(S-h.timeAdded)/v,k=t?(S-t.timeAdded)/v:-1,A=s.getSource(),D=p.coveringZoomLevel({tileSize:A.tileSize,roundZoom:A.roundZoom}),R=!t||Math.abs(t.tileID.overscaledZ-D)>Math.abs(h.tileID.overscaledZ-D),Z=R&&h.refreshedUponExpiration?1:l.clamp(R?E:1-k,0,1);return h.refreshedUponExpiration&&E>=1&&(h.refreshedUponExpiration=!1),t?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const za=new l.Color(1,0,0,1),$r=new l.Color(0,1,0,1),zc=new l.Color(0,0,1,1),Vl=new l.Color(1,0,1,1),Ac=new l.Color(0,1,1,1);function ao(h,t,s,c){Go(h,0,t+s/2,h.transform.width,s,c)}function Bs(h,t,s,c){Go(h,t-s/2,0,s,h.transform.height,c)}function Go(h,t,s,c,p,g){const v=h.context,S=v.gl;S.enable(S.SCISSOR_TEST),S.scissor(t*h.pixelRatio,s*h.pixelRatio,c*h.pixelRatio,p*h.pixelRatio),v.clear({color:g}),S.disable(S.SCISSOR_TEST)}function Wd(h,t,s){const c=h.context,p=c.gl,g=s.posMatrix,v=h.useProgram("debug"),S=St.disabled,E=qt.disabled,k=h.colorModeForRenderPass(),A="$debug",D=h.style.terrain&&h.style.terrain.getTerrainData(s);c.activeTexture.set(p.TEXTURE0),h.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const R=t.getTileByID(s.key).latestRawTileData,Z=Math.floor((R&&R.byteLength||0)/1024),$=t.getTile(s).tileSize,G=512/Math.min($,512)*(s.overscaledZ/h.transform.zoom)*.5;let te=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(te+=` => ${s.overscaledZ}`),function(se,ce){se.initDebugOverlayCanvas();const W=se.debugOverlayCanvas,pe=se.context.gl,he=se.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,W.width,W.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(ce,5,5),he.strokeText(ce,5,5),se.debugOverlayTexture.update(W),se.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(h,`${te} ${Z}kB`),v.draw(c,p.TRIANGLES,S,E,Ht.alphaBlended,Jt.disabled,Cs(g,l.Color.transparent,G),null,A,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),v.draw(c,p.LINE_STRIP,S,E,k,Jt.disabled,Cs(g,l.Color.red),D,A,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function Aa(h,t,s){const c=h.context,p=c.gl,g=h.colorModeForRenderPass(),v=new St(p.LEQUAL,St.ReadWrite,h.depthRangeFor3D),S=h.useProgram("terrain"),E=t.getTerrainMesh(),k=t.getTerrainData(s.tileID);c.bindFramebuffer.set(null),c.viewport.set([0,0,h.width,h.height]),c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,t.getRTTFramebuffer().colorAttachment.get());const A=h.transform.calculatePosMatrix(s.tileID.toUnwrapped());S.draw(c,p.TRIANGLES,v,qt.disabled,g,Jt.backCCW,{u_matrix:A,u_texture:0},k,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}function Pc(h,t,s,c){const p=h.context,g=s.tileSize*t.qualityFactor;s.textures[c]||(s.textures[c]=h.getTileTexture(g)||new Ie(p,{width:g,height:g,data:null},p.gl.RGBA),s.textures[c].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),c===0&&t.sourceCache.renderHistory.unshift(s.tileID.key));const v=t.getRTTFramebuffer();v.colorAttachment.set(s.textures[c].texture),p.bindFramebuffer.set(v.framebuffer),p.viewport.set([0,0,g,g])}class Mc{constructor(t){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=t,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=t.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const t=this.painter.style,s=t.terrain;for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const p=t.sourceCaches[c].getVisibleCoordinates();for(const g of p){const v=s.sourceCache.getTerrainCoords(g);for(const S in v)this._coordsDescendingInv[c][S]||(this._coordsDescendingInv[c][S]=[]),this._coordsDescendingInv[c][S].push(v[S])}}for(const c of t._order){const p=t._layers[c],g=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const v in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][v]=this._coordsDescendingInv[g][v].map(S=>S.key).sort().join()}}return this._renderableTiles.forEach(c=>{for(const p in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[p][c.tileID.key];g&&g!==c.textureCoords[p]&&c.clearTextures(this.painter),s.needsRerender(p,c.tileID)&&c.clearTextures(this.painter)}this._rerender[c.tileID.key]=!c.textures.length}),s.clearRerenderCache(),s.sourceCache.removeOutdated(this.painter),this}renderLayer(t){const s=t.type,c=this.painter,p=c.style._order,g=c.currentLayer,v=g+1===p.length;if(this._renderToTexture[s]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(p[g]),!v))return!0;if(this._renderToTexture[this._prevType]||s==="hillshade"||this._renderToTexture[s]&&v){this._prevType=s;const S=this._stacks.length-1,E=this._stacks[S]||[];for(const k of this._renderableTiles){if(Pc(c,c.style.terrain,k,S),this._rerender[k.tileID.key]){c.context.clear({color:l.Color.transparent});for(let A=0;A<E.length;A++){const D=c.style._layers[E[A]],R=D.source?this._coordsDescendingInv[D.source][k.tileID.key]:[k.tileID];c._renderTileClippingMasks(D,R),c.renderLayer(c,c.style.sourceCaches[D.source],D,R),D.source&&(k.textureCoords[D.source]=this._coordsDescendingInvStr[D.source][k.tileID.key])}}Aa(c,c.style.terrain,k)}if(s==="hillshade"){this._stacks.push([p[g]]);for(const k of this._renderableTiles){const A=this._coordsDescendingInv[t.source][k.tileID.key];Pc(c,c.style.terrain,k,this._stacks.length-1),c.context.clear({color:l.Color.transparent}),c._renderTileClippingMasks(t,A),c.renderLayer(c,c.style.sourceCaches[t.source],t,A),Aa(c,c.style.terrain,k)}return!0}return this._renderToTexture[s]}return!1}}const Fs={symbol:function(h,t,s,c,p){if(h.renderPass!=="translucent")return;const g=qt.disabled,v=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(S,E,k,A,D,R,Z){const $=E.transform,G=D==="map",te=R==="map";for(const se of S){const ce=A.getTile(se),W=ce.getBucket(k);if(!W||!W.text||!W.text.segments.get().length)continue;const pe=l.evaluateSizeForZoom(W.textSizeData,$.zoom),he=mn(ce,1,E.transform.zoom),_e=to(se.posMatrix,te,G,E.transform,he),ve=k.layout.get("icon-text-fit")!=="none"&&W.hasIconData();if(pe){const ke=Math.pow(2,$.zoom-ce.tileID.overscaledZ);Cc(W,G,te,Z,$,_e,se.posMatrix,ke,pe,ve,E.style.terrain?(ye,Ge)=>E.style.terrain.getElevation(se,ye,Ge):null)}}}(c,h,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p),s.paint.get("icon-opacity").constantOr(1)!==0&&Ca(h,t,s,c,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),g,v),s.paint.get("text-opacity").constantOr(1)!==0&&Ca(h,t,s,c,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),g,v),t.map.showCollisionBoxes&&(jo(h,t,s,c,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),jo(h,t,s,c,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),g=s.paint.get("circle-stroke-width"),v=s.paint.get("circle-stroke-opacity"),S=!s.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(g.constantOr(1)===0||v.constantOr(1)===0))return;const E=h.context,k=E.gl,A=h.depthModeForSublayer(0,St.ReadOnly),D=qt.disabled,R=h.colorModeForRenderPass(),Z=[];for(let $=0;$<c.length;$++){const G=c[$],te=t.getTile(G),se=te.getBucket(s);if(!se)continue;const ce=se.programConfigurations.get(s.id),W=h.useProgram("circle",ce),pe=se.layoutVertexBuffer,he=se.indexBuffer,_e=h.style.terrain&&h.style.terrain.getTerrainData(G),ve={programConfiguration:ce,program:W,layoutVertexBuffer:pe,indexBuffer:he,uniformValues:mc(h,G,te,s),terrainData:_e};if(S){const ke=se.segments.get();for(const ye of ke)Z.push({segments:new l.SegmentVector([ye]),sortKey:ye.sortKey,state:ve})}else Z.push({segments:se.segments,sortKey:0,state:ve})}S&&Z.sort(($,G)=>$.sortKey-G.sortKey);for(const $ of Z){const{programConfiguration:G,program:te,layoutVertexBuffer:se,indexBuffer:ce,uniformValues:W,terrainData:pe}=$.state;te.draw(E,k.TRIANGLES,A,D,R,Jt.disabled,W,pe,s.id,se,ce,$.segments,s.paint,h.transform.zoom,G)}},heatmap:function(h,t,s,c){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,g=p.gl,v=qt.disabled,S=new Ht([g.ONE,g.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(E,k,A){const D=E.gl;E.activeTexture.set(D.TEXTURE1),E.viewport.set([0,0,k.width/4,k.height/4]);let R=A.heatmapFbo;if(R)D.bindTexture(D.TEXTURE_2D,R.colorAttachment.get()),E.bindFramebuffer.set(R.framebuffer);else{const Z=D.createTexture();D.bindTexture(D.TEXTURE_2D,Z),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.LINEAR),R=A.heatmapFbo=E.createFramebuffer(k.width/4,k.height/4,!1),function($,G,te,se){const ce=$.gl;ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,G.width/4,G.height/4,0,ce.RGBA,$.extRenderToTextureHalfFloat?$.extTextureHalfFloat.HALF_FLOAT_OES:ce.UNSIGNED_BYTE,null),se.colorAttachment.set(te)}(E,k,Z,R)}})(p,h,s),p.clear({color:l.Color.transparent});for(let E=0;E<c.length;E++){const k=c[E];if(t.hasRenderableParent(k))continue;const A=t.getTile(k),D=A.getBucket(s);if(!D)continue;const R=D.programConfigurations.get(s.id),Z=h.useProgram("heatmap",R),{zoom:$}=h.transform;Z.draw(p,g.TRIANGLES,St.disabled,v,S,Jt.disabled,ya(k.posMatrix,A,$,s.paint.get("heatmap-intensity")),null,s.id,D.layoutVertexBuffer,D.indexBuffer,D.segments,s.paint,h.transform.zoom,R)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,g){const v=p.context,S=v.gl,E=g.heatmapFbo;if(!E)return;v.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,E.colorAttachment.get()),v.activeTexture.set(S.TEXTURE1);let k=g.colorRampTexture;k||(k=g.colorRampTexture=new Ie(v,g.colorRamp,S.RGBA)),k.bind(S.LINEAR,S.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(v,S.TRIANGLES,St.disabled,qt.disabled,p.colorModeForRenderPass(),Jt.disabled,((A,D,R,Z)=>{const $=l.create();l.ortho($,0,A.width,A.height,0,0,1);const G=A.context.gl;return{u_matrix:$,u_world:[G.drawingBufferWidth,G.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")}})(p,g),null,g.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,g.paint,p.transform.zoom)}(h,s))},line:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),g=s.paint.get("line-width");if(p.constantOr(1)===0||g.constantOr(1)===0)return;const v=h.depthModeForSublayer(0,St.ReadOnly),S=h.colorModeForRenderPass(),E=s.paint.get("line-dasharray"),k=s.paint.get("line-pattern"),A=k.constantOr(1),D=s.paint.get("line-gradient"),R=s.getCrossfadeParameters(),Z=A?"linePattern":E?"lineSDF":D?"lineGradient":"line",$=h.context,G=$.gl;let te=!0;for(const se of c){const ce=t.getTile(se);if(A&&!ce.patternsLoaded())continue;const W=ce.getBucket(s);if(!W)continue;const pe=W.programConfigurations.get(s.id),he=h.context.program.get(),_e=h.useProgram(Z,pe),ve=te||_e.program!==he,ke=h.style.terrain&&h.style.terrain.getTerrainData(se),ye=k.constantOr(null);if(ye&&ce.imageAtlas){const qe=ce.imageAtlas,mt=qe.patternPositions[ye.to.toString()],_t=qe.patternPositions[ye.from.toString()];mt&&_t&&pe.setConstantPatternPositions(mt,_t)}const Ge=ke?se:null,Re=A?va(h,ce,s,R,Ge):E?Is(h,ce,s,E,R,Ge):D?kl(h,ce,s,W.lineClipsArray.length,Ge):No(h,ce,s,Ge);if(A)$.activeTexture.set(G.TEXTURE0),ce.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),pe.updatePaintBuffers(R);else if(E&&(ve||h.lineAtlas.dirty))$.activeTexture.set(G.TEXTURE0),h.lineAtlas.bind($);else if(D){const qe=W.gradients[s.id];let mt=qe.texture;if(s.gradientVersion!==qe.version){let _t=256;if(s.stepInterpolant){const nt=t.getSource().maxzoom,Bt=se.canonical.z===nt?Math.ceil(1<<h.transform.maxZoom-se.canonical.z):1;_t=l.clamp(l.nextPowerOfTwo(W.maxLineLength/l.EXTENT*1024*Bt),256,$.maxTextureSize)}qe.gradient=l.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:_t,image:qe.gradient||void 0,clips:W.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new Ie($,qe.gradient,G.RGBA),qe.version=s.gradientVersion,mt=qe.texture}$.activeTexture.set(G.TEXTURE0),mt.bind(s.stepInterpolant?G.NEAREST:G.LINEAR,G.CLAMP_TO_EDGE)}_e.draw($,G.TRIANGLES,v,h.stencilModeForClipping(se),S,Jt.disabled,Re,ke,s.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,s.paint,h.transform.zoom,pe,W.layoutVertexBuffer2),te=!1}},fill:function(h,t,s,c){const p=s.paint.get("fill-color"),g=s.paint.get("fill-opacity");if(g.constantOr(1)===0)return;const v=h.colorModeForRenderPass(),S=s.paint.get("fill-pattern"),E=h.opaquePassEnabledForLayer()&&!S.constantOr(1)&&p.constantOr(l.Color.transparent).a===1&&g.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===E){const k=h.depthModeForSublayer(1,h.renderPass==="opaque"?St.ReadWrite:St.ReadOnly);Ls(h,t,s,c,k,v,!1)}if(h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const k=h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);Ls(h,t,s,c,k,v,!0)}},"fill-extrusion":function(h,t,s,c){const p=s.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const g=new St(h.context.gl.LEQUAL,St.ReadWrite,h.depthRangeFor3D);if(p!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Rs(h,t,s,c,g,qt.disabled,Ht.disabled),Rs(h,t,s,c,g,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const v=h.colorModeForRenderPass();Rs(h,t,s,c,g,qt.disabled,v)}}},hillshade:function(h,t,s,c){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,g=h.depthModeForSublayer(0,St.ReadOnly),v=h.colorModeForRenderPass(),[S,E]=h.renderPass==="translucent"?h.stencilConfigForOverlap(c):[{},c];for(const k of E){const A=t.getTile(k);A.needsHillshadePrepare!==void 0&&A.needsHillshadePrepare&&h.renderPass==="offscreen"?Ic(h,A,s,g,qt.disabled,v):h.renderPass==="translucent"&&Ul(h,k,A,s,g,S[k.overscaledZ],v)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,t,s,c){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!c.length)return;const p=h.context,g=p.gl,v=t.getSource(),S=h.useProgram("raster"),E=h.colorModeForRenderPass(),[k,A]=v instanceof lt?[{},c]:h.stencilConfigForOverlap(c),D=A[A.length-1].overscaledZ,R=!h.options.moving;for(const Z of A){const $=h.depthModeForSublayer(Z.overscaledZ-D,s.paint.get("raster-opacity")===1?St.ReadWrite:St.ReadOnly,g.LESS),G=t.getTile(Z);G.registerFadeDuration(s.paint.get("raster-fade-duration"));const te=t.findLoadedParent(Z,0),se=Ia(G,te,t,s,h.transform,h.style.terrain);let ce,W;const pe=s.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;p.activeTexture.set(g.TEXTURE0),G.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(g.TEXTURE1),te?(te.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),ce=Math.pow(2,te.tileID.overscaledZ-G.tileID.overscaledZ),W=[G.tileID.canonical.x*ce%1,G.tileID.canonical.y*ce%1]):G.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST);const he=h.style.terrain&&h.style.terrain.getTerrainData(Z),_e=he?Z:null,ve=_e?_e.posMatrix:h.transform.calculatePosMatrix(Z.toUnwrapped(),R),ke=gc(ve,W||[0,0],ce||1,se,s);v instanceof lt?S.draw(p,g.TRIANGLES,$,qt.disabled,E,Jt.disabled,ke,he,s.id,v.boundsBuffer,h.quadTriangleIndexBuffer,v.boundsSegments):S.draw(p,g.TRIANGLES,$,k[Z.overscaledZ],E,Jt.disabled,ke,he,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,t,s,c){const p=s.paint.get("background-color"),g=s.paint.get("background-opacity");if(g===0)return;const v=h.context,S=v.gl,E=h.transform,k=E.tileSize,A=s.paint.get("background-pattern");if(h.isPatternMissing(A))return;const D=!A&&p.a===1&&g===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==D)return;const R=qt.disabled,Z=h.depthModeForSublayer(0,D==="opaque"?St.ReadWrite:St.ReadOnly),$=h.colorModeForRenderPass(),G=h.useProgram(A?"backgroundPattern":"background"),te=c||E.coveringTiles({tileSize:k,terrain:h.style.terrain});A&&(v.activeTexture.set(S.TEXTURE0),h.imageManager.bind(h.context));const se=s.getCrossfadeParameters();for(const ce of te){const W=c?ce.posMatrix:h.transform.calculatePosMatrix(ce.toUnwrapped()),pe=A?Fd(W,g,h,A,{tileID:ce,tileSize:k},se):Bd(W,g,p),he=h.style.terrain&&h.style.terrain.getTerrainData(ce);G.draw(v,S.TRIANGLES,Z,R,$,Jt.disabled,pe,he,s.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,t,s){for(let c=0;c<s.length;c++)Wd(h,t,s[c])},custom:function(h,t,s){const c=h.context,p=s.implementation;if(h.renderPass==="offscreen"){const g=p.prerender;g&&(h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),g.call(p,c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),c.setStencilMode(qt.disabled);const g=p.renderingMode==="3d"?new St(h.context.gl.LEQUAL,St.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,St.ReadOnly);c.setDepthMode(g),p.render(c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState(),c.bindFramebuffer.set(null)}}};class $l{constructor(t,s){this.context=new kc(t),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=tr.maxUnderzooming+tr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ut,this.gpuTimers={}}resize(t,s,c){if(this.width=t*c,this.height=s*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const t=this.context,s=new l.PosArray;s.emplaceBack(0,0),s.emplaceBack(l.EXTENT,0),s.emplaceBack(0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,It.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const c=new l.PosArray;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=t.createVertexBuffer(c,It.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const p=new l.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(l.EXTENT,0,l.EXTENT,0),p.emplaceBack(0,l.EXTENT,0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(p,We.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const g=new l.PosArray;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,It.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const v=new l.LineStripIndexArray;v.emplaceBack(0),v.emplaceBack(1),v.emplaceBack(3),v.emplaceBack(2),v.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(v);const S=new l.TriangleIndexArray;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(S),this.emptyTexture=new Ie(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);const E=this.context.gl;this.stencilClearMode=new qt({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.create();l.ortho(c,0,this.width,this.height,0,0,1),l.scale(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,s.TRIANGLES,St.disabled,this.stencilClearMode,Ht.disabled,Jt.disabled,Oo(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,s){if(this.currentStencilSource===t.source||!t.isTileClipped()||!s||!s.length)return;this.currentStencilSource=t.source;const c=this.context,p=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Ht.disabled),c.setDepthMode(St.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of s){const S=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,E=this.style.terrain&&this.style.terrain.getTerrainData(v);g.draw(c,p.TRIANGLES,St.disabled,new qt({func:p.ALWAYS,mask:0},S,255,p.KEEP,p.KEEP,p.REPLACE),Ht.disabled,Jt.disabled,Oo(v.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new qt({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){const s=this.context.gl;return new qt({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,c=t.sort((v,S)=>S.overscaledZ-v.overscaledZ),p=c[c.length-1].overscaledZ,g=c[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const v={};for(let S=0;S<g;S++)v[S+p]=new qt({func:s.GEQUAL,mask:255},S+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=g,[v,c]}return[{[p]:qt.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ht([t.CONSTANT_COLOR,t.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ht.unblended:Ht.alphaBlended}depthModeForSublayer(t,s,c){if(!this.opaquePassEnabledForLayer())return St.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(c||this.context.gl.LEQUAL,s,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,g=this.style.terrain&&new Mc(this);for(const k in p){const A=p[k];A.used&&A.prepare(this.context)}const v={},S={},E={};for(const k in p){const A=p[k];v[k]=A.getVisibleCoordinates(),S[k]=v[k].slice().reverse(),E[k]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<c.length;k++)if(this.style._layers[c[k]].is3D()){this.opaquePassCutoff=k;break}if(g){this.opaquePassCutoff=0;const k=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(A,D){const R=A.context,Z=R.gl,$=Ht.unblended,G=new St(Z.LEQUAL,St.ReadWrite,[0,1]),te=D.getTerrainMesh(),se=D.sourceCache.getRenderableTiles(),ce=A.useProgram("terrainDepth");R.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),R.clear({color:l.Color.transparent,depth:1});for(const W of se){const pe=D.getTerrainData(W.tileID),he=A.transform.calculatePosMatrix(W.tileID.toUnwrapped());ce.draw(R,Z.TRIANGLES,G,qt.disabled,$,Jt.backCCW,{u_matrix:he},pe,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,A.width,A.height])}(this,this.style.terrain),function(A,D){const R=A.context,Z=R.gl,$=Ht.unblended,G=new St(Z.LEQUAL,St.ReadWrite,[0,1]),te=D.getTerrainMesh(),se=D.getCoordsTexture(),ce=D.sourceCache.getRenderableTiles(),W=A.useProgram("terrainCoords");R.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),R.clear({color:l.Color.transparent,depth:1}),D.coordsIndex=[];for(const pe of ce){const he=D.getTerrainData(pe.tileID);R.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,se.texture);const _e=A.transform.calculatePosMatrix(pe.tileID.toUnwrapped());W.draw(R,Z.TRIANGLES,G,qt.disabled,$,Jt.backCCW,{u_matrix:_e,u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0},he,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),D.coordsIndex.push(pe.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,A.width,A.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const k of c){const A=this.style._layers[k];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const D=S[A.source];(A.type==="custom"||D.length)&&this.renderLayer(this,p[A.source],A,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!g)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[c[this.currentLayer]],A=p[k.source],D=v[k.source];this._renderTileClippingMasks(k,D),this.renderLayer(this,A,k,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const k=this.style._layers[c[this.currentLayer]],A=p[k.source];if(g&&g.renderLayer(k))continue;const D=(k.type==="symbol"?E:S)[k.source];this._renderTileClippingMasks(k,v[k.source]),this.renderLayer(this,A,k,D)}if(this.options.showTileBoundaries){let k,A;Object.values(this.style._layers).forEach(D=>{D.source&&!D.isHidden(this.transform.zoom)&&(D.source!==(A&&A.id)&&(A=this.style.sourceCaches[D.source]),(!k||k.getSource().maxzoom<A.getSource().maxzoom)&&(k=A))}),k&&Fs.debug(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const A=k.transform.padding;ao(k,k.transform.height-(A.top||0),3,za),ao(k,A.bottom||0,3,$r),Bs(k,A.left||0,3,zc),Bs(k,k.transform.width-(A.right||0),3,Vl);const D=k.transform.centerPoint;(function(R,Z,$,G){Go(R,Z-1,$-10,2,20,G),Go(R,Z-10,$-1,20,2,G)})(k,D.x,k.transform.height-D.y,Ac)}(this),this.context.setDefault()}renderLayer(t,s,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,this.gpuTimingStart(c),Fs[c.type](t,s,c,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let c=this.gpuTimers[t.id];c||(c=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),c.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,c.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const s={};for(const c in t){const p=t[c],g=this.context.extTimerQuery,v=g.getQueryObjectEXT(p.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(p.query),s[c]=v}return s}translatePosMatrix(t,s,c,p,g){if(!c[0]&&!c[1])return t;const v=g?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(v){const k=Math.sin(v),A=Math.cos(v);c=[c[0]*A-c[1]*k,c[0]*k+c[1]*A]}const S=[g?c[0]:mn(s,c[0],this.transform.zoom),g?c[1]:mn(s,c[1],this.transform.zoom),0],E=new Float32Array(16);return l.translate(E,t,S),E}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!s||!c}useProgram(t,s){this.cache=this.cache||{};const c=t+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new hc(this.context,t,ks[t],s,Il[t],this._showOverdrawInspector,this.style.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ie(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Pa{constructor(t,s){this.points=t,this.planes=s}static fromInvProjectionMatrix(t,s,c){const p=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const E=1/(S=l.transformMat4([],S,t))[3]/s*p;return l.mul$1(S,S,[E,E,1/S[3],E])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const E=l.sub([],g[S[0]],g[S[1]]),k=l.sub([],g[S[2]],g[S[1]]),A=l.normalize([],l.cross([],E,k)),D=-l.dot(A,g[S[1]]);return A.concat(D)});return new Pa(g,v)}}class Os{constructor(t,s){this.min=t,this.max=s,this.center=l.scale$1([],l.add([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],c=l.clone$2(this.min),p=l.clone$2(this.max);for(let g=0;g<s.length;g++)c[g]=s[g]?this.min[g]:this.center[g],p[g]=s[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Os(c,p)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<t.planes.length;p++){const g=t.planes[p];let v=0;for(let S=0;S<s.length;S++)l.dot$1(g,s[S])>=0&&v++;if(v===0)return 0;v!==s.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let S=0;S<t.points.length;S++){const E=t.points[S][p]-this.min[p];g=Math.min(g,E),v=Math.max(v,E)}if(v<0||g>this.max[p]-this.min[p])return 0}return 1}}class qo{constructor(t=0,s=0,c=0,p=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=c,this.right=p}interpolate(t,s,c){return s.top!=null&&t.top!=null&&(this.top=l.number(t.top,s.top,c)),s.bottom!=null&&t.bottom!=null&&(this.bottom=l.number(t.bottom,s.bottom,c)),s.left!=null&&t.left!=null&&(this.left=l.number(t.left,s.left,c)),s.right!=null&&t.right!=null&&(this.right=l.number(t.right,s.right,c)),this}getCenter(t,s){const c=l.clamp((this.left+t-this.right)/2,0,t),p=l.clamp((this.top+s-this.bottom)/2,0,s);return new l.pointGeometry(c,p)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new qo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Ns{constructor(t,s,c,p,g){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=g===void 0||!!g,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new qo,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new Ns(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t._elevation=this._elevation,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const s=-l.wrap(t,-180,180)*Math.PI/180;var c;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(c=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c),function(p,g,v){var S=g[0],E=g[1],k=g[2],A=g[3],D=Math.sin(v),R=Math.cos(v);p[0]=S*R+k*D,p[1]=E*R+A*D,p[2]=S*-D+k*R,p[3]=E*-D+A*R}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=l.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,c){this._unmodified=!1,this._edgeInsets.interpolate(t,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new l.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new l.pointGeometry(0,0)),p=this.pointCoordinate(new l.pointGeometry(this.width,0)),g=this.pointCoordinate(new l.pointGeometry(this.width,this.height)),v=this.pointCoordinate(new l.pointGeometry(0,this.height)),S=Math.floor(Math.min(c.x,p.x,g.x,v.x)),E=Math.floor(Math.max(c.x,p.x,g.x,v.x)),k=1;for(let A=S-k;A<=E+k;A++)A!==0&&s.push(new l.UnwrappedTileID(A,t))}return s}coveringTiles(t){var s,c;let p=this.coveringZoomLevel(t);const g=p;if(t.minzoom!==void 0&&p<t.minzoom)return[];t.maxzoom!==void 0&&p>t.maxzoom&&(p=t.maxzoom);const v=this.pointCoordinate(this.getCameraPoint()),S=l.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,p),k=[E*v.x,E*v.y,0],A=[E*S.x,E*S.y,0],D=Pa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let R=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(R=p);const Z=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,$=W=>({aabb:new Os([W*E,0,0],[(W+1)*E,E,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),G=[],te=[],se=p,ce=t.reparseOverscaled?g:p;if(this._renderWorldCopies)for(let W=1;W<=3;W++)G.push($(-W)),G.push($(W));for(G.push($(0));G.length>0;){const W=G.pop(),pe=W.x,he=W.y;let _e=W.fullyVisible;if(!_e){const qe=W.aabb.intersects(D);if(qe===0)continue;_e=qe===2}const ve=t.terrain?k:A,ke=W.aabb.distanceX(ve),ye=W.aabb.distanceY(ve),Ge=Math.max(Math.abs(ke),Math.abs(ye)),Re=Z+(1<<se-W.zoom)-2;if(W.zoom===se||Ge>Re&&W.zoom>=R){const qe=se-W.zoom,mt=k[0]-.5-(pe<<qe),_t=k[1]-.5-(he<<qe);te.push({tileID:new l.OverscaledTileID(W.zoom===se?ce:W.zoom,W.wrap,W.zoom,pe,he),distanceSq:l.sqrLen([A[0]-.5-pe,A[1]-.5-he]),tileDistanceToCamera:Math.sqrt(mt*mt+_t*_t)})}else for(let qe=0;qe<4;qe++){const mt=(pe<<1)+qe%2,_t=(he<<1)+(qe>>1),nt=W.zoom+1;let Bt=W.aabb.quadrant(qe);if(t.terrain){const Ft=new l.OverscaledTileID(nt,W.wrap,nt,mt,_t),Et=t.terrain.getMinMaxElevation(Ft),At=(s=Et.minElevation)!==null&&s!==void 0?s:this.elevation,Ut=(c=Et.maxElevation)!==null&&c!==void 0?c:this.elevation;Bt=new Os([Bt.min[0],Bt.min[1],At],[Bt.max[0],Bt.max[1],Ut])}G.push({aabb:Bt,zoom:nt,x:mt,y:_t,wrap:W.wrap,fullyVisible:_e})}}return te.sort((W,pe)=>W.distanceSq-pe.distanceSq).map(W=>W.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=l.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.pointGeometry(l.mercatorXfromLng(t.lng)*this.worldSize,l.mercatorYfromLat(s)*this.worldSize)}unproject(t){return new l.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(t,s){const c=l.MercatorCoordinate.fromLngLat(t),p=(1<<this.tileZoom)*l.EXTENT,g=c.x*p,v=c.y*p,S=Math.floor(g/l.EXTENT),E=Math.floor(v/l.EXTENT),k=new l.OverscaledTileID(this.tileZoom,0,this.tileZoom,S,E);return s.getElevation(k,g%l.EXTENT,v%l.EXTENT,l.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const s=this.pointLocation(this.centerPoint,t),c=this.getElevation(s,t);if(!(this.elevation-c))return;const p=this.getCameraPosition(),g=l.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),v=l.MercatorCoordinate.fromLngLat(s,c),S=g.x-v.x,E=g.y-v.y,k=g.z-v.z,A=Math.sqrt(S*S+E*E+k*k),D=this.scaleZoom(this.cameraToCenterDistance/A/this.tileSize);this._elevation=c,this._center=s,this.zoom=D}setLocationAtPoint(t,s){const c=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(t),v=new l.MercatorCoordinate(g.x-(c.x-p.x),g.y-(c.y-p.y));this.center=this.coordinateLocation(v),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,s){return s?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,s),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,s){return this.coordinateLocation(this.pointCoordinate(t,s))}locationCoordinate(t){return l.MercatorCoordinate.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,s){if(s){const R=s.pointCoordinate(t);if(R!=null)return R}const c=[t.x,t.y,0,1],p=[t.x,t.y,1,1];l.transformMat4(c,c,this.pixelMatrixInverse),l.transformMat4(p,p,this.pixelMatrixInverse);const g=c[3],v=p[3],S=c[1]/g,E=p[1]/v,k=c[2]/g,A=p[2]/v,D=k===A?0:(0-k)/(A-k);return new l.MercatorCoordinate(l.number(c[0]/g,p[0]/v,D)/this.worldSize,l.number(S,E,D)/this.worldSize)}coordinatePoint(t,s=0,c=this.pixelMatrix){const p=[t.x*this.worldSize,t.y*this.worldSize,s,1];return l.transformMat4(p,p,c),new l.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new l.LngLatBounds().extend(this.pointLocation(new l.pointGeometry(0,t))).extend(this.pointLocation(new l.pointGeometry(this.width,t))).extend(this.pointLocation(new l.pointGeometry(this.width,this.height))).extend(this.pointLocation(new l.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,s=!1){const c=t.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const g=t.canonical,v=this.worldSize/this.zoomScale(g.z),S=g.x+Math.pow(2,g.z)*t.wrap,E=l.identity(new Float64Array(16));return l.translate(E,E,[S*v,g.y*v,0]),l.scale(E,E,[v/l.EXTENT,v/l.EXTENT,1]),l.multiply(E,s?this.alignedProjMatrix:this.projMatrix,E),p[c]=new Float32Array(E),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,s,c,p,g=-90,v=90,S=-180,E=180;const k=this.size,A=this._unmodified;if(this.latRange){const Z=this.latRange;g=l.mercatorYfromLat(Z[1])*this.worldSize,v=l.mercatorYfromLat(Z[0])*this.worldSize,t=v-g<k.y?k.y/(v-g):0}if(this.lngRange){const Z=this.lngRange;S=l.wrap(l.mercatorXfromLng(Z[0])*this.worldSize,0,this.worldSize),E=l.wrap(l.mercatorXfromLng(Z[1])*this.worldSize,0,this.worldSize),E<S&&(E+=this.worldSize),s=E-S<k.x?k.x/(E-S):0}const D=this.point,R=Math.max(s||0,t||0);if(R)return this.center=this.unproject(new l.pointGeometry(s?(E+S)/2:D.x,t?(v+g)/2:D.y)),this.zoom+=this.scaleZoom(R),this._unmodified=A,void(this._constraining=!1);if(this.latRange){const Z=D.y,$=k.y/2;Z-$<g&&(p=g+$),Z+$>v&&(p=v-$)}if(this.lngRange){const Z=(S+E)/2,$=l.wrap(D.x,Z-this.worldSize/2,Z+this.worldSize/2),G=k.x/2;$-G<S&&(c=S+G),$+G>E&&(c=E-G)}c===void 0&&p===void 0||(this.center=this.unproject(new l.pointGeometry(c!==void 0?c:D.x,p!==void 0?p:D.y)).wrap()),this._unmodified=A,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=l.identity(new Float64Array(16));l.scale(p,p,[this.width/2,-this.height/2,1]),l.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=l.identity(new Float64Array(16)),l.scale(p,p,[1,-1,1]),l.translate(p,p,[-1,-1,0]),l.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const g=Math.PI/2+this._pitch,v=this._fov*(.5+t.y/this.height),S=Math.sin(v)*this.cameraToSeaLevelDistance/Math.sin(l.clamp(Math.PI-g-v,.01,Math.PI-.01)),E=this.getHorizon(),k=2*Math.atan(E/this.cameraToCenterDistance)*(.5+t.y/(2*E)),A=Math.sin(k)*this.cameraToSeaLevelDistance/Math.sin(l.clamp(Math.PI-g-k,.01,Math.PI-.01)),D=Math.cos(Math.PI/2-this._pitch)*S+this.cameraToSeaLevelDistance,R=Math.cos(Math.PI/2-this._pitch)*A+this.cameraToSeaLevelDistance,Z=1.01*Math.min(D,R),$=this.height/50;p=new Float64Array(16),l.perspective(p,this._fov,this.width/this.height,$,Z),p[8]=2*-t.x/this.width,p[9]=2*t.y/this.height,l.scale(p,p,[1,-1,1]),l.translate(p,p,[0,0,-this.cameraToCenterDistance]),l.rotateX(p,p,this._pitch),l.rotateZ(p,p,this.angle),l.translate(p,p,[-s,-c,0]),this.mercatorMatrix=l.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),l.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,p),l.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=l.invert([],p),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const G=this.width%2/2,te=this.height%2/2,se=Math.cos(this.angle),ce=Math.sin(this.angle),W=s-Math.round(s)+se*G+ce*te,pe=c-Math.round(c)+se*te+ce*G,he=new Float64Array(p);if(l.translate(he,he,[W>.5?W-1:W,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=he,p=l.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new l.pointGeometry(0,0)),s=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.pointGeometry(0,t))}getCameraQueryGeometry(t){const s=this.getCameraPoint();if(t.length===1)return[t[0],s];{let c=s.x,p=s.y,g=s.x,v=s.y;for(const S of t)c=Math.min(c,S.x),p=Math.min(p,S.y),g=Math.max(g,S.x),v=Math.max(v,S.y);return[new l.pointGeometry(c,p),new l.pointGeometry(g,p),new l.pointGeometry(g,v),new l.pointGeometry(c,v),new l.pointGeometry(c,p)]}}}class Dc{constructor(t){this._hashName=t&&encodeURIComponent(t),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(s,c){let p=!1,g=null;const v=()=>{g=null,p&&(s(),g=setTimeout(v,300),p=!1)};return()=>(p=!0,g||v(),g)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),v=Math.round(s.lng*g)/g,S=Math.round(s.lat*g)/g,E=this._map.getBearing(),k=this._map.getPitch();let A="";if(A+=t?`/${v}/${S}/${c}`:`${c}/${S}/${v}`,(E||k)&&(A+="/"+Math.round(10*E)/10),k&&(A+=`/${Math.round(k)}`),this._hashName){const D=this._hashName;let R=!1;const Z=window.location.hash.slice(1).split("&").map($=>{const G=$.split("=")[0];return G===D?(R=!0,`${G}=${A}`):$}).filter($=>$);return R||Z.push(`${D}=${A}`),`#${Z.join("&")}`}return`#${A}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(s=c)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(s=>isNaN(s))){const s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:s,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}}}const Us={linearity:.3,easing:l.bezier(0,0,.3,1)},Lc=l.extend({deceleration:2500,maxSpeed:1400},Us),Rc=l.extend({deceleration:20,maxSpeed:1400},Us),Bc=l.extend({deceleration:1e3,maxSpeed:360},Us),Zo=l.extend({deceleration:1e3,maxSpeed:90},Us);class Fc{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=l.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new l.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)s.zoom+=g.zoomDelta||0,s.bearing+=g.bearingDelta||0,s.pitch+=g.pitchDelta||0,g.panDelta&&s.pan._add(g.panDelta),g.around&&(s.around=g.around),g.pinchAround&&(s.pinchAround=g.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const g=$s(s.pan.mag(),c,l.extend({},Lc,t||{}));p.offset=s.pan.mult(g.amount/s.pan.mag()),p.center=this._map.transform.center,Vs(p,g)}if(s.zoom){const g=$s(s.zoom,c,Rc);p.zoom=this._map.transform.zoom+g.amount,Vs(p,g)}if(s.bearing){const g=$s(s.bearing,c,Bc);p.bearing=this._map.transform.bearing+l.clamp(g.amount,-179,179),Vs(p,g)}if(s.pitch){const g=$s(s.pitch,c,Zo);p.pitch=this._map.transform.pitch+g.amount,Vs(p,g)}if(p.zoom||p.bearing){const g=s.pinchAround===void 0?s.around:s.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),l.extend(p,{noMoveStart:!0})}}function Vs(h,t){(!h.duration||h.duration<t.duration)&&(h.duration=t.duration,h.easing=t.easing)}function $s(h,t,s){const{maxSpeed:c,linearity:p,deceleration:g}=s,v=l.clamp(h*p/(t/1e3),-c,c),S=Math.abs(v)/(g*p);return{easing:s.easing,duration:1e3*S,amount:v*(S/2)}}class yr extends l.Event{constructor(t,s,c,p={}){const g=q.mousePos(s.getCanvasContainer(),c),v=s.unproject(g);super(t,l.extend({point:g,lngLat:v,originalEvent:c},p)),this._defaultPrevented=!1,this.target=s}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class js extends l.Event{constructor(t,s,c){const p=t==="touchend"?c.changedTouches:c.touches,g=q.touchPos(s.getCanvasContainer(),p),v=g.map(E=>s.unproject(E)),S=g.reduce((E,k,A,D)=>E.add(k.div(D.length)),new l.pointGeometry(0,0));super(t,{points:g,point:S,lngLats:v,lngLat:s.unproject(S),originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class _r extends l.Event{constructor(t,s,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Xd{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new _r(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new yr(t.type,this._map,t))}mouseup(t){this._map.fire(new yr(t.type,this._map,t))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new yr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new yr(t.type,this._map,t))}mouseover(t){this._map.fire(new yr(t.type,this._map,t))}mouseout(t){this._map.fire(new yr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new js(t.type,this._map,t))}touchmove(t){this._map.fire(new js(t.type,this._map,t))}touchend(t){this._map.fire(new js(t.type,this._map,t))}touchcancel(t){this._map.fire(new js(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vi{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new yr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new yr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Oc{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(q.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=q.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const g=Math.min(p.x,c.x),v=Math.max(p.x,c.x),S=Math.min(p.y,c.y),E=Math.max(p.y,c.y);q.setTransform(this._box,`translate(${g}px,${S}px)`),this._box.style.width=v-g+"px",this._box.style.height=E-S+"px"}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const c=this._startPos,p=s;if(this.reset(),q.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:g=>g.fitScreenCoordinates(c,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new l.Event(t,{originalEvent:s}))}}function wi(h,t){if(h.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${t.length}`);const s={};for(let c=0;c<h.length;c++)s[h[c].identifier]=t[c];return s}class Gs{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const g=new l.pointGeometry(0,0);for(const v of p)g._add(v);return g.div(p.length)}(s),this.touches=wi(c,s)))}touchmove(t,s,c){if(this.aborted||!this.centroid)return;const p=wi(c,s);for(const g in this.touches){const v=this.touches[g],S=p[g];(!S||S.dist(v)>30)&&(this.aborted=!0)}}touchend(t,s,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class jl{constructor(t){this.singleTap=new Gs(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,s,c){this.singleTap.touchstart(t,s,c)}touchmove(t,s,c){this.singleTap.touchmove(t,s,c)}touchend(t,s,c){const p=this.singleTap.touchend(t,s,c);if(p){const g=t.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(p)<30;if(g&&v||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Kd{constructor(){this._zoomIn=new jl({numTouches:1,numTaps:2}),this._zoomOut=new jl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,c){this._zoomIn.touchstart(t,s,c),this._zoomOut.touchstart(t,s,c)}touchmove(t,s,c){this._zoomIn.touchmove(t,s,c),this._zoomOut.touchmove(t,s,c)}touchend(t,s,c){const p=this._zoomIn.touchend(t,s,c),g=this._zoomOut.touchend(t,s,c);return p?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:v=>v.easeTo({duration:300,zoom:v.getZoom()+1,around:v.unproject(p)},{originalEvent:t})}):g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:v=>v.easeTo({duration:300,zoom:v.getZoom()-1,around:v.unproject(g)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Yd={0:1,2:2};class Ma{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const c=q.mouseButton(t);this._correctButton(t,c)&&(this._lastPoint=s,this._eventButton=c)}mousemoveWindow(t,s){const c=this._lastPoint;if(c){if(t.preventDefault(),function(p,g){const v=Yd[g];return p.buttons===void 0||(p.buttons&v)!==v}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(c,s)}}mouseupWindow(t){this._lastPoint&&q.mouseButton(t)===this._eventButton&&(this._moved&&q.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qs extends Ma{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return s===0&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class bi extends Ma{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const c=.8*(s.x-t.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(t){t.preventDefault()}}class Xe extends Ma{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const c=-.5*(s.y-t.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(t){t.preventDefault()}}class Nc{constructor(t,s){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,s,c){return this._calculateTransform(t,s,c)}touchmove(t,s,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,s,c)}touchend(t,s,c){this._calculateTransform(t,s,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,c){c.length>0&&(this._active=!0);const p=wi(c,s),g=new l.pointGeometry(0,0),v=new l.pointGeometry(0,0);let S=0;for(const k in p){const A=p[k],D=this._touches[k];D&&(g._add(A),v._add(A.sub(D)),S++,p[k]=A)}if(this._touches=p,S<this._minTouches||!v.mag())return;const E=v.div(S);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(S),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,s,c){return{}}touchstart(t,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,c){if(!this._firstTwoTouches)return;t.preventDefault();const[p,g]=this._firstTwoTouches,v=$i(c,s,p),S=$i(c,s,g);if(!v||!S)return;const E=this._aroundCenter?null:v.add(S).div(2);return this._move([v,S],E,t)}touchend(t,s,c){if(!this._firstTwoTouches)return;const[p,g]=this._firstTwoTouches,v=$i(c,s,p),S=$i(c,s,g);v&&S||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $i(h,t,s){for(let c=0;c<h.length;c++)if(h[c].identifier===s)return t[c]}function Gl(h,t){return Math.log(h/t)/Math.LN2}class Ue extends lo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Gl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gl(this._distance,c),pinchAround:s}}}function Da(h,t){return 180*h.angleWith(t)/Math.PI}class Jd extends lo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Da(this._vector,c),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,c=Da(t,this._startVector);return Math.abs(c)<s}}function ql(h){return Math.abs(h.y)>Math.abs(h.x)}class Zl extends lo{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,s,c){super.touchstart(t,s,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,ql(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=t[0].sub(this._lastPoints[0]),g=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(t,s,c){if(this._valid!==void 0)return this._valid;const p=t.mag()>=2,g=s.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const v=t.y>0==s.y>0;return ql(t)&&ql(s)&&v}}const Uc={panStep:100,bearingStep:15,pitchStep:10};class Vc{constructor(){const t=Uc;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,c=0,p=0,g=0,v=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?p=1:(t.preventDefault(),v=-1);break;case 40:t.shiftKey?p=-1:(t.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:S=>{const E=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:Qd,zoom:s?Math.round(E)+s*(t.shiftKey?2:1):E,bearing:S.getBearing()+c*this._bearingStep,pitch:S.getPitch()+p*this._pitchStep,offset:[-g*this._panStep,-v*this._panStep],center:S.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Qd(h){return h*(2-h)}const $c=4.000244140625;class Hl{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;t.preventDefault()}let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=l.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%$c==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=q.mousePos(this._el,t);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>$c?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&E!==0&&(E=1/E);const k=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(k*E))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,p=this._easing;let g,v=!1;if(this._type==="wheel"&&c&&p){const S=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),E=p(S);g=l.number(c,s,E),S<1?this._frameId||(this._frameId=!0):v=!0}else g=s,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=l.ease;if(this._prevEase){const c=this._prevEase,p=(l.exported.now()-c.start)/c.duration,g=c.easing(p+.01)-c.easing(p),v=.27/Math.sqrt(g*g+1e-4)*.01,S=Math.sqrt(.0729-v*v);s=l.bezier(v,S,.25,1)}return this._prevEase={start:l.exported.now(),duration:t,easing:s},s}reset(){this._active=!1}}class Wl{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xl{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,s){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(t.shiftKey?-1:1),around:c.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kl{constructor(){this._tap=new jl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,s,c){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=s[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(t,s,c))}touchmove(t,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=s[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,t.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(t,s,c)}touchend(t,s,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(t,s,c)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nr{constructor(t,s,c){this._el=t,this._mousePan=s,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ji{constructor(t,s,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jc{constructor(t,s,c,p){this._el=t,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ho=h=>h.zoom||h.drag||h.pitch||h.rotate;class Yl extends l.Event{}function Zs(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class Gc{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fc(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),l.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,g,v]of this._listeners)q.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[t,s,c]of this._listeners)q.removeEventListener(t,s,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new Xd(s,t));const p=s.boxZoom=new Oc(s,t);this._add("boxZoom",p);const g=new Kd,v=new Xl;s.doubleClickZoom=new Wl(v,g),this._add("tapZoom",g),this._add("clickZoom",v);const S=new Kl;this._add("tapDragZoom",S);const E=s.touchPitch=new Zl(s);this._add("touchPitch",E);const k=new bi(t),A=new Xe(t);s.dragRotate=new ji(t,k,A),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",A,["mouseRotate"]);const D=new qs(t),R=new Nc(t,s);s.dragPan=new nr(c,D,R),this._add("mousePan",D),this._add("touchPan",R,["touchZoom","touchRotate"]);const Z=new Jd,$=new Ue;s.touchZoomRotate=new jc(c,$,Z,S),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",$,["touchPan","touchRotate"]);const G=s.scrollZoom=new Hl(s,this);this._add("scrollZoom",G,["mousePan"]);const te=s.keyboard=new Vc;this._add("keyboard",te),this._add("blockableMapEvent",new Vi(s));for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[se]&&s[se].enable(t[se])}_add(t,s,c){this._handlers.push({handlerName:t,handler:s,allowed:c}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Ho(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,s,c){for(const p in t)if(p!==c&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const c of t)this._el.contains(c.target)&&s.push(c);return s}handleEvent(t,s){if(t.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=t.type==="renderFrame"?void 0:t,p={needsRenderFrame:!1},g={},v={},S=t.touches,E=S?this._getMapTouches(S):void 0,k=E?q.touchPos(this._el,E):q.mousePos(this._el,t);for(const{handlerName:R,handler:Z,allowed:$}of this._handlers){if(!Z.isEnabled())continue;let G;this._blockedByActive(v,$,R)?Z.reset():Z[s||t.type]&&(G=Z[s||t.type](t,k,E),this.mergeHandlerResult(p,g,G,R,c),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||Z.isActive())&&(v[R]=Z)}const A={};for(const R in this._previousActiveHandlers)v[R]||(A[R]=c);this._previousActiveHandlers=v,(Object.keys(A).length||Zs(p))&&(this._changes.push([p,g,A]),this._triggerRenderFrame()),(Object.keys(v).length||Zs(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:D}=p;D&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],D(this._map))}mergeHandlerResult(t,s,c,p,g){if(!c)return;l.extend(t,c);const v={handlerName:p,originalEvent:c.originalEvent||g};c.zoomDelta!==void 0&&(s.zoom=v),c.panDelta!==void 0&&(s.drag=v),c.pitchDelta!==void 0&&(s.pitch=v),c.bearingDelta!==void 0&&(s.rotate=v)}_applyChanges(){const t={},s={},c={};for(const[p,g,v]of this._changes)p.panDelta&&(t.panDelta=(t.panDelta||new l.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(t.around=p.around),p.pinchAround!==void 0&&(t.pinchAround=p.pinchAround),p.noInertia&&(t.noInertia=p.noInertia),l.extend(s,g),l.extend(c,v);this._updateMapTransform(t,s,c),this._changes=[]}_updateMapTransform(t,s,c){const p=this._map,g=p.transform,v=p.style&&p.style.terrain;if(!(Zs(t)||v&&this._drag))return this._fireEvents(s,c,!0);let{panDelta:S,zoomDelta:E,bearingDelta:k,pitchDelta:A,around:D,pinchAround:R}=t;R!==void 0&&(D=R),p._stop(!0),D=D||p.transform.centerPoint;const Z=g.pointLocation(S?D.sub(S):D);k&&(g.bearing+=k),A&&(g.pitch+=A),E&&(g.zoom+=E),v?s.drag&&!this._drag?(this._drag={center:g.centerPoint,lngLat:g.pointLocation(D),point:D,handlerName:s.drag.handlerName},p.fire(new l.Event("freezeElevation",{freeze:!0}))):this._drag&&c[this._drag.handlerName]?(p.fire(new l.Event("freezeElevation",{freeze:!1})),this._drag=null):s.drag&&this._drag&&(g.center=g.pointLocation(g.centerPoint.sub(S))):g.setLocationAtPoint(Z,D),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,c,!0)}_fireEvents(t,s,c){const p=Ho(this._eventsInProgress),g=Ho(t),v={};for(const A in t){const{originalEvent:D}=t[A];this._eventsInProgress[A]||(v[`${A}start`]=D),this._eventsInProgress[A]=t[A]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(const A in v)this._fireEvent(A,v[A]);g&&this._fireEvent("move",g.originalEvent);for(const A in t){const{originalEvent:D}=t[A];this._fireEvent(A,D)}const S={};let E;for(const A in this._eventsInProgress){const{handlerName:D,originalEvent:R}=this._eventsInProgress[A];this._handlersById[D].isActive()||(delete this._eventsInProgress[A],E=s[D]||R,S[`${A}end`]=E)}for(const A in S)this._fireEvent(A,S[A]);const k=Ho(this._eventsInProgress);if(c&&(p||g)&&!k){this._updatingCamera=!0;const A=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=R=>R!==0&&-this._bearingSnap<R&&R<this._bearingSnap;A?(D(A.bearing||this._map.getBearing())&&(A.bearing=0),this._map.easeTo(A,{originalEvent:E})):(this._map.fire(new l.Event("moveend",{originalEvent:E})),D(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new l.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new Yl("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ar={extend:(h,...t)=>l.extend(h,...t),run(h){h()},logToElement(h,t=!1,s="log"){const c=window.document.getElementById(s);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${h}`)}};class Qt extends l.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,c){return t=l.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,l.extend({offset:t},s),c)}panTo(t,s,c){return this.easeTo(l.extend({center:t},s),c)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,c){return this.easeTo(l.extend({zoom:t},s),c)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,c){return this.easeTo(l.extend({bearing:t},s),c)}resetNorth(t,s){return this.rotateTo(0,l.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=l.LngLatBounds.convert(t);const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,s)}_cameraForBoxAndBearing(t,s,c,p){const g={top:0,bottom:0,right:0,left:0};if(typeof(p=l.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const he=p.padding;p.padding={top:he,bottom:he,right:he,left:he}}p.padding=l.extend(g,p.padding);const v=this.transform,S=v.padding,E=v.project(l.LngLat.convert(t)),k=v.project(l.LngLat.convert(s)),A=E.rotate(-c*Math.PI/180),D=k.rotate(-c*Math.PI/180),R=new l.pointGeometry(Math.max(A.x,D.x),Math.max(A.y,D.y)),Z=new l.pointGeometry(Math.min(A.x,D.x),Math.min(A.y,D.y)),$=R.sub(Z),G=(v.width-(S.left+S.right+p.padding.left+p.padding.right))/$.x,te=(v.height-(S.top+S.bottom+p.padding.top+p.padding.bottom))/$.y;if(te<0||G<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const se=Math.min(v.scaleZoom(v.scale*Math.min(G,te)),p.maxZoom),ce=l.pointGeometry.convert(p.offset),W=new l.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),pe=ce.add(W).mult(v.scale/v.zoomScale(se));return{center:v.unproject(E.add(k).div(2).sub(pe)),zoom:se,bearing:c}}fitBounds(t,s,c){return this._fitInternal(this.cameraForBounds(t,s),s,c)}fitScreenCoordinates(t,s,c,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.pointGeometry.convert(t)),this.transform.pointLocation(l.pointGeometry.convert(s)),c,p),p,g)}_fitInternal(t,s,c){return t?(delete(s=l.extend(t,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(t,s){this.stop();const c=this.transform;let p=!1,g=!1,v=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(p=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=l.LngLat.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(g=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(v=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),p&&this.fire(new l.Event("zoomstart",s)).fire(new l.Event("zoom",s)).fire(new l.Event("zoomend",s)),g&&this.fire(new l.Event("rotatestart",s)).fire(new l.Event("rotate",s)).fire(new l.Event("rotateend",s)),v&&this.fire(new l.Event("pitchstart",s)).fire(new l.Event("pitch",s)).fire(new l.Event("pitchend",s)),this.fire(new l.Event("moveend",s))}calculateCameraOptionsFromTo(t,s,c,p=0){const g=l.MercatorCoordinate.fromLngLat(t,s),v=l.MercatorCoordinate.fromLngLat(c,p),S=v.x-g.x,E=v.y-g.y,k=v.z-g.z,A=Math.hypot(S,E,k);if(A===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(S,E),R=this.transform.scaleZoom(this.transform.cameraToCenterDistance/A/this.transform.tileSize),Z=180*Math.atan2(S,-E)/Math.PI;let $=180*Math.acos(D/A)/Math.PI;return $=k<0?90-$:90+$,{center:v.toLngLat(),zoom:R,pitch:$,bearing:Z}}easeTo(t,s){this._stop(!1,t.easeId),((t=l.extend({offset:[0,0],duration:500,easing:l.ease},t)).animate===!1||!t.essential&&l.exported.prefersReducedMotion)&&(t.duration=0);const c=this.transform,p=this.getZoom(),g=this.getBearing(),v=this.getPitch(),S=this.getPadding(),E="zoom"in t?+t.zoom:p,k="bearing"in t?this._normalizeBearing(t.bearing,g):g,A="pitch"in t?+t.pitch:v,D="padding"in t?t.padding:c.padding,R=l.pointGeometry.convert(t.offset);let Z=c.centerPoint.add(R);const $=c.pointLocation(Z),G=l.LngLat.convert(t.center||$);this._normalizeCenter(G);const te=c.project($),se=c.project(G).sub(te),ce=c.zoomScale(E-p);let W,pe;t.around&&(W=l.LngLat.convert(t.around),pe=c.locationPoint(W));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==p,this._rotating=this._rotating||g!==k,this._pitching=this._pitching||A!==v,this._padding=!c.isPaddingEqual(D),this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,he),this._ease(_e=>{if(this._zooming&&(c.zoom=l.number(p,E,_e)),this._rotating&&(c.bearing=l.number(g,k,_e)),this._pitching&&(c.pitch=l.number(v,A,_e)),this._padding&&(c.interpolatePadding(S,D,_e),Z=c.centerPoint.add(R)),W)c.setLocationAtPoint(W,pe);else{const ve=c.zoomScale(c.zoom-p),ke=E>p?Math.min(2,ce):Math.max(.5,ce),ye=Math.pow(ke,1-_e),Ge=c.unproject(te.add(se.mult(_e*ye)).mult(ve));c.setLocationAtPoint(c.renderWorldCopies?Ge.wrap():Ge,Z)}this._fireMoveEvents(s)},_e=>{this._afterEase(s,_e)},t),this}_prepareEase(t,s,c={}){this._moving=!0,this.fire(new l.Event("freezeElevation",{freeze:!0})),s||c.moving||this.fire(new l.Event("movestart",t)),this._zooming&&!c.zooming&&this.fire(new l.Event("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new l.Event("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new l.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new l.Event("move",t)),this._zooming&&this.fire(new l.Event("zoom",t)),this._rotating&&this.fire(new l.Event("rotate",t)),this._pitching&&this.fire(new l.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId,this.fire(new l.Event("freezeElevation",{freeze:!1}));const c=this._zooming,p=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new l.Event("zoomend",t)),p&&this.fire(new l.Event("rotateend",t)),g&&this.fire(new l.Event("pitchend",t)),this.fire(new l.Event("moveend",t))}flyTo(t,s){if(!t.essential&&l.exported.prefersReducedMotion){const nt=l.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(nt,s)}this.stop(),t=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},t);const c=this.transform,p=this.getZoom(),g=this.getBearing(),v=this.getPitch(),S=this.getPadding(),E="zoom"in t?l.clamp(+t.zoom,c.minZoom,c.maxZoom):p,k="bearing"in t?this._normalizeBearing(t.bearing,g):g,A="pitch"in t?+t.pitch:v,D="padding"in t?t.padding:c.padding,R=c.zoomScale(E-p),Z=l.pointGeometry.convert(t.offset);let $=c.centerPoint.add(Z);const G=c.pointLocation($),te=l.LngLat.convert(t.center||G);this._normalizeCenter(te);const se=c.project(G),ce=c.project(te).sub(se);let W=t.curve;const pe=Math.max(c.width,c.height),he=pe/R,_e=ce.mag();if("minZoom"in t){const nt=l.clamp(Math.min(t.minZoom,p,E),c.minZoom,c.maxZoom),Bt=pe/c.zoomScale(nt-p);W=Math.sqrt(Bt/_e*2)}const ve=W*W;function ke(nt){const Bt=(he*he-pe*pe+(nt?-1:1)*ve*ve*_e*_e)/(2*(nt?he:pe)*ve*_e);return Math.log(Math.sqrt(Bt*Bt+1)-Bt)}function ye(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function Ge(nt){return(Math.exp(nt)+Math.exp(-nt))/2}const Re=ke(0);let qe=function(nt){return Ge(Re)/Ge(Re+W*nt)},mt=function(nt){return pe*((Ge(Re)*(ye(Bt=Re+W*nt)/Ge(Bt))-ye(Re))/ve)/_e;var Bt},_t=(ke(1)-Re)/W;if(Math.abs(_e)<1e-6||!isFinite(_t)){if(Math.abs(pe-he)<1e-6)return this.easeTo(t,s);const nt=he<pe?-1:1;_t=Math.abs(Math.log(he/pe))/W,mt=function(){return 0},qe=function(Bt){return Math.exp(nt*W*Bt)}}return t.duration="duration"in t?+t.duration:1e3*_t/("screenSpeed"in t?+t.screenSpeed/W:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=g!==k,this._pitching=A!==v,this._padding=!c.isPaddingEqual(D),this._prepareEase(s,!1),this._ease(nt=>{const Bt=nt*_t,Ft=1/qe(Bt);c.zoom=nt===1?E:p+c.scaleZoom(Ft),this._rotating&&(c.bearing=l.number(g,k,nt)),this._pitching&&(c.pitch=l.number(v,A,nt)),this._padding&&(c.interpolatePadding(S,D,nt),$=c.centerPoint.add(Z));const Et=nt===1?te:c.unproject(se.add(ce.mult(mt(Bt))).mult(Ft));c.setLocationAtPoint(c.renderWorldCopies?Et.wrap():Et,$),this._fireMoveEvents(s)},()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,s)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,s,c){c.animate===!1||c.duration===0?(t(1),s()):(this._easeStart=l.exported.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=l.wrap(t,-180,180);const c=Math.abs(t-s);return Math.abs(t-360-s)<c&&(t-=360),Math.abs(t+360-s)<c&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const c=t.lng-s.center.lng;t.lng+=c>180?-360:c<-180?360:0}}class Hs{constructor(t={}){this.options=t,l.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=q.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=q.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const c=this._map._getUIString(`AttributionControl.${s}`);t.title=c,t.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"&&t.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const g=s[p];if(g.used||g.usedForTerrain){const v=g.getSource();v.attribution&&t.indexOf(v.attribution)<0&&t.push(v.attribution)}}t=t.filter(p=>String(p).trim()),t.sort((p,g)=>p.length-g.length),t=t.filter((p,g)=>{for(let v=g+1;v<t.length;v++)if(t[v].indexOf(p)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class La{constructor(t={}){this.options=t,l.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=q.create("div","maplibregl-ctrl mapboxgl-ctrl");const s=q.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&s.classList.add("maplibregl-compact","mapboxgl-compact"):s.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class qc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const p of c)if(p.id===t)return void(p.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Zc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Hc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},ep={showCompass:!0,showZoom:!0,visualizePitch:!1};class ri{constructor(t,s,c=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new bi({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,c&&(this.mousePitch=new Xe({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),q.addEventListener(s,"mousedown",this.mousedown),q.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(s,"touchmove",this.touchmove),q.addEventListener(s,"touchend",this.touchend),q.addEventListener(s,"touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),q.disableDrag()}move(t,s){const c=this.map,p=this.mouseRotate.mousemoveWindow(t,s);if(p&&p.bearingDelta&&c.setBearing(c.getBearing()+p.bearingDelta),this.mousePitch){const g=this.mousePitch.mousemoveWindow(t,s);g&&g.pitchDelta&&c.setPitch(c.getPitch()+g.pitchDelta)}}off(){const t=this.element;q.removeEventListener(t,"mousedown",this.mousedown),q.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(t,"touchmove",this.touchmove),q.removeEventListener(t,"touchend",this.touchend),q.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(window,"mousemove",this.mousemove),q.removeEventListener(window,"mouseup",this.mouseup)}mousedown(t){this.down(l.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),q.mousePos(this.element,t)),q.addEventListener(window,"mousemove",this.mousemove),q.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.move(t,q.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ws(h,t,s){if(h=new l.LngLat(h.lng,h.lat),t){const c=new l.LngLat(h.lng-360,h.lat),p=new l.LngLat(h.lng+360,h.lat),g=s.locationPoint(h).distSqr(t);s.locationPoint(c).distSqr(t)<g?h=c:s.locationPoint(p).distSqr(t)<g&&(h=p)}for(;Math.abs(h.lng-s.center.lng)>180;){const c=s.locationPoint(h);if(c.x>=0&&c.y>=0&&c.x<=s.width&&c.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const Qe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ot(h,t,s){const c=h.classList;for(const p in Qe)c.remove(`maplibregl-${s}-anchor-${p}`,`mapboxgl-${s}-anchor-${p}`);c.add(`maplibregl-${s}-anchor-${t}`,`mapboxgl-${s}-anchor-${t}`)}class Wo extends l.Evented{constructor(t,s){if(super(),(t instanceof HTMLElement||s)&&(t=l.extend({element:t},s)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=l.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div"),this._element.setAttribute("aria-label","Map marker");const c=q.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${g}px`),c.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const v=q.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const S=q.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const E=q.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of k){const W=q.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",ce.rx),W.setAttributeNS(null,"ry",ce.ry),E.appendChild(W)}const A=q.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const D=q.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(D);const R=q.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");const Z=q.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(Z);const $=q.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const G=q.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=q.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const se=q.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#FFFFFF"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962"),G.appendChild(te),G.appendChild(se),S.appendChild(E),S.appendChild(A),S.appendChild(R),S.appendChild($),S.appendChild(G),c.appendChild(S),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(c),this._offset=l.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),ot(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const s=t.code,c=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,c=this._element;this._popup&&(s===c||c.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ws(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(s=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),t&&t.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,`${Qe[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${s}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),g=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*g?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(t){return this._offset=l.pointGeometry.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const s=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Jl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Gi,Ln=0,qi=!1;const ii={maxWidth:100,unit:"metric"};function Wc(h,t,s){const c=s&&s.maxWidth||100,p=h._container.clientHeight/2,g=h.unproject([0,p]),v=h.unproject([c,p]),S=g.distanceTo(v);if(s&&s.unit==="imperial"){const E=3.2808*S;E>5280?Zi(t,c,E/5280,h._getUIString("ScaleControl.Miles")):Zi(t,c,E,h._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Zi(t,c,S/1852,h._getUIString("ScaleControl.NauticalMiles")):S>=1e3?Zi(t,c,S/1e3,h._getUIString("ScaleControl.Kilometers")):Zi(t,c,S,h._getUIString("ScaleControl.Meters"))}function Zi(h,t,s,c){const p=function(g){const v=Math.pow(10,`${Math.floor(g)}`.length-1);let S=g/v;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(E){const k=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*k)/k}(S),v*S}(s);h.style.width=t*(p/s)+"px",h.innerHTML=`${p}&nbsp;${c}`}const ln={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},gn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ql(h){if(h){if(typeof h=="number"){const t=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new l.pointGeometry(0,0),top:new l.pointGeometry(0,h),"top-left":new l.pointGeometry(t,t),"top-right":new l.pointGeometry(-t,t),bottom:new l.pointGeometry(0,-h),"bottom-left":new l.pointGeometry(t,-t),"bottom-right":new l.pointGeometry(-t,-t),left:new l.pointGeometry(h,0),right:new l.pointGeometry(-h,0)}}if(h instanceof l.pointGeometry||Array.isArray(h)){const t=l.pointGeometry.convert(h);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.pointGeometry.convert(h.center||[0,0]),top:l.pointGeometry.convert(h.top||[0,0]),"top-left":l.pointGeometry.convert(h["top-left"]||[0,0]),"top-right":l.pointGeometry.convert(h["top-right"]||[0,0]),bottom:l.pointGeometry.convert(h.bottom||[0,0]),"bottom-left":l.pointGeometry.convert(h["bottom-left"]||[0,0]),"bottom-right":l.pointGeometry.convert(h["bottom-right"]||[0,0]),left:l.pointGeometry.convert(h.left||[0,0]),right:l.pointGeometry.convert(h.right||[0,0])}}return Ql(new l.pointGeometry(0,0))}const uo={supported:N,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends Qt{constructor(h){var t;if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(h=l.extend({},Hc,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ns(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new qc,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Zc,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(t=h.pixelRatio)!==null&&t!==void 0?t:devicePixelRatio,this._requestManager=new Ae(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Gc(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new Dc(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new Hs({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new La,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new l.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new l.Event(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new l.Event("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(h,t){if(t===void 0&&(t=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(h);return t>-1&&this._controls.splice(t,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,t,s,c){return c==null&&this.style.terrain&&(c=this.transform.getElevation(s,this.style.terrain)),super.calculateCameraOptionsFromTo(h,t,s,c)}resize(h){const t=this._containerDimensions(),s=t[0],c=t[1];this._resizeCanvas(s,c,this.getPixelRatio()),this.transform.resize(s,c),this.painter.resize(s,c,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new l.Event("movestart",h)).fire(new l.Event("move",h))),this.fire(new l.Event("resize",h)),p&&this.fire(new l.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[t,s]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(t,s,h),this.painter.resize(t,s,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(l.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint(l.LngLat.convert(h),this.style&&this.style.terrain)}unproject(h){return this.transform.pointLocation(l.pointGeometry.convert(h),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(h,t,s){if(h==="mouseenter"||h==="mouseover"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:g=>{const v=this.getLayer(t)?this.queryRenderedFeatures(g.point,{layers:[t]}):[];v.length?c||(c=!0,s.call(this,new yr(h,this,g.originalEvent,{features:v}))):c=!1},mouseout:()=>{c=!1}}}}if(h==="mouseleave"||h==="mouseout"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:v=>{(this.getLayer(t)?this.queryRenderedFeatures(v.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,s.call(this,new yr(h,this,v.originalEvent)))},mouseout:v=>{c&&(c=!1,s.call(this,new yr(h,this,v.originalEvent)))}}}}{const c=p=>{const g=this.getLayer(t)?this.queryRenderedFeatures(p.point,{layers:[t]}):[];g.length&&(p.features=g,s.call(this,p),delete p.features)};return{layer:t,listener:s,delegates:{[h]:c}}}}on(h,t,s){if(s===void 0)return super.on(h,t);const c=this._createDelegatedListener(h,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(h,t,s){if(s===void 0)return super.once(h,t);const c=this._createDelegatedListener(h,t,s);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(h,t,s){return s===void 0?super.off(h,t):(this._delegatedListeners&&this._delegatedListeners[h]&&(c=>{const p=this._delegatedListeners[h];for(let g=0;g<p.length;g++){const v=p[g];if(v.layer===t&&v.listener===s){for(const S in v.delegates)this.off(S,v.delegates[S]);return p.splice(g,1),this}}})(),this)}queryRenderedFeatures(h,t){if(!this.style)return[];let s;if(t!==void 0||h===void 0||h instanceof l.pointGeometry||Array.isArray(h)||(t=h,h=void 0),t=t||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof l.pointGeometry||typeof h[0]=="number")s=[l.pointGeometry.convert(h)];else{const c=l.pointGeometry.convert(h[0]),p=l.pointGeometry.convert(h[1]);s=[c,new l.pointGeometry(p.x,c.y),p,new l.pointGeometry(c.x,p.y),c]}return this.style.queryRenderedFeatures(s,t,this.transform)}querySourceFeatures(h,t){return this.style.querySourceFeatures(h,t)}setStyle(h,t){return(t=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(h,t))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const t=this._locale[h];if(t==null)throw new Error(`Missing UI string '${h}'`);return t}_updateStyle(h,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new Nn(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Nn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,t){if(typeof h=="string"){const s=this._requestManager.transformRequest(h,l.ResourceType.Style);l.getJSON(s,(c,p)=>{c?this.fire(new l.ErrorEvent(c)):p&&this._updateDiff(p,t)})}else typeof h=="object"&&this._updateDiff(h,t)}_updateDiff(h,t){try{this.style.setState(h)&&this._update(!0)}catch(s){l.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(h,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(h,t){return this._lazyInitEmptyStyle(),this.style.addSource(h,t),this._update(!0)}isSourceLoaded(h){const t=this.style&&this.style.sourceCaches[h];if(t!==void 0)return t.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){return this.style.setTerrain(h),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const t in h){const s=h[t]._tiles;for(const c in s){const p=s[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,t,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,t,s)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,t,{pixelRatio:s=1,sdf:c=!1,stretchX:p,stretchY:g,content:v}={}){if(this._lazyInitEmptyStyle(),t instanceof HTMLImageElement||l.isImageBitmap(t)){const{width:S,height:E,data:k}=l.exported.getImageData(t);this.style.addImage(h,{data:new l.RGBAImage({width:S,height:E},k),pixelRatio:s,stretchX:p,stretchY:g,content:v,sdf:c,version:0})}else{if(t.width===void 0||t.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:S,height:E,data:k}=t,A=t;this.style.addImage(h,{data:new l.RGBAImage({width:S,height:E},new Uint8Array(k)),pixelRatio:s,stretchX:p,stretchY:g,content:v,sdf:c,version:0,userImage:A}),A.onAdd&&A.onAdd(this,h)}}}updateImage(h,t){const s=this.style.getImage(h);if(!s)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||l.isImageBitmap(t)?l.exported.getImageData(t):t,{width:p,height:g,data:v}=c;if(p===void 0||g===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||g!==s.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(t instanceof HTMLImageElement||l.isImageBitmap(t));s.data.replace(v,S),this.style.updateImage(h,s)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,t){l.getImage(this._requestManager.transformRequest(h,l.ResourceType.Image),t)}listImages(){return this.style.listImages()}addLayer(h,t){return this._lazyInitEmptyStyle(),this.style.addLayer(h,t),this._update(!0)}moveLayer(h,t){return this.style.moveLayer(h,t),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,t,s){return this.style.setLayerZoomRange(h,t,s),this._update(!0)}setFilter(h,t,s={}){return this.style.setFilter(h,t,s),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,t,s,c={}){return this.style.setPaintProperty(h,t,s,c),this._update(!0)}getPaintProperty(h,t){return this.style.getPaintProperty(h,t)}setLayoutProperty(h,t,s,c={}){return this.style.setLayoutProperty(h,t,s,c),this._update(!0)}getLayoutProperty(h,t){return this.style.getLayoutProperty(h,t)}setLight(h,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,t){return this.style.setFeatureState(h,t),this._update()}removeFeatureState(h,t){return this.style.removeFeatureState(h,t),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,t=0;return this._container&&(h=this._container.clientWidth||400,t=this._container.clientHeight||300),[h,t]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map","mapboxgl-map");const t=this._canvasContainer=q.create("div","maplibregl-canvas-container mapboxgl-canvas-container",h);this._interactive&&t.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=q.create("canvas","maplibregl-canvas mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions();this._resizeCanvas(s[0],s[1],this.getPixelRatio());const c=this._controlContainer=q.create("div","maplibregl-control-container mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=q.create("div",`maplibregl-ctrl-${g} mapboxgl-ctrl-${g}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const h=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=q.create("div","maplibregl-cooperative-gesture-screen",h);let t="Control",s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",t="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${s}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",c=>{c.key===t&&(this._metaPress=!0)}),document.addEventListener("keyup",c=>{c.key===t&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",c=>{this._onCooperativeGesture(c,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(h,t,s){this._canvas.width=s*h,this._canvas.height=s*t,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const h=l.extend({},N.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);t?(this.painter=new $l(t,this.transform),l.exported$1.testSupport(t)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,t,s){return!t&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){let t,s=0;const c=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(t=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,t),s=l.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,S=l.exported.now();this.style.zoomHistory.update(v,S);const E=new l.EvaluationParameters(v,{now:S,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=E.crossFadingFactor();k===1&&k===this._crossFadingFactor||(p=!0,this._crossFadingFactor=k),this.style.update(E)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const v=l.exported.now()-s;c.endQueryEXT(c.TIME_ELAPSED_EXT,t),setTimeout(()=>{const S=c.getQueryObjectEXT(t,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(t),this.fire(new l.Event("gpu-timing-frame",{cpuTime:v,gpuTime:S}))},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const S=this.painter.queryGpuTimers(v);this.fire(new l.Event("gpu-timing-layer",{layerTimes:S}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),q.remove(this._canvasContainer),q.remove(this._controlContainer),this._cooperativeGestures&&q.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.exported.frame(h=>{l.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,t){l.setCacheLimits(h,t)}get version(){return"2.4.0"}},NavigationControl:class{constructor(h){this.options=l.extend({},ep,h),this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),t=h===this._map.getMaxZoom(),s=h===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ri(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,t){const s=q.create("button",h,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(h,t){const s=this._map._getUIString(`NavigationControl.${t}`);h.title=s,h.setAttribute("aria-label",s)}},GeolocateControl:class extends l.Evented{constructor(h){super(),this.options=l.extend({},Jl,h),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){var t;return this._map=h,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,Gi!==void 0?t(Gi):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(s=>{Gi=s.state!=="denied",t(Gi)}):(Gi=!!window.navigator.geolocation,t(Gi)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ln=0,qi=!1}_isOutOfMapMaxBounds(h){const t=this._map.getMaxBounds(),s=h.coords;return t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",h)),this._finish()}}_updateCamera(h){const t=new l.LngLat(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,c=this._map.getBearing(),p=l.extend({bearing:c},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),p,{geolocateSource:!0})}_updateMarker(h){if(h){const t=new l.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.clientHeight/2,t=this._map.unproject([0,h]),s=this._map.unproject([1,h]),c=t.distanceTo(s),p=Math.ceil(2*this._accuracy/c);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&qi)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=q.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wo(this._dotElement),this._circleElement=q.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ln--,qi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ln++,Ln>1?(h={maximumAge:6e5,timeout:0},qi=!0):(h=this.options.positionOptions,qi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Hs,LogoControl:La,ScaleControl:class{constructor(h){this.options=l.extend({},ii,h),l.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Wc(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,Wc(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=q.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(h){this.options=h,l.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=q.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),q.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){q.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends l.Evented{constructor(h){super(),this.options=l.extend(Object.create(ln),h),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=l.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const t=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=h;c=s.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=q.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=q.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(g=>this._container.classList.add(g)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ws(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const t=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let s=this.options.anchor;const c=Ql(this.options.offset);if(!s){const g=this._container.offsetWidth,v=this._container.offsetHeight;let S;S=t.y+c.bottom.y<v?["top"]:t.y>this._map.transform.height-v?["bottom"]:[],t.x<g/2?S.push("left"):t.x>this._map.transform.width-g/2&&S.push("right"),s=S.length===0?"bottom":S.join("-")}const p=t.add(c[s]).round();q.setTransform(this._container,`${Qe[s]} translate(${p.x}px,${p.y}px)`),ot(this._container,s,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(gn);h&&h.focus()}_onClose(){this.remove()}},Marker:Wo,Style:Nn,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.pointGeometry,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,AJAXError:l.AJAXError,config:l.config,CanvasSource:Vt,GeoJSONSource:hr,ImageSource:lt,RasterDEMTileSource:at,RasterTileSource:Nr,VectorTileSource:Ir,VideoSource:ct,prewarm:function(){Po().acquire(gi)},clearPrewarmedResources:function(){const h=Bi;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(gi),Bi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return pr.workerCount},set workerCount(h){pr.workerCount=h},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){l.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){l.clearTileCache(h)},workerUrl:"",addProtocol(h,t){l.config.REGISTERED_PROTOCOLS[h]=t},removeProtocol(h){delete l.config.REGISTERED_PROTOCOLS[h]}};return Ar.extend(uo,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),uo});var I=_;return I})})(lS);const uS=pm;const _f=({longitude:n,latitude:o,zoom:u,style:f="https://tile.openstreetmap.jp/styles/osm-bright/style.json"})=>Tt(lg,{mapLib:uS,initialViewState:{longitude:n,latitude:o,zoom:u},cursor:"default",doubleClickZoom:!1,dragRotate:!1,dragPan:!1,keyboard:!1,scrollZoom:!1,touchPitch:!1,touchZoomRotate:!1,style:{display:"block",width:"100%",height:"25vh"},mapStyle:f,children:Tt(sS,{position:"bottom-right"})}),J_=({src:n})=>ui("div",{className:"section-background",children:[Tt("div",{className:"section-background-overlay"}),Tt("img",{src:n})]}),cS="OpenStoryMaps",hS="Open source story telling with maps",dS="2022-12-31",pS="yuiseki",fS="/unopengis-dwg7.jpg";function Q_(n){const o=Object.assign({section:"section",h2:"h2",p:"p",blockquote:"blockquote",a:"a"},n.components);return ui(uv,{children:[ui(o.section,{children:[Tt(o.h2,{id:"what-is-this",children:"What is this?"}),Tt(o.p,{children:"OpenStoryMaps is a software designed to tell a story along with Maps."}),Tt(o.p,{children:`Really many people want to tell their story, with Maps.
They also need to tell their story with Data visualization.`}),Tt(o.p,{children:"OpenStoryMaps allows you to tell a story with Maps and Data by simply writing Markdown."}),Tt(o.p,{children:`This web page demonstrates what is possible with OpenStoryMaps.
Let's scroll down.`})]}),`
`,ui(o.section,{children:[Tt(o.h2,{id:"unhq-ny-usa",children:"UNHQ, NY, USA"}),Tt(J_,{src:"/UNHQ_NYC.jpg"}),Tt(_f,{longitude:-73.968056,latitude:40.749444,zoom:15}),ui(o.blockquote,{children:[`
`,Tt(o.p,{children:`The United Nations is headquartered in Midtown Manhattan, New York City, United
States, and the complex has served as the official headquarters of the United Nations
since its completion in 1951. It is in the Turtle Bay neighborhood of Manhattan,
on 17 to 18 acres (6.9 to 7.3 ha) of grounds overlooking the East River. Its borders
are First Avenue on the west, East 42nd Street to the south, East 48th Street on
the north, and the East River to the east.`}),`
`]}),Tt(o.p,{children:Tt(o.a,{href:"https://en.wikipedia.org/wiki/Headquarters_of_the_United_Nations",children:"https://en.wikipedia.org/wiki/Headquarters_of_the_United_Nations"})})]}),`
`,ui(o.section,{children:[Tt(o.h2,{id:"ungsc-brindisi-italy",children:"UNGSC, Brindisi, Italy"}),Tt(J_,{src:"/UNGSC_Logo.png"}),Tt(_f,{longitude:17.9466719,latitude:40.6494882,zoom:17}),ui(o.blockquote,{children:[`
`,Tt(o.p,{children:`The United Nations Global Service Centre (UNGSC) is United Nations Peacekeeping office
based in Brindisi, Italy, as well as Valencia, Spain that provides logistics, geospatial
intelligence, IT services and training to peacekeeping and special political missions
around the world.`}),`
`]}),Tt(o.p,{children:Tt(o.a,{href:"https://en.wikipedia.org/wiki/United_Nations_Global_Service_Centre",children:"https://en.wikipedia.org/wiki/United_Nations_Global_Service_Centre"})})]}),`
`,ui(o.section,{children:[Tt(o.h2,{id:"geospatial-information-authority-of-japan",children:"Geospatial Information Authority of Japan"}),Tt(_f,{style:"/gsi_ort.json",longitude:140.084583,latitude:36.104583,zoom:16}),ui(o.blockquote,{children:[`
`,Tt(o.p,{children:`The Geospatial Information Authority of Japan (国土地理院, Kokudo Chiri-in), or GSI, is
the national institution responsible for surveying and mapping the national land of Japan.
The former name of the organization from 1949 until March 2010 was Geographical Survey Institute;
despite the rename, it retains the same initials.`}),`
`]}),Tt(o.p,{children:Tt(o.a,{href:"https://en.wikipedia.org/wiki/Geospatial_Information_Authority_of_Japan",children:"https://en.wikipedia.org/wiki/Geospatial_Information_Authority_of_Japan"})})]})]})}function mS(n={}){const{wrapper:o}=n.components||{};return o?Tt(o,Object.assign({},n,{children:Tt(Q_,n)})):Q_(n)}const gS=()=>(pt.useEffect(()=>(G_.init({tocSelector:"#toc",contentSelector:"#root",headingSelector:"h2"}),()=>G_.destroy()),[]),ui(uv,{children:[ui("section",{id:"hero",children:[Tt("div",{id:"hero-background",children:Tt("img",{src:fS})}),Tt("div",{id:"hero-overlay"}),ui("div",{id:"hero-content",children:[Tt("h1",{children:cS}),Tt("h3",{children:hS}),Tt("div",{children:pS}),Tt("div",{children:dS})]})]}),Tt("div",{id:"toc"}),Tt(mS,{})]}));A2.render(Tt(vw.StrictMode,{children:Tt(gS,{})}),document.getElementById("root"));
