(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))y(_);new MutationObserver(_=>{for(const S of _)if(S.type==="childList")for(const M of S.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&y(M)}).observe(document,{childList:!0,subtree:!0});function u(_){const S={};return _.integrity&&(S.integrity=_.integrity),_.referrerPolicy&&(S.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?S.credentials="include":_.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function y(_){if(_.ep)return;_.ep=!0;const S=u(_);fetch(_.href,S)}})();var rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bv={exports:{}},jd={},Ov={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ic=Symbol.for("react.element"),Kw=Symbol.for("react.portal"),Yw=Symbol.for("react.fragment"),Qw=Symbol.for("react.strict_mode"),Jw=Symbol.for("react.profiler"),eb=Symbol.for("react.provider"),tb=Symbol.for("react.context"),ib=Symbol.for("react.forward_ref"),nb=Symbol.for("react.suspense"),rb=Symbol.for("react.memo"),sb=Symbol.for("react.lazy"),f_=Symbol.iterator;function ob(i){return i===null||typeof i!="object"?null:(i=f_&&i[f_]||i["@@iterator"],typeof i=="function"?i:null)}var Nv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vv=Object.assign,Uv={};function Rl(i,s,u){this.props=i,this.context=s,this.refs=Uv,this.updater=u||Nv}Rl.prototype.isReactComponent={};Rl.prototype.setState=function(i,s){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,s,"setState")};Rl.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function jv(){}jv.prototype=Rl.prototype;function Om(i,s,u){this.props=i,this.context=s,this.refs=Uv,this.updater=u||Nv}var Nm=Om.prototype=new jv;Nm.constructor=Om;Vv(Nm,Rl.prototype);Nm.isPureReactComponent=!0;var m_=Array.isArray,$v=Object.prototype.hasOwnProperty,Vm={current:null},qv={key:!0,ref:!0,__self:!0,__source:!0};function Zv(i,s,u){var y,_={},S=null,M=null;if(s!=null)for(y in s.ref!==void 0&&(M=s.ref),s.key!==void 0&&(S=""+s.key),s)$v.call(s,y)&&!qv.hasOwnProperty(y)&&(_[y]=s[y]);var l=arguments.length-2;if(l===1)_.children=u;else if(1<l){for(var N=Array(l),R=0;R<l;R++)N[R]=arguments[R+2];_.children=N}if(i&&i.defaultProps)for(y in l=i.defaultProps,l)_[y]===void 0&&(_[y]=l[y]);return{$$typeof:Ic,type:i,key:S,ref:M,props:_,_owner:Vm.current}}function ab(i,s){return{$$typeof:Ic,type:i.type,key:s,ref:i.ref,props:i.props,_owner:i._owner}}function Um(i){return typeof i=="object"&&i!==null&&i.$$typeof===Ic}function lb(i){var s={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(u){return s[u]})}var g_=/\/+/g;function pf(i,s){return typeof i=="object"&&i!==null&&i.key!=null?lb(""+i.key):s.toString(36)}function sd(i,s,u,y,_){var S=typeof i;(S==="undefined"||S==="boolean")&&(i=null);var M=!1;if(i===null)M=!0;else switch(S){case"string":case"number":M=!0;break;case"object":switch(i.$$typeof){case Ic:case Kw:M=!0}}if(M)return M=i,_=_(M),i=y===""?"."+pf(M,0):y,m_(_)?(u="",i!=null&&(u=i.replace(g_,"$&/")+"/"),sd(_,s,u,"",function(R){return R})):_!=null&&(Um(_)&&(_=ab(_,u+(!_.key||M&&M.key===_.key?"":(""+_.key).replace(g_,"$&/")+"/")+i)),s.push(_)),1;if(M=0,y=y===""?".":y+":",m_(i))for(var l=0;l<i.length;l++){S=i[l];var N=y+pf(S,l);M+=sd(S,s,u,N,_)}else if(N=ob(i),typeof N=="function")for(i=N.call(i),l=0;!(S=i.next()).done;)S=S.value,N=y+pf(S,l++),M+=sd(S,s,u,N,_);else if(S==="object")throw s=String(i),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return M}function Uh(i,s,u){if(i==null)return i;var y=[],_=0;return sd(i,y,"","",function(S){return s.call(u,S,_++)}),y}function ub(i){if(i._status===-1){var s=i._result;s=s(),s.then(function(u){(i._status===0||i._status===-1)&&(i._status=1,i._result=u)},function(u){(i._status===0||i._status===-1)&&(i._status=2,i._result=u)}),i._status===-1&&(i._status=0,i._result=s)}if(i._status===1)return i._result.default;throw i._result}var On={current:null},od={transition:null},cb={ReactCurrentDispatcher:On,ReactCurrentBatchConfig:od,ReactCurrentOwner:Vm};Pt.Children={map:Uh,forEach:function(i,s,u){Uh(i,function(){s.apply(this,arguments)},u)},count:function(i){var s=0;return Uh(i,function(){s++}),s},toArray:function(i){return Uh(i,function(s){return s})||[]},only:function(i){if(!Um(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Pt.Component=Rl;Pt.Fragment=Yw;Pt.Profiler=Jw;Pt.PureComponent=Om;Pt.StrictMode=Qw;Pt.Suspense=nb;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cb;Pt.cloneElement=function(i,s,u){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var y=Vv({},i.props),_=i.key,S=i.ref,M=i._owner;if(s!=null){if(s.ref!==void 0&&(S=s.ref,M=Vm.current),s.key!==void 0&&(_=""+s.key),i.type&&i.type.defaultProps)var l=i.type.defaultProps;for(N in s)$v.call(s,N)&&!qv.hasOwnProperty(N)&&(y[N]=s[N]===void 0&&l!==void 0?l[N]:s[N])}var N=arguments.length-2;if(N===1)y.children=u;else if(1<N){l=Array(N);for(var R=0;R<N;R++)l[R]=arguments[R+2];y.children=l}return{$$typeof:Ic,type:i.type,key:_,ref:S,props:y,_owner:M}};Pt.createContext=function(i){return i={$$typeof:tb,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:eb,_context:i},i.Consumer=i};Pt.createElement=Zv;Pt.createFactory=function(i){var s=Zv.bind(null,i);return s.type=i,s};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(i){return{$$typeof:ib,render:i}};Pt.isValidElement=Um;Pt.lazy=function(i){return{$$typeof:sb,_payload:{_status:-1,_result:i},_init:ub}};Pt.memo=function(i,s){return{$$typeof:rb,type:i,compare:s===void 0?null:s}};Pt.startTransition=function(i){var s=od.transition;od.transition={};try{i()}finally{od.transition=s}};Pt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Pt.useCallback=function(i,s){return On.current.useCallback(i,s)};Pt.useContext=function(i){return On.current.useContext(i)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(i){return On.current.useDeferredValue(i)};Pt.useEffect=function(i,s){return On.current.useEffect(i,s)};Pt.useId=function(){return On.current.useId()};Pt.useImperativeHandle=function(i,s,u){return On.current.useImperativeHandle(i,s,u)};Pt.useInsertionEffect=function(i,s){return On.current.useInsertionEffect(i,s)};Pt.useLayoutEffect=function(i,s){return On.current.useLayoutEffect(i,s)};Pt.useMemo=function(i,s){return On.current.useMemo(i,s)};Pt.useReducer=function(i,s,u){return On.current.useReducer(i,s,u)};Pt.useRef=function(i){return On.current.useRef(i)};Pt.useState=function(i){return On.current.useState(i)};Pt.useSyncExternalStore=function(i,s,u){return On.current.useSyncExternalStore(i,s,u)};Pt.useTransition=function(){return On.current.useTransition()};Pt.version="18.2.0";Ov.exports=Pt;var pt=Ov.exports;const hb=Ud(pt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var db=pt,pb=Symbol.for("react.element"),fb=Symbol.for("react.fragment"),mb=Object.prototype.hasOwnProperty,gb=db.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yb={key:!0,ref:!0,__self:!0,__source:!0};function Gv(i,s,u){var y,_={},S=null,M=null;u!==void 0&&(S=""+u),s.key!==void 0&&(S=""+s.key),s.ref!==void 0&&(M=s.ref);for(y in s)mb.call(s,y)&&!yb.hasOwnProperty(y)&&(_[y]=s[y]);if(i&&i.defaultProps)for(y in s=i.defaultProps,s)_[y]===void 0&&(_[y]=s[y]);return{$$typeof:pb,type:i,key:S,ref:M,props:_,_owner:gb.current}}jd.Fragment=fb;jd.jsx=Gv;jd.jsxs=Gv;Bv.exports=jd;var st=Bv.exports,Hv={exports:{}},dr={},Wv={exports:{}},Xv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function s(He,dt){var yt=He.length;He.push(dt);e:for(;0<yt;){var $t=yt-1>>>1,Nt=He[$t];if(0<_(Nt,dt))He[$t]=dt,He[yt]=Nt,yt=$t;else break e}}function u(He){return He.length===0?null:He[0]}function y(He){if(He.length===0)return null;var dt=He[0],yt=He.pop();if(yt!==dt){He[0]=yt;e:for(var $t=0,Nt=He.length,Dt=Nt>>>1;$t<Dt;){var ci=2*($t+1)-1,tr=He[ci],hn=ci+1,ir=He[hn];if(0>_(tr,yt))hn<Nt&&0>_(ir,tr)?(He[$t]=ir,He[hn]=yt,$t=hn):(He[$t]=tr,He[ci]=yt,$t=ci);else if(hn<Nt&&0>_(ir,yt))He[$t]=ir,He[hn]=yt,$t=hn;else break e}}return dt}function _(He,dt){var yt=He.sortIndex-dt.sortIndex;return yt!==0?yt:He.id-dt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var S=performance;i.unstable_now=function(){return S.now()}}else{var M=Date,l=M.now();i.unstable_now=function(){return M.now()-l}}var N=[],R=[],re=1,de=null,te=3,Pe=!1,ke=!1,Me=!1,ut=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(He){for(var dt=u(R);dt!==null;){if(dt.callback===null)y(R);else if(dt.startTime<=He)y(R),dt.sortIndex=dt.expirationTime,s(N,dt);else break;dt=u(R)}}function ve(He){if(Me=!1,se(He),!ke)if(u(N)!==null)ke=!0,kn(Fe);else{var dt=u(R);dt!==null&&qi(ve,dt.startTime-He)}}function Fe(He,dt){ke=!1,Me&&(Me=!1,ee(Be),Be=-1),Pe=!0;var yt=te;try{for(se(dt),de=u(N);de!==null&&(!(de.expirationTime>dt)||He&&!Ot());){var $t=de.callback;if(typeof $t=="function"){de.callback=null,te=de.priorityLevel;var Nt=$t(de.expirationTime<=dt);dt=i.unstable_now(),typeof Nt=="function"?de.callback=Nt:de===u(N)&&y(N),se(dt)}else y(N);de=u(N)}if(de!==null)var Dt=!0;else{var ci=u(R);ci!==null&&qi(ve,ci.startTime-dt),Dt=!1}return Dt}finally{de=null,te=yt,Pe=!1}}var Oe=!1,Ge=null,Be=-1,Et=5,tt=-1;function Ot(){return!(i.unstable_now()-tt<Et)}function ui(){if(Ge!==null){var He=i.unstable_now();tt=He;var dt=!0;try{dt=Ge(!0,He)}finally{dt?$i():(Oe=!1,Ge=null)}}else Oe=!1}var $i;if(typeof Y=="function")$i=function(){Y(ui)};else if(typeof MessageChannel<"u"){var Di=new MessageChannel,Ji=Di.port2;Di.port1.onmessage=ui,$i=function(){Ji.postMessage(null)}}else $i=function(){ut(ui,0)};function kn(He){Ge=He,Oe||(Oe=!0,$i())}function qi(He,dt){Be=ut(function(){He(i.unstable_now())},dt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(He){He.callback=null},i.unstable_continueExecution=function(){ke||Pe||(ke=!0,kn(Fe))},i.unstable_forceFrameRate=function(He){0>He||125<He?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Et=0<He?Math.floor(1e3/He):5},i.unstable_getCurrentPriorityLevel=function(){return te},i.unstable_getFirstCallbackNode=function(){return u(N)},i.unstable_next=function(He){switch(te){case 1:case 2:case 3:var dt=3;break;default:dt=te}var yt=te;te=dt;try{return He()}finally{te=yt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(He,dt){switch(He){case 1:case 2:case 3:case 4:case 5:break;default:He=3}var yt=te;te=He;try{return dt()}finally{te=yt}},i.unstable_scheduleCallback=function(He,dt,yt){var $t=i.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?$t+yt:$t):yt=$t,He){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=yt+Nt,He={id:re++,callback:dt,priorityLevel:He,startTime:yt,expirationTime:Nt,sortIndex:-1},yt>$t?(He.sortIndex=yt,s(R,He),u(N)===null&&He===u(R)&&(Me?(ee(Be),Be=-1):Me=!0,qi(ve,yt-$t))):(He.sortIndex=Nt,s(N,He),ke||Pe||(ke=!0,kn(Fe))),He},i.unstable_shouldYield=Ot,i.unstable_wrapCallback=function(He){var dt=te;return function(){var yt=te;te=dt;try{return He.apply(this,arguments)}finally{te=yt}}}})(Xv);Wv.exports=Xv;var _b=Wv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv=pt,hr=_b;function Le(i){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yv=new Set,hc={};function va(i,s){El(i,s),El(i+"Capture",s)}function El(i,s){for(hc[i]=s,i=0;i<s.length;i++)Yv.add(s[i])}var js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gf=Object.prototype.hasOwnProperty,vb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y_={},__={};function xb(i){return Gf.call(__,i)?!0:Gf.call(y_,i)?!1:vb.test(i)?__[i]=!0:(y_[i]=!0,!1)}function wb(i,s,u,y){if(u!==null&&u.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return y?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function bb(i,s,u,y){if(s===null||typeof s>"u"||wb(i,s,u,y))return!0;if(y)return!1;if(u!==null)switch(u.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Nn(i,s,u,y,_,S,M){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=y,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=i,this.type=s,this.sanitizeURL=S,this.removeEmptyString=M}var cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){cn[i]=new Nn(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var s=i[0];cn[s]=new Nn(s,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){cn[i]=new Nn(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){cn[i]=new Nn(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){cn[i]=new Nn(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){cn[i]=new Nn(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){cn[i]=new Nn(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){cn[i]=new Nn(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){cn[i]=new Nn(i,5,!1,i.toLowerCase(),null,!1,!1)});var jm=/[\-:]([a-z])/g;function $m(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var s=i.replace(jm,$m);cn[s]=new Nn(s,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var s=i.replace(jm,$m);cn[s]=new Nn(s,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var s=i.replace(jm,$m);cn[s]=new Nn(s,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){cn[i]=new Nn(i,1,!1,i.toLowerCase(),null,!1,!1)});cn.xlinkHref=new Nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){cn[i]=new Nn(i,1,!1,i.toLowerCase(),null,!0,!0)});function qm(i,s,u,y){var _=cn.hasOwnProperty(s)?cn[s]:null;(_!==null?_.type!==0:y||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(bb(s,u,_,y)&&(u=null),y||_===null?xb(s)&&(u===null?i.removeAttribute(s):i.setAttribute(s,""+u)):_.mustUseProperty?i[_.propertyName]=u===null?_.type===3?!1:"":u:(s=_.attributeName,y=_.attributeNamespace,u===null?i.removeAttribute(s):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,y?i.setAttributeNS(y,s,u):i.setAttribute(s,u))))}var Gs=Kv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jh=Symbol.for("react.element"),ul=Symbol.for("react.portal"),cl=Symbol.for("react.fragment"),Zm=Symbol.for("react.strict_mode"),Hf=Symbol.for("react.profiler"),Qv=Symbol.for("react.provider"),Jv=Symbol.for("react.context"),Gm=Symbol.for("react.forward_ref"),Wf=Symbol.for("react.suspense"),Xf=Symbol.for("react.suspense_list"),Hm=Symbol.for("react.memo"),_o=Symbol.for("react.lazy"),e0=Symbol.for("react.offscreen"),v_=Symbol.iterator;function qu(i){return i===null||typeof i!="object"?null:(i=v_&&i[v_]||i["@@iterator"],typeof i=="function"?i:null)}var xi=Object.assign,ff;function Qu(i){if(ff===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);ff=s&&s[1]||""}return`
`+ff+i}var mf=!1;function gf(i,s){if(!i||mf)return"";mf=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(R){var y=R}Reflect.construct(i,[],s)}else{try{s.call()}catch(R){y=R}i.call(s.prototype)}else{try{throw Error()}catch(R){y=R}i()}}catch(R){if(R&&y&&typeof R.stack=="string"){for(var _=R.stack.split(`
`),S=y.stack.split(`
`),M=_.length-1,l=S.length-1;1<=M&&0<=l&&_[M]!==S[l];)l--;for(;1<=M&&0<=l;M--,l--)if(_[M]!==S[l]){if(M!==1||l!==1)do if(M--,l--,0>l||_[M]!==S[l]){var N=`
`+_[M].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=M&&0<=l);break}}}finally{mf=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?Qu(i):""}function Sb(i){switch(i.tag){case 5:return Qu(i.type);case 16:return Qu("Lazy");case 13:return Qu("Suspense");case 19:return Qu("SuspenseList");case 0:case 2:case 15:return i=gf(i.type,!1),i;case 11:return i=gf(i.type.render,!1),i;case 1:return i=gf(i.type,!0),i;default:return""}}function Kf(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case cl:return"Fragment";case ul:return"Portal";case Hf:return"Profiler";case Zm:return"StrictMode";case Wf:return"Suspense";case Xf:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Jv:return(i.displayName||"Context")+".Consumer";case Qv:return(i._context.displayName||"Context")+".Provider";case Gm:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Hm:return s=i.displayName||null,s!==null?s:Kf(i.type)||"Memo";case _o:s=i._payload,i=i._init;try{return Kf(i(s))}catch{}}return null}function Tb(i){var s=i.type;switch(i.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=s.render,i=i.displayName||i.name||"",s.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kf(s);case 8:return s===Zm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Lo(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function t0(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function kb(i){var s=t0(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),y=""+i[s];if(!i.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,S=u.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return _.call(this)},set:function(M){y=""+M,S.call(this,M)}}),Object.defineProperty(i,s,{enumerable:u.enumerable}),{getValue:function(){return y},setValue:function(M){y=""+M},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function $h(i){i._valueTracker||(i._valueTracker=kb(i))}function i0(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var u=s.getValue(),y="";return i&&(y=t0(i)?i.checked?"true":"false":i.value),i=y,i!==u?(s.setValue(i),!0):!1}function yd(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Yf(i,s){var u=s.checked;return xi({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function x_(i,s){var u=s.defaultValue==null?"":s.defaultValue,y=s.checked!=null?s.checked:s.defaultChecked;u=Lo(s.value!=null?s.value:u),i._wrapperState={initialChecked:y,initialValue:u,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function n0(i,s){s=s.checked,s!=null&&qm(i,"checked",s,!1)}function Qf(i,s){n0(i,s);var u=Lo(s.value),y=s.type;if(u!=null)y==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(y==="submit"||y==="reset"){i.removeAttribute("value");return}s.hasOwnProperty("value")?Jf(i,s.type,u):s.hasOwnProperty("defaultValue")&&Jf(i,s.type,Lo(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(i.defaultChecked=!!s.defaultChecked)}function w_(i,s,u){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var y=s.type;if(!(y!=="submit"&&y!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+i._wrapperState.initialValue,u||s===i.value||(i.value=s),i.defaultValue=s}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function Jf(i,s,u){(s!=="number"||yd(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var Ju=Array.isArray;function wl(i,s,u,y){if(i=i.options,s){s={};for(var _=0;_<u.length;_++)s["$"+u[_]]=!0;for(u=0;u<i.length;u++)_=s.hasOwnProperty("$"+i[u].value),i[u].selected!==_&&(i[u].selected=_),_&&y&&(i[u].defaultSelected=!0)}else{for(u=""+Lo(u),s=null,_=0;_<i.length;_++){if(i[_].value===u){i[_].selected=!0,y&&(i[_].defaultSelected=!0);return}s!==null||i[_].disabled||(s=i[_])}s!==null&&(s.selected=!0)}}function em(i,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Le(91));return xi({},s,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function b_(i,s){var u=s.value;if(u==null){if(u=s.children,s=s.defaultValue,u!=null){if(s!=null)throw Error(Le(92));if(Ju(u)){if(1<u.length)throw Error(Le(93));u=u[0]}s=u}s==null&&(s=""),u=s}i._wrapperState={initialValue:Lo(u)}}function r0(i,s){var u=Lo(s.value),y=Lo(s.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),s.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),y!=null&&(i.defaultValue=""+y)}function S_(i){var s=i.textContent;s===i._wrapperState.initialValue&&s!==""&&s!==null&&(i.value=s)}function s0(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tm(i,s){return i==null||i==="http://www.w3.org/1999/xhtml"?s0(s):i==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var qh,o0=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,u,y,_){MSApp.execUnsafeLocalFunction(function(){return i(s,u,y,_)})}:i}(function(i,s){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=s;else{for(qh=qh||document.createElement("div"),qh.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=qh.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;s.firstChild;)i.appendChild(s.firstChild)}});function dc(i,s){if(s){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=s;return}}i.textContent=s}var ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cb=["Webkit","ms","Moz","O"];Object.keys(ic).forEach(function(i){Cb.forEach(function(s){s=s+i.charAt(0).toUpperCase()+i.substring(1),ic[s]=ic[i]})});function a0(i,s,u){return s==null||typeof s=="boolean"||s===""?"":u||typeof s!="number"||s===0||ic.hasOwnProperty(i)&&ic[i]?(""+s).trim():s+"px"}function l0(i,s){i=i.style;for(var u in s)if(s.hasOwnProperty(u)){var y=u.indexOf("--")===0,_=a0(u,s[u],y);u==="float"&&(u="cssFloat"),y?i.setProperty(u,_):i[u]=_}}var Eb=xi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function im(i,s){if(s){if(Eb[i]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Le(137,i));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Le(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Le(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Le(62))}}function nm(i,s){if(i.indexOf("-")===-1)return typeof s.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rm=null;function Wm(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var sm=null,bl=null,Sl=null;function T_(i){if(i=zc(i)){if(typeof sm!="function")throw Error(Le(280));var s=i.stateNode;s&&(s=Hd(s),sm(i.stateNode,i.type,s))}}function u0(i){bl?Sl?Sl.push(i):Sl=[i]:bl=i}function c0(){if(bl){var i=bl,s=Sl;if(Sl=bl=null,T_(i),s)for(i=0;i<s.length;i++)T_(s[i])}}function h0(i,s){return i(s)}function d0(){}var yf=!1;function p0(i,s,u){if(yf)return i(s,u);yf=!0;try{return h0(i,s,u)}finally{yf=!1,(bl!==null||Sl!==null)&&(d0(),c0())}}function pc(i,s){var u=i.stateNode;if(u===null)return null;var y=Hd(u);if(y===null)return null;u=y[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(i=i.type,y=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!y;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(Le(231,s,typeof u));return u}var om=!1;if(js)try{var Zu={};Object.defineProperty(Zu,"passive",{get:function(){om=!0}}),window.addEventListener("test",Zu,Zu),window.removeEventListener("test",Zu,Zu)}catch{om=!1}function Ib(i,s,u,y,_,S,M,l,N){var R=Array.prototype.slice.call(arguments,3);try{s.apply(u,R)}catch(re){this.onError(re)}}var nc=!1,_d=null,vd=!1,am=null,Pb={onError:function(i){nc=!0,_d=i}};function Mb(i,s,u,y,_,S,M,l,N){nc=!1,_d=null,Ib.apply(Pb,arguments)}function zb(i,s,u,y,_,S,M,l,N){if(Mb.apply(this,arguments),nc){if(nc){var R=_d;nc=!1,_d=null}else throw Error(Le(198));vd||(vd=!0,am=R)}}function xa(i){var s=i,u=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,s.flags&4098&&(u=s.return),i=s.return;while(i)}return s.tag===3?u:null}function f0(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function k_(i){if(xa(i)!==i)throw Error(Le(188))}function Ab(i){var s=i.alternate;if(!s){if(s=xa(i),s===null)throw Error(Le(188));return s!==i?null:i}for(var u=i,y=s;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(y=_.return,y!==null){u=y;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return k_(_),i;if(S===y)return k_(_),s;S=S.sibling}throw Error(Le(188))}if(u.return!==y.return)u=_,y=S;else{for(var M=!1,l=_.child;l;){if(l===u){M=!0,u=_,y=S;break}if(l===y){M=!0,y=_,u=S;break}l=l.sibling}if(!M){for(l=S.child;l;){if(l===u){M=!0,u=S,y=_;break}if(l===y){M=!0,y=S,u=_;break}l=l.sibling}if(!M)throw Error(Le(189))}}if(u.alternate!==y)throw Error(Le(190))}if(u.tag!==3)throw Error(Le(188));return u.stateNode.current===u?i:s}function m0(i){return i=Ab(i),i!==null?g0(i):null}function g0(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var s=g0(i);if(s!==null)return s;i=i.sibling}return null}var y0=hr.unstable_scheduleCallback,C_=hr.unstable_cancelCallback,Lb=hr.unstable_shouldYield,Db=hr.unstable_requestPaint,Li=hr.unstable_now,Rb=hr.unstable_getCurrentPriorityLevel,Xm=hr.unstable_ImmediatePriority,_0=hr.unstable_UserBlockingPriority,xd=hr.unstable_NormalPriority,Fb=hr.unstable_LowPriority,v0=hr.unstable_IdlePriority,$d=null,ms=null;function Bb(i){if(ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot($d,i,void 0,(i.current.flags&128)===128)}catch{}}var Xr=Math.clz32?Math.clz32:Vb,Ob=Math.log,Nb=Math.LN2;function Vb(i){return i>>>=0,i===0?32:31-(Ob(i)/Nb|0)|0}var Zh=64,Gh=4194304;function ec(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function wd(i,s){var u=i.pendingLanes;if(u===0)return 0;var y=0,_=i.suspendedLanes,S=i.pingedLanes,M=u&268435455;if(M!==0){var l=M&~_;l!==0?y=ec(l):(S&=M,S!==0&&(y=ec(S)))}else M=u&~_,M!==0?y=ec(M):S!==0&&(y=ec(S));if(y===0)return 0;if(s!==0&&s!==y&&!(s&_)&&(_=y&-y,S=s&-s,_>=S||_===16&&(S&4194240)!==0))return s;if(y&4&&(y|=u&16),s=i.entangledLanes,s!==0)for(i=i.entanglements,s&=y;0<s;)u=31-Xr(s),_=1<<u,y|=i[u],s&=~_;return y}function Ub(i,s){switch(i){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jb(i,s){for(var u=i.suspendedLanes,y=i.pingedLanes,_=i.expirationTimes,S=i.pendingLanes;0<S;){var M=31-Xr(S),l=1<<M,N=_[M];N===-1?(!(l&u)||l&y)&&(_[M]=Ub(l,s)):N<=s&&(i.expiredLanes|=l),S&=~l}}function lm(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function x0(){var i=Zh;return Zh<<=1,!(Zh&4194240)&&(Zh=64),i}function _f(i){for(var s=[],u=0;31>u;u++)s.push(i);return s}function Pc(i,s,u){i.pendingLanes|=s,s!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,s=31-Xr(s),i[s]=u}function $b(i,s){var u=i.pendingLanes&~s;i.pendingLanes=s,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=s,i.mutableReadLanes&=s,i.entangledLanes&=s,s=i.entanglements;var y=i.eventTimes;for(i=i.expirationTimes;0<u;){var _=31-Xr(u),S=1<<_;s[_]=0,y[_]=-1,i[_]=-1,u&=~S}}function Km(i,s){var u=i.entangledLanes|=s;for(i=i.entanglements;u;){var y=31-Xr(u),_=1<<y;_&s|i[y]&s&&(i[y]|=s),u&=~_}}var Gt=0;function w0(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var b0,Ym,S0,T0,k0,um=!1,Hh=[],ko=null,Co=null,Eo=null,fc=new Map,mc=new Map,xo=[],qb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E_(i,s){switch(i){case"focusin":case"focusout":ko=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":Eo=null;break;case"pointerover":case"pointerout":fc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(s.pointerId)}}function Gu(i,s,u,y,_,S){return i===null||i.nativeEvent!==S?(i={blockedOn:s,domEventName:u,eventSystemFlags:y,nativeEvent:S,targetContainers:[_]},s!==null&&(s=zc(s),s!==null&&Ym(s)),i):(i.eventSystemFlags|=y,s=i.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),i)}function Zb(i,s,u,y,_){switch(s){case"focusin":return ko=Gu(ko,i,s,u,y,_),!0;case"dragenter":return Co=Gu(Co,i,s,u,y,_),!0;case"mouseover":return Eo=Gu(Eo,i,s,u,y,_),!0;case"pointerover":var S=_.pointerId;return fc.set(S,Gu(fc.get(S)||null,i,s,u,y,_)),!0;case"gotpointercapture":return S=_.pointerId,mc.set(S,Gu(mc.get(S)||null,i,s,u,y,_)),!0}return!1}function C0(i){var s=ua(i.target);if(s!==null){var u=xa(s);if(u!==null){if(s=u.tag,s===13){if(s=f0(u),s!==null){i.blockedOn=s,k0(i.priority,function(){S0(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ad(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var u=cm(i.domEventName,i.eventSystemFlags,s[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var y=new u.constructor(u.type,u);rm=y,u.target.dispatchEvent(y),rm=null}else return s=zc(u),s!==null&&Ym(s),i.blockedOn=u,!1;s.shift()}return!0}function I_(i,s,u){ad(i)&&u.delete(s)}function Gb(){um=!1,ko!==null&&ad(ko)&&(ko=null),Co!==null&&ad(Co)&&(Co=null),Eo!==null&&ad(Eo)&&(Eo=null),fc.forEach(I_),mc.forEach(I_)}function Hu(i,s){i.blockedOn===s&&(i.blockedOn=null,um||(um=!0,hr.unstable_scheduleCallback(hr.unstable_NormalPriority,Gb)))}function gc(i){function s(_){return Hu(_,i)}if(0<Hh.length){Hu(Hh[0],i);for(var u=1;u<Hh.length;u++){var y=Hh[u];y.blockedOn===i&&(y.blockedOn=null)}}for(ko!==null&&Hu(ko,i),Co!==null&&Hu(Co,i),Eo!==null&&Hu(Eo,i),fc.forEach(s),mc.forEach(s),u=0;u<xo.length;u++)y=xo[u],y.blockedOn===i&&(y.blockedOn=null);for(;0<xo.length&&(u=xo[0],u.blockedOn===null);)C0(u),u.blockedOn===null&&xo.shift()}var Tl=Gs.ReactCurrentBatchConfig,bd=!0;function Hb(i,s,u,y){var _=Gt,S=Tl.transition;Tl.transition=null;try{Gt=1,Qm(i,s,u,y)}finally{Gt=_,Tl.transition=S}}function Wb(i,s,u,y){var _=Gt,S=Tl.transition;Tl.transition=null;try{Gt=4,Qm(i,s,u,y)}finally{Gt=_,Tl.transition=S}}function Qm(i,s,u,y){if(bd){var _=cm(i,s,u,y);if(_===null)If(i,s,y,Sd,u),E_(i,y);else if(Zb(_,i,s,u,y))y.stopPropagation();else if(E_(i,y),s&4&&-1<qb.indexOf(i)){for(;_!==null;){var S=zc(_);if(S!==null&&b0(S),S=cm(i,s,u,y),S===null&&If(i,s,y,Sd,u),S===_)break;_=S}_!==null&&y.stopPropagation()}else If(i,s,y,null,u)}}var Sd=null;function cm(i,s,u,y){if(Sd=null,i=Wm(y),i=ua(i),i!==null)if(s=xa(i),s===null)i=null;else if(u=s.tag,u===13){if(i=f0(s),i!==null)return i;i=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null);return Sd=i,null}function E0(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rb()){case Xm:return 1;case _0:return 4;case xd:case Fb:return 16;case v0:return 536870912;default:return 16}default:return 16}}var So=null,Jm=null,ld=null;function I0(){if(ld)return ld;var i,s=Jm,u=s.length,y,_="value"in So?So.value:So.textContent,S=_.length;for(i=0;i<u&&s[i]===_[i];i++);var M=u-i;for(y=1;y<=M&&s[u-y]===_[S-y];y++);return ld=_.slice(i,1<y?1-y:void 0)}function ud(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Wh(){return!0}function P_(){return!1}function pr(i){function s(u,y,_,S,M){this._reactName=u,this._targetInst=_,this.type=y,this.nativeEvent=S,this.target=M,this.currentTarget=null;for(var l in i)i.hasOwnProperty(l)&&(u=i[l],this[l]=u?u(S):S[l]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Wh:P_,this.isPropagationStopped=P_,this}return xi(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Wh)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Wh)},persist:function(){},isPersistent:Wh}),s}var Fl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eg=pr(Fl),Mc=xi({},Fl,{view:0,detail:0}),Xb=pr(Mc),vf,xf,Wu,qd=xi({},Mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Wu&&(Wu&&i.type==="mousemove"?(vf=i.screenX-Wu.screenX,xf=i.screenY-Wu.screenY):xf=vf=0,Wu=i),vf)},movementY:function(i){return"movementY"in i?i.movementY:xf}}),M_=pr(qd),Kb=xi({},qd,{dataTransfer:0}),Yb=pr(Kb),Qb=xi({},Mc,{relatedTarget:0}),wf=pr(Qb),Jb=xi({},Fl,{animationName:0,elapsedTime:0,pseudoElement:0}),e2=pr(Jb),t2=xi({},Fl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),i2=pr(t2),n2=xi({},Fl,{data:0}),z_=pr(n2),r2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a2(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=o2[i])?!!s[i]:!1}function tg(){return a2}var l2=xi({},Mc,{key:function(i){if(i.key){var s=r2[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=ud(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?s2[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tg,charCode:function(i){return i.type==="keypress"?ud(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ud(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),u2=pr(l2),c2=xi({},qd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A_=pr(c2),h2=xi({},Mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tg}),d2=pr(h2),p2=xi({},Fl,{propertyName:0,elapsedTime:0,pseudoElement:0}),f2=pr(p2),m2=xi({},qd,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),g2=pr(m2),y2=[9,13,27,32],ig=js&&"CompositionEvent"in window,rc=null;js&&"documentMode"in document&&(rc=document.documentMode);var _2=js&&"TextEvent"in window&&!rc,P0=js&&(!ig||rc&&8<rc&&11>=rc),L_=" ",D_=!1;function M0(i,s){switch(i){case"keyup":return y2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var hl=!1;function v2(i,s){switch(i){case"compositionend":return z0(s);case"keypress":return s.which!==32?null:(D_=!0,L_);case"textInput":return i=s.data,i===L_&&D_?null:i;default:return null}}function x2(i,s){if(hl)return i==="compositionend"||!ig&&M0(i,s)?(i=I0(),ld=Jm=So=null,hl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return P0&&s.locale!=="ko"?null:s.data;default:return null}}var w2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R_(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!w2[i.type]:s==="textarea"}function A0(i,s,u,y){u0(y),s=Td(s,"onChange"),0<s.length&&(u=new eg("onChange","change",null,u,y),i.push({event:u,listeners:s}))}var sc=null,yc=null;function b2(i){$0(i,0)}function Zd(i){var s=fl(i);if(i0(s))return i}function S2(i,s){if(i==="change")return s}var L0=!1;if(js){var bf;if(js){var Sf="oninput"in document;if(!Sf){var F_=document.createElement("div");F_.setAttribute("oninput","return;"),Sf=typeof F_.oninput=="function"}bf=Sf}else bf=!1;L0=bf&&(!document.documentMode||9<document.documentMode)}function B_(){sc&&(sc.detachEvent("onpropertychange",D0),yc=sc=null)}function D0(i){if(i.propertyName==="value"&&Zd(yc)){var s=[];A0(s,yc,i,Wm(i)),p0(b2,s)}}function T2(i,s,u){i==="focusin"?(B_(),sc=s,yc=u,sc.attachEvent("onpropertychange",D0)):i==="focusout"&&B_()}function k2(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Zd(yc)}function C2(i,s){if(i==="click")return Zd(s)}function E2(i,s){if(i==="input"||i==="change")return Zd(s)}function I2(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Yr=typeof Object.is=="function"?Object.is:I2;function _c(i,s){if(Yr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var u=Object.keys(i),y=Object.keys(s);if(u.length!==y.length)return!1;for(y=0;y<u.length;y++){var _=u[y];if(!Gf.call(s,_)||!Yr(i[_],s[_]))return!1}return!0}function O_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function N_(i,s){var u=O_(i);i=0;for(var y;u;){if(u.nodeType===3){if(y=i+u.textContent.length,i<=s&&y>=s)return{node:u,offset:s-i};i=y}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=O_(u)}}function R0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?R0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function F0(){for(var i=window,s=yd();s instanceof i.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)i=s.contentWindow;else break;s=yd(i.document)}return s}function ng(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function P2(i){var s=F0(),u=i.focusedElem,y=i.selectionRange;if(s!==u&&u&&u.ownerDocument&&R0(u.ownerDocument.documentElement,u)){if(y!==null&&ng(u)){if(s=y.start,i=y.end,i===void 0&&(i=s),"selectionStart"in u)u.selectionStart=s,u.selectionEnd=Math.min(i,u.value.length);else if(i=(s=u.ownerDocument||document)&&s.defaultView||window,i.getSelection){i=i.getSelection();var _=u.textContent.length,S=Math.min(y.start,_);y=y.end===void 0?S:Math.min(y.end,_),!i.extend&&S>y&&(_=y,y=S,S=_),_=N_(u,S);var M=N_(u,y);_&&M&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==M.node||i.focusOffset!==M.offset)&&(s=s.createRange(),s.setStart(_.node,_.offset),i.removeAllRanges(),S>y?(i.addRange(s),i.extend(M.node,M.offset)):(s.setEnd(M.node,M.offset),i.addRange(s)))}}for(s=[],i=u;i=i.parentNode;)i.nodeType===1&&s.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<s.length;u++)i=s[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var M2=js&&"documentMode"in document&&11>=document.documentMode,dl=null,hm=null,oc=null,dm=!1;function V_(i,s,u){var y=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;dm||dl==null||dl!==yd(y)||(y=dl,"selectionStart"in y&&ng(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),oc&&_c(oc,y)||(oc=y,y=Td(hm,"onSelect"),0<y.length&&(s=new eg("onSelect","select",null,s,u),i.push({event:s,listeners:y}),s.target=dl)))}function Xh(i,s){var u={};return u[i.toLowerCase()]=s.toLowerCase(),u["Webkit"+i]="webkit"+s,u["Moz"+i]="moz"+s,u}var pl={animationend:Xh("Animation","AnimationEnd"),animationiteration:Xh("Animation","AnimationIteration"),animationstart:Xh("Animation","AnimationStart"),transitionend:Xh("Transition","TransitionEnd")},Tf={},B0={};js&&(B0=document.createElement("div").style,"AnimationEvent"in window||(delete pl.animationend.animation,delete pl.animationiteration.animation,delete pl.animationstart.animation),"TransitionEvent"in window||delete pl.transitionend.transition);function Gd(i){if(Tf[i])return Tf[i];if(!pl[i])return i;var s=pl[i],u;for(u in s)if(s.hasOwnProperty(u)&&u in B0)return Tf[i]=s[u];return i}var O0=Gd("animationend"),N0=Gd("animationiteration"),V0=Gd("animationstart"),U0=Gd("transitionend"),j0=new Map,U_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ro(i,s){j0.set(i,s),va(s,[i])}for(var kf=0;kf<U_.length;kf++){var Cf=U_[kf],z2=Cf.toLowerCase(),A2=Cf[0].toUpperCase()+Cf.slice(1);Ro(z2,"on"+A2)}Ro(O0,"onAnimationEnd");Ro(N0,"onAnimationIteration");Ro(V0,"onAnimationStart");Ro("dblclick","onDoubleClick");Ro("focusin","onFocus");Ro("focusout","onBlur");Ro(U0,"onTransitionEnd");El("onMouseEnter",["mouseout","mouseover"]);El("onMouseLeave",["mouseout","mouseover"]);El("onPointerEnter",["pointerout","pointerover"]);El("onPointerLeave",["pointerout","pointerover"]);va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));va("onBeforeInput",["compositionend","keypress","textInput","paste"]);va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L2=new Set("cancel close invalid load scroll toggle".split(" ").concat(tc));function j_(i,s,u){var y=i.type||"unknown-event";i.currentTarget=u,zb(y,s,void 0,i),i.currentTarget=null}function $0(i,s){s=(s&4)!==0;for(var u=0;u<i.length;u++){var y=i[u],_=y.event;y=y.listeners;e:{var S=void 0;if(s)for(var M=y.length-1;0<=M;M--){var l=y[M],N=l.instance,R=l.currentTarget;if(l=l.listener,N!==S&&_.isPropagationStopped())break e;j_(_,l,R),S=N}else for(M=0;M<y.length;M++){if(l=y[M],N=l.instance,R=l.currentTarget,l=l.listener,N!==S&&_.isPropagationStopped())break e;j_(_,l,R),S=N}}}if(vd)throw i=am,vd=!1,am=null,i}function ai(i,s){var u=s[ym];u===void 0&&(u=s[ym]=new Set);var y=i+"__bubble";u.has(y)||(q0(s,i,2,!1),u.add(y))}function Ef(i,s,u){var y=0;s&&(y|=4),q0(u,i,y,s)}var Kh="_reactListening"+Math.random().toString(36).slice(2);function vc(i){if(!i[Kh]){i[Kh]=!0,Yv.forEach(function(u){u!=="selectionchange"&&(L2.has(u)||Ef(u,!1,i),Ef(u,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Kh]||(s[Kh]=!0,Ef("selectionchange",!1,s))}}function q0(i,s,u,y){switch(E0(s)){case 1:var _=Hb;break;case 4:_=Wb;break;default:_=Qm}u=_.bind(null,s,u,i),_=void 0,!om||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),y?_!==void 0?i.addEventListener(s,u,{capture:!0,passive:_}):i.addEventListener(s,u,!0):_!==void 0?i.addEventListener(s,u,{passive:_}):i.addEventListener(s,u,!1)}function If(i,s,u,y,_){var S=y;if(!(s&1)&&!(s&2)&&y!==null)e:for(;;){if(y===null)return;var M=y.tag;if(M===3||M===4){var l=y.stateNode.containerInfo;if(l===_||l.nodeType===8&&l.parentNode===_)break;if(M===4)for(M=y.return;M!==null;){var N=M.tag;if((N===3||N===4)&&(N=M.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;M=M.return}for(;l!==null;){if(M=ua(l),M===null)return;if(N=M.tag,N===5||N===6){y=S=M;continue e}l=l.parentNode}}y=y.return}p0(function(){var R=S,re=Wm(u),de=[];e:{var te=j0.get(i);if(te!==void 0){var Pe=eg,ke=i;switch(i){case"keypress":if(ud(u)===0)break e;case"keydown":case"keyup":Pe=u2;break;case"focusin":ke="focus",Pe=wf;break;case"focusout":ke="blur",Pe=wf;break;case"beforeblur":case"afterblur":Pe=wf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pe=M_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pe=Yb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pe=d2;break;case O0:case N0:case V0:Pe=e2;break;case U0:Pe=f2;break;case"scroll":Pe=Xb;break;case"wheel":Pe=g2;break;case"copy":case"cut":case"paste":Pe=i2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pe=A_}var Me=(s&4)!==0,ut=!Me&&i==="scroll",ee=Me?te!==null?te+"Capture":null:te;Me=[];for(var Y=R,se;Y!==null;){se=Y;var ve=se.stateNode;if(se.tag===5&&ve!==null&&(se=ve,ee!==null&&(ve=pc(Y,ee),ve!=null&&Me.push(xc(Y,ve,se)))),ut)break;Y=Y.return}0<Me.length&&(te=new Pe(te,ke,null,u,re),de.push({event:te,listeners:Me}))}}if(!(s&7)){e:{if(te=i==="mouseover"||i==="pointerover",Pe=i==="mouseout"||i==="pointerout",te&&u!==rm&&(ke=u.relatedTarget||u.fromElement)&&(ua(ke)||ke[$s]))break e;if((Pe||te)&&(te=re.window===re?re:(te=re.ownerDocument)?te.defaultView||te.parentWindow:window,Pe?(ke=u.relatedTarget||u.toElement,Pe=R,ke=ke?ua(ke):null,ke!==null&&(ut=xa(ke),ke!==ut||ke.tag!==5&&ke.tag!==6)&&(ke=null)):(Pe=null,ke=R),Pe!==ke)){if(Me=M_,ve="onMouseLeave",ee="onMouseEnter",Y="mouse",(i==="pointerout"||i==="pointerover")&&(Me=A_,ve="onPointerLeave",ee="onPointerEnter",Y="pointer"),ut=Pe==null?te:fl(Pe),se=ke==null?te:fl(ke),te=new Me(ve,Y+"leave",Pe,u,re),te.target=ut,te.relatedTarget=se,ve=null,ua(re)===R&&(Me=new Me(ee,Y+"enter",ke,u,re),Me.target=se,Me.relatedTarget=ut,ve=Me),ut=ve,Pe&&ke)t:{for(Me=Pe,ee=ke,Y=0,se=Me;se;se=ll(se))Y++;for(se=0,ve=ee;ve;ve=ll(ve))se++;for(;0<Y-se;)Me=ll(Me),Y--;for(;0<se-Y;)ee=ll(ee),se--;for(;Y--;){if(Me===ee||ee!==null&&Me===ee.alternate)break t;Me=ll(Me),ee=ll(ee)}Me=null}else Me=null;Pe!==null&&$_(de,te,Pe,Me,!1),ke!==null&&ut!==null&&$_(de,ut,ke,Me,!0)}}e:{if(te=R?fl(R):window,Pe=te.nodeName&&te.nodeName.toLowerCase(),Pe==="select"||Pe==="input"&&te.type==="file")var Fe=S2;else if(R_(te))if(L0)Fe=E2;else{Fe=k2;var Oe=T2}else(Pe=te.nodeName)&&Pe.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(Fe=C2);if(Fe&&(Fe=Fe(i,R))){A0(de,Fe,u,re);break e}Oe&&Oe(i,te,R),i==="focusout"&&(Oe=te._wrapperState)&&Oe.controlled&&te.type==="number"&&Jf(te,"number",te.value)}switch(Oe=R?fl(R):window,i){case"focusin":(R_(Oe)||Oe.contentEditable==="true")&&(dl=Oe,hm=R,oc=null);break;case"focusout":oc=hm=dl=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,V_(de,u,re);break;case"selectionchange":if(M2)break;case"keydown":case"keyup":V_(de,u,re)}var Ge;if(ig)e:{switch(i){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else hl?M0(i,u)&&(Be="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Be="onCompositionStart");Be&&(P0&&u.locale!=="ko"&&(hl||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&hl&&(Ge=I0()):(So=re,Jm="value"in So?So.value:So.textContent,hl=!0)),Oe=Td(R,Be),0<Oe.length&&(Be=new z_(Be,i,null,u,re),de.push({event:Be,listeners:Oe}),Ge?Be.data=Ge:(Ge=z0(u),Ge!==null&&(Be.data=Ge)))),(Ge=_2?v2(i,u):x2(i,u))&&(R=Td(R,"onBeforeInput"),0<R.length&&(re=new z_("onBeforeInput","beforeinput",null,u,re),de.push({event:re,listeners:R}),re.data=Ge))}$0(de,s)})}function xc(i,s,u){return{instance:i,listener:s,currentTarget:u}}function Td(i,s){for(var u=s+"Capture",y=[];i!==null;){var _=i,S=_.stateNode;_.tag===5&&S!==null&&(_=S,S=pc(i,u),S!=null&&y.unshift(xc(i,S,_)),S=pc(i,s),S!=null&&y.push(xc(i,S,_))),i=i.return}return y}function ll(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function $_(i,s,u,y,_){for(var S=s._reactName,M=[];u!==null&&u!==y;){var l=u,N=l.alternate,R=l.stateNode;if(N!==null&&N===y)break;l.tag===5&&R!==null&&(l=R,_?(N=pc(u,S),N!=null&&M.unshift(xc(u,N,l))):_||(N=pc(u,S),N!=null&&M.push(xc(u,N,l)))),u=u.return}M.length!==0&&i.push({event:s,listeners:M})}var D2=/\r\n?/g,R2=/\u0000|\uFFFD/g;function q_(i){return(typeof i=="string"?i:""+i).replace(D2,`
`).replace(R2,"")}function Yh(i,s,u){if(s=q_(s),q_(i)!==s&&u)throw Error(Le(425))}function kd(){}var pm=null,fm=null;function mm(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var gm=typeof setTimeout=="function"?setTimeout:void 0,F2=typeof clearTimeout=="function"?clearTimeout:void 0,Z_=typeof Promise=="function"?Promise:void 0,B2=typeof queueMicrotask=="function"?queueMicrotask:typeof Z_<"u"?function(i){return Z_.resolve(null).then(i).catch(O2)}:gm;function O2(i){setTimeout(function(){throw i})}function Pf(i,s){var u=s,y=0;do{var _=u.nextSibling;if(i.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(y===0){i.removeChild(_),gc(s);return}y--}else u!=="$"&&u!=="$?"&&u!=="$!"||y++;u=_}while(u);gc(s)}function Io(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return i}function G_(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(s===0)return i;s--}else u==="/$"&&s++}i=i.previousSibling}return null}var Bl=Math.random().toString(36).slice(2),fs="__reactFiber$"+Bl,wc="__reactProps$"+Bl,$s="__reactContainer$"+Bl,ym="__reactEvents$"+Bl,N2="__reactListeners$"+Bl,V2="__reactHandles$"+Bl;function ua(i){var s=i[fs];if(s)return s;for(var u=i.parentNode;u;){if(s=u[$s]||u[fs]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(i=G_(i);i!==null;){if(u=i[fs])return u;i=G_(i)}return s}i=u,u=i.parentNode}return null}function zc(i){return i=i[fs]||i[$s],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function fl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Le(33))}function Hd(i){return i[wc]||null}var _m=[],ml=-1;function Fo(i){return{current:i}}function li(i){0>ml||(i.current=_m[ml],_m[ml]=null,ml--)}function ii(i,s){ml++,_m[ml]=i.current,i.current=s}var Do={},Tn=Fo(Do),Qn=Fo(!1),fa=Do;function Il(i,s){var u=i.type.contextTypes;if(!u)return Do;var y=i.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===s)return y.__reactInternalMemoizedMaskedChildContext;var _={},S;for(S in u)_[S]=s[S];return y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=_),_}function Jn(i){return i=i.childContextTypes,i!=null}function Cd(){li(Qn),li(Tn)}function H_(i,s,u){if(Tn.current!==Do)throw Error(Le(168));ii(Tn,s),ii(Qn,u)}function Z0(i,s,u){var y=i.stateNode;if(s=s.childContextTypes,typeof y.getChildContext!="function")return u;y=y.getChildContext();for(var _ in y)if(!(_ in s))throw Error(Le(108,Tb(i)||"Unknown",_));return xi({},u,y)}function Ed(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Do,fa=Tn.current,ii(Tn,i),ii(Qn,Qn.current),!0}function W_(i,s,u){var y=i.stateNode;if(!y)throw Error(Le(169));u?(i=Z0(i,s,fa),y.__reactInternalMemoizedMergedChildContext=i,li(Qn),li(Tn),ii(Tn,i)):li(Qn),ii(Qn,u)}var Os=null,Wd=!1,Mf=!1;function G0(i){Os===null?Os=[i]:Os.push(i)}function U2(i){Wd=!0,G0(i)}function Bo(){if(!Mf&&Os!==null){Mf=!0;var i=0,s=Gt;try{var u=Os;for(Gt=1;i<u.length;i++){var y=u[i];do y=y(!0);while(y!==null)}Os=null,Wd=!1}catch(_){throw Os!==null&&(Os=Os.slice(i+1)),y0(Xm,Bo),_}finally{Gt=s,Mf=!1}}return null}var gl=[],yl=0,Id=null,Pd=0,kr=[],Cr=0,ma=null,Ns=1,Vs="";function aa(i,s){gl[yl++]=Pd,gl[yl++]=Id,Id=i,Pd=s}function H0(i,s,u){kr[Cr++]=Ns,kr[Cr++]=Vs,kr[Cr++]=ma,ma=i;var y=Ns;i=Vs;var _=32-Xr(y)-1;y&=~(1<<_),u+=1;var S=32-Xr(s)+_;if(30<S){var M=_-_%5;S=(y&(1<<M)-1).toString(32),y>>=M,_-=M,Ns=1<<32-Xr(s)+_|u<<_|y,Vs=S+i}else Ns=1<<S|u<<_|y,Vs=i}function rg(i){i.return!==null&&(aa(i,1),H0(i,1,0))}function sg(i){for(;i===Id;)Id=gl[--yl],gl[yl]=null,Pd=gl[--yl],gl[yl]=null;for(;i===ma;)ma=kr[--Cr],kr[Cr]=null,Vs=kr[--Cr],kr[Cr]=null,Ns=kr[--Cr],kr[Cr]=null}var cr=null,ur=null,fi=!1,Wr=null;function W0(i,s){var u=Er(5,null,null,0);u.elementType="DELETED",u.stateNode=s,u.return=i,s=i.deletions,s===null?(i.deletions=[u],i.flags|=16):s.push(u)}function X_(i,s){switch(i.tag){case 5:var u=i.type;return s=s.nodeType!==1||u.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(i.stateNode=s,cr=i,ur=Io(s.firstChild),!0):!1;case 6:return s=i.pendingProps===""||s.nodeType!==3?null:s,s!==null?(i.stateNode=s,cr=i,ur=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(u=ma!==null?{id:Ns,overflow:Vs}:null,i.memoizedState={dehydrated:s,treeContext:u,retryLane:1073741824},u=Er(18,null,null,0),u.stateNode=s,u.return=i,i.child=u,cr=i,ur=null,!0):!1;default:return!1}}function vm(i){return(i.mode&1)!==0&&(i.flags&128)===0}function xm(i){if(fi){var s=ur;if(s){var u=s;if(!X_(i,s)){if(vm(i))throw Error(Le(418));s=Io(u.nextSibling);var y=cr;s&&X_(i,s)?W0(y,u):(i.flags=i.flags&-4097|2,fi=!1,cr=i)}}else{if(vm(i))throw Error(Le(418));i.flags=i.flags&-4097|2,fi=!1,cr=i}}}function K_(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;cr=i}function Qh(i){if(i!==cr)return!1;if(!fi)return K_(i),fi=!0,!1;var s;if((s=i.tag!==3)&&!(s=i.tag!==5)&&(s=i.type,s=s!=="head"&&s!=="body"&&!mm(i.type,i.memoizedProps)),s&&(s=ur)){if(vm(i))throw X0(),Error(Le(418));for(;s;)W0(i,s),s=Io(s.nextSibling)}if(K_(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Le(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(s===0){ur=Io(i.nextSibling);break e}s--}else u!=="$"&&u!=="$!"&&u!=="$?"||s++}i=i.nextSibling}ur=null}}else ur=cr?Io(i.stateNode.nextSibling):null;return!0}function X0(){for(var i=ur;i;)i=Io(i.nextSibling)}function Pl(){ur=cr=null,fi=!1}function og(i){Wr===null?Wr=[i]:Wr.push(i)}var j2=Gs.ReactCurrentBatchConfig;function Gr(i,s){if(i&&i.defaultProps){s=xi({},s),i=i.defaultProps;for(var u in i)s[u]===void 0&&(s[u]=i[u]);return s}return s}var Md=Fo(null),zd=null,_l=null,ag=null;function lg(){ag=_l=zd=null}function ug(i){var s=Md.current;li(Md),i._currentValue=s}function wm(i,s,u){for(;i!==null;){var y=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,y!==null&&(y.childLanes|=s)):y!==null&&(y.childLanes&s)!==s&&(y.childLanes|=s),i===u)break;i=i.return}}function kl(i,s){zd=i,ag=_l=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&s&&(Yn=!0),i.firstContext=null)}function Pr(i){var s=i._currentValue;if(ag!==i)if(i={context:i,memoizedValue:s,next:null},_l===null){if(zd===null)throw Error(Le(308));_l=i,zd.dependencies={lanes:0,firstContext:i}}else _l=_l.next=i;return s}var ca=null;function cg(i){ca===null?ca=[i]:ca.push(i)}function K0(i,s,u,y){var _=s.interleaved;return _===null?(u.next=u,cg(s)):(u.next=_.next,_.next=u),s.interleaved=u,qs(i,y)}function qs(i,s){i.lanes|=s;var u=i.alternate;for(u!==null&&(u.lanes|=s),u=i,i=i.return;i!==null;)i.childLanes|=s,u=i.alternate,u!==null&&(u.childLanes|=s),u=i,i=i.return;return u.tag===3?u.stateNode:null}var vo=!1;function hg(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y0(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Us(i,s){return{eventTime:i,lane:s,tag:0,payload:null,callback:null,next:null}}function Po(i,s,u){var y=i.updateQueue;if(y===null)return null;if(y=y.shared,Rt&2){var _=y.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),y.pending=s,qs(i,u)}return _=y.interleaved,_===null?(s.next=s,cg(y)):(s.next=_.next,_.next=s),y.interleaved=s,qs(i,u)}function cd(i,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194240)!==0)){var y=s.lanes;y&=i.pendingLanes,u|=y,s.lanes=u,Km(i,u)}}function Y_(i,s){var u=i.updateQueue,y=i.alternate;if(y!==null&&(y=y.updateQueue,u===y)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var M={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};S===null?_=S=M:S=S.next=M,u=u.next}while(u!==null);S===null?_=S=s:S=S.next=s}else _=S=s;u={baseState:y.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:y.shared,effects:y.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=s:i.next=s,u.lastBaseUpdate=s}function Ad(i,s,u,y){var _=i.updateQueue;vo=!1;var S=_.firstBaseUpdate,M=_.lastBaseUpdate,l=_.shared.pending;if(l!==null){_.shared.pending=null;var N=l,R=N.next;N.next=null,M===null?S=R:M.next=R,M=N;var re=i.alternate;re!==null&&(re=re.updateQueue,l=re.lastBaseUpdate,l!==M&&(l===null?re.firstBaseUpdate=R:l.next=R,re.lastBaseUpdate=N))}if(S!==null){var de=_.baseState;M=0,re=R=N=null,l=S;do{var te=l.lane,Pe=l.eventTime;if((y&te)===te){re!==null&&(re=re.next={eventTime:Pe,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var ke=i,Me=l;switch(te=s,Pe=u,Me.tag){case 1:if(ke=Me.payload,typeof ke=="function"){de=ke.call(Pe,de,te);break e}de=ke;break e;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Me.payload,te=typeof ke=="function"?ke.call(Pe,de,te):ke,te==null)break e;de=xi({},de,te);break e;case 2:vo=!0}}l.callback!==null&&l.lane!==0&&(i.flags|=64,te=_.effects,te===null?_.effects=[l]:te.push(l))}else Pe={eventTime:Pe,lane:te,tag:l.tag,payload:l.payload,callback:l.callback,next:null},re===null?(R=re=Pe,N=de):re=re.next=Pe,M|=te;if(l=l.next,l===null){if(l=_.shared.pending,l===null)break;te=l,l=te.next,te.next=null,_.lastBaseUpdate=te,_.shared.pending=null}}while(!0);if(re===null&&(N=de),_.baseState=N,_.firstBaseUpdate=R,_.lastBaseUpdate=re,s=_.shared.interleaved,s!==null){_=s;do M|=_.lane,_=_.next;while(_!==s)}else S===null&&(_.shared.lanes=0);ya|=M,i.lanes=M,i.memoizedState=de}}function Q_(i,s,u){if(i=s.effects,s.effects=null,i!==null)for(s=0;s<i.length;s++){var y=i[s],_=y.callback;if(_!==null){if(y.callback=null,y=u,typeof _!="function")throw Error(Le(191,_));_.call(y)}}}var Q0=new Kv.Component().refs;function bm(i,s,u,y){s=i.memoizedState,u=u(y,s),u=u==null?s:xi({},s,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Xd={isMounted:function(i){return(i=i._reactInternals)?xa(i)===i:!1},enqueueSetState:function(i,s,u){i=i._reactInternals;var y=Bn(),_=zo(i),S=Us(y,_);S.payload=s,u!=null&&(S.callback=u),s=Po(i,S,_),s!==null&&(Kr(s,i,_,y),cd(s,i,_))},enqueueReplaceState:function(i,s,u){i=i._reactInternals;var y=Bn(),_=zo(i),S=Us(y,_);S.tag=1,S.payload=s,u!=null&&(S.callback=u),s=Po(i,S,_),s!==null&&(Kr(s,i,_,y),cd(s,i,_))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var u=Bn(),y=zo(i),_=Us(u,y);_.tag=2,s!=null&&(_.callback=s),s=Po(i,_,y),s!==null&&(Kr(s,i,y,u),cd(s,i,y))}};function J_(i,s,u,y,_,S,M){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(y,S,M):s.prototype&&s.prototype.isPureReactComponent?!_c(u,y)||!_c(_,S):!0}function J0(i,s,u){var y=!1,_=Do,S=s.contextType;return typeof S=="object"&&S!==null?S=Pr(S):(_=Jn(s)?fa:Tn.current,y=s.contextTypes,S=(y=y!=null)?Il(i,_):Do),s=new s(u,S),i.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Xd,i.stateNode=s,s._reactInternals=i,y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=S),s}function ev(i,s,u,y){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,y),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,y),s.state!==i&&Xd.enqueueReplaceState(s,s.state,null)}function Sm(i,s,u,y){var _=i.stateNode;_.props=u,_.state=i.memoizedState,_.refs=Q0,hg(i);var S=s.contextType;typeof S=="object"&&S!==null?_.context=Pr(S):(S=Jn(s)?fa:Tn.current,_.context=Il(i,S)),_.state=i.memoizedState,S=s.getDerivedStateFromProps,typeof S=="function"&&(bm(i,s,S,u),_.state=i.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(s=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),s!==_.state&&Xd.enqueueReplaceState(_,_.state,null),Ad(i,u,_,y),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function Xu(i,s,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(Le(309));var y=u.stateNode}if(!y)throw Error(Le(147,i));var _=y,S=""+i;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===S?s.ref:(s=function(M){var l=_.refs;l===Q0&&(l=_.refs={}),M===null?delete l[S]:l[S]=M},s._stringRef=S,s)}if(typeof i!="string")throw Error(Le(284));if(!u._owner)throw Error(Le(290,i))}return i}function Jh(i,s){throw i=Object.prototype.toString.call(s),Error(Le(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i))}function tv(i){var s=i._init;return s(i._payload)}function ex(i){function s(ee,Y){if(i){var se=ee.deletions;se===null?(ee.deletions=[Y],ee.flags|=16):se.push(Y)}}function u(ee,Y){if(!i)return null;for(;Y!==null;)s(ee,Y),Y=Y.sibling;return null}function y(ee,Y){for(ee=new Map;Y!==null;)Y.key!==null?ee.set(Y.key,Y):ee.set(Y.index,Y),Y=Y.sibling;return ee}function _(ee,Y){return ee=Ao(ee,Y),ee.index=0,ee.sibling=null,ee}function S(ee,Y,se){return ee.index=se,i?(se=ee.alternate,se!==null?(se=se.index,se<Y?(ee.flags|=2,Y):se):(ee.flags|=2,Y)):(ee.flags|=1048576,Y)}function M(ee){return i&&ee.alternate===null&&(ee.flags|=2),ee}function l(ee,Y,se,ve){return Y===null||Y.tag!==6?(Y=Bf(se,ee.mode,ve),Y.return=ee,Y):(Y=_(Y,se),Y.return=ee,Y)}function N(ee,Y,se,ve){var Fe=se.type;return Fe===cl?re(ee,Y,se.props.children,ve,se.key):Y!==null&&(Y.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===_o&&tv(Fe)===Y.type)?(ve=_(Y,se.props),ve.ref=Xu(ee,Y,se),ve.return=ee,ve):(ve=gd(se.type,se.key,se.props,null,ee.mode,ve),ve.ref=Xu(ee,Y,se),ve.return=ee,ve)}function R(ee,Y,se,ve){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==se.containerInfo||Y.stateNode.implementation!==se.implementation?(Y=Of(se,ee.mode,ve),Y.return=ee,Y):(Y=_(Y,se.children||[]),Y.return=ee,Y)}function re(ee,Y,se,ve,Fe){return Y===null||Y.tag!==7?(Y=pa(se,ee.mode,ve,Fe),Y.return=ee,Y):(Y=_(Y,se),Y.return=ee,Y)}function de(ee,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=Bf(""+Y,ee.mode,se),Y.return=ee,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case jh:return se=gd(Y.type,Y.key,Y.props,null,ee.mode,se),se.ref=Xu(ee,null,Y),se.return=ee,se;case ul:return Y=Of(Y,ee.mode,se),Y.return=ee,Y;case _o:var ve=Y._init;return de(ee,ve(Y._payload),se)}if(Ju(Y)||qu(Y))return Y=pa(Y,ee.mode,se,null),Y.return=ee,Y;Jh(ee,Y)}return null}function te(ee,Y,se,ve){var Fe=Y!==null?Y.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Fe!==null?null:l(ee,Y,""+se,ve);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case jh:return se.key===Fe?N(ee,Y,se,ve):null;case ul:return se.key===Fe?R(ee,Y,se,ve):null;case _o:return Fe=se._init,te(ee,Y,Fe(se._payload),ve)}if(Ju(se)||qu(se))return Fe!==null?null:re(ee,Y,se,ve,null);Jh(ee,se)}return null}function Pe(ee,Y,se,ve,Fe){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ee=ee.get(se)||null,l(Y,ee,""+ve,Fe);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case jh:return ee=ee.get(ve.key===null?se:ve.key)||null,N(Y,ee,ve,Fe);case ul:return ee=ee.get(ve.key===null?se:ve.key)||null,R(Y,ee,ve,Fe);case _o:var Oe=ve._init;return Pe(ee,Y,se,Oe(ve._payload),Fe)}if(Ju(ve)||qu(ve))return ee=ee.get(se)||null,re(Y,ee,ve,Fe,null);Jh(Y,ve)}return null}function ke(ee,Y,se,ve){for(var Fe=null,Oe=null,Ge=Y,Be=Y=0,Et=null;Ge!==null&&Be<se.length;Be++){Ge.index>Be?(Et=Ge,Ge=null):Et=Ge.sibling;var tt=te(ee,Ge,se[Be],ve);if(tt===null){Ge===null&&(Ge=Et);break}i&&Ge&&tt.alternate===null&&s(ee,Ge),Y=S(tt,Y,Be),Oe===null?Fe=tt:Oe.sibling=tt,Oe=tt,Ge=Et}if(Be===se.length)return u(ee,Ge),fi&&aa(ee,Be),Fe;if(Ge===null){for(;Be<se.length;Be++)Ge=de(ee,se[Be],ve),Ge!==null&&(Y=S(Ge,Y,Be),Oe===null?Fe=Ge:Oe.sibling=Ge,Oe=Ge);return fi&&aa(ee,Be),Fe}for(Ge=y(ee,Ge);Be<se.length;Be++)Et=Pe(Ge,ee,Be,se[Be],ve),Et!==null&&(i&&Et.alternate!==null&&Ge.delete(Et.key===null?Be:Et.key),Y=S(Et,Y,Be),Oe===null?Fe=Et:Oe.sibling=Et,Oe=Et);return i&&Ge.forEach(function(Ot){return s(ee,Ot)}),fi&&aa(ee,Be),Fe}function Me(ee,Y,se,ve){var Fe=qu(se);if(typeof Fe!="function")throw Error(Le(150));if(se=Fe.call(se),se==null)throw Error(Le(151));for(var Oe=Fe=null,Ge=Y,Be=Y=0,Et=null,tt=se.next();Ge!==null&&!tt.done;Be++,tt=se.next()){Ge.index>Be?(Et=Ge,Ge=null):Et=Ge.sibling;var Ot=te(ee,Ge,tt.value,ve);if(Ot===null){Ge===null&&(Ge=Et);break}i&&Ge&&Ot.alternate===null&&s(ee,Ge),Y=S(Ot,Y,Be),Oe===null?Fe=Ot:Oe.sibling=Ot,Oe=Ot,Ge=Et}if(tt.done)return u(ee,Ge),fi&&aa(ee,Be),Fe;if(Ge===null){for(;!tt.done;Be++,tt=se.next())tt=de(ee,tt.value,ve),tt!==null&&(Y=S(tt,Y,Be),Oe===null?Fe=tt:Oe.sibling=tt,Oe=tt);return fi&&aa(ee,Be),Fe}for(Ge=y(ee,Ge);!tt.done;Be++,tt=se.next())tt=Pe(Ge,ee,Be,tt.value,ve),tt!==null&&(i&&tt.alternate!==null&&Ge.delete(tt.key===null?Be:tt.key),Y=S(tt,Y,Be),Oe===null?Fe=tt:Oe.sibling=tt,Oe=tt);return i&&Ge.forEach(function(ui){return s(ee,ui)}),fi&&aa(ee,Be),Fe}function ut(ee,Y,se,ve){if(typeof se=="object"&&se!==null&&se.type===cl&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case jh:e:{for(var Fe=se.key,Oe=Y;Oe!==null;){if(Oe.key===Fe){if(Fe=se.type,Fe===cl){if(Oe.tag===7){u(ee,Oe.sibling),Y=_(Oe,se.props.children),Y.return=ee,ee=Y;break e}}else if(Oe.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===_o&&tv(Fe)===Oe.type){u(ee,Oe.sibling),Y=_(Oe,se.props),Y.ref=Xu(ee,Oe,se),Y.return=ee,ee=Y;break e}u(ee,Oe);break}else s(ee,Oe);Oe=Oe.sibling}se.type===cl?(Y=pa(se.props.children,ee.mode,ve,se.key),Y.return=ee,ee=Y):(ve=gd(se.type,se.key,se.props,null,ee.mode,ve),ve.ref=Xu(ee,Y,se),ve.return=ee,ee=ve)}return M(ee);case ul:e:{for(Oe=se.key;Y!==null;){if(Y.key===Oe)if(Y.tag===4&&Y.stateNode.containerInfo===se.containerInfo&&Y.stateNode.implementation===se.implementation){u(ee,Y.sibling),Y=_(Y,se.children||[]),Y.return=ee,ee=Y;break e}else{u(ee,Y);break}else s(ee,Y);Y=Y.sibling}Y=Of(se,ee.mode,ve),Y.return=ee,ee=Y}return M(ee);case _o:return Oe=se._init,ut(ee,Y,Oe(se._payload),ve)}if(Ju(se))return ke(ee,Y,se,ve);if(qu(se))return Me(ee,Y,se,ve);Jh(ee,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Y!==null&&Y.tag===6?(u(ee,Y.sibling),Y=_(Y,se),Y.return=ee,ee=Y):(u(ee,Y),Y=Bf(se,ee.mode,ve),Y.return=ee,ee=Y),M(ee)):u(ee,Y)}return ut}var Ml=ex(!0),tx=ex(!1),Ac={},gs=Fo(Ac),bc=Fo(Ac),Sc=Fo(Ac);function ha(i){if(i===Ac)throw Error(Le(174));return i}function dg(i,s){switch(ii(Sc,s),ii(bc,i),ii(gs,Ac),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:tm(null,"");break;default:i=i===8?s.parentNode:s,s=i.namespaceURI||null,i=i.tagName,s=tm(s,i)}li(gs),ii(gs,s)}function zl(){li(gs),li(bc),li(Sc)}function ix(i){ha(Sc.current);var s=ha(gs.current),u=tm(s,i.type);s!==u&&(ii(bc,i),ii(gs,u))}function pg(i){bc.current===i&&(li(gs),li(bc))}var _i=Fo(0);function Ld(i){for(var s=i;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var zf=[];function fg(){for(var i=0;i<zf.length;i++)zf[i]._workInProgressVersionPrimary=null;zf.length=0}var hd=Gs.ReactCurrentDispatcher,Af=Gs.ReactCurrentBatchConfig,ga=0,vi=null,Ui=null,Yi=null,Dd=!1,ac=!1,Tc=0,$2=0;function wn(){throw Error(Le(321))}function mg(i,s){if(s===null)return!1;for(var u=0;u<s.length&&u<i.length;u++)if(!Yr(i[u],s[u]))return!1;return!0}function gg(i,s,u,y,_,S){if(ga=S,vi=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,hd.current=i===null||i.memoizedState===null?H2:W2,i=u(y,_),ac){S=0;do{if(ac=!1,Tc=0,25<=S)throw Error(Le(301));S+=1,Yi=Ui=null,s.updateQueue=null,hd.current=X2,i=u(y,_)}while(ac)}if(hd.current=Rd,s=Ui!==null&&Ui.next!==null,ga=0,Yi=Ui=vi=null,Dd=!1,s)throw Error(Le(300));return i}function yg(){var i=Tc!==0;return Tc=0,i}function ps(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yi===null?vi.memoizedState=Yi=i:Yi=Yi.next=i,Yi}function Mr(){if(Ui===null){var i=vi.alternate;i=i!==null?i.memoizedState:null}else i=Ui.next;var s=Yi===null?vi.memoizedState:Yi.next;if(s!==null)Yi=s,Ui=i;else{if(i===null)throw Error(Le(310));Ui=i,i={memoizedState:Ui.memoizedState,baseState:Ui.baseState,baseQueue:Ui.baseQueue,queue:Ui.queue,next:null},Yi===null?vi.memoizedState=Yi=i:Yi=Yi.next=i}return Yi}function kc(i,s){return typeof s=="function"?s(i):s}function Lf(i){var s=Mr(),u=s.queue;if(u===null)throw Error(Le(311));u.lastRenderedReducer=i;var y=Ui,_=y.baseQueue,S=u.pending;if(S!==null){if(_!==null){var M=_.next;_.next=S.next,S.next=M}y.baseQueue=_=S,u.pending=null}if(_!==null){S=_.next,y=y.baseState;var l=M=null,N=null,R=S;do{var re=R.lane;if((ga&re)===re)N!==null&&(N=N.next={lane:0,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null}),y=R.hasEagerState?R.eagerState:i(y,R.action);else{var de={lane:re,action:R.action,hasEagerState:R.hasEagerState,eagerState:R.eagerState,next:null};N===null?(l=N=de,M=y):N=N.next=de,vi.lanes|=re,ya|=re}R=R.next}while(R!==null&&R!==S);N===null?M=y:N.next=l,Yr(y,s.memoizedState)||(Yn=!0),s.memoizedState=y,s.baseState=M,s.baseQueue=N,u.lastRenderedState=y}if(i=u.interleaved,i!==null){_=i;do S=_.lane,vi.lanes|=S,ya|=S,_=_.next;while(_!==i)}else _===null&&(u.lanes=0);return[s.memoizedState,u.dispatch]}function Df(i){var s=Mr(),u=s.queue;if(u===null)throw Error(Le(311));u.lastRenderedReducer=i;var y=u.dispatch,_=u.pending,S=s.memoizedState;if(_!==null){u.pending=null;var M=_=_.next;do S=i(S,M.action),M=M.next;while(M!==_);Yr(S,s.memoizedState)||(Yn=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),u.lastRenderedState=S}return[S,y]}function nx(){}function rx(i,s){var u=vi,y=Mr(),_=s(),S=!Yr(y.memoizedState,_);if(S&&(y.memoizedState=_,Yn=!0),y=y.queue,_g(ax.bind(null,u,y,i),[i]),y.getSnapshot!==s||S||Yi!==null&&Yi.memoizedState.tag&1){if(u.flags|=2048,Cc(9,ox.bind(null,u,y,_,s),void 0,null),Qi===null)throw Error(Le(349));ga&30||sx(u,s,_)}return _}function sx(i,s,u){i.flags|=16384,i={getSnapshot:s,value:u},s=vi.updateQueue,s===null?(s={lastEffect:null,stores:null},vi.updateQueue=s,s.stores=[i]):(u=s.stores,u===null?s.stores=[i]:u.push(i))}function ox(i,s,u,y){s.value=u,s.getSnapshot=y,lx(s)&&ux(i)}function ax(i,s,u){return u(function(){lx(s)&&ux(i)})}function lx(i){var s=i.getSnapshot;i=i.value;try{var u=s();return!Yr(i,u)}catch{return!0}}function ux(i){var s=qs(i,1);s!==null&&Kr(s,i,1,-1)}function iv(i){var s=ps();return typeof i=="function"&&(i=i()),s.memoizedState=s.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kc,lastRenderedState:i},s.queue=i,i=i.dispatch=G2.bind(null,vi,i),[s.memoizedState,i]}function Cc(i,s,u,y){return i={tag:i,create:s,destroy:u,deps:y,next:null},s=vi.updateQueue,s===null?(s={lastEffect:null,stores:null},vi.updateQueue=s,s.lastEffect=i.next=i):(u=s.lastEffect,u===null?s.lastEffect=i.next=i:(y=u.next,u.next=i,i.next=y,s.lastEffect=i)),i}function cx(){return Mr().memoizedState}function dd(i,s,u,y){var _=ps();vi.flags|=i,_.memoizedState=Cc(1|s,u,void 0,y===void 0?null:y)}function Kd(i,s,u,y){var _=Mr();y=y===void 0?null:y;var S=void 0;if(Ui!==null){var M=Ui.memoizedState;if(S=M.destroy,y!==null&&mg(y,M.deps)){_.memoizedState=Cc(s,u,S,y);return}}vi.flags|=i,_.memoizedState=Cc(1|s,u,S,y)}function nv(i,s){return dd(8390656,8,i,s)}function _g(i,s){return Kd(2048,8,i,s)}function hx(i,s){return Kd(4,2,i,s)}function dx(i,s){return Kd(4,4,i,s)}function px(i,s){if(typeof s=="function")return i=i(),s(i),function(){s(null)};if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function fx(i,s,u){return u=u!=null?u.concat([i]):null,Kd(4,4,px.bind(null,s,i),u)}function vg(){}function mx(i,s){var u=Mr();s=s===void 0?null:s;var y=u.memoizedState;return y!==null&&s!==null&&mg(s,y[1])?y[0]:(u.memoizedState=[i,s],i)}function gx(i,s){var u=Mr();s=s===void 0?null:s;var y=u.memoizedState;return y!==null&&s!==null&&mg(s,y[1])?y[0]:(i=i(),u.memoizedState=[i,s],i)}function yx(i,s,u){return ga&21?(Yr(u,s)||(u=x0(),vi.lanes|=u,ya|=u,i.baseState=!0),s):(i.baseState&&(i.baseState=!1,Yn=!0),i.memoizedState=u)}function q2(i,s){var u=Gt;Gt=u!==0&&4>u?u:4,i(!0);var y=Af.transition;Af.transition={};try{i(!1),s()}finally{Gt=u,Af.transition=y}}function _x(){return Mr().memoizedState}function Z2(i,s,u){var y=zo(i);if(u={lane:y,action:u,hasEagerState:!1,eagerState:null,next:null},vx(i))xx(s,u);else if(u=K0(i,s,u,y),u!==null){var _=Bn();Kr(u,i,y,_),wx(u,s,y)}}function G2(i,s,u){var y=zo(i),_={lane:y,action:u,hasEagerState:!1,eagerState:null,next:null};if(vx(i))xx(s,_);else{var S=i.alternate;if(i.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var M=s.lastRenderedState,l=S(M,u);if(_.hasEagerState=!0,_.eagerState=l,Yr(l,M)){var N=s.interleaved;N===null?(_.next=_,cg(s)):(_.next=N.next,N.next=_),s.interleaved=_;return}}catch{}finally{}u=K0(i,s,_,y),u!==null&&(_=Bn(),Kr(u,i,y,_),wx(u,s,y))}}function vx(i){var s=i.alternate;return i===vi||s!==null&&s===vi}function xx(i,s){ac=Dd=!0;var u=i.pending;u===null?s.next=s:(s.next=u.next,u.next=s),i.pending=s}function wx(i,s,u){if(u&4194240){var y=s.lanes;y&=i.pendingLanes,u|=y,s.lanes=u,Km(i,u)}}var Rd={readContext:Pr,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useInsertionEffect:wn,useLayoutEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useMutableSource:wn,useSyncExternalStore:wn,useId:wn,unstable_isNewReconciler:!1},H2={readContext:Pr,useCallback:function(i,s){return ps().memoizedState=[i,s===void 0?null:s],i},useContext:Pr,useEffect:nv,useImperativeHandle:function(i,s,u){return u=u!=null?u.concat([i]):null,dd(4194308,4,px.bind(null,s,i),u)},useLayoutEffect:function(i,s){return dd(4194308,4,i,s)},useInsertionEffect:function(i,s){return dd(4,2,i,s)},useMemo:function(i,s){var u=ps();return s=s===void 0?null:s,i=i(),u.memoizedState=[i,s],i},useReducer:function(i,s,u){var y=ps();return s=u!==void 0?u(s):s,y.memoizedState=y.baseState=s,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},y.queue=i,i=i.dispatch=Z2.bind(null,vi,i),[y.memoizedState,i]},useRef:function(i){var s=ps();return i={current:i},s.memoizedState=i},useState:iv,useDebugValue:vg,useDeferredValue:function(i){return ps().memoizedState=i},useTransition:function(){var i=iv(!1),s=i[0];return i=q2.bind(null,i[1]),ps().memoizedState=i,[s,i]},useMutableSource:function(){},useSyncExternalStore:function(i,s,u){var y=vi,_=ps();if(fi){if(u===void 0)throw Error(Le(407));u=u()}else{if(u=s(),Qi===null)throw Error(Le(349));ga&30||sx(y,s,u)}_.memoizedState=u;var S={value:u,getSnapshot:s};return _.queue=S,nv(ax.bind(null,y,S,i),[i]),y.flags|=2048,Cc(9,ox.bind(null,y,S,u,s),void 0,null),u},useId:function(){var i=ps(),s=Qi.identifierPrefix;if(fi){var u=Vs,y=Ns;u=(y&~(1<<32-Xr(y)-1)).toString(32)+u,s=":"+s+"R"+u,u=Tc++,0<u&&(s+="H"+u.toString(32)),s+=":"}else u=$2++,s=":"+s+"r"+u.toString(32)+":";return i.memoizedState=s},unstable_isNewReconciler:!1},W2={readContext:Pr,useCallback:mx,useContext:Pr,useEffect:_g,useImperativeHandle:fx,useInsertionEffect:hx,useLayoutEffect:dx,useMemo:gx,useReducer:Lf,useRef:cx,useState:function(){return Lf(kc)},useDebugValue:vg,useDeferredValue:function(i){var s=Mr();return yx(s,Ui.memoizedState,i)},useTransition:function(){var i=Lf(kc)[0],s=Mr().memoizedState;return[i,s]},useMutableSource:nx,useSyncExternalStore:rx,useId:_x,unstable_isNewReconciler:!1},X2={readContext:Pr,useCallback:mx,useContext:Pr,useEffect:_g,useImperativeHandle:fx,useInsertionEffect:hx,useLayoutEffect:dx,useMemo:gx,useReducer:Df,useRef:cx,useState:function(){return Df(kc)},useDebugValue:vg,useDeferredValue:function(i){var s=Mr();return Ui===null?s.memoizedState=i:yx(s,Ui.memoizedState,i)},useTransition:function(){var i=Df(kc)[0],s=Mr().memoizedState;return[i,s]},useMutableSource:nx,useSyncExternalStore:rx,useId:_x,unstable_isNewReconciler:!1};function Al(i,s){try{var u="",y=s;do u+=Sb(y),y=y.return;while(y);var _=u}catch(S){_=`
Error generating stack: `+S.message+`
`+S.stack}return{value:i,source:s,stack:_,digest:null}}function Rf(i,s,u){return{value:i,source:null,stack:u??null,digest:s??null}}function Tm(i,s){try{console.error(s.value)}catch(u){setTimeout(function(){throw u})}}var K2=typeof WeakMap=="function"?WeakMap:Map;function bx(i,s,u){u=Us(-1,u),u.tag=3,u.payload={element:null};var y=s.value;return u.callback=function(){Bd||(Bd=!0,Dm=y),Tm(i,s)},u}function Sx(i,s,u){u=Us(-1,u),u.tag=3;var y=i.type.getDerivedStateFromError;if(typeof y=="function"){var _=s.value;u.payload=function(){return y(_)},u.callback=function(){Tm(i,s)}}var S=i.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(u.callback=function(){Tm(i,s),typeof y!="function"&&(Mo===null?Mo=new Set([this]):Mo.add(this));var M=s.stack;this.componentDidCatch(s.value,{componentStack:M!==null?M:""})}),u}function rv(i,s,u){var y=i.pingCache;if(y===null){y=i.pingCache=new K2;var _=new Set;y.set(s,_)}else _=y.get(s),_===void 0&&(_=new Set,y.set(s,_));_.has(u)||(_.add(u),i=cS.bind(null,i,s,u),s.then(i,i))}function sv(i){do{var s;if((s=i.tag===13)&&(s=i.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return i;i=i.return}while(i!==null);return null}function ov(i,s,u,y,_){return i.mode&1?(i.flags|=65536,i.lanes=_,i):(i===s?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(s=Us(-1,1),s.tag=2,Po(u,s,1))),u.lanes|=1),i)}var Y2=Gs.ReactCurrentOwner,Yn=!1;function Fn(i,s,u,y){s.child=i===null?tx(s,null,u,y):Ml(s,i.child,u,y)}function av(i,s,u,y,_){u=u.render;var S=s.ref;return kl(s,_),y=gg(i,s,u,y,S,_),u=yg(),i!==null&&!Yn?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~_,Zs(i,s,_)):(fi&&u&&rg(s),s.flags|=1,Fn(i,s,y,_),s.child)}function lv(i,s,u,y,_){if(i===null){var S=u.type;return typeof S=="function"&&!Eg(S)&&S.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(s.tag=15,s.type=S,Tx(i,s,S,y,_)):(i=gd(u.type,null,y,s,s.mode,_),i.ref=s.ref,i.return=s,s.child=i)}if(S=i.child,!(i.lanes&_)){var M=S.memoizedProps;if(u=u.compare,u=u!==null?u:_c,u(M,y)&&i.ref===s.ref)return Zs(i,s,_)}return s.flags|=1,i=Ao(S,y),i.ref=s.ref,i.return=s,s.child=i}function Tx(i,s,u,y,_){if(i!==null){var S=i.memoizedProps;if(_c(S,y)&&i.ref===s.ref)if(Yn=!1,s.pendingProps=y=S,(i.lanes&_)!==0)i.flags&131072&&(Yn=!0);else return s.lanes=i.lanes,Zs(i,s,_)}return km(i,s,u,y,_)}function kx(i,s,u){var y=s.pendingProps,_=y.children,S=i!==null?i.memoizedState:null;if(y.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},ii(xl,lr),lr|=u;else{if(!(u&1073741824))return i=S!==null?S.baseLanes|u:u,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:i,cachePool:null,transitions:null},s.updateQueue=null,ii(xl,lr),lr|=i,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=S!==null?S.baseLanes:u,ii(xl,lr),lr|=y}else S!==null?(y=S.baseLanes|u,s.memoizedState=null):y=u,ii(xl,lr),lr|=y;return Fn(i,s,_,u),s.child}function Cx(i,s){var u=s.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(s.flags|=512,s.flags|=2097152)}function km(i,s,u,y,_){var S=Jn(u)?fa:Tn.current;return S=Il(s,S),kl(s,_),u=gg(i,s,u,y,S,_),y=yg(),i!==null&&!Yn?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~_,Zs(i,s,_)):(fi&&y&&rg(s),s.flags|=1,Fn(i,s,u,_),s.child)}function uv(i,s,u,y,_){if(Jn(u)){var S=!0;Ed(s)}else S=!1;if(kl(s,_),s.stateNode===null)pd(i,s),J0(s,u,y),Sm(s,u,y,_),y=!0;else if(i===null){var M=s.stateNode,l=s.memoizedProps;M.props=l;var N=M.context,R=u.contextType;typeof R=="object"&&R!==null?R=Pr(R):(R=Jn(u)?fa:Tn.current,R=Il(s,R));var re=u.getDerivedStateFromProps,de=typeof re=="function"||typeof M.getSnapshotBeforeUpdate=="function";de||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(l!==y||N!==R)&&ev(s,M,y,R),vo=!1;var te=s.memoizedState;M.state=te,Ad(s,y,M,_),N=s.memoizedState,l!==y||te!==N||Qn.current||vo?(typeof re=="function"&&(bm(s,u,re,y),N=s.memoizedState),(l=vo||J_(s,u,l,y,te,N,R))?(de||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(s.flags|=4194308)):(typeof M.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=y,s.memoizedState=N),M.props=y,M.state=N,M.context=R,y=l):(typeof M.componentDidMount=="function"&&(s.flags|=4194308),y=!1)}else{M=s.stateNode,Y0(i,s),l=s.memoizedProps,R=s.type===s.elementType?l:Gr(s.type,l),M.props=R,de=s.pendingProps,te=M.context,N=u.contextType,typeof N=="object"&&N!==null?N=Pr(N):(N=Jn(u)?fa:Tn.current,N=Il(s,N));var Pe=u.getDerivedStateFromProps;(re=typeof Pe=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(l!==de||te!==N)&&ev(s,M,y,N),vo=!1,te=s.memoizedState,M.state=te,Ad(s,y,M,_);var ke=s.memoizedState;l!==de||te!==ke||Qn.current||vo?(typeof Pe=="function"&&(bm(s,u,Pe,y),ke=s.memoizedState),(R=vo||J_(s,u,R,y,te,ke,N)||!1)?(re||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(y,ke,N),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(y,ke,N)),typeof M.componentDidUpdate=="function"&&(s.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof M.componentDidUpdate!="function"||l===i.memoizedProps&&te===i.memoizedState||(s.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||l===i.memoizedProps&&te===i.memoizedState||(s.flags|=1024),s.memoizedProps=y,s.memoizedState=ke),M.props=y,M.state=ke,M.context=N,y=R):(typeof M.componentDidUpdate!="function"||l===i.memoizedProps&&te===i.memoizedState||(s.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||l===i.memoizedProps&&te===i.memoizedState||(s.flags|=1024),y=!1)}return Cm(i,s,u,y,S,_)}function Cm(i,s,u,y,_,S){Cx(i,s);var M=(s.flags&128)!==0;if(!y&&!M)return _&&W_(s,u,!1),Zs(i,s,S);y=s.stateNode,Y2.current=s;var l=M&&typeof u.getDerivedStateFromError!="function"?null:y.render();return s.flags|=1,i!==null&&M?(s.child=Ml(s,i.child,null,S),s.child=Ml(s,null,l,S)):Fn(i,s,l,S),s.memoizedState=y.state,_&&W_(s,u,!0),s.child}function Ex(i){var s=i.stateNode;s.pendingContext?H_(i,s.pendingContext,s.pendingContext!==s.context):s.context&&H_(i,s.context,!1),dg(i,s.containerInfo)}function cv(i,s,u,y,_){return Pl(),og(_),s.flags|=256,Fn(i,s,u,y),s.child}var Em={dehydrated:null,treeContext:null,retryLane:0};function Im(i){return{baseLanes:i,cachePool:null,transitions:null}}function Ix(i,s,u){var y=s.pendingProps,_=_i.current,S=!1,M=(s.flags&128)!==0,l;if((l=M)||(l=i!==null&&i.memoizedState===null?!1:(_&2)!==0),l?(S=!0,s.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),ii(_i,_&1),i===null)return xm(s),i=s.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(s.mode&1?i.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(M=y.children,i=y.fallback,S?(y=s.mode,S=s.child,M={mode:"hidden",children:M},!(y&1)&&S!==null?(S.childLanes=0,S.pendingProps=M):S=Jd(M,y,0,null),i=pa(i,y,u,null),S.return=s,i.return=s,S.sibling=i,s.child=S,s.child.memoizedState=Im(u),s.memoizedState=Em,i):xg(s,M));if(_=i.memoizedState,_!==null&&(l=_.dehydrated,l!==null))return Q2(i,s,M,y,l,_,u);if(S){S=y.fallback,M=s.mode,_=i.child,l=_.sibling;var N={mode:"hidden",children:y.children};return!(M&1)&&s.child!==_?(y=s.child,y.childLanes=0,y.pendingProps=N,s.deletions=null):(y=Ao(_,N),y.subtreeFlags=_.subtreeFlags&14680064),l!==null?S=Ao(l,S):(S=pa(S,M,u,null),S.flags|=2),S.return=s,y.return=s,y.sibling=S,s.child=y,y=S,S=s.child,M=i.child.memoizedState,M=M===null?Im(u):{baseLanes:M.baseLanes|u,cachePool:null,transitions:M.transitions},S.memoizedState=M,S.childLanes=i.childLanes&~u,s.memoizedState=Em,y}return S=i.child,i=S.sibling,y=Ao(S,{mode:"visible",children:y.children}),!(s.mode&1)&&(y.lanes=u),y.return=s,y.sibling=null,i!==null&&(u=s.deletions,u===null?(s.deletions=[i],s.flags|=16):u.push(i)),s.child=y,s.memoizedState=null,y}function xg(i,s){return s=Jd({mode:"visible",children:s},i.mode,0,null),s.return=i,i.child=s}function ed(i,s,u,y){return y!==null&&og(y),Ml(s,i.child,null,u),i=xg(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Q2(i,s,u,y,_,S,M){if(u)return s.flags&256?(s.flags&=-257,y=Rf(Error(Le(422))),ed(i,s,M,y)):s.memoizedState!==null?(s.child=i.child,s.flags|=128,null):(S=y.fallback,_=s.mode,y=Jd({mode:"visible",children:y.children},_,0,null),S=pa(S,_,M,null),S.flags|=2,y.return=s,S.return=s,y.sibling=S,s.child=y,s.mode&1&&Ml(s,i.child,null,M),s.child.memoizedState=Im(M),s.memoizedState=Em,S);if(!(s.mode&1))return ed(i,s,M,null);if(_.data==="$!"){if(y=_.nextSibling&&_.nextSibling.dataset,y)var l=y.dgst;return y=l,S=Error(Le(419)),y=Rf(S,y,void 0),ed(i,s,M,y)}if(l=(M&i.childLanes)!==0,Yn||l){if(y=Qi,y!==null){switch(M&-M){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(y.suspendedLanes|M)?0:_,_!==0&&_!==S.retryLane&&(S.retryLane=_,qs(i,_),Kr(y,i,_,-1))}return Cg(),y=Rf(Error(Le(421))),ed(i,s,M,y)}return _.data==="$?"?(s.flags|=128,s.child=i.child,s=hS.bind(null,i),_._reactRetry=s,null):(i=S.treeContext,ur=Io(_.nextSibling),cr=s,fi=!0,Wr=null,i!==null&&(kr[Cr++]=Ns,kr[Cr++]=Vs,kr[Cr++]=ma,Ns=i.id,Vs=i.overflow,ma=s),s=xg(s,y.children),s.flags|=4096,s)}function hv(i,s,u){i.lanes|=s;var y=i.alternate;y!==null&&(y.lanes|=s),wm(i.return,s,u)}function Ff(i,s,u,y,_){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:y,tail:u,tailMode:_}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=y,S.tail=u,S.tailMode=_)}function Px(i,s,u){var y=s.pendingProps,_=y.revealOrder,S=y.tail;if(Fn(i,s,y.children,u),y=_i.current,y&2)y=y&1|2,s.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&hv(i,u,s);else if(i.tag===19)hv(i,u,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}y&=1}if(ii(_i,y),!(s.mode&1))s.memoizedState=null;else switch(_){case"forwards":for(u=s.child,_=null;u!==null;)i=u.alternate,i!==null&&Ld(i)===null&&(_=u),u=u.sibling;u=_,u===null?(_=s.child,s.child=null):(_=u.sibling,u.sibling=null),Ff(s,!1,_,u,S);break;case"backwards":for(u=null,_=s.child,s.child=null;_!==null;){if(i=_.alternate,i!==null&&Ld(i)===null){s.child=_;break}i=_.sibling,_.sibling=u,u=_,_=i}Ff(s,!0,u,null,S);break;case"together":Ff(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function pd(i,s){!(s.mode&1)&&i!==null&&(i.alternate=null,s.alternate=null,s.flags|=2)}function Zs(i,s,u){if(i!==null&&(s.dependencies=i.dependencies),ya|=s.lanes,!(u&s.childLanes))return null;if(i!==null&&s.child!==i.child)throw Error(Le(153));if(s.child!==null){for(i=s.child,u=Ao(i,i.pendingProps),s.child=u,u.return=s;i.sibling!==null;)i=i.sibling,u=u.sibling=Ao(i,i.pendingProps),u.return=s;u.sibling=null}return s.child}function J2(i,s,u){switch(s.tag){case 3:Ex(s),Pl();break;case 5:ix(s);break;case 1:Jn(s.type)&&Ed(s);break;case 4:dg(s,s.stateNode.containerInfo);break;case 10:var y=s.type._context,_=s.memoizedProps.value;ii(Md,y._currentValue),y._currentValue=_;break;case 13:if(y=s.memoizedState,y!==null)return y.dehydrated!==null?(ii(_i,_i.current&1),s.flags|=128,null):u&s.child.childLanes?Ix(i,s,u):(ii(_i,_i.current&1),i=Zs(i,s,u),i!==null?i.sibling:null);ii(_i,_i.current&1);break;case 19:if(y=(u&s.childLanes)!==0,i.flags&128){if(y)return Px(i,s,u);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ii(_i,_i.current),y)break;return null;case 22:case 23:return s.lanes=0,kx(i,s,u)}return Zs(i,s,u)}var Mx,Pm,zx,Ax;Mx=function(i,s){for(var u=s.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};Pm=function(){};zx=function(i,s,u,y){var _=i.memoizedProps;if(_!==y){i=s.stateNode,ha(gs.current);var S=null;switch(u){case"input":_=Yf(i,_),y=Yf(i,y),S=[];break;case"select":_=xi({},_,{value:void 0}),y=xi({},y,{value:void 0}),S=[];break;case"textarea":_=em(i,_),y=em(i,y),S=[];break;default:typeof _.onClick!="function"&&typeof y.onClick=="function"&&(i.onclick=kd)}im(u,y);var M;u=null;for(R in _)if(!y.hasOwnProperty(R)&&_.hasOwnProperty(R)&&_[R]!=null)if(R==="style"){var l=_[R];for(M in l)l.hasOwnProperty(M)&&(u||(u={}),u[M]="")}else R!=="dangerouslySetInnerHTML"&&R!=="children"&&R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(hc.hasOwnProperty(R)?S||(S=[]):(S=S||[]).push(R,null));for(R in y){var N=y[R];if(l=_!=null?_[R]:void 0,y.hasOwnProperty(R)&&N!==l&&(N!=null||l!=null))if(R==="style")if(l){for(M in l)!l.hasOwnProperty(M)||N&&N.hasOwnProperty(M)||(u||(u={}),u[M]="");for(M in N)N.hasOwnProperty(M)&&l[M]!==N[M]&&(u||(u={}),u[M]=N[M])}else u||(S||(S=[]),S.push(R,u)),u=N;else R==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,l=l?l.__html:void 0,N!=null&&l!==N&&(S=S||[]).push(R,N)):R==="children"?typeof N!="string"&&typeof N!="number"||(S=S||[]).push(R,""+N):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&(hc.hasOwnProperty(R)?(N!=null&&R==="onScroll"&&ai("scroll",i),S||l===N||(S=[])):(S=S||[]).push(R,N))}u&&(S=S||[]).push("style",u);var R=S;(s.updateQueue=R)&&(s.flags|=4)}};Ax=function(i,s,u,y){u!==y&&(s.flags|=4)};function Ku(i,s){if(!fi)switch(i.tailMode){case"hidden":s=i.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var y=null;u!==null;)u.alternate!==null&&(y=u),u=u.sibling;y===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:y.sibling=null}}function bn(i){var s=i.alternate!==null&&i.alternate.child===i.child,u=0,y=0;if(s)for(var _=i.child;_!==null;)u|=_.lanes|_.childLanes,y|=_.subtreeFlags&14680064,y|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)u|=_.lanes|_.childLanes,y|=_.subtreeFlags,y|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=y,i.childLanes=u,s}function eS(i,s,u){var y=s.pendingProps;switch(sg(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(s),null;case 1:return Jn(s.type)&&Cd(),bn(s),null;case 3:return y=s.stateNode,zl(),li(Qn),li(Tn),fg(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(i===null||i.child===null)&&(Qh(s)?s.flags|=4:i===null||i.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Wr!==null&&(Bm(Wr),Wr=null))),Pm(i,s),bn(s),null;case 5:pg(s);var _=ha(Sc.current);if(u=s.type,i!==null&&s.stateNode!=null)zx(i,s,u,y,_),i.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!y){if(s.stateNode===null)throw Error(Le(166));return bn(s),null}if(i=ha(gs.current),Qh(s)){y=s.stateNode,u=s.type;var S=s.memoizedProps;switch(y[fs]=s,y[wc]=S,i=(s.mode&1)!==0,u){case"dialog":ai("cancel",y),ai("close",y);break;case"iframe":case"object":case"embed":ai("load",y);break;case"video":case"audio":for(_=0;_<tc.length;_++)ai(tc[_],y);break;case"source":ai("error",y);break;case"img":case"image":case"link":ai("error",y),ai("load",y);break;case"details":ai("toggle",y);break;case"input":x_(y,S),ai("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!S.multiple},ai("invalid",y);break;case"textarea":b_(y,S),ai("invalid",y)}im(u,S),_=null;for(var M in S)if(S.hasOwnProperty(M)){var l=S[M];M==="children"?typeof l=="string"?y.textContent!==l&&(S.suppressHydrationWarning!==!0&&Yh(y.textContent,l,i),_=["children",l]):typeof l=="number"&&y.textContent!==""+l&&(S.suppressHydrationWarning!==!0&&Yh(y.textContent,l,i),_=["children",""+l]):hc.hasOwnProperty(M)&&l!=null&&M==="onScroll"&&ai("scroll",y)}switch(u){case"input":$h(y),w_(y,S,!0);break;case"textarea":$h(y),S_(y);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(y.onclick=kd)}y=_,s.updateQueue=y,y!==null&&(s.flags|=4)}else{M=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=s0(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=M.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof y.is=="string"?i=M.createElement(u,{is:y.is}):(i=M.createElement(u),u==="select"&&(M=i,y.multiple?M.multiple=!0:y.size&&(M.size=y.size))):i=M.createElementNS(i,u),i[fs]=s,i[wc]=y,Mx(i,s,!1,!1),s.stateNode=i;e:{switch(M=nm(u,y),u){case"dialog":ai("cancel",i),ai("close",i),_=y;break;case"iframe":case"object":case"embed":ai("load",i),_=y;break;case"video":case"audio":for(_=0;_<tc.length;_++)ai(tc[_],i);_=y;break;case"source":ai("error",i),_=y;break;case"img":case"image":case"link":ai("error",i),ai("load",i),_=y;break;case"details":ai("toggle",i),_=y;break;case"input":x_(i,y),_=Yf(i,y),ai("invalid",i);break;case"option":_=y;break;case"select":i._wrapperState={wasMultiple:!!y.multiple},_=xi({},y,{value:void 0}),ai("invalid",i);break;case"textarea":b_(i,y),_=em(i,y),ai("invalid",i);break;default:_=y}im(u,_),l=_;for(S in l)if(l.hasOwnProperty(S)){var N=l[S];S==="style"?l0(i,N):S==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&o0(i,N)):S==="children"?typeof N=="string"?(u!=="textarea"||N!=="")&&dc(i,N):typeof N=="number"&&dc(i,""+N):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(hc.hasOwnProperty(S)?N!=null&&S==="onScroll"&&ai("scroll",i):N!=null&&qm(i,S,N,M))}switch(u){case"input":$h(i),w_(i,y,!1);break;case"textarea":$h(i),S_(i);break;case"option":y.value!=null&&i.setAttribute("value",""+Lo(y.value));break;case"select":i.multiple=!!y.multiple,S=y.value,S!=null?wl(i,!!y.multiple,S,!1):y.defaultValue!=null&&wl(i,!!y.multiple,y.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=kd)}switch(u){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return bn(s),null;case 6:if(i&&s.stateNode!=null)Ax(i,s,i.memoizedProps,y);else{if(typeof y!="string"&&s.stateNode===null)throw Error(Le(166));if(u=ha(Sc.current),ha(gs.current),Qh(s)){if(y=s.stateNode,u=s.memoizedProps,y[fs]=s,(S=y.nodeValue!==u)&&(i=cr,i!==null))switch(i.tag){case 3:Yh(y.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Yh(y.nodeValue,u,(i.mode&1)!==0)}S&&(s.flags|=4)}else y=(u.nodeType===9?u:u.ownerDocument).createTextNode(y),y[fs]=s,s.stateNode=y}return bn(s),null;case 13:if(li(_i),y=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(fi&&ur!==null&&s.mode&1&&!(s.flags&128))X0(),Pl(),s.flags|=98560,S=!1;else if(S=Qh(s),y!==null&&y.dehydrated!==null){if(i===null){if(!S)throw Error(Le(318));if(S=s.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(Le(317));S[fs]=s}else Pl(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;bn(s),S=!1}else Wr!==null&&(Bm(Wr),Wr=null),S=!0;if(!S)return s.flags&65536?s:null}return s.flags&128?(s.lanes=u,s):(y=y!==null,y!==(i!==null&&i.memoizedState!==null)&&y&&(s.child.flags|=8192,s.mode&1&&(i===null||_i.current&1?ji===0&&(ji=3):Cg())),s.updateQueue!==null&&(s.flags|=4),bn(s),null);case 4:return zl(),Pm(i,s),i===null&&vc(s.stateNode.containerInfo),bn(s),null;case 10:return ug(s.type._context),bn(s),null;case 17:return Jn(s.type)&&Cd(),bn(s),null;case 19:if(li(_i),S=s.memoizedState,S===null)return bn(s),null;if(y=(s.flags&128)!==0,M=S.rendering,M===null)if(y)Ku(S,!1);else{if(ji!==0||i!==null&&i.flags&128)for(i=s.child;i!==null;){if(M=Ld(i),M!==null){for(s.flags|=128,Ku(S,!1),y=M.updateQueue,y!==null&&(s.updateQueue=y,s.flags|=4),s.subtreeFlags=0,y=u,u=s.child;u!==null;)S=u,i=y,S.flags&=14680066,M=S.alternate,M===null?(S.childLanes=0,S.lanes=i,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=M.childLanes,S.lanes=M.lanes,S.child=M.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=M.memoizedProps,S.memoizedState=M.memoizedState,S.updateQueue=M.updateQueue,S.type=M.type,i=M.dependencies,S.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return ii(_i,_i.current&1|2),s.child}i=i.sibling}S.tail!==null&&Li()>Ll&&(s.flags|=128,y=!0,Ku(S,!1),s.lanes=4194304)}else{if(!y)if(i=Ld(M),i!==null){if(s.flags|=128,y=!0,u=i.updateQueue,u!==null&&(s.updateQueue=u,s.flags|=4),Ku(S,!0),S.tail===null&&S.tailMode==="hidden"&&!M.alternate&&!fi)return bn(s),null}else 2*Li()-S.renderingStartTime>Ll&&u!==1073741824&&(s.flags|=128,y=!0,Ku(S,!1),s.lanes=4194304);S.isBackwards?(M.sibling=s.child,s.child=M):(u=S.last,u!==null?u.sibling=M:s.child=M,S.last=M)}return S.tail!==null?(s=S.tail,S.rendering=s,S.tail=s.sibling,S.renderingStartTime=Li(),s.sibling=null,u=_i.current,ii(_i,y?u&1|2:u&1),s):(bn(s),null);case 22:case 23:return kg(),y=s.memoizedState!==null,i!==null&&i.memoizedState!==null!==y&&(s.flags|=8192),y&&s.mode&1?lr&1073741824&&(bn(s),s.subtreeFlags&6&&(s.flags|=8192)):bn(s),null;case 24:return null;case 25:return null}throw Error(Le(156,s.tag))}function tS(i,s){switch(sg(s),s.tag){case 1:return Jn(s.type)&&Cd(),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return zl(),li(Qn),li(Tn),fg(),i=s.flags,i&65536&&!(i&128)?(s.flags=i&-65537|128,s):null;case 5:return pg(s),null;case 13:if(li(_i),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(Le(340));Pl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return li(_i),null;case 4:return zl(),null;case 10:return ug(s.type._context),null;case 22:case 23:return kg(),null;case 24:return null;default:return null}}var td=!1,Sn=!1,iS=typeof WeakSet=="function"?WeakSet:Set,et=null;function vl(i,s){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(y){Ti(i,s,y)}else u.current=null}function Mm(i,s,u){try{u()}catch(y){Ti(i,s,y)}}var dv=!1;function nS(i,s){if(pm=bd,i=F0(),ng(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var y=u.getSelection&&u.getSelection();if(y&&y.rangeCount!==0){u=y.anchorNode;var _=y.anchorOffset,S=y.focusNode;y=y.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var M=0,l=-1,N=-1,R=0,re=0,de=i,te=null;t:for(;;){for(var Pe;de!==u||_!==0&&de.nodeType!==3||(l=M+_),de!==S||y!==0&&de.nodeType!==3||(N=M+y),de.nodeType===3&&(M+=de.nodeValue.length),(Pe=de.firstChild)!==null;)te=de,de=Pe;for(;;){if(de===i)break t;if(te===u&&++R===_&&(l=M),te===S&&++re===y&&(N=M),(Pe=de.nextSibling)!==null)break;de=te,te=de.parentNode}de=Pe}u=l===-1||N===-1?null:{start:l,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(fm={focusedElem:i,selectionRange:u},bd=!1,et=s;et!==null;)if(s=et,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,et=i;else for(;et!==null;){s=et;try{var ke=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(ke!==null){var Me=ke.memoizedProps,ut=ke.memoizedState,ee=s.stateNode,Y=ee.getSnapshotBeforeUpdate(s.elementType===s.type?Me:Gr(s.type,Me),ut);ee.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:var se=s.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(ve){Ti(s,s.return,ve)}if(i=s.sibling,i!==null){i.return=s.return,et=i;break}et=s.return}return ke=dv,dv=!1,ke}function lc(i,s,u){var y=s.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var _=y=y.next;do{if((_.tag&i)===i){var S=_.destroy;_.destroy=void 0,S!==void 0&&Mm(s,u,S)}_=_.next}while(_!==y)}}function Yd(i,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var u=s=s.next;do{if((u.tag&i)===i){var y=u.create;u.destroy=y()}u=u.next}while(u!==s)}}function zm(i){var s=i.ref;if(s!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof s=="function"?s(i):s.current=i}}function Lx(i){var s=i.alternate;s!==null&&(i.alternate=null,Lx(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&(delete s[fs],delete s[wc],delete s[ym],delete s[N2],delete s[V2])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Dx(i){return i.tag===5||i.tag===3||i.tag===4}function pv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Am(i,s,u){var y=i.tag;if(y===5||y===6)i=i.stateNode,s?u.nodeType===8?u.parentNode.insertBefore(i,s):u.insertBefore(i,s):(u.nodeType===8?(s=u.parentNode,s.insertBefore(i,u)):(s=u,s.appendChild(i)),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=kd));else if(y!==4&&(i=i.child,i!==null))for(Am(i,s,u),i=i.sibling;i!==null;)Am(i,s,u),i=i.sibling}function Lm(i,s,u){var y=i.tag;if(y===5||y===6)i=i.stateNode,s?u.insertBefore(i,s):u.appendChild(i);else if(y!==4&&(i=i.child,i!==null))for(Lm(i,s,u),i=i.sibling;i!==null;)Lm(i,s,u),i=i.sibling}var ln=null,Hr=!1;function yo(i,s,u){for(u=u.child;u!==null;)Rx(i,s,u),u=u.sibling}function Rx(i,s,u){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount($d,u)}catch{}switch(u.tag){case 5:Sn||vl(u,s);case 6:var y=ln,_=Hr;ln=null,yo(i,s,u),ln=y,Hr=_,ln!==null&&(Hr?(i=ln,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):ln.removeChild(u.stateNode));break;case 18:ln!==null&&(Hr?(i=ln,u=u.stateNode,i.nodeType===8?Pf(i.parentNode,u):i.nodeType===1&&Pf(i,u),gc(i)):Pf(ln,u.stateNode));break;case 4:y=ln,_=Hr,ln=u.stateNode.containerInfo,Hr=!0,yo(i,s,u),ln=y,Hr=_;break;case 0:case 11:case 14:case 15:if(!Sn&&(y=u.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){_=y=y.next;do{var S=_,M=S.destroy;S=S.tag,M!==void 0&&(S&2||S&4)&&Mm(u,s,M),_=_.next}while(_!==y)}yo(i,s,u);break;case 1:if(!Sn&&(vl(u,s),y=u.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=u.memoizedProps,y.state=u.memoizedState,y.componentWillUnmount()}catch(l){Ti(u,s,l)}yo(i,s,u);break;case 21:yo(i,s,u);break;case 22:u.mode&1?(Sn=(y=Sn)||u.memoizedState!==null,yo(i,s,u),Sn=y):yo(i,s,u);break;default:yo(i,s,u)}}function fv(i){var s=i.updateQueue;if(s!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new iS),s.forEach(function(y){var _=dS.bind(null,i,y);u.has(y)||(u.add(y),y.then(_,_))})}}function Zr(i,s){var u=s.deletions;if(u!==null)for(var y=0;y<u.length;y++){var _=u[y];try{var S=i,M=s,l=M;e:for(;l!==null;){switch(l.tag){case 5:ln=l.stateNode,Hr=!1;break e;case 3:ln=l.stateNode.containerInfo,Hr=!0;break e;case 4:ln=l.stateNode.containerInfo,Hr=!0;break e}l=l.return}if(ln===null)throw Error(Le(160));Rx(S,M,_),ln=null,Hr=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(R){Ti(_,s,R)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Fx(s,i),s=s.sibling}function Fx(i,s){var u=i.alternate,y=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Zr(s,i),ds(i),y&4){try{lc(3,i,i.return),Yd(3,i)}catch(Me){Ti(i,i.return,Me)}try{lc(5,i,i.return)}catch(Me){Ti(i,i.return,Me)}}break;case 1:Zr(s,i),ds(i),y&512&&u!==null&&vl(u,u.return);break;case 5:if(Zr(s,i),ds(i),y&512&&u!==null&&vl(u,u.return),i.flags&32){var _=i.stateNode;try{dc(_,"")}catch(Me){Ti(i,i.return,Me)}}if(y&4&&(_=i.stateNode,_!=null)){var S=i.memoizedProps,M=u!==null?u.memoizedProps:S,l=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{l==="input"&&S.type==="radio"&&S.name!=null&&n0(_,S),nm(l,M);var R=nm(l,S);for(M=0;M<N.length;M+=2){var re=N[M],de=N[M+1];re==="style"?l0(_,de):re==="dangerouslySetInnerHTML"?o0(_,de):re==="children"?dc(_,de):qm(_,re,de,R)}switch(l){case"input":Qf(_,S);break;case"textarea":r0(_,S);break;case"select":var te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!S.multiple;var Pe=S.value;Pe!=null?wl(_,!!S.multiple,Pe,!1):te!==!!S.multiple&&(S.defaultValue!=null?wl(_,!!S.multiple,S.defaultValue,!0):wl(_,!!S.multiple,S.multiple?[]:"",!1))}_[wc]=S}catch(Me){Ti(i,i.return,Me)}}break;case 6:if(Zr(s,i),ds(i),y&4){if(i.stateNode===null)throw Error(Le(162));_=i.stateNode,S=i.memoizedProps;try{_.nodeValue=S}catch(Me){Ti(i,i.return,Me)}}break;case 3:if(Zr(s,i),ds(i),y&4&&u!==null&&u.memoizedState.isDehydrated)try{gc(s.containerInfo)}catch(Me){Ti(i,i.return,Me)}break;case 4:Zr(s,i),ds(i);break;case 13:Zr(s,i),ds(i),_=i.child,_.flags&8192&&(S=_.memoizedState!==null,_.stateNode.isHidden=S,!S||_.alternate!==null&&_.alternate.memoizedState!==null||(Sg=Li())),y&4&&fv(i);break;case 22:if(re=u!==null&&u.memoizedState!==null,i.mode&1?(Sn=(R=Sn)||re,Zr(s,i),Sn=R):Zr(s,i),ds(i),y&8192){if(R=i.memoizedState!==null,(i.stateNode.isHidden=R)&&!re&&i.mode&1)for(et=i,re=i.child;re!==null;){for(de=et=re;et!==null;){switch(te=et,Pe=te.child,te.tag){case 0:case 11:case 14:case 15:lc(4,te,te.return);break;case 1:vl(te,te.return);var ke=te.stateNode;if(typeof ke.componentWillUnmount=="function"){y=te,u=te.return;try{s=y,ke.props=s.memoizedProps,ke.state=s.memoizedState,ke.componentWillUnmount()}catch(Me){Ti(y,u,Me)}}break;case 5:vl(te,te.return);break;case 22:if(te.memoizedState!==null){gv(de);continue}}Pe!==null?(Pe.return=te,et=Pe):gv(de)}re=re.sibling}e:for(re=null,de=i;;){if(de.tag===5){if(re===null){re=de;try{_=de.stateNode,R?(S=_.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(l=de.stateNode,N=de.memoizedProps.style,M=N!=null&&N.hasOwnProperty("display")?N.display:null,l.style.display=a0("display",M))}catch(Me){Ti(i,i.return,Me)}}}else if(de.tag===6){if(re===null)try{de.stateNode.nodeValue=R?"":de.memoizedProps}catch(Me){Ti(i,i.return,Me)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===i)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===i)break e;for(;de.sibling===null;){if(de.return===null||de.return===i)break e;re===de&&(re=null),de=de.return}re===de&&(re=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:Zr(s,i),ds(i),y&4&&fv(i);break;case 21:break;default:Zr(s,i),ds(i)}}function ds(i){var s=i.flags;if(s&2){try{e:{for(var u=i.return;u!==null;){if(Dx(u)){var y=u;break e}u=u.return}throw Error(Le(160))}switch(y.tag){case 5:var _=y.stateNode;y.flags&32&&(dc(_,""),y.flags&=-33);var S=pv(i);Lm(i,S,_);break;case 3:case 4:var M=y.stateNode.containerInfo,l=pv(i);Am(i,l,M);break;default:throw Error(Le(161))}}catch(N){Ti(i,i.return,N)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function rS(i,s,u){et=i,Bx(i)}function Bx(i,s,u){for(var y=(i.mode&1)!==0;et!==null;){var _=et,S=_.child;if(_.tag===22&&y){var M=_.memoizedState!==null||td;if(!M){var l=_.alternate,N=l!==null&&l.memoizedState!==null||Sn;l=td;var R=Sn;if(td=M,(Sn=N)&&!R)for(et=_;et!==null;)M=et,N=M.child,M.tag===22&&M.memoizedState!==null?yv(_):N!==null?(N.return=M,et=N):yv(_);for(;S!==null;)et=S,Bx(S),S=S.sibling;et=_,td=l,Sn=R}mv(i)}else _.subtreeFlags&8772&&S!==null?(S.return=_,et=S):mv(i)}}function mv(i){for(;et!==null;){var s=et;if(s.flags&8772){var u=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Sn||Yd(5,s);break;case 1:var y=s.stateNode;if(s.flags&4&&!Sn)if(u===null)y.componentDidMount();else{var _=s.elementType===s.type?u.memoizedProps:Gr(s.type,u.memoizedProps);y.componentDidUpdate(_,u.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var S=s.updateQueue;S!==null&&Q_(s,S,y);break;case 3:var M=s.updateQueue;if(M!==null){if(u=null,s.child!==null)switch(s.child.tag){case 5:u=s.child.stateNode;break;case 1:u=s.child.stateNode}Q_(s,M,u)}break;case 5:var l=s.stateNode;if(u===null&&s.flags&4){u=l;var N=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&u.focus();break;case"img":N.src&&(u.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var R=s.alternate;if(R!==null){var re=R.memoizedState;if(re!==null){var de=re.dehydrated;de!==null&&gc(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}Sn||s.flags&512&&zm(s)}catch(te){Ti(s,s.return,te)}}if(s===i){et=null;break}if(u=s.sibling,u!==null){u.return=s.return,et=u;break}et=s.return}}function gv(i){for(;et!==null;){var s=et;if(s===i){et=null;break}var u=s.sibling;if(u!==null){u.return=s.return,et=u;break}et=s.return}}function yv(i){for(;et!==null;){var s=et;try{switch(s.tag){case 0:case 11:case 15:var u=s.return;try{Yd(4,s)}catch(N){Ti(s,u,N)}break;case 1:var y=s.stateNode;if(typeof y.componentDidMount=="function"){var _=s.return;try{y.componentDidMount()}catch(N){Ti(s,_,N)}}var S=s.return;try{zm(s)}catch(N){Ti(s,S,N)}break;case 5:var M=s.return;try{zm(s)}catch(N){Ti(s,M,N)}}}catch(N){Ti(s,s.return,N)}if(s===i){et=null;break}var l=s.sibling;if(l!==null){l.return=s.return,et=l;break}et=s.return}}var sS=Math.ceil,Fd=Gs.ReactCurrentDispatcher,wg=Gs.ReactCurrentOwner,Ir=Gs.ReactCurrentBatchConfig,Rt=0,Qi=null,Ri=null,un=0,lr=0,xl=Fo(0),ji=0,Ec=null,ya=0,Qd=0,bg=0,uc=null,Kn=null,Sg=0,Ll=1/0,Bs=null,Bd=!1,Dm=null,Mo=null,id=!1,To=null,Od=0,cc=0,Rm=null,fd=-1,md=0;function Bn(){return Rt&6?Li():fd!==-1?fd:fd=Li()}function zo(i){return i.mode&1?Rt&2&&un!==0?un&-un:j2.transition!==null?(md===0&&(md=x0()),md):(i=Gt,i!==0||(i=window.event,i=i===void 0?16:E0(i.type)),i):1}function Kr(i,s,u,y){if(50<cc)throw cc=0,Rm=null,Error(Le(185));Pc(i,u,y),(!(Rt&2)||i!==Qi)&&(i===Qi&&(!(Rt&2)&&(Qd|=u),ji===4&&wo(i,un)),er(i,y),u===1&&Rt===0&&!(s.mode&1)&&(Ll=Li()+500,Wd&&Bo()))}function er(i,s){var u=i.callbackNode;jb(i,s);var y=wd(i,i===Qi?un:0);if(y===0)u!==null&&C_(u),i.callbackNode=null,i.callbackPriority=0;else if(s=y&-y,i.callbackPriority!==s){if(u!=null&&C_(u),s===1)i.tag===0?U2(_v.bind(null,i)):G0(_v.bind(null,i)),B2(function(){!(Rt&6)&&Bo()}),u=null;else{switch(w0(y)){case 1:u=Xm;break;case 4:u=_0;break;case 16:u=xd;break;case 536870912:u=v0;break;default:u=xd}u=Zx(u,Ox.bind(null,i))}i.callbackPriority=s,i.callbackNode=u}}function Ox(i,s){if(fd=-1,md=0,Rt&6)throw Error(Le(327));var u=i.callbackNode;if(Cl()&&i.callbackNode!==u)return null;var y=wd(i,i===Qi?un:0);if(y===0)return null;if(y&30||y&i.expiredLanes||s)s=Nd(i,y);else{s=y;var _=Rt;Rt|=2;var S=Vx();(Qi!==i||un!==s)&&(Bs=null,Ll=Li()+500,da(i,s));do try{lS();break}catch(l){Nx(i,l)}while(!0);lg(),Fd.current=S,Rt=_,Ri!==null?s=0:(Qi=null,un=0,s=ji)}if(s!==0){if(s===2&&(_=lm(i),_!==0&&(y=_,s=Fm(i,_))),s===1)throw u=Ec,da(i,0),wo(i,y),er(i,Li()),u;if(s===6)wo(i,y);else{if(_=i.current.alternate,!(y&30)&&!oS(_)&&(s=Nd(i,y),s===2&&(S=lm(i),S!==0&&(y=S,s=Fm(i,S))),s===1))throw u=Ec,da(i,0),wo(i,y),er(i,Li()),u;switch(i.finishedWork=_,i.finishedLanes=y,s){case 0:case 1:throw Error(Le(345));case 2:la(i,Kn,Bs);break;case 3:if(wo(i,y),(y&130023424)===y&&(s=Sg+500-Li(),10<s)){if(wd(i,0)!==0)break;if(_=i.suspendedLanes,(_&y)!==y){Bn(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=gm(la.bind(null,i,Kn,Bs),s);break}la(i,Kn,Bs);break;case 4:if(wo(i,y),(y&4194240)===y)break;for(s=i.eventTimes,_=-1;0<y;){var M=31-Xr(y);S=1<<M,M=s[M],M>_&&(_=M),y&=~S}if(y=_,y=Li()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*sS(y/1960))-y,10<y){i.timeoutHandle=gm(la.bind(null,i,Kn,Bs),y);break}la(i,Kn,Bs);break;case 5:la(i,Kn,Bs);break;default:throw Error(Le(329))}}}return er(i,Li()),i.callbackNode===u?Ox.bind(null,i):null}function Fm(i,s){var u=uc;return i.current.memoizedState.isDehydrated&&(da(i,s).flags|=256),i=Nd(i,s),i!==2&&(s=Kn,Kn=u,s!==null&&Bm(s)),i}function Bm(i){Kn===null?Kn=i:Kn.push.apply(Kn,i)}function oS(i){for(var s=i;;){if(s.flags&16384){var u=s.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var y=0;y<u.length;y++){var _=u[y],S=_.getSnapshot;_=_.value;try{if(!Yr(S(),_))return!1}catch{return!1}}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function wo(i,s){for(s&=~bg,s&=~Qd,i.suspendedLanes|=s,i.pingedLanes&=~s,i=i.expirationTimes;0<s;){var u=31-Xr(s),y=1<<u;i[u]=-1,s&=~y}}function _v(i){if(Rt&6)throw Error(Le(327));Cl();var s=wd(i,0);if(!(s&1))return er(i,Li()),null;var u=Nd(i,s);if(i.tag!==0&&u===2){var y=lm(i);y!==0&&(s=y,u=Fm(i,y))}if(u===1)throw u=Ec,da(i,0),wo(i,s),er(i,Li()),u;if(u===6)throw Error(Le(345));return i.finishedWork=i.current.alternate,i.finishedLanes=s,la(i,Kn,Bs),er(i,Li()),null}function Tg(i,s){var u=Rt;Rt|=1;try{return i(s)}finally{Rt=u,Rt===0&&(Ll=Li()+500,Wd&&Bo())}}function _a(i){To!==null&&To.tag===0&&!(Rt&6)&&Cl();var s=Rt;Rt|=1;var u=Ir.transition,y=Gt;try{if(Ir.transition=null,Gt=1,i)return i()}finally{Gt=y,Ir.transition=u,Rt=s,!(Rt&6)&&Bo()}}function kg(){lr=xl.current,li(xl)}function da(i,s){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,F2(u)),Ri!==null)for(u=Ri.return;u!==null;){var y=u;switch(sg(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Cd();break;case 3:zl(),li(Qn),li(Tn),fg();break;case 5:pg(y);break;case 4:zl();break;case 13:li(_i);break;case 19:li(_i);break;case 10:ug(y.type._context);break;case 22:case 23:kg()}u=u.return}if(Qi=i,Ri=i=Ao(i.current,null),un=lr=s,ji=0,Ec=null,bg=Qd=ya=0,Kn=uc=null,ca!==null){for(s=0;s<ca.length;s++)if(u=ca[s],y=u.interleaved,y!==null){u.interleaved=null;var _=y.next,S=u.pending;if(S!==null){var M=S.next;S.next=_,y.next=M}u.pending=y}ca=null}return i}function Nx(i,s){do{var u=Ri;try{if(lg(),hd.current=Rd,Dd){for(var y=vi.memoizedState;y!==null;){var _=y.queue;_!==null&&(_.pending=null),y=y.next}Dd=!1}if(ga=0,Yi=Ui=vi=null,ac=!1,Tc=0,wg.current=null,u===null||u.return===null){ji=1,Ec=s,Ri=null;break}e:{var S=i,M=u.return,l=u,N=s;if(s=un,l.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var R=N,re=l,de=re.tag;if(!(re.mode&1)&&(de===0||de===11||de===15)){var te=re.alternate;te?(re.updateQueue=te.updateQueue,re.memoizedState=te.memoizedState,re.lanes=te.lanes):(re.updateQueue=null,re.memoizedState=null)}var Pe=sv(M);if(Pe!==null){Pe.flags&=-257,ov(Pe,M,l,S,s),Pe.mode&1&&rv(S,R,s),s=Pe,N=R;var ke=s.updateQueue;if(ke===null){var Me=new Set;Me.add(N),s.updateQueue=Me}else ke.add(N);break e}else{if(!(s&1)){rv(S,R,s),Cg();break e}N=Error(Le(426))}}else if(fi&&l.mode&1){var ut=sv(M);if(ut!==null){!(ut.flags&65536)&&(ut.flags|=256),ov(ut,M,l,S,s),og(Al(N,l));break e}}S=N=Al(N,l),ji!==4&&(ji=2),uc===null?uc=[S]:uc.push(S),S=M;do{switch(S.tag){case 3:S.flags|=65536,s&=-s,S.lanes|=s;var ee=bx(S,N,s);Y_(S,ee);break e;case 1:l=N;var Y=S.type,se=S.stateNode;if(!(S.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(Mo===null||!Mo.has(se)))){S.flags|=65536,s&=-s,S.lanes|=s;var ve=Sx(S,l,s);Y_(S,ve);break e}}S=S.return}while(S!==null)}jx(u)}catch(Fe){s=Fe,Ri===u&&u!==null&&(Ri=u=u.return);continue}break}while(!0)}function Vx(){var i=Fd.current;return Fd.current=Rd,i===null?Rd:i}function Cg(){(ji===0||ji===3||ji===2)&&(ji=4),Qi===null||!(ya&268435455)&&!(Qd&268435455)||wo(Qi,un)}function Nd(i,s){var u=Rt;Rt|=2;var y=Vx();(Qi!==i||un!==s)&&(Bs=null,da(i,s));do try{aS();break}catch(_){Nx(i,_)}while(!0);if(lg(),Rt=u,Fd.current=y,Ri!==null)throw Error(Le(261));return Qi=null,un=0,ji}function aS(){for(;Ri!==null;)Ux(Ri)}function lS(){for(;Ri!==null&&!Lb();)Ux(Ri)}function Ux(i){var s=qx(i.alternate,i,lr);i.memoizedProps=i.pendingProps,s===null?jx(i):Ri=s,wg.current=null}function jx(i){var s=i;do{var u=s.alternate;if(i=s.return,s.flags&32768){if(u=tS(u,s),u!==null){u.flags&=32767,Ri=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{ji=6,Ri=null;return}}else if(u=eS(u,s,lr),u!==null){Ri=u;return}if(s=s.sibling,s!==null){Ri=s;return}Ri=s=i}while(s!==null);ji===0&&(ji=5)}function la(i,s,u){var y=Gt,_=Ir.transition;try{Ir.transition=null,Gt=1,uS(i,s,u,y)}finally{Ir.transition=_,Gt=y}return null}function uS(i,s,u,y){do Cl();while(To!==null);if(Rt&6)throw Error(Le(327));u=i.finishedWork;var _=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(Le(177));i.callbackNode=null,i.callbackPriority=0;var S=u.lanes|u.childLanes;if($b(i,S),i===Qi&&(Ri=Qi=null,un=0),!(u.subtreeFlags&2064)&&!(u.flags&2064)||id||(id=!0,Zx(xd,function(){return Cl(),null})),S=(u.flags&15990)!==0,u.subtreeFlags&15990||S){S=Ir.transition,Ir.transition=null;var M=Gt;Gt=1;var l=Rt;Rt|=4,wg.current=null,nS(i,u),Fx(u,i),P2(fm),bd=!!pm,fm=pm=null,i.current=u,rS(u),Db(),Rt=l,Gt=M,Ir.transition=S}else i.current=u;if(id&&(id=!1,To=i,Od=_),S=i.pendingLanes,S===0&&(Mo=null),Bb(u.stateNode),er(i,Li()),s!==null)for(y=i.onRecoverableError,u=0;u<s.length;u++)_=s[u],y(_.value,{componentStack:_.stack,digest:_.digest});if(Bd)throw Bd=!1,i=Dm,Dm=null,i;return Od&1&&i.tag!==0&&Cl(),S=i.pendingLanes,S&1?i===Rm?cc++:(cc=0,Rm=i):cc=0,Bo(),null}function Cl(){if(To!==null){var i=w0(Od),s=Ir.transition,u=Gt;try{if(Ir.transition=null,Gt=16>i?16:i,To===null)var y=!1;else{if(i=To,To=null,Od=0,Rt&6)throw Error(Le(331));var _=Rt;for(Rt|=4,et=i.current;et!==null;){var S=et,M=S.child;if(et.flags&16){var l=S.deletions;if(l!==null){for(var N=0;N<l.length;N++){var R=l[N];for(et=R;et!==null;){var re=et;switch(re.tag){case 0:case 11:case 15:lc(8,re,S)}var de=re.child;if(de!==null)de.return=re,et=de;else for(;et!==null;){re=et;var te=re.sibling,Pe=re.return;if(Lx(re),re===R){et=null;break}if(te!==null){te.return=Pe,et=te;break}et=Pe}}}var ke=S.alternate;if(ke!==null){var Me=ke.child;if(Me!==null){ke.child=null;do{var ut=Me.sibling;Me.sibling=null,Me=ut}while(Me!==null)}}et=S}}if(S.subtreeFlags&2064&&M!==null)M.return=S,et=M;else e:for(;et!==null;){if(S=et,S.flags&2048)switch(S.tag){case 0:case 11:case 15:lc(9,S,S.return)}var ee=S.sibling;if(ee!==null){ee.return=S.return,et=ee;break e}et=S.return}}var Y=i.current;for(et=Y;et!==null;){M=et;var se=M.child;if(M.subtreeFlags&2064&&se!==null)se.return=M,et=se;else e:for(M=Y;et!==null;){if(l=et,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yd(9,l)}}catch(Fe){Ti(l,l.return,Fe)}if(l===M){et=null;break e}var ve=l.sibling;if(ve!==null){ve.return=l.return,et=ve;break e}et=l.return}}if(Rt=_,Bo(),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot($d,i)}catch{}y=!0}return y}finally{Gt=u,Ir.transition=s}}return!1}function vv(i,s,u){s=Al(u,s),s=bx(i,s,1),i=Po(i,s,1),s=Bn(),i!==null&&(Pc(i,1,s),er(i,s))}function Ti(i,s,u){if(i.tag===3)vv(i,i,u);else for(;s!==null;){if(s.tag===3){vv(s,i,u);break}else if(s.tag===1){var y=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Mo===null||!Mo.has(y))){i=Al(u,i),i=Sx(s,i,1),s=Po(s,i,1),i=Bn(),s!==null&&(Pc(s,1,i),er(s,i));break}}s=s.return}}function cS(i,s,u){var y=i.pingCache;y!==null&&y.delete(s),s=Bn(),i.pingedLanes|=i.suspendedLanes&u,Qi===i&&(un&u)===u&&(ji===4||ji===3&&(un&130023424)===un&&500>Li()-Sg?da(i,0):bg|=u),er(i,s)}function $x(i,s){s===0&&(i.mode&1?(s=Gh,Gh<<=1,!(Gh&130023424)&&(Gh=4194304)):s=1);var u=Bn();i=qs(i,s),i!==null&&(Pc(i,s,u),er(i,u))}function hS(i){var s=i.memoizedState,u=0;s!==null&&(u=s.retryLane),$x(i,u)}function dS(i,s){var u=0;switch(i.tag){case 13:var y=i.stateNode,_=i.memoizedState;_!==null&&(u=_.retryLane);break;case 19:y=i.stateNode;break;default:throw Error(Le(314))}y!==null&&y.delete(s),$x(i,u)}var qx;qx=function(i,s,u){if(i!==null)if(i.memoizedProps!==s.pendingProps||Qn.current)Yn=!0;else{if(!(i.lanes&u)&&!(s.flags&128))return Yn=!1,J2(i,s,u);Yn=!!(i.flags&131072)}else Yn=!1,fi&&s.flags&1048576&&H0(s,Pd,s.index);switch(s.lanes=0,s.tag){case 2:var y=s.type;pd(i,s),i=s.pendingProps;var _=Il(s,Tn.current);kl(s,u),_=gg(null,s,y,i,_,u);var S=yg();return s.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Jn(y)?(S=!0,Ed(s)):S=!1,s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,hg(s),_.updater=Xd,s.stateNode=_,_._reactInternals=s,Sm(s,y,i,u),s=Cm(null,s,y,!0,S,u)):(s.tag=0,fi&&S&&rg(s),Fn(null,s,_,u),s=s.child),s;case 16:y=s.elementType;e:{switch(pd(i,s),i=s.pendingProps,_=y._init,y=_(y._payload),s.type=y,_=s.tag=fS(y),i=Gr(y,i),_){case 0:s=km(null,s,y,i,u);break e;case 1:s=uv(null,s,y,i,u);break e;case 11:s=av(null,s,y,i,u);break e;case 14:s=lv(null,s,y,Gr(y.type,i),u);break e}throw Error(Le(306,y,""))}return s;case 0:return y=s.type,_=s.pendingProps,_=s.elementType===y?_:Gr(y,_),km(i,s,y,_,u);case 1:return y=s.type,_=s.pendingProps,_=s.elementType===y?_:Gr(y,_),uv(i,s,y,_,u);case 3:e:{if(Ex(s),i===null)throw Error(Le(387));y=s.pendingProps,S=s.memoizedState,_=S.element,Y0(i,s),Ad(s,y,null,u);var M=s.memoizedState;if(y=M.element,S.isDehydrated)if(S={element:y,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},s.updateQueue.baseState=S,s.memoizedState=S,s.flags&256){_=Al(Error(Le(423)),s),s=cv(i,s,y,u,_);break e}else if(y!==_){_=Al(Error(Le(424)),s),s=cv(i,s,y,u,_);break e}else for(ur=Io(s.stateNode.containerInfo.firstChild),cr=s,fi=!0,Wr=null,u=tx(s,null,y,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Pl(),y===_){s=Zs(i,s,u);break e}Fn(i,s,y,u)}s=s.child}return s;case 5:return ix(s),i===null&&xm(s),y=s.type,_=s.pendingProps,S=i!==null?i.memoizedProps:null,M=_.children,mm(y,_)?M=null:S!==null&&mm(y,S)&&(s.flags|=32),Cx(i,s),Fn(i,s,M,u),s.child;case 6:return i===null&&xm(s),null;case 13:return Ix(i,s,u);case 4:return dg(s,s.stateNode.containerInfo),y=s.pendingProps,i===null?s.child=Ml(s,null,y,u):Fn(i,s,y,u),s.child;case 11:return y=s.type,_=s.pendingProps,_=s.elementType===y?_:Gr(y,_),av(i,s,y,_,u);case 7:return Fn(i,s,s.pendingProps,u),s.child;case 8:return Fn(i,s,s.pendingProps.children,u),s.child;case 12:return Fn(i,s,s.pendingProps.children,u),s.child;case 10:e:{if(y=s.type._context,_=s.pendingProps,S=s.memoizedProps,M=_.value,ii(Md,y._currentValue),y._currentValue=M,S!==null)if(Yr(S.value,M)){if(S.children===_.children&&!Qn.current){s=Zs(i,s,u);break e}}else for(S=s.child,S!==null&&(S.return=s);S!==null;){var l=S.dependencies;if(l!==null){M=S.child;for(var N=l.firstContext;N!==null;){if(N.context===y){if(S.tag===1){N=Us(-1,u&-u),N.tag=2;var R=S.updateQueue;if(R!==null){R=R.shared;var re=R.pending;re===null?N.next=N:(N.next=re.next,re.next=N),R.pending=N}}S.lanes|=u,N=S.alternate,N!==null&&(N.lanes|=u),wm(S.return,u,s),l.lanes|=u;break}N=N.next}}else if(S.tag===10)M=S.type===s.type?null:S.child;else if(S.tag===18){if(M=S.return,M===null)throw Error(Le(341));M.lanes|=u,l=M.alternate,l!==null&&(l.lanes|=u),wm(M,u,s),M=S.sibling}else M=S.child;if(M!==null)M.return=S;else for(M=S;M!==null;){if(M===s){M=null;break}if(S=M.sibling,S!==null){S.return=M.return,M=S;break}M=M.return}S=M}Fn(i,s,_.children,u),s=s.child}return s;case 9:return _=s.type,y=s.pendingProps.children,kl(s,u),_=Pr(_),y=y(_),s.flags|=1,Fn(i,s,y,u),s.child;case 14:return y=s.type,_=Gr(y,s.pendingProps),_=Gr(y.type,_),lv(i,s,y,_,u);case 15:return Tx(i,s,s.type,s.pendingProps,u);case 17:return y=s.type,_=s.pendingProps,_=s.elementType===y?_:Gr(y,_),pd(i,s),s.tag=1,Jn(y)?(i=!0,Ed(s)):i=!1,kl(s,u),J0(s,y,_),Sm(s,y,_,u),Cm(null,s,y,!0,i,u);case 19:return Px(i,s,u);case 22:return kx(i,s,u)}throw Error(Le(156,s.tag))};function Zx(i,s){return y0(i,s)}function pS(i,s,u,y){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(i,s,u,y){return new pS(i,s,u,y)}function Eg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function fS(i){if(typeof i=="function")return Eg(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Gm)return 11;if(i===Hm)return 14}return 2}function Ao(i,s){var u=i.alternate;return u===null?(u=Er(i.tag,s,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=s,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,s=i.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function gd(i,s,u,y,_,S){var M=2;if(y=i,typeof i=="function")Eg(i)&&(M=1);else if(typeof i=="string")M=5;else e:switch(i){case cl:return pa(u.children,_,S,s);case Zm:M=8,_|=8;break;case Hf:return i=Er(12,u,s,_|2),i.elementType=Hf,i.lanes=S,i;case Wf:return i=Er(13,u,s,_),i.elementType=Wf,i.lanes=S,i;case Xf:return i=Er(19,u,s,_),i.elementType=Xf,i.lanes=S,i;case e0:return Jd(u,_,S,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Qv:M=10;break e;case Jv:M=9;break e;case Gm:M=11;break e;case Hm:M=14;break e;case _o:M=16,y=null;break e}throw Error(Le(130,i==null?i:typeof i,""))}return s=Er(M,u,s,_),s.elementType=i,s.type=y,s.lanes=S,s}function pa(i,s,u,y){return i=Er(7,i,y,s),i.lanes=u,i}function Jd(i,s,u,y){return i=Er(22,i,y,s),i.elementType=e0,i.lanes=u,i.stateNode={isHidden:!1},i}function Bf(i,s,u){return i=Er(6,i,null,s),i.lanes=u,i}function Of(i,s,u){return s=Er(4,i.children!==null?i.children:[],i.key,s),s.lanes=u,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function mS(i,s,u,y,_){this.tag=s,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_f(0),this.expirationTimes=_f(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_f(0),this.identifierPrefix=y,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ig(i,s,u,y,_,S,M,l,N){return i=new mS(i,s,u,l,N),s===1?(s=1,S===!0&&(s|=8)):s=0,S=Er(3,null,null,s),i.current=S,S.stateNode=i,S.memoizedState={element:y,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},hg(S),i}function gS(i,s,u){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ul,key:y==null?null:""+y,children:i,containerInfo:s,implementation:u}}function Gx(i){if(!i)return Do;i=i._reactInternals;e:{if(xa(i)!==i||i.tag!==1)throw Error(Le(170));var s=i;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Jn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(Le(171))}if(i.tag===1){var u=i.type;if(Jn(u))return Z0(i,u,s)}return s}function Hx(i,s,u,y,_,S,M,l,N){return i=Ig(u,y,!0,i,_,S,M,l,N),i.context=Gx(null),u=i.current,y=Bn(),_=zo(u),S=Us(y,_),S.callback=s??null,Po(u,S,_),i.current.lanes=_,Pc(i,_,y),er(i,y),i}function ep(i,s,u,y){var _=s.current,S=Bn(),M=zo(_);return u=Gx(u),s.context===null?s.context=u:s.pendingContext=u,s=Us(S,M),s.payload={element:i},y=y===void 0?null:y,y!==null&&(s.callback=y),i=Po(_,s,M),i!==null&&(Kr(i,_,M,S),cd(i,_,M)),M}function Vd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function xv(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<s?u:s}}function Pg(i,s){xv(i,s),(i=i.alternate)&&xv(i,s)}function yS(){return null}var Wx=typeof reportError=="function"?reportError:function(i){console.error(i)};function Mg(i){this._internalRoot=i}tp.prototype.render=Mg.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(Le(409));ep(i,s,null,null)};tp.prototype.unmount=Mg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;_a(function(){ep(null,i,null,null)}),s[$s]=null}};function tp(i){this._internalRoot=i}tp.prototype.unstable_scheduleHydration=function(i){if(i){var s=T0();i={blockedOn:null,target:i,priority:s};for(var u=0;u<xo.length&&s!==0&&s<xo[u].priority;u++);xo.splice(u,0,i),u===0&&C0(i)}};function zg(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ip(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function wv(){}function _S(i,s,u,y,_){if(_){if(typeof y=="function"){var S=y;y=function(){var R=Vd(M);S.call(R)}}var M=Hx(s,y,i,0,null,!1,!1,"",wv);return i._reactRootContainer=M,i[$s]=M.current,vc(i.nodeType===8?i.parentNode:i),_a(),M}for(;_=i.lastChild;)i.removeChild(_);if(typeof y=="function"){var l=y;y=function(){var R=Vd(N);l.call(R)}}var N=Ig(i,0,!1,null,null,!1,!1,"",wv);return i._reactRootContainer=N,i[$s]=N.current,vc(i.nodeType===8?i.parentNode:i),_a(function(){ep(s,N,u,y)}),N}function np(i,s,u,y,_){var S=u._reactRootContainer;if(S){var M=S;if(typeof _=="function"){var l=_;_=function(){var N=Vd(M);l.call(N)}}ep(s,M,i,_)}else M=_S(u,s,i,_,y);return Vd(M)}b0=function(i){switch(i.tag){case 3:var s=i.stateNode;if(s.current.memoizedState.isDehydrated){var u=ec(s.pendingLanes);u!==0&&(Km(s,u|1),er(s,Li()),!(Rt&6)&&(Ll=Li()+500,Bo()))}break;case 13:_a(function(){var y=qs(i,1);if(y!==null){var _=Bn();Kr(y,i,1,_)}}),Pg(i,1)}};Ym=function(i){if(i.tag===13){var s=qs(i,134217728);if(s!==null){var u=Bn();Kr(s,i,134217728,u)}Pg(i,134217728)}};S0=function(i){if(i.tag===13){var s=zo(i),u=qs(i,s);if(u!==null){var y=Bn();Kr(u,i,s,y)}Pg(i,s)}};T0=function(){return Gt};k0=function(i,s){var u=Gt;try{return Gt=i,s()}finally{Gt=u}};sm=function(i,s,u){switch(s){case"input":if(Qf(i,u),s=u.name,u.type==="radio"&&s!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<u.length;s++){var y=u[s];if(y!==i&&y.form===i.form){var _=Hd(y);if(!_)throw Error(Le(90));i0(y),Qf(y,_)}}}break;case"textarea":r0(i,u);break;case"select":s=u.value,s!=null&&wl(i,!!u.multiple,s,!1)}};h0=Tg;d0=_a;var vS={usingClientEntryPoint:!1,Events:[zc,fl,Hd,u0,c0,Tg]},Yu={findFiberByHostInstance:ua,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},xS={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=m0(i),i===null?null:i.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||yS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{$d=nd.inject(xS),ms=nd}catch{}}dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vS;dr.createPortal=function(i,s){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zg(s))throw Error(Le(200));return gS(i,s,null,u)};dr.createRoot=function(i,s){if(!zg(i))throw Error(Le(299));var u=!1,y="",_=Wx;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(y=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),s=Ig(i,1,!1,null,null,u,!1,y,_),i[$s]=s.current,vc(i.nodeType===8?i.parentNode:i),new Mg(s)};dr.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(Le(188)):(i=Object.keys(i).join(","),Error(Le(268,i)));return i=m0(s),i=i===null?null:i.stateNode,i};dr.flushSync=function(i){return _a(i)};dr.hydrate=function(i,s,u){if(!ip(s))throw Error(Le(200));return np(null,i,s,!0,u)};dr.hydrateRoot=function(i,s,u){if(!zg(i))throw Error(Le(405));var y=u!=null&&u.hydratedSources||null,_=!1,S="",M=Wx;if(u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(S=u.identifierPrefix),u.onRecoverableError!==void 0&&(M=u.onRecoverableError)),s=Hx(s,null,i,1,u??null,_,!1,S,M),i[$s]=s.current,vc(i),y)for(i=0;i<y.length;i++)u=y[i],_=u._getVersion,_=_(u._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[u,_]:s.mutableSourceEagerHydrationData.push(u,_);return new tp(s)};dr.render=function(i,s,u){if(!ip(s))throw Error(Le(200));return np(null,i,s,!1,u)};dr.unmountComponentAtNode=function(i){if(!ip(i))throw Error(Le(40));return i._reactRootContainer?(_a(function(){np(null,null,i,!1,function(){i._reactRootContainer=null,i[$s]=null})}),!0):!1};dr.unstable_batchedUpdates=Tg;dr.unstable_renderSubtreeIntoContainer=function(i,s,u,y){if(!ip(u))throw Error(Le(200));if(i==null||i._reactInternals===void 0)throw Error(Le(38));return np(i,s,u,!1,y)};dr.version="18.2.0-next-9e3b772b8-20220608";function Xx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Xx)}catch(i){console.error(i)}}Xx(),Hv.exports=dr;var Ag=Hv.exports;const wS=Ud(Ag);var Kx={exports:{}},Nf,bv;function bS(){return bv||(bv=1,Nf={tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h1, h2, h3",ignoreSelector:".js-toc-ignore",hasInnerContainers:!1,linkClass:"toc-link",extraLinkClasses:"",activeLinkClass:"is-active-link",listClass:"toc-list",extraListClasses:"",isCollapsedClass:"is-collapsed",collapsibleClass:"is-collapsible",listItemClass:"toc-list-item",activeListItemClass:"is-active-li",collapseDepth:0,scrollSmooth:!0,scrollSmoothDuration:420,scrollSmoothOffset:0,scrollEndCallback:function(i){},headingsOffset:1,throttleTimeout:50,positionFixedSelector:null,positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto",includeHtml:!1,includeTitleTags:!1,onClick:function(i){},orderedList:!0,scrollContainer:null,skipRendering:!1,headingLabelCallback:!1,ignoreHiddenElements:!1,headingObjectCallback:null,basePath:"",disableTocScrollSync:!1,tocScrollOffset:0}),Nf}var Vf,Sv;function SS(){return Sv||(Sv=1,Vf=function(i){var s=[].forEach,u=[].some,y=document.body,_,S=!0,M=" ";function l(ee,Y){var se=Y.appendChild(R(ee));if(ee.children.length){var ve=re(ee.isCollapsed);ee.children.forEach(function(Fe){l(Fe,ve)}),se.appendChild(ve)}}function N(ee,Y){var se=!1,ve=re(se);if(Y.forEach(function(Fe){l(Fe,ve)}),_=ee||_,_!==null)return _.firstChild&&_.removeChild(_.firstChild),Y.length===0?_:_.appendChild(ve)}function R(ee){var Y=document.createElement("li"),se=document.createElement("a");return i.listItemClass&&Y.setAttribute("class",i.listItemClass),i.onClick&&(se.onclick=i.onClick),i.includeTitleTags&&se.setAttribute("title",ee.textContent),i.includeHtml&&ee.childNodes.length?s.call(ee.childNodes,function(ve){se.appendChild(ve.cloneNode(!0))}):se.textContent=ee.textContent,se.setAttribute("href",i.basePath+"#"+ee.id),se.setAttribute("class",i.linkClass+M+"node-name--"+ee.nodeName+M+i.extraLinkClasses),Y.appendChild(se),Y}function re(ee){var Y=i.orderedList?"ol":"ul",se=document.createElement(Y),ve=i.listClass+M+i.extraListClasses;return ee&&(ve=ve+M+i.collapsibleClass,ve=ve+M+i.isCollapsedClass),se.setAttribute("class",ve),se}function de(){if(i.scrollContainer&&document.querySelector(i.scrollContainer)){var ee;ee=document.querySelector(i.scrollContainer).scrollTop}else ee=document.documentElement.scrollTop||y.scrollTop;var Y=document.querySelector(i.positionFixedSelector);i.fixedSidebarOffset==="auto"&&(i.fixedSidebarOffset=_.offsetTop),ee>i.fixedSidebarOffset?Y.className.indexOf(i.positionFixedClass)===-1&&(Y.className+=M+i.positionFixedClass):Y.className=Y.className.split(M+i.positionFixedClass).join("")}function te(ee){var Y=0;return ee!==null&&(Y=ee.offsetTop,i.hasInnerContainers&&(Y+=te(ee.offsetParent))),Y}function Pe(ee){if(i.scrollContainer&&document.querySelector(i.scrollContainer)){var Y;Y=document.querySelector(i.scrollContainer).scrollTop}else Y=document.documentElement.scrollTop||y.scrollTop;i.positionFixedSelector&&de();var se=ee,ve;if(S&&_!==null&&se.length>0){u.call(se,function(Ot,ui){if(te(Ot)>Y+i.headingsOffset+10){var $i=ui===0?ui:ui-1;return ve=se[$i],!0}else if(ui===se.length-1)return ve=se[se.length-1],!0});var Fe=_.querySelector("."+i.activeLinkClass),Oe=_.querySelector("."+i.linkClass+".node-name--"+ve.nodeName+'[href="'+i.basePath+"#"+ve.id.replace(/([ #;&,.+*~':"!^$[\]()=>|/\\@])/g,"\\$1")+'"]');if(Fe===Oe)return;var Ge=_.querySelectorAll("."+i.linkClass);s.call(Ge,function(Ot){Ot.className=Ot.className.split(M+i.activeLinkClass).join("")});var Be=_.querySelectorAll("."+i.listItemClass);s.call(Be,function(Ot){Ot.className=Ot.className.split(M+i.activeListItemClass).join("")}),Oe&&Oe.className.indexOf(i.activeLinkClass)===-1&&(Oe.className+=M+i.activeLinkClass);var Et=Oe&&Oe.parentNode;Et&&Et.className.indexOf(i.activeListItemClass)===-1&&(Et.className+=M+i.activeListItemClass);var tt=_.querySelectorAll("."+i.listClass+"."+i.collapsibleClass);s.call(tt,function(Ot){Ot.className.indexOf(i.isCollapsedClass)===-1&&(Ot.className+=M+i.isCollapsedClass)}),Oe&&Oe.nextSibling&&Oe.nextSibling.className.indexOf(i.isCollapsedClass)!==-1&&(Oe.nextSibling.className=Oe.nextSibling.className.split(M+i.isCollapsedClass).join("")),ke(Oe&&Oe.parentNode.parentNode)}}function ke(ee){return ee&&ee.className.indexOf(i.collapsibleClass)!==-1&&ee.className.indexOf(i.isCollapsedClass)!==-1?(ee.className=ee.className.split(M+i.isCollapsedClass).join(""),ke(ee.parentNode.parentNode)):ee}function Me(ee){var Y=ee.target||ee.srcElement;typeof Y.className!="string"||Y.className.indexOf(i.linkClass)===-1||(S=!1)}function ut(){S=!0}return{enableTocAnimation:ut,disableTocAnimation:Me,render:N,updateToc:Pe}}),Vf}var Uf,Tv;function TS(){return Tv||(Tv=1,Uf=function(s){var u=[].reduce;function y(re){return re[re.length-1]}function _(re){return+re.nodeName.toUpperCase().replace("H","")}function S(re){try{return re instanceof window.HTMLElement||re instanceof window.parent.HTMLElement}catch{return re instanceof window.HTMLElement}}function M(re){if(!S(re))return re;if(s.ignoreHiddenElements&&(!re.offsetHeight||!re.offsetParent))return null;const de=re.getAttribute("data-heading-label")||(s.headingLabelCallback?String(s.headingLabelCallback(re.textContent)):re.textContent.trim());var te={id:re.id,children:[],nodeName:re.nodeName,headingLevel:_(re),textContent:de};return s.includeHtml&&(te.childNodes=re.childNodes),s.headingObjectCallback?s.headingObjectCallback(te,re):te}function l(re,de){for(var te=M(re),Pe=te.headingLevel,ke=de,Me=y(ke),ut=Me?Me.headingLevel:0,ee=Pe-ut;ee>0&&(Me=y(ke),!(Me&&Pe===Me.headingLevel));)Me&&Me.children!==void 0&&(ke=Me.children),ee--;return Pe>=s.collapseDepth&&(te.isCollapsed=!0),ke.push(te),ke}function N(re,de){var te=de;s.ignoreSelector&&(te=de.split(",").map(function(ke){return ke.trim()+":not("+s.ignoreSelector+")"}));try{return re.querySelectorAll(te)}catch{return console.warn("Headers not found with selector: "+te),null}}function R(re){return u.call(re,function(te,Pe){var ke=M(Pe);return ke&&l(ke,te.nest),te},{nest:[]})}return{nestHeadingsArray:R,selectHeadings:N}}),Uf}var jf,kv;function kS(){return kv||(kv=1,jf=function(s){var u=s.tocElement||document.querySelector(s.tocSelector);if(u&&u.scrollHeight>u.clientHeight){var y=u.querySelector("."+s.activeListItemClass);y&&(u.scrollTop=y.offsetTop-s.tocScrollOffset)}}),jf}var $f={},Cv;function CS(){if(Cv)return $f;Cv=1,$f.initSmoothScrolling=i;function i(u){var y=u.duration,_=u.offset,S=location.hash?N(location.href):location.href;M();function M(){document.body.addEventListener("click",re,!1);function re(de){!l(de.target)||de.target.className.indexOf("no-smooth-scroll")>-1||de.target.href.charAt(de.target.href.length-2)==="#"&&de.target.href.charAt(de.target.href.length-1)==="!"||de.target.className.indexOf(u.linkClass)===-1||s(de.target.hash,{duration:y,offset:_,callback:function(){R(de.target.hash)}})}}function l(re){return re.tagName.toLowerCase()==="a"&&(re.hash.length>0||re.href.charAt(re.href.length-1)==="#")&&(N(re.href)===S||N(re.href)+"#"===S)}function N(re){return re.slice(0,re.lastIndexOf("#"))}function R(re){var de=document.getElementById(re.substring(1));de&&(/^(?:a|select|input|button|textarea)$/i.test(de.tagName)||(de.tabIndex=-1),de.focus())}}function s(u,y){var _=window.pageYOffset,S={duration:y.duration,offset:y.offset||0,callback:y.callback,easing:y.easing||Pe},M=document.querySelector('[id="'+decodeURI(u).split("#").join("")+'"]')||document.querySelector('[id="'+u.split("#").join("")+'"]'),l=typeof u=="string"?S.offset+(u?M&&M.getBoundingClientRect().top||0:-(document.documentElement.scrollTop||document.body.scrollTop)):u,N=typeof S.duration=="function"?S.duration(l):S.duration,R,re;requestAnimationFrame(function(ke){R=ke,de(ke)});function de(ke){re=ke-R,window.scrollTo(0,S.easing(re,_,l,N)),re<N?requestAnimationFrame(de):te()}function te(){window.scrollTo(0,_+l),typeof S.callback=="function"&&S.callback()}function Pe(ke,Me,ut,ee){return ke/=ee/2,ke<1?ut/2*ke*ke+Me:(ke--,-ut/2*(ke*(ke-2)-1)+Me)}}return $f}(function(i,s){(function(u,y){i.exports=y(u)})(typeof rd<"u"?rd:window||rd,function(u){var y=bS(),_={},S={},M=SS(),l=TS(),N=kS(),R,re,de=!!u&&!!u.document&&!!u.document.querySelector&&!!u.addEventListener;if(typeof window>"u"&&!de)return;var te,Pe=Object.prototype.hasOwnProperty;function ke(){for(var Y={},se=0;se<arguments.length;se++){var ve=arguments[se];for(var Fe in ve)Pe.call(ve,Fe)&&(Y[Fe]=ve[Fe])}return Y}function Me(Y,se,ve){se||(se=250);var Fe,Oe;return function(){var Ge=ve||this,Be=+new Date,Et=arguments;Fe&&Be<Fe+se?(clearTimeout(Oe),Oe=setTimeout(function(){Fe=Be,Y.apply(Ge,Et)},se)):(Fe=Be,Y.apply(Ge,Et))}}function ut(Y){try{return Y.contentElement||document.querySelector(Y.contentSelector)}catch{return console.warn("Contents element not found: "+Y.contentSelector),null}}function ee(Y){try{return Y.tocElement||document.querySelector(Y.tocSelector)}catch{return console.warn("TOC element not found: "+Y.tocSelector),null}}return S.destroy=function(){var Y=ee(_);Y!==null&&(_.skipRendering||Y&&(Y.innerHTML=""),_.scrollContainer&&document.querySelector(_.scrollContainer)?(document.querySelector(_.scrollContainer).removeEventListener("scroll",this._scrollListener,!1),document.querySelector(_.scrollContainer).removeEventListener("resize",this._scrollListener,!1),R&&document.querySelector(_.scrollContainer).removeEventListener("click",this._clickListener,!1)):(document.removeEventListener("scroll",this._scrollListener,!1),document.removeEventListener("resize",this._scrollListener,!1),R&&document.removeEventListener("click",this._clickListener,!1)))},S.init=function(Y){if(de){_=ke(y,Y||{}),this.options=_,this.state={},_.scrollSmooth&&(_.duration=_.scrollSmoothDuration,_.offset=_.scrollSmoothOffset,S.scrollSmooth=CS().initSmoothScrolling(_)),R=M(_),re=l(_),this._buildHtml=R,this._parseContent=re,this._headingsArray=te,S.destroy();var se=ut(_);if(se!==null){var ve=ee(_);if(ve!==null&&(te=re.selectHeadings(se,_.headingSelector),te!==null)){var Fe=re.nestHeadingsArray(te),Oe=Fe.nest;if(!_.skipRendering)R.render(ve,Oe);else return this;this._scrollListener=Me(function(Be){R.updateToc(te),!_.disableTocScrollSync&&N(_);var Et=Be&&Be.target&&Be.target.scrollingElement&&Be.target.scrollingElement.scrollTop===0;(Be&&(Be.eventPhase===0||Be.currentTarget===null)||Et)&&(R.updateToc(te),_.scrollEndCallback&&_.scrollEndCallback(Be))},_.throttleTimeout),this._scrollListener(),_.scrollContainer&&document.querySelector(_.scrollContainer)?(document.querySelector(_.scrollContainer).addEventListener("scroll",this._scrollListener,!1),document.querySelector(_.scrollContainer).addEventListener("resize",this._scrollListener,!1)):(document.addEventListener("scroll",this._scrollListener,!1),document.addEventListener("resize",this._scrollListener,!1));var Ge=null;return this._clickListener=Me(function(Be){_.scrollSmooth&&R.disableTocAnimation(Be),R.updateToc(te),Ge&&clearTimeout(Ge),Ge=setTimeout(function(){R.enableTocAnimation()},_.scrollSmoothDuration)},_.throttleTimeout),_.scrollContainer&&document.querySelector(_.scrollContainer)?document.querySelector(_.scrollContainer).addEventListener("click",this._clickListener,!1):document.addEventListener("click",this._clickListener,!1),this}}}},S.refresh=function(Y){S.destroy(),S.init(Y||this.options)},u.tocbot=S,S})})(Kx);var ES=Kx.exports;const Ev=Ud(ES),IS="modulepreload",PS=function(i){return"/OpenStoryMaps/"+i},Iv={},MS=function(s,u,y){let _=Promise.resolve();if(u&&u.length>0){const S=document.getElementsByTagName("link");_=Promise.all(u.map(M=>{if(M=PS(M),M in Iv)return;Iv[M]=!0;const l=M.endsWith(".css"),N=l?'[rel="stylesheet"]':"";if(!!y)for(let de=S.length-1;de>=0;de--){const te=S[de];if(te.href===M&&(!l||te.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${M}"]${N}`))return;const re=document.createElement("link");if(re.rel=l?"stylesheet":IS,l||(re.as="script",re.crossOrigin=""),re.href=M,document.head.appendChild(re),l)return new Promise((de,te)=>{re.addEventListener("load",de),re.addEventListener("error",()=>te(new Error(`Unable to preload CSS for ${M}`)))})}))}return _.then(()=>s()).catch(S=>{const M=new Event("vite:preloadError",{cancelable:!0});if(M.payload=S,window.dispatchEvent(M),!M.defaultPrevented)throw S})},zS=pt.createContext(null);function AS(i){const s=i.clone();return s.pixelsToGLUnits=i.pixelsToGLUnits,s}function Pv(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function Mv(i,s){const u=s.viewState||s;let y=!1;if("longitude"in u&&"latitude"in u){const _=i.center;i.center=new _.constructor(u.longitude,u.latitude),y=y||_!==i.center}if("zoom"in u){const _=i.zoom;i.zoom=u.zoom,y=y||_!==i.zoom}if("bearing"in u){const _=i.bearing;i.bearing=u.bearing,y=y||_!==i.bearing}if("pitch"in u){const _=i.pitch;i.pitch=u.pitch,y=y||_!==i.pitch}return u.padding&&!i.isPaddingEqual(u.padding)&&(y=!0,i.padding=u.padding),y}const LS=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function zv(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const s={};for(const y of i.layers)s[y.id]=y;const u=i.layers.map(y=>{const _=s[y.ref];let S=null;if("interactive"in y&&(S={...y},delete S.interactive),_){S=S||{...y},delete S.ref;for(const M of LS)M in _&&(S[M]=_[M])}return S||y});return{...i,layers:u}}function DS(i,s){const u=Array.isArray(i)?i[0]:i?i.x:0,y=Array.isArray(i)?i[1]:i?i.y:0,_=Array.isArray(s)?s[0]:s?s.x:0,S=Array.isArray(s)?s[1]:s?s.y:0;return u===_&&y===S}function bo(i,s){if(i===s)return!0;if(!i||!s)return!1;if(Array.isArray(i)){if(!Array.isArray(s)||i.length!==s.length)return!1;for(let u=0;u<i.length;u++)if(!bo(i[u],s[u]))return!1;return!0}else if(Array.isArray(s))return!1;if(typeof i=="object"&&typeof s=="object"){const u=Object.keys(i),y=Object.keys(s);if(u.length!==y.length)return!1;for(const _ of u)if(!s.hasOwnProperty(_)||!bo(i[_],s[_]))return!1;return!0}return!1}var Av={};const Lv={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},qf={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Dv={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},RS=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],FS=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Dl{constructor(s,u,y){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=_=>{const S=this.props[Dv[_.type]];S&&S(_)},this._onPointerEvent=_=>{(_.type==="mousemove"||_.type==="mouseout")&&this._updateHover(_);const S=this.props[Lv[_.type]];S&&(this.props.interactiveLayerIds&&_.type!=="mouseover"&&_.type!=="mouseout"&&(_.features=this._hoveredFeatures||this._queryRenderedFeatures(_.point)),S(_),delete _.features)},this._onCameraEvent=_=>{if(!this._internalUpdate){const S=this.props[qf[_.type]];S&&S(_)}_.type in this._deferredEvents&&(this._deferredEvents[_.type]=!1)},this._MapClass=s,this.props=u,this._initialize(y)}get map(){return this._map}get transform(){return this._renderTransform}setProps(s){const u=this.props;this.props=s;const y=this._updateSettings(s,u);y&&this._createShadowTransform(this._map);const _=this._updateSize(s),S=this._updateViewState(s,!0);this._updateStyle(s,u),this._updateStyleComponents(s,u),this._updateHandlers(s,u),(y||_||S&&!this._map.isMoving())&&this.redraw()}static reuse(s,u){const y=Dl.savedMaps.pop();if(!y)return null;const _=y.map,S=_.getContainer();for(u.className=S.className;S.childNodes.length>0;)u.appendChild(S.childNodes[0]);_._container=u;const M=_._resizeObserver;M&&(M.disconnect(),M.observe(u)),y.setProps({...s,styleDiffing:!1}),_.resize();const{initialViewState:l}=s;return l&&(l.bounds?_.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):y._updateViewState(l,!1)),_.isStyleLoaded()?_.fire("load"):_.once("styledata",()=>_.fire("load")),_._update(),y}_initialize(s){const{props:u}=this,y={...u,...u.initialViewState,accessToken:u.mapboxAccessToken||BS()||null,container:s,style:zv(u.mapStyle)},_=y.initialViewState||y.viewState||y;if(Object.assign(y,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),u.gl){const R=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=R,u.gl)}const S=new this._MapClass(y);_.padding&&S.setPadding(_.padding),u.cursor&&(S.getCanvas().style.cursor=u.cursor),this._createShadowTransform(S);const M=S._render;S._render=R=>{this._inRender=!0,M.call(S,R),this._inRender=!1};const l=S._renderTaskQueue.run;S._renderTaskQueue.run=R=>{l.call(S._renderTaskQueue,R),this._onBeforeRepaint()},S.on("render",()=>this._onAfterRepaint());const N=S.fire;S.fire=this._fireEvent.bind(this,N),S.on("resize",()=>{this._renderTransform.resize(S.transform.width,S.transform.height)}),S.on("styledata",()=>this._updateStyleComponents(this.props,{})),S.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const R in Lv)S.on(R,this._onPointerEvent);for(const R in qf)S.on(R,this._onCameraEvent);for(const R in Dv)S.on(R,this._onEvent);this._map=S}recycle(){const u=this.map.getContainer().querySelector("[mapboxgl-children]");u==null||u.remove(),Dl.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const s=this._map;!this._inRender&&s.style&&(s._frame&&(s._frame.cancel(),s._frame=null),s._render())}_createShadowTransform(s){const u=AS(s.transform);s.painter.transform=u,this._renderTransform=u}_updateSize(s){const{viewState:u}=s;if(u){const y=this._map;if(u.width!==y.transform.width||u.height!==y.transform.height)return y.resize(),!0}return!1}_updateViewState(s,u){if(this._internalUpdate)return!1;const y=this._map,_=this._renderTransform,{zoom:S,pitch:M,bearing:l}=_,N=y.isMoving();N&&(_.cameraElevationReference="sea");const R=Mv(_,{...Pv(y.transform),...s});if(N&&(_.cameraElevationReference="ground"),R&&u){const re=this._deferredEvents;re.move=!0,re.zoom||(re.zoom=S!==_.zoom),re.rotate||(re.rotate=l!==_.bearing),re.pitch||(re.pitch=M!==_.pitch)}return N||Mv(y.transform,s),R}_updateSettings(s,u){const y=this._map;let _=!1;for(const S of RS)S in s&&!bo(s[S],u[S])&&(_=!0,y[`set${S[0].toUpperCase()}${S.slice(1)}`](s[S]));return _}_updateStyle(s,u){if(s.cursor!==u.cursor&&(this._map.getCanvas().style.cursor=s.cursor),s.mapStyle!==u.mapStyle){const y={diff:s.styleDiffing};return"localIdeographFontFamily"in s&&(y.localIdeographFontFamily=s.localIdeographFontFamily),this._map.setStyle(zv(s.mapStyle),y),!0}return!1}_updateStyleComponents(s,u){const y=this._map;let _=!1;return y.style.loaded()&&("light"in s&&!bo(s.light,u.light)&&(_=!0,y.setLight(s.light)),"fog"in s&&!bo(s.fog,u.fog)&&(_=!0,y.setFog(s.fog)),"terrain"in s&&!bo(s.terrain,u.terrain)&&(!s.terrain||y.getSource(s.terrain.source))&&(_=!0,y.setTerrain(s.terrain))),_}_updateHandlers(s,u){const y=this._map;let _=!1;for(const S of FS){const M=s[S];bo(M,u[S])||(_=!0,M?y[S].enable(M):y[S].disable())}return _}_queryRenderedFeatures(s){const u=this._map,{interactiveLayerIds:y=[]}=this.props;try{return u.queryRenderedFeatures(s,{layers:y.filter(u.getLayer.bind(u))})}catch{return[]}}_updateHover(s){var u;const{props:y}=this;if(y.interactiveLayerIds&&(y.onMouseMove||y.onMouseEnter||y.onMouseLeave)){const S=s.type,M=((u=this._hoveredFeatures)===null||u===void 0?void 0:u.length)>0,l=this._queryRenderedFeatures(s.point),N=l.length>0;!N&&M&&(s.type="mouseleave",this._onPointerEvent(s)),this._hoveredFeatures=l,N&&!M&&(s.type="mouseenter",this._onPointerEvent(s)),s.type=S}else this._hoveredFeatures=null}_fireEvent(s,u,y){const _=this._map,S=_.transform,M=typeof u=="string"?u:u.type;return M==="move"&&this._updateViewState(this.props,!1),M in qf&&(typeof u=="object"&&(u.viewState=Pv(S)),this._map.isMoving())?(_.transform=this._renderTransform,s.call(_,u,y),_.transform=S,_):(s.call(_,u,y),_)}_onBeforeRepaint(){const s=this._map;this._internalUpdate=!0;for(const y in this._deferredEvents)this._deferredEvents[y]&&s.fire(y);this._internalUpdate=!1;const u=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=u}}}Dl.savedMaps=[];function BS(){let i=null;if(typeof location<"u"){const s=/access_token=([^&\/]*)/.exec(location.search);i=s&&s[1]}try{i=i||Av.MapboxAccessToken}catch{}try{i=i||Av.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return i}const OS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function NS(i,s){if(!i)return null;const u=i.map,y={getMap:()=>u,getCenter:()=>i.transform.center,getZoom:()=>i.transform.zoom,getBearing:()=>i.transform.bearing,getPitch:()=>i.transform.pitch,getPadding:()=>i.transform.padding,getBounds:()=>i.transform.getBounds(),project:_=>i.transform.locationPoint(s.LngLat.convert(_)),unproject:_=>i.transform.pointLocation(s.Point.convert(_)),queryTerrainElevation:(_,S)=>{const M=u.transform;u.transform=i.transform;const l=u.queryTerrainElevation(_,S);return u.transform=M,l}};for(const _ of VS(u))!(_ in y)&&!OS.includes(_)&&(y[_]=u[_].bind(u));return y}function VS(i){const s=new Set;let u=i;for(;u;){for(const y of Object.getOwnPropertyNames(u))y[0]!=="_"&&typeof i[y]=="function"&&y!=="fire"&&y!=="setEventedParent"&&s.add(y);u=Object.getPrototypeOf(u)}return Array.from(s)}const US=typeof document<"u"?pt.useLayoutEffect:pt.useEffect,jS=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function $S(i,s){for(const u of jS)u in s&&(i[u]=s[u]);s.RTLTextPlugin&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"&&i.setRTLTextPlugin(s.RTLTextPlugin,u=>{u&&console.error(u)},!1)}const rp=pt.createContext(null),qS={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:i=>console.error(i.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Lg=pt.forwardRef((i,s)=>{const u=pt.useContext(zS),[y,_]=pt.useState(null),S=pt.useRef(),{current:M}=pt.useRef({mapLib:null,map:null});pt.useEffect(()=>{const R=i.mapLib;let re=!0,de;return Promise.resolve(R||MS(()=>import("./index-H3yz6dTg.js").then(te=>te.i),__vite__mapDeps([]))).then(te=>{if(re){if(te.Map||(te=te.default),!te||!te.Map)throw new Error("Invalid mapLib");if($S(te,i),!te.supported||te.supported(i))i.reuseMaps&&(de=Dl.reuse(i,S.current)),de||(de=new Dl(te.Map,i,S.current)),M.map=NS(de,te),M.mapLib=te,_(de),u==null||u.onMapMount(M.map,i.id);else throw new Error("Map is not supported by this browser")}}).catch(te=>{i.onError({type:"error",target:null,originalEvent:null,error:te})}),()=>{re=!1,de&&(u==null||u.onMapUnmount(i.id),i.reuseMaps?de.recycle():de.destroy())}},[]),US(()=>{y&&y.setProps(i)}),pt.useImperativeHandle(s,()=>M.map,[y]);const l=pt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),N={height:"100%"};return pt.createElement("div",{id:i.id,ref:S,style:l},y&&pt.createElement(rp.Provider,{value:M},pt.createElement("div",{"mapboxgl-children":"",style:N},i.children)))});Lg.displayName="Map";Lg.defaultProps=qS;const ZS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function wa(i,s){if(!i||!s)return;const u=i.style;for(const y in s){const _=s[y];Number.isFinite(_)&&!ZS.test(y)?u[y]=`${_}px`:u[y]=_}}const GS={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function Yx(i){const{map:s,mapLib:u}=pt.useContext(rp),y=pt.useRef({props:i});y.current.props=i;const _=pt.useMemo(()=>{let S=!1;pt.Children.forEach(i.children,N=>{N&&(S=!0)});const M={...i,element:S?document.createElement("div"):null},l=new u.Marker(M).setLngLat([i.longitude,i.latitude]);return l.getElement().addEventListener("click",N=>{var R,re;(re=(R=y.current.props).onClick)===null||re===void 0||re.call(R,{type:"click",target:l,originalEvent:N})}),l.on("dragstart",N=>{var R,re;const de=N;de.lngLat=_.getLngLat(),(re=(R=y.current.props).onDragStart)===null||re===void 0||re.call(R,de)}),l.on("drag",N=>{var R,re;const de=N;de.lngLat=_.getLngLat(),(re=(R=y.current.props).onDrag)===null||re===void 0||re.call(R,de)}),l.on("dragend",N=>{var R,re;const de=N;de.lngLat=_.getLngLat(),(re=(R=y.current.props).onDragEnd)===null||re===void 0||re.call(R,de)}),l},[]);return pt.useEffect(()=>(_.addTo(s.getMap()),()=>{_.remove()}),[]),pt.useEffect(()=>{wa(_.getElement(),i.style)},[i.style]),(_.getLngLat().lng!==i.longitude||_.getLngLat().lat!==i.latitude)&&_.setLngLat([i.longitude,i.latitude]),i.offset&&!DS(_.getOffset(),i.offset)&&_.setOffset(i.offset),_.isDraggable()!==i.draggable&&_.setDraggable(i.draggable),_.getRotation()!==i.rotation&&_.setRotation(i.rotation),_.getRotationAlignment()!==i.rotationAlignment&&_.setRotationAlignment(i.rotationAlignment),_.getPitchAlignment()!==i.pitchAlignment&&_.setPitchAlignment(i.pitchAlignment),_.getPopup()!==i.popup&&_.setPopup(i.popup),Ag.createPortal(i.children,_.getElement())}Yx.defaultProps=GS;pt.memo(Yx);function Rv(i){return new Set(i?i.trim().split(/\s+/):[])}function HS(i){const{map:s,mapLib:u}=pt.useContext(rp),y=pt.useMemo(()=>document.createElement("div"),[]),_=pt.useRef({props:i});_.current.props=i;const S=pt.useMemo(()=>{const M={...i},l=new u.Popup(M).setLngLat([i.longitude,i.latitude]);return l.once("open",N=>{var R,re;(re=(R=_.current.props).onOpen)===null||re===void 0||re.call(R,N)}),l},[]);if(pt.useEffect(()=>{const M=l=>{var N,R;(R=(N=_.current.props).onClose)===null||R===void 0||R.call(N,l)};return S.on("close",M),S.setDOMContent(y).addTo(s.getMap()),()=>{S.off("close",M),S.isOpen()&&S.remove()}},[]),pt.useEffect(()=>{wa(S.getElement(),i.style)},[i.style]),S.isOpen()&&((S.getLngLat().lng!==i.longitude||S.getLngLat().lat!==i.latitude)&&S.setLngLat([i.longitude,i.latitude]),i.offset&&!bo(S.options.offset,i.offset)&&S.setOffset(i.offset),(S.options.anchor!==i.anchor||S.options.maxWidth!==i.maxWidth)&&(S.options.anchor=i.anchor,S.setMaxWidth(i.maxWidth)),S.options.className!==i.className)){const M=Rv(S.options.className),l=Rv(i.className);for(const N of M)l.has(N)||S.removeClassName(N);for(const N of l)M.has(N)||S.addClassName(N);S.options.className=i.className}return Ag.createPortal(i.children,y)}pt.memo(HS);function Lc(i,s,u,y){const _=pt.useContext(rp),S=pt.useMemo(()=>i(_),[]);return pt.useEffect(()=>{const M=y||u||s,l=typeof s=="function"&&typeof u=="function"?s:null,N=typeof u=="function"?u:typeof s=="function"?s:null,{map:R}=_;return R.hasControl(S)||(R.addControl(S,M==null?void 0:M.position),l&&l(_)),()=>{N&&N(_),R.hasControl(S)&&R.removeControl(S)}},[]),S}function WS(i){const s=Lc(({mapLib:u})=>new u.AttributionControl(i),{position:i.position});return pt.useEffect(()=>{wa(s._container,i.style)},[i.style]),null}pt.memo(WS);function XS(i){const s=Lc(({mapLib:u})=>new u.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return pt.useEffect(()=>{wa(s._controlContainer,i.style)},[i.style]),null}pt.memo(XS);const Qx=pt.forwardRef((i,s)=>{const u=pt.useRef({props:i}),y=Lc(({mapLib:_})=>{const S=new _.GeolocateControl(i),M=S._setupUI;return S._setupUI=l=>{S._container.hasChildNodes()||M(l)},S.on("geolocate",l=>{var N,R;(R=(N=u.current.props).onGeolocate)===null||R===void 0||R.call(N,l)}),S.on("error",l=>{var N,R;(R=(N=u.current.props).onError)===null||R===void 0||R.call(N,l)}),S.on("outofmaxbounds",l=>{var N,R;(R=(N=u.current.props).onOutOfMaxBounds)===null||R===void 0||R.call(N,l)}),S.on("trackuserlocationstart",l=>{var N,R;(R=(N=u.current.props).onTrackUserLocationStart)===null||R===void 0||R.call(N,l)}),S.on("trackuserlocationend",l=>{var N,R;(R=(N=u.current.props).onTrackUserLocationEnd)===null||R===void 0||R.call(N,l)}),S},{position:i.position});return u.current.props=i,pt.useImperativeHandle(s,()=>({trigger:()=>y.trigger()}),[]),pt.useEffect(()=>{wa(y._container,i.style)},[i.style]),null});Qx.displayName="GeolocateControl";pt.memo(Qx);function KS(i){const s=Lc(({mapLib:u})=>new u.NavigationControl(i),{position:i.position});return pt.useEffect(()=>{wa(s._container,i.style)},[i.style]),null}const YS=pt.memo(KS),QS={unit:"metric",maxWidth:100};function Jx(i){const s=Lc(({mapLib:u})=>new u.ScaleControl(i),{position:i.position});return(s.options.unit!==i.unit||s.options.maxWidth!==i.maxWidth)&&(s.options.maxWidth=i.maxWidth,s.setUnit(i.unit)),pt.useEffect(()=>{wa(s._container,i.style)},[i.style]),null}Jx.defaultProps=QS;pt.memo(Jx);var e1={exports:{}};(function(i,s){(function(u,y){i.exports=y()})(rd,function(){var u,y,_;function S(l,N){if(!u)u=N;else if(!y)y=N;else{var R="var sharedChunk = {}; ("+u+")(sharedChunk); ("+y+")(sharedChunk);",re={};u(re),_=N(re),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([R],{type:"text/javascript"})))}}S(["exports"],function(l){function N(n,e,r,a){return new(r||(r=Promise))(function(h,f){function g(k){try{b(a.next(k))}catch(E){f(E)}}function v(k){try{b(a.throw(k))}catch(E){f(E)}}function b(k){var E;k.done?h(k.value):(E=k.value,E instanceof r?E:new r(function(z){z(E)})).then(g,v)}b((a=a.apply(n,e||[])).next())})}function R(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}typeof SuppressedError=="function"&&SuppressedError;var re=de;function de(n,e){this.x=n,this.y=e}de.prototype={clone:function(){return new de(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,r=n.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),r=Math.sin(n),a=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=a,this},_rotateAround:function(n,e){var r=Math.cos(n),a=Math.sin(n),h=e.y+a*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},de.convert=function(n){return n instanceof de?n:Array.isArray(n)?new de(n[0],n[1]):n};var te=R(re),Pe=ke;function ke(n,e,r,a){this.cx=3*n,this.bx=3*(r-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=r,this.p2y=a}ke.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var r=n,a=0;a<8;a++){var h=this.sampleCurveX(r)-n;if(Math.abs(h)<e)return r;var f=this.sampleCurveDerivativeX(r);if(Math.abs(f)<1e-6)break;r-=h/f}var g=0,v=1;for(r=n,a=0;a<20&&(h=this.sampleCurveX(r),!(Math.abs(h-n)<e));a++)n>h?g=r:v=r,r=.5*(v-g)+g;return r},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Me=R(Pe);let ut,ee;function Y(){return ut==null&&(ut=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ut}function se(){if(ee==null&&(ee=!1,Y())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let a=0;a<5*5;a++){const h=4*a;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(a%5,Math.floor(a/5),1,1)}const r=e.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&r[a]!==a){ee=!0;break}}}return ee||!1}function ve(n,e,r,a){const h=new Me(n,e,r,a);return function(f){return h.solve(f)}}const Fe=ve(.25,.1,.25,1);function Oe(n,e,r){return Math.min(r,Math.max(e,n))}function Ge(n,e,r){const a=r-e,h=((n-e)%a+a)%a+e;return h===e?r:h}function Be(n,...e){for(const r of e)for(const a in r)n[a]=r[a];return n}let Et=1;function tt(n,e,r){const a={};for(const h in n)a[h]=e.call(r||this,n[h],h,n);return a}function Ot(n,e,r){const a={};for(const h in n)e.call(r||this,n[h],h,n)&&(a[h]=n[h]);return a}function ui(n){return Array.isArray(n)?n.map(ui):typeof n=="object"&&n?tt(n,ui):n}const $i={};function Di(n){$i[n]||(typeof console<"u"&&console.warn(n),$i[n]=!0)}function Ji(n,e,r){return(r.y-n.y)*(e.x-n.x)>(e.y-n.y)*(r.x-n.x)}function kn(n){let e=0;for(let r,a,h=0,f=n.length,g=f-1;h<f;g=h++)r=n[h],a=n[g],e+=(a.x-r.x)*(r.y+a.y);return e}function qi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let He=null;function dt(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function $t(n,e,r,a,h){return N(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const f=new VideoFrame(n,{timestamp:0});try{const g=f==null?void 0:f.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),b=new Uint8ClampedArray(a*h*4);if(yield f.copyTo(b,function(k,E,z,L,B){const O=4*Math.max(-E,0),j=(Math.max(0,z)-z)*L*4+O,W=4*L,Q=Math.max(0,E),ue=Math.max(0,z);return{rect:{x:Q,y:ue,width:Math.min(k.width,E+L)-Q,height:Math.min(k.height,z+B)-ue},layout:[{offset:j,stride:W}]}}(n,e,r,a,h)),v)for(let k=0;k<b.length;k+=4){const E=b[k];b[k]=b[k+2],b[k+2]=E}return b}finally{f.close()}})}let Nt,Dt,ci,tr;const hn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(n){const e=requestAnimationFrame(n);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(n,e=0){return this.getImageCanvasContext(n).getImageData(-e,-e,n.width+2*e,n.height+2*e)},getImageCanvasContext(n){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=n.width,e.height=n.height,r.drawImage(n,0,0,n.width,n.height),r},resolveURL:n=>(ci||(ci=document.createElement("a")),ci.href=n,ci.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(tr==null&&(tr=matchMedia("(prefers-reduced-motion: reduce)")),tr.matches)}},ir={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Qr extends Error{constructor(e,r,a,h){super(`AJAXError: ${r} (${e}): ${a}`),this.status=e,this.statusText=r,this.url=a,this.body=h}}const nr=qi()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Vn=n=>ir.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))];function Oo(n,e){const r=new AbortController,a=new Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,cache:n.cache,referrer:nr(),signal:r.signal});let h=!1,f=!1;return n.type==="json"&&a.headers.set("Accept","application/json"),f||fetch(a).then(g=>g.ok?(v=>{(n.type==="arrayBuffer"||n.type==="image"?v.arrayBuffer():n.type==="json"?v.json():v.text()).then(b=>{f||(h=!0,e(null,b,v.headers.get("Cache-Control"),v.headers.get("Expires")))}).catch(b=>{f||e(new Error(b.message))})})(g):g.blob().then(v=>e(new Qr(g.status,g.statusText,n.url,v)))).catch(g=>{g.code!==20&&e(new Error(g.message))}),{cancel:()=>{f=!0,h||r.abort()}}}const Jr=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){if(qi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e);if(!qi())return(Vn(n.url)||Oo)(n,e)}if(!(/^file:/.test(r=n.url)||/^file:/.test(nr())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Oo(n,e);if(qi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var r;return function(a,h){const f=new XMLHttpRequest;f.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(f.responseType="arraybuffer");for(const g in a.headers)f.setRequestHeader(g,a.headers[g]);return a.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=a.credentials==="include",f.onerror=()=>{h(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let g=f.response;if(a.type==="json")try{g=JSON.parse(f.response)}catch(v){return h(v)}h(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else{const g=new Blob([f.response],{type:f.getResponseHeader("Content-Type")});h(new Qr(f.status,f.statusText,a.url,g))}},f.send(a.body),{cancel:()=>f.abort()}}(n,e)},No=function(n,e){return Jr(Be(n,{type:"arrayBuffer"}),e)};function zr(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),r=window.location;return e.protocol===r.protocol&&e.host===r.host}function Hs(n,e,r){r[n]&&r[n].indexOf(e)!==-1||(r[n]=r[n]||[],r[n].push(e))}function ys(n,e,r){if(r&&r[n]){const a=r[n].indexOf(e);a!==-1&&r[n].splice(a,1)}}class es{constructor(e,r={}){Be(this,r),this.type=e}}class ts extends es{constructor(e,r={}){super("error",Be({error:e},r))}}class _s{on(e,r){return this._listeners=this._listeners||{},Hs(e,r,this._listeners),this}off(e,r){return ys(e,r,this._listeners),ys(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Hs(e,r,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,r){typeof e=="string"&&(e=new es(e,r||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of f)ys(a,v,this._oneTimeListeners),v.call(this,e);const g=this._eventedParent;g&&(Be(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof ts&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const dn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Un(n,e){const r={};for(const a in n)a!=="ref"&&(r[a]=n[a]);return dn.forEach(a=>{a in e&&(r[a]=e[a])}),r}function jt(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!jt(n[r],e[r]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const r in n)if(!jt(n[r],e[r]))return!1;return!0}return n===e}const It={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function fr(n,e,r){r.push({command:It.addSource,args:[n,e[n]]})}function Ws(n,e,r){e.push({command:It.removeSource,args:[n]}),r[n]=!0}function Ar(n,e,r,a){Ws(n,r,a),fr(n,e,r)}function ba(n,e,r){let a;for(a in n[r])if(Object.prototype.hasOwnProperty.call(n[r],a)&&a!=="data"&&!jt(n[r][a],e[r][a]))return!1;for(a in e[r])if(Object.prototype.hasOwnProperty.call(e[r],a)&&a!=="data"&&!jt(n[r][a],e[r][a]))return!1;return!0}function Xs(n,e,r,a,h,f){let g;for(g in e=e||{},n=n||{})Object.prototype.hasOwnProperty.call(n,g)&&(jt(n[g],e[g])||r.push({command:f,args:[a,g,e[g],h]}));for(g in e)Object.prototype.hasOwnProperty.call(e,g)&&!Object.prototype.hasOwnProperty.call(n,g)&&(jt(n[g],e[g])||r.push({command:f,args:[a,g,e[g],h]}))}function is(n){return n.id}function vs(n,e){return n[e.id]=e,n}class Ae{constructor(e,r,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function mr(n,...e){for(const r of e)for(const a in r)n[a]=r[a];return n}class ni extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class xs{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[a,h]of r)this.bindings[a]=h}concat(e){return new xs(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Lr={kind:"null"},Re={kind:"number"},gt={kind:"string"},ct={kind:"boolean"},en={kind:"color"},gr={kind:"object"},ft={kind:"value"},Dr={kind:"collator"},Z={kind:"formatted"},A={kind:"padding"},D={kind:"resolvedImage"},V={kind:"variableAnchorOffsetCollection"};function H(n,e){return{kind:"array",itemType:n,N:e}}function X(n){if(n.kind==="array"){const e=X(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const ce=[Lr,Re,gt,ct,en,Z,gr,H(ft),A,D,V];function ne(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ne(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const r of ce)if(!ne(r,e))return null}}return`Expected ${X(n)} but found ${X(e)} instead.`}function J(n,e){return e.some(r=>r.kind===n.kind)}function le(n,e){return e.some(r=>r==="null"?n===null:r==="array"?Array.isArray(n):r==="object"?n&&!Array.isArray(n)&&typeof n=="object":r===typeof n)}function _e(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const xe=.96422,Se=.82521,it=4/29,lt=6/29,We=3*lt*lt,rt=lt*lt*lt,ht=Math.PI/180,Lt=180/Math.PI;function Vt(n){return(n%=360)<0&&(n+=360),n}function Ct([n,e,r,a]){let h,f;const g=Zi((.2225045*(n=kt(n))+.7168786*(e=kt(e))+.0606169*(r=kt(r)))/1);n===e&&e===r?h=f=g:(h=Zi((.4360747*n+.3850649*e+.1430804*r)/xe),f=Zi((.0139322*n+.0971045*e+.7141733*r)/Se));const v=116*g-16;return[v<0?0:v,500*(h-g),200*(g-f),a]}function kt(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Zi(n){return n>rt?Math.pow(n,1/3):n/We+it}function qt([n,e,r,a]){let h=(n+16)/116,f=isNaN(e)?h:h+e/500,g=isNaN(r)?h:h-r/200;return h=1*Fi(h),f=xe*Fi(f),g=Se*Fi(g),[wi(3.1338561*f-1.6168667*h-.4906146*g),wi(-.9787684*f+1.9161415*h+.033454*g),wi(.0719453*f-.2289914*h+1.4052427*g),a]}function wi(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Fi(n){return n>lt?n*n*n:We*(n-it)}function jn(n){return parseInt(n.padEnd(2,n),16)/255}function Dc(n,e){return Ks(e?n/100:n,0,1)}function Ks(n,e,r){return Math.min(Math.max(e,n),r)}function Ys(n){return!n.some(Number.isNaN)}const sp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ft{constructor(e,r,a,h=1,f=!0){this.r=e,this.g=r,this.b=a,this.a=h,f||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,r,a,h]))}static parse(e){if(e instanceof Ft)return e;if(typeof e!="string")return;const r=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=sp[a];if(h){const[g,v,b]=h;return[g/255,v/255,b/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let v=1;return[jn(a.slice(v,v+=g)),jn(a.slice(v,v+=g)),jn(a.slice(v,v+=g)),jn(a.slice(v,v+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,b,k,E,z,L,B,O,j,W,Q,ue]=g,ie=[E||" ",B||" ",W].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const he=[k,L,j].join(""),fe=he==="%%%"?100:he===""?255:0;if(fe){const be=[Ks(+b/fe,0,1),Ks(+z/fe,0,1),Ks(+O/fe,0,1),Q?Dc(+Q,ue):1];if(Ys(be))return be}}return}}const f=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(f){const[g,v,b,k,E,z,L,B,O]=f,j=[b||" ",E||" ",L].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const W=[+v,Ks(+k,0,100),Ks(+z,0,100),B?Dc(+B,O):1];if(Ys(W))return function([Q,ue,ie,he]){function fe(be){const $e=(be+Q/30)%12,Ke=ue*Math.min(ie,1-ie);return ie-Ke*Math.max(-1,Math.min($e-3,9-$e,1))}return Q=Vt(Q),ue/=100,ie/=100,[fe(0),fe(8),fe(4),he]}(W)}}}(e);return r?new Ft(...r,!1):void 0}get rgb(){const{r:e,g:r,b:a,a:h}=this,f=h||1/0;return this.overwriteGetter("rgb",[e/f,r/f,a/f,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[r,a,h,f]=Ct(e),g=Math.sqrt(a*a+h*h);return[Math.round(1e4*g)?Vt(Math.atan2(h,a)*Lt):NaN,g,r,f]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ct(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){const[e,r,a,h]=this.rgb;return`rgba(${[e,r,a].map(f=>Math.round(255*f)).join(",")},${h})`}}Ft.black=new Ft(0,0,0,1),Ft.white=new Ft(1,1,1,1),Ft.transparent=new Ft(0,0,0,0),Ft.red=new Ft(1,0,0,1);class Ol{constructor(e,r,a){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Sa{constructor(e,r,a,h,f){this.text=e,this.image=r,this.scale=a,this.fontStack=h,this.textColor=f}}class Gi{constructor(e){this.sections=e}static fromString(e){return new Gi([new Sa(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Gi?e:Gi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Cn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Cn)return e;if(typeof e=="number")return new Cn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Cn(e)}}toString(){return JSON.stringify(this.values)}}const op=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class $n{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof $n)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let r=0;r<e.length;r+=2){const a=e[r],h=e[r+1];if(typeof a!="string"||!op.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new $n(e)}}toString(){return JSON.stringify(this.values)}}class Bi{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Bi({name:e,available:!1}):null}}function Ta(n,e,r,a){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[n,e,r,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[n,e,r,a]:[n,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qs(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Ft||n instanceof Ol||n instanceof Gi||n instanceof Cn||n instanceof $n||n instanceof Bi)return!0;if(Array.isArray(n)){for(const e of n)if(!Qs(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Qs(n[e]))return!1;return!0}return!1}function Qt(n){if(n===null)return Lr;if(typeof n=="string")return gt;if(typeof n=="boolean")return ct;if(typeof n=="number")return Re;if(n instanceof Ft)return en;if(n instanceof Ol)return Dr;if(n instanceof Gi)return Z;if(n instanceof Cn)return A;if(n instanceof $n)return V;if(n instanceof Bi)return D;if(Array.isArray(n)){const e=n.length;let r;for(const a of n){const h=Qt(a);if(r){if(r===h)continue;r=ft;break}r=h}return H(r||ft,e)}return gr}function Mt(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Ft||n instanceof Gi||n instanceof Cn||n instanceof $n||n instanceof Bi?n.toString():JSON.stringify(n)}class ws{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Qs(e[1]))return r.error("invalid value");const a=e[1];let h=Qt(a);const f=r.expectedType;return h.kind!=="array"||h.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(h=f),new ws(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ri{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ka={string:gt,number:Re,boolean:ct,object:gr};class qn{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let a,h=1;const f=e[0];if(f==="array"){let v,b;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in ka)||k==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=ka[k],h++}else v=ft;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);b=e[2],h++}a=H(v,b)}else{if(!ka[f])throw new Error(`Types doesn't contain name = ${f}`);a=ka[f]}const g=[];for(;h<e.length;h++){const v=r.parse(e[h],h,ft);if(!v)return null;g.push(v)}return new qn(a,g)}evaluate(e){for(let r=0;r<this.args.length;r++){const a=this.args[r].evaluate(e);if(!ne(this.type,Qt(a)))return a;if(r===this.args.length-1)throw new ri(`Expected value to be of type ${X(this.type)}, but found ${X(Qt(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Nl={"to-boolean":ct,"to-color":en,"to-number":Re,"to-string":gt};class ns{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[0];if(!Nl[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return r.error("Expected one argument.");const h=Nl[a],f=[];for(let g=1;g<e.length;g++){const v=r.parse(e[g],g,ft);if(!v)return null;f.push(v)}return new ns(h,f)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,a;for(const h of this.args){if(r=h.evaluate(e),a=null,r instanceof Ft)return r;if(typeof r=="string"){const f=e.parseColor(r);if(f)return f}else if(Array.isArray(r)&&(a=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ta(r[0],r[1],r[2],r[3]),!a))return new Ft(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ri(a||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const a of this.args){r=a.evaluate(e);const h=Cn.parse(r);if(h)return h}throw new ri(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const a of this.args){r=a.evaluate(e);const h=$n.parse(r);if(h)return h}throw new ri(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const a of this.args){if(r=a.evaluate(e),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new ri(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Gi.fromString(Mt(this.args[0].evaluate(e)));case"resolvedImage":return Bi.fromString(Mt(this.args[0].evaluate(e)));default:return Mt(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Rc=["Unknown","Point","LineString","Polygon"];class Vl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Ft.parse(e)),r}}class Ca{constructor(e,r,a=[],h,f=new xs,g=[]){this.registry=e,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=f,this.errors=g,this.expectedType=h,this._isConstant=r}parse(e,r,a,h,f={}){return r?this.concat(r,a,h)._parse(e,f):this._parse(e,f)}_parse(e,r){function a(h,f,g){return g==="assert"?new qn(f,[h]):g==="coerce"?new ns(f,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[h];if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,b=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(v.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||b.kind!=="value"&&b.kind!=="array"){if(this.checkSubtype(v,b))return null}else g=a(g,v,r.typeAnnotation||"coerce");else g=a(g,v,r.typeAnnotation||"coerce");else g=a(g,v,r.typeAnnotation||"coerce");else g=a(g,v,r.typeAnnotation||"assert")}if(!(g instanceof ws)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new Vl;try{g=new ws(g.type,g.evaluate(v))}catch(b){return this.error(b.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,a){const h=typeof e=="number"?this.path.concat(e):this.path,f=a?this.scope.concat(a):this.scope;return new Ca(this.registry,this._isConstant,h,r||null,f,this.errors)}error(e,...r){const a=`${this.key}${r.map(h=>`[${h}]`).join("")}`;this.errors.push(new ni(a,e))}checkSubtype(e,r){const a=ne(e,r);return a&&this.error(a),a}}class Ea{constructor(e,r,a){this.type=Dr,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");const h=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,ct);if(!h)return null;const f=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,ct);if(!f)return null;let g=null;return a.locale&&(g=r.parse(a.locale,1,gt),!g)?null:new Ea(h,f,g)}evaluate(e){return new Ol(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const rs=8192;function Ul(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Vo(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Fc(n,e){const r=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(r*h*rs),Math.round(a*h*rs)]}function ap(n,e,r){const a=n[0]-e[0],h=n[1]-e[1],f=n[0]-r[0],g=n[1]-r[1];return a*g-f*h==0&&a*f<=0&&h*g<=0}function jl(n,e){let r=!1;for(let g=0,v=e.length;g<v;g++){const b=e[g];for(let k=0,E=b.length;k<E-1;k++){if(ap(n,b[k],b[k+1]))return!1;(h=b[k])[1]>(a=n)[1]!=(f=b[k+1])[1]>a[1]&&a[0]<(f[0]-h[0])*(a[1]-h[1])/(f[1]-h[1])+h[0]&&(r=!r)}}var a,h,f;return r}function $l(n,e){for(let r=0;r<e.length;r++)if(jl(n,e[r]))return!0;return!1}function Bc(n,e,r,a){const h=a[0]-r[0],f=a[1]-r[1],g=(n[0]-r[0])*f-h*(n[1]-r[1]),v=(e[0]-r[0])*f-h*(e[1]-r[1]);return g>0&&v<0||g<0&&v>0}function lp(n,e,r){for(const k of r)for(let E=0;E<k.length-1;++E)if((v=[(g=k[E+1])[0]-(f=k[E])[0],g[1]-f[1]])[0]*(b=[(h=e)[0]-(a=n)[0],h[1]-a[1]])[1]-v[1]*b[0]!=0&&Bc(a,h,f,g)&&Bc(f,g,a,h))return!0;var a,h,f,g,v,b;return!1}function Oc(n,e){for(let r=0;r<n.length;++r)if(!jl(n[r],e))return!1;for(let r=0;r<n.length-1;++r)if(lp(n[r],n[r+1],e))return!1;return!0}function Nc(n,e){for(let r=0;r<e.length;r++)if(Oc(n,e[r]))return!0;return!1}function Ia(n,e,r){const a=[];for(let h=0;h<n.length;h++){const f=[];for(let g=0;g<n[h].length;g++){const v=Fc(n[h][g],r);Ul(e,v),f.push(v)}a.push(f)}return a}function Vc(n,e,r){const a=[];for(let h=0;h<n.length;h++){const f=Ia(n[h],e,r);a.push(f)}return a}function Uc(n,e,r,a){if(n[0]<r[0]||n[0]>r[2]){const h=.5*a;let f=n[0]-r[0]>h?-a:r[0]-n[0]>h?a:0;f===0&&(f=n[0]-r[2]>h?-a:r[2]-n[0]>h?a:0),n[0]+=f}Ul(e,n)}function ql(n,e,r,a){const h=Math.pow(2,a.z)*rs,f=[a.x*rs,a.y*rs],g=[];for(const v of n)for(const b of v){const k=[b.x+f[0],b.y+f[1]];Uc(k,e,r,h),g.push(k)}return g}function Zl(n,e,r,a){const h=Math.pow(2,a.z)*rs,f=[a.x*rs,a.y*rs],g=[];for(const b of n){const k=[];for(const E of b){const z=[E.x+f[0],E.y+f[1]];Ul(e,z),k.push(z)}g.push(k)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of g)for(const k of b)Uc(k,e,r,h)}var v;return g}class bs{constructor(e,r){this.type=ct,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Qs(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let h=0;h<a.features.length;++h){const f=a.features[h].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new bs(a,a.features[h].geometry)}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new bs(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new bs(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const v=Ia(a.coordinates,f,g),b=ql(r.geometry(),h,f,g);if(!Vo(h,f))return!1;for(const k of b)if(!jl(k,v))return!1}if(a.type==="MultiPolygon"){const v=Vc(a.coordinates,f,g),b=ql(r.geometry(),h,f,g);if(!Vo(h,f))return!1;for(const k of b)if(!$l(k,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,a){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const v=Ia(a.coordinates,f,g),b=Zl(r.geometry(),h,f,g);if(!Vo(h,f))return!1;for(const k of b)if(!Oc(k,v))return!1}if(a.type==="MultiPolygon"){const v=Vc(a.coordinates,f,g),b=Zl(r.geometry(),h,f,g);if(!Vo(h,f))return!1;for(const k of b)if(!Nc(k,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Pa{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const a=e[1];return r.scope.has(a)?new Pa(a,r.scope.get(a)):r.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Zn{constructor(e,r,a,h){this.name=e,this.type=r,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const a=e[0],h=Zn.definitions[a];if(!h)return r.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=g.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let b=null;for(const[k,E]of v){b=new Ca(r.registry,Ma,r.path,null,r.scope);const z=[];let L=!1;for(let B=1;B<e.length;B++){const O=e[B],j=Array.isArray(k)?k[B-1]:k.type,W=b.parse(O,1+z.length,j);if(!W){L=!0;break}z.push(W)}if(!L)if(Array.isArray(k)&&k.length!==z.length)b.error(`Expected ${k.length} arguments, but found ${z.length} instead.`);else{for(let B=0;B<z.length;B++){const O=Array.isArray(k)?k[B]:k.type,j=z[B];b.concat(B+1).checkSubtype(O,j.type)}if(b.errors.length===0)return new Zn(a,f,E,z)}}if(v.length===1)r.errors.push(...b.errors);else{const k=(v.length?v:g).map(([z])=>{return L=z,Array.isArray(L)?`(${L.map(X).join(", ")})`:`(${X(L.type)}...)`;var L}).join(" | "),E=[];for(let z=1;z<e.length;z++){const L=r.parse(e[z],1+E.length);if(!L)return null;E.push(X(L.type))}r.error(`Expected arguments of type ${k}, but found (${E.join(", ")}) instead.`)}return null}static register(e,r){Zn.definitions=r;for(const a in r)e[a]=Zn}}function Ma(n){if(n instanceof Pa)return Ma(n.boundExpression);if(n instanceof Zn&&n.name==="error"||n instanceof Ea||n instanceof bs)return!1;const e=n instanceof ns||n instanceof qn;let r=!0;return n.eachChild(a=>{r=e?r&&Ma(a):r&&a instanceof ws}),!!r&&za(n)&&Aa(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function za(n){if(n instanceof Zn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof bs)return!1;let e=!0;return n.eachChild(r=>{e&&!za(r)&&(e=!1)}),e}function Uo(n){if(n instanceof Zn&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(r=>{e&&!Uo(r)&&(e=!1)}),e}function Aa(n,e){if(n instanceof Zn&&e.indexOf(n.name)>=0)return!1;let r=!0;return n.eachChild(a=>{r&&!Aa(a,e)&&(r=!1)}),r}function Js(n,e){const r=n.length-1;let a,h,f=0,g=r,v=0;for(;f<=g;)if(v=Math.floor((f+g)/2),a=n[v],h=n[v+1],a<=e){if(v===r||e<h)return v;f=v+1}else{if(!(a>e))throw new ri("Input is not a number.");g=v-1}return 0}class ss{constructor(e,r,a){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[h,f]of a)this.labels.push(h),this.outputs.push(f)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const a=r.parse(e[1],1,Re);if(!a)return null;const h=[];let f=null;r.expectedType&&r.expectedType.kind!=="value"&&(f=r.expectedType);for(let g=1;g<e.length;g+=2){const v=g===1?-1/0:e[g],b=e[g+1],k=g,E=g+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const z=r.parse(b,E,f);if(!z)return null;f=f||z.type,h.push([v,z])}return new ss(f,a,h)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const f=r.length;return h>=r[f-1]?a[f-1].evaluate(e):a[Js(r,h)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function St(n,e,r){return n+r*(e-n)}function La(n,e,r){return n.map((a,h)=>St(a,e[h],r))}const En={number:St,color:function(n,e,r,a="rgb"){switch(a){case"rgb":{const[h,f,g,v]=La(n.rgb,e.rgb,r);return new Ft(h,f,g,v,!1)}case"hcl":{const[h,f,g,v]=n.hcl,[b,k,E,z]=e.hcl;let L,B;if(isNaN(h)||isNaN(b))isNaN(h)?isNaN(b)?L=NaN:(L=b,g!==1&&g!==0||(B=k)):(L=h,E!==1&&E!==0||(B=f));else{let ue=b-h;b>h&&ue>180?ue-=360:b<h&&h-b>180&&(ue+=360),L=h+r*ue}const[O,j,W,Q]=function([ue,ie,he,fe]){return ue=isNaN(ue)?0:ue*ht,qt([he,Math.cos(ue)*ie,Math.sin(ue)*ie,fe])}([L,B??St(f,k,r),St(g,E,r),St(v,z,r)]);return new Ft(O,j,W,Q,!1)}case"lab":{const[h,f,g,v]=qt(La(n.lab,e.lab,r));return new Ft(h,f,g,v,!1)}}},array:La,padding:function(n,e,r){return new Cn(La(n.values,e.values,r))},variableAnchorOffsetCollection:function(n,e,r){const a=n.values,h=e.values;if(a.length!==h.length)throw new ri(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${e.toString()}`);const f=[];for(let g=0;g<a.length;g+=2){if(a[g]!==h[g])throw new ri(`Cannot interpolate values containing mismatched anchors. from[${g}]: ${a[g]}, to[${g}]: ${h[g]}`);f.push(a[g]);const[v,b]=a[g+1],[k,E]=h[g+1];f.push([St(v,k,r),St(b,E,r)])}return new $n(f)}};class In{constructor(e,r,a,h,f){this.type=e,this.operator=r,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[g,v]of f)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(e,r,a,h){let f=0;if(e.name==="exponential")f=Gl(r,e.base,a,h);else if(e.name==="linear")f=Gl(r,1,a,h);else if(e.name==="cubic-bezier"){const g=e.controlPoints;f=new Me(g[0],g[1],g[2],g[3]).solve(Gl(r,1,a,h))}return f}static parse(e,r){let[a,h,f,...g]=e;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(E=>typeof E!="number"||E<0||E>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(f=r.parse(f,2,Re),!f)return null;const v=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=en:r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let k=0;k<g.length;k+=2){const E=g[k],z=g[k+1],L=k+3,B=k+4;if(typeof E!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=E)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const O=r.parse(z,B,b);if(!O)return null;b=b||O.type,v.push([E,O])}return _e(b,Re)||_e(b,en)||_e(b,A)||_e(b,V)||_e(b,H(Re))?new In(b,a,h,f,v):r.error(`Type ${X(b)} is not interpolatable.`)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);const f=r.length;if(h>=r[f-1])return a[f-1].evaluate(e);const g=Js(r,h),v=In.interpolationFactor(this.interpolation,h,r[g],r[g+1]),b=a[g].evaluate(e),k=a[g+1].evaluate(e);switch(this.operator){case"interpolate":return En[this.type.kind](b,k,v);case"interpolate-hcl":return En.color(b,k,v,"hcl");case"interpolate-lab":return En.color(b,k,v,"lab")}}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Gl(n,e,r,a){const h=a-r,f=n-r;return h===0?0:e===1?f/h:(Math.pow(e,f)-1)/(Math.pow(e,h)-1)}class Da{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let a=null;const h=r.expectedType;h&&h.kind!=="value"&&(a=h);const f=[];for(const v of e.slice(1)){const b=r.parse(v,1+f.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,f.push(b)}if(!a)throw new Error("No output type");const g=h&&f.some(v=>ne(h,v.type));return new Da(g?ft:a,f)}evaluate(e){let r,a=null,h=0;for(const f of this.args)if(h++,a=f.evaluate(e),a&&a instanceof Bi&&!a.available&&(r||(r=a.name),a=null,h===this.args.length&&(a=r)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Ra{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let f=1;f<e.length-1;f+=2){const g=e[f];if(typeof g!="string")return r.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=r.parse(e[f+1],f+1);if(!v)return null;a.push([g,v])}const h=r.parse(e[e.length-1],e.length-1,r.expectedType,a);return h?new Ra(a,h):null}outputDefined(){return this.result.outputDefined()}}class Hl{constructor(e,r,a){this.type=e,this.index=r,this.input=a}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Re),h=r.parse(e[2],2,H(r.expectedType||ft));return a&&h?new Hl(h.type.itemType,a,h):null}evaluate(e){const r=this.index.evaluate(e),a=this.input.evaluate(e);if(r<0)throw new ri(`Array index out of bounds: ${r} < 0.`);if(r>=a.length)throw new ri(`Array index out of bounds: ${r} > ${a.length-1}.`);if(r!==Math.floor(r))throw new ri(`Array index must be an integer, but found ${r} instead.`);return a[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Wl{constructor(e,r){this.type=ct,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,ft),h=r.parse(e[2],2,ft);return a&&h?J(a.type,[ct,gt,Re,Lr,ft])?new Wl(a,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(a.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!le(r,["boolean","string","number","null"]))throw new ri(`Expected first argument to be of type boolean, string, number or null, but found ${X(Qt(r))} instead.`);if(!le(a,["string","array"]))throw new ri(`Expected second argument to be of type array or string, but found ${X(Qt(a))} instead.`);return a.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Fa{constructor(e,r,a){this.type=Re,this.needle=e,this.haystack=r,this.fromIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,ft),h=r.parse(e[2],2,ft);if(!a||!h)return null;if(!J(a.type,[ct,gt,Re,Lr,ft]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(a.type)} instead`);if(e.length===4){const f=r.parse(e[3],3,Re);return f?new Fa(a,h,f):null}return new Fa(a,h)}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!le(r,["boolean","string","number","null"]))throw new ri(`Expected first argument to be of type boolean, string, number or null, but found ${X(Qt(r))} instead.`);if(!le(a,["string","array"]))throw new ri(`Expected second argument to be of type array or string, but found ${X(Qt(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(r,h)}return a.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Xl{constructor(e,r,a,h,f,g){this.inputType=e,this.type=r,this.input=a,this.cases=h,this.outputs=f,this.otherwise=g}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let a,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const f={},g=[];for(let k=2;k<e.length-1;k+=2){let E=e[k];const z=e[k+1];Array.isArray(E)||(E=[E]);const L=r.concat(k);if(E.length===0)return L.error("Expected at least one branch label.");for(const O of E){if(typeof O!="number"&&typeof O!="string")return L.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,Qt(O)))return null}else a=Qt(O);if(f[String(O)]!==void 0)return L.error("Branch labels must be unique.");f[String(O)]=g.length}const B=r.parse(z,k,h);if(!B)return null;h=h||B.type,g.push(B)}const v=r.parse(e[1],1,ft);if(!v)return null;const b=r.parse(e[e.length-1],e.length-1,h);return b?v.type.kind!=="value"&&r.concat(1).checkSubtype(a,v.type)?null:new Xl(a,h,v,f,g,b):null}evaluate(e){const r=this.input.evaluate(e);return(Qt(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Kl{constructor(e,r,a){this.type=e,this.branches=r,this.otherwise=a}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const h=[];for(let g=1;g<e.length-1;g+=2){const v=r.parse(e[g],g,ct);if(!v)return null;const b=r.parse(e[g+1],g+1,a);if(!b)return null;h.push([v,b]),a=a||b.type}const f=r.parse(e[e.length-1],e.length-1,a);if(!f)return null;if(!a)throw new Error("Can't infer output type");return new Kl(a,h,f)}evaluate(e){for(const[r,a]of this.branches)if(r.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,a]of this.branches)e(r),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ba{constructor(e,r,a,h){this.type=e,this.input=r,this.beginIndex=a,this.endIndex=h}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,ft),h=r.parse(e[2],2,Re);if(!a||!h)return null;if(!J(a.type,[H(ft),gt,ft]))return r.error(`Expected first argument to be of type array or string, but found ${X(a.type)} instead`);if(e.length===4){const f=r.parse(e[3],3,Re);return f?new Ba(a.type,a,h,f):null}return new Ba(a.type,a,h)}evaluate(e){const r=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!le(r,["string","array"]))throw new ri(`Expected first argument to be of type array or string, but found ${X(Qt(r))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return r.slice(a,h)}return r.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function jc(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function $c(n,e,r,a){return a.compare(e,r)===0}function eo(n,e,r){const a=n!=="=="&&n!=="!=";return class t1{constructor(f,g,v){this.type=ct,this.lhs=f,this.rhs=g,this.collator=v,this.hasUntypedArgument=f.type.kind==="value"||g.type.kind==="value"}static parse(f,g){if(f.length!==3&&f.length!==4)return g.error("Expected two or three arguments.");const v=f[0];let b=g.parse(f[1],1,ft);if(!b)return null;if(!jc(v,b.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${X(b.type)}'.`);let k=g.parse(f[2],2,ft);if(!k)return null;if(!jc(v,k.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${X(k.type)}'.`);if(b.type.kind!==k.type.kind&&b.type.kind!=="value"&&k.type.kind!=="value")return g.error(`Cannot compare types '${X(b.type)}' and '${X(k.type)}'.`);a&&(b.type.kind==="value"&&k.type.kind!=="value"?b=new qn(k.type,[b]):b.type.kind!=="value"&&k.type.kind==="value"&&(k=new qn(b.type,[k])));let E=null;if(f.length===4){if(b.type.kind!=="string"&&k.type.kind!=="string"&&b.type.kind!=="value"&&k.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(E=g.parse(f[3],3,Dr),!E)return null}return new t1(b,k,E)}evaluate(f){const g=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(a&&this.hasUntypedArgument){const b=Qt(g),k=Qt(v);if(b.kind!==k.kind||b.kind!=="string"&&b.kind!=="number")throw new ri(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${b.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=Qt(g),k=Qt(v);if(b.kind!=="string"||k.kind!=="string")return e(f,g,v)}return this.collator?r(f,g,v,this.collator.evaluate(f)):e(f,g,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}}}const up=eo("==",function(n,e,r){return e===r},$c),cp=eo("!=",function(n,e,r){return e!==r},function(n,e,r,a){return!$c(0,e,r,a)}),hp=eo("<",function(n,e,r){return e<r},function(n,e,r,a){return a.compare(e,r)<0}),dp=eo(">",function(n,e,r){return e>r},function(n,e,r,a){return a.compare(e,r)>0}),pp=eo("<=",function(n,e,r){return e<=r},function(n,e,r,a){return a.compare(e,r)<=0}),fp=eo(">=",function(n,e,r){return e>=r},function(n,e,r,a){return a.compare(e,r)>=0});class Yl{constructor(e,r,a,h,f){this.type=gt,this.number=e,this.locale=r,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=f}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const a=r.parse(e[1],1,Re);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let f=null;if(h.locale&&(f=r.parse(h.locale,1,gt),!f))return null;let g=null;if(h.currency&&(g=r.parse(h.currency,1,gt),!g))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,Re),!v))return null;let b=null;return h["max-fraction-digits"]&&(b=r.parse(h["max-fraction-digits"],1,Re),!b)?null:new Yl(a,f,g,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Oa{constructor(e){this.type=Z,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");const h=[];let f=!1;for(let g=1;g<=e.length-1;++g){const v=e[g];if(f&&typeof v=="object"&&!Array.isArray(v)){f=!1;let b=null;if(v["font-scale"]&&(b=r.parse(v["font-scale"],1,Re),!b))return null;let k=null;if(v["text-font"]&&(k=r.parse(v["text-font"],1,H(gt)),!k))return null;let E=null;if(v["text-color"]&&(E=r.parse(v["text-color"],1,en),!E))return null;const z=h[h.length-1];z.scale=b,z.font=k,z.textColor=E}else{const b=r.parse(e[g],1,ft);if(!b)return null;const k=b.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,h.push({content:b,scale:null,font:null,textColor:null})}}return new Oa(h)}evaluate(e){return new Gi(this.sections.map(r=>{const a=r.content.evaluate(e);return Qt(a)===D?new Sa("",a,null,null,null):new Sa(Mt(a),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class Ql{constructor(e){this.type=D,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const a=r.parse(e[1],1,gt);return a?new Ql(a):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),a=Bi.fromString(r);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(r)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class Jl{constructor(e){this.type=Re,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=r.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${X(a.type)} instead.`):new Jl(a):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ri(`Expected value to be of type string or array, but found ${X(Qt(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const to={"==":up,"!=":cp,">":dp,"<":hp,">=":fp,"<=":pp,array:qn,at:Hl,boolean:qn,case:Kl,coalesce:Da,collator:Ea,format:Oa,image:Ql,in:Wl,"index-of":Fa,interpolate:In,"interpolate-hcl":In,"interpolate-lab":In,length:Jl,let:Ra,literal:ws,match:Xl,number:qn,"number-format":Yl,object:qn,slice:Ba,step:ss,string:qn,"to-boolean":ns,"to-color":ns,"to-number":ns,"to-string":ns,var:Pa,within:bs};function qc(n,[e,r,a,h]){e=e.evaluate(n),r=r.evaluate(n),a=a.evaluate(n);const f=h?h.evaluate(n):1,g=Ta(e,r,a,f);if(g)throw new ri(g);return new Ft(e/255,r/255,a/255,f,!1)}function Zc(n,e){return n in e}function eu(n,e){const r=e[n];return r===void 0?null:r}function Ss(n){return{type:n}}function Gc(n){return{result:"success",value:n}}function os(n){return{result:"error",value:n}}function io(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Hc(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function tu(n){return!!n.expression&&n.expression.interpolated}function zt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Jt(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function mp(n){return n}function Tt(n,e){const r=e.type==="color",a=n.stops&&typeof n.stops[0][0]=="object",h=a||!(a||n.property!==void 0),f=n.type||(tu(e)?"exponential":"interval");if(r||e.type==="padding"){const E=r?Ft.parse:Cn.parse;(n=mr({},n)).stops&&(n.stops=n.stops.map(z=>[z[0],E(z[1])])),n.default=E(n.default?n.default:e.default)}if(n.colorSpace&&(g=n.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var g;let v,b,k;if(f==="exponential")v=jo;else if(f==="interval")v=Kt;else if(f==="categorical"){v=ei,b=Object.create(null);for(const E of n.stops)b[E[0]]=E[1];k=typeof n.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);v=Wc}if(a){const E={},z=[];for(let O=0;O<n.stops.length;O++){const j=n.stops[O],W=j[0].zoom;E[W]===void 0&&(E[W]={zoom:W,type:n.type,property:n.property,default:n.default,stops:[]},z.push(W)),E[W].stops.push([j[0].value,j[1]])}const L=[];for(const O of z)L.push([E[O].zoom,Tt(E[O],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:In.interpolationFactor.bind(void 0,B),zoomStops:L.map(O=>O[0]),evaluate:({zoom:O},j)=>jo({stops:L,base:n.base},e,O).evaluate(O,j)}}if(h){const E=f==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:In.interpolationFactor.bind(void 0,E),zoomStops:n.stops.map(z=>z[0]),evaluate:({zoom:z})=>v(n,e,z,b,k)}}return{kind:"source",evaluate(E,z){const L=z&&z.properties?z.properties[n.property]:void 0;return L===void 0?Ts(n.default,e.default):v(n,e,L,b,k)}}}function Ts(n,e,r){return n!==void 0?n:e!==void 0?e:r!==void 0?r:void 0}function ei(n,e,r,a,h){return Ts(typeof r===h?a[r]:void 0,n.default,e.default)}function Kt(n,e,r){if(zt(r)!=="number")return Ts(n.default,e.default);const a=n.stops.length;if(a===1||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[a-1][0])return n.stops[a-1][1];const h=Js(n.stops.map(f=>f[0]),r);return n.stops[h][1]}function jo(n,e,r){const a=n.base!==void 0?n.base:1;if(zt(r)!=="number")return Ts(n.default,e.default);const h=n.stops.length;if(h===1||r<=n.stops[0][0])return n.stops[0][1];if(r>=n.stops[h-1][0])return n.stops[h-1][1];const f=Js(n.stops.map(E=>E[0]),r),g=function(E,z,L,B){const O=B-L,j=E-L;return O===0?0:z===1?j/O:(Math.pow(z,j)-1)/(Math.pow(z,O)-1)}(r,a,n.stops[f][0],n.stops[f+1][0]),v=n.stops[f][1],b=n.stops[f+1][1],k=En[e.type]||mp;return typeof v.evaluate=="function"?{evaluate(...E){const z=v.evaluate.apply(void 0,E),L=b.evaluate.apply(void 0,E);if(z!==void 0&&L!==void 0)return k(z,L,g,n.colorSpace)}}:k(v,b,g,n.colorSpace)}function Wc(n,e,r){switch(e.type){case"color":r=Ft.parse(r);break;case"formatted":r=Gi.fromString(r.toString());break;case"resolvedImage":r=Bi.fromString(r.toString());break;case"padding":r=Cn.parse(r);break;default:zt(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return Ts(r,n.default,e.default)}Zn.register(to,{error:[{kind:"error"},[gt],(n,[e])=>{throw new ri(e.evaluate(n))}],typeof:[gt,[ft],(n,[e])=>X(Qt(e.evaluate(n)))],"to-rgba":[H(Re,4),[en],(n,[e])=>{const[r,a,h,f]=e.evaluate(n).rgb;return[255*r,255*a,255*h,f]}],rgb:[en,[Re,Re,Re],qc],rgba:[en,[Re,Re,Re,Re],qc],has:{type:ct,overloads:[[[gt],(n,[e])=>Zc(e.evaluate(n),n.properties())],[[gt,gr],(n,[e,r])=>Zc(e.evaluate(n),r.evaluate(n))]]},get:{type:ft,overloads:[[[gt],(n,[e])=>eu(e.evaluate(n),n.properties())],[[gt,gr],(n,[e,r])=>eu(e.evaluate(n),r.evaluate(n))]]},"feature-state":[ft,[gt],(n,[e])=>eu(e.evaluate(n),n.featureState||{})],properties:[gr,[],n=>n.properties()],"geometry-type":[gt,[],n=>n.geometryType()],id:[ft,[],n=>n.id()],zoom:[Re,[],n=>n.globals.zoom],"heatmap-density":[Re,[],n=>n.globals.heatmapDensity||0],"line-progress":[Re,[],n=>n.globals.lineProgress||0],accumulated:[ft,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Re,Ss(Re),(n,e)=>{let r=0;for(const a of e)r+=a.evaluate(n);return r}],"*":[Re,Ss(Re),(n,e)=>{let r=1;for(const a of e)r*=a.evaluate(n);return r}],"-":{type:Re,overloads:[[[Re,Re],(n,[e,r])=>e.evaluate(n)-r.evaluate(n)],[[Re],(n,[e])=>-e.evaluate(n)]]},"/":[Re,[Re,Re],(n,[e,r])=>e.evaluate(n)/r.evaluate(n)],"%":[Re,[Re,Re],(n,[e,r])=>e.evaluate(n)%r.evaluate(n)],ln2:[Re,[],()=>Math.LN2],pi:[Re,[],()=>Math.PI],e:[Re,[],()=>Math.E],"^":[Re,[Re,Re],(n,[e,r])=>Math.pow(e.evaluate(n),r.evaluate(n))],sqrt:[Re,[Re],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Re,[Re],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Re,[Re],(n,[e])=>Math.log(e.evaluate(n))],log2:[Re,[Re],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Re,[Re],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Re,[Re],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Re,[Re],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Re,[Re],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Re,[Re],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Re,[Re],(n,[e])=>Math.atan(e.evaluate(n))],min:[Re,Ss(Re),(n,e)=>Math.min(...e.map(r=>r.evaluate(n)))],max:[Re,Ss(Re),(n,e)=>Math.max(...e.map(r=>r.evaluate(n)))],abs:[Re,[Re],(n,[e])=>Math.abs(e.evaluate(n))],round:[Re,[Re],(n,[e])=>{const r=e.evaluate(n);return r<0?-Math.round(-r):Math.round(r)}],floor:[Re,[Re],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Re,[Re],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[ct,[gt,ft],(n,[e,r])=>n.properties()[e.value]===r.value],"filter-id-==":[ct,[ft],(n,[e])=>n.id()===e.value],"filter-type-==":[ct,[gt],(n,[e])=>n.geometryType()===e.value],"filter-<":[ct,[gt,ft],(n,[e,r])=>{const a=n.properties()[e.value],h=r.value;return typeof a==typeof h&&a<h}],"filter-id-<":[ct,[ft],(n,[e])=>{const r=n.id(),a=e.value;return typeof r==typeof a&&r<a}],"filter->":[ct,[gt,ft],(n,[e,r])=>{const a=n.properties()[e.value],h=r.value;return typeof a==typeof h&&a>h}],"filter-id->":[ct,[ft],(n,[e])=>{const r=n.id(),a=e.value;return typeof r==typeof a&&r>a}],"filter-<=":[ct,[gt,ft],(n,[e,r])=>{const a=n.properties()[e.value],h=r.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[ct,[ft],(n,[e])=>{const r=n.id(),a=e.value;return typeof r==typeof a&&r<=a}],"filter->=":[ct,[gt,ft],(n,[e,r])=>{const a=n.properties()[e.value],h=r.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[ct,[ft],(n,[e])=>{const r=n.id(),a=e.value;return typeof r==typeof a&&r>=a}],"filter-has":[ct,[ft],(n,[e])=>e.value in n.properties()],"filter-has-id":[ct,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[ct,[H(gt)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[ct,[H(ft)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[ct,[gt,H(ft)],(n,[e,r])=>r.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[ct,[gt,H(ft)],(n,[e,r])=>function(a,h,f,g){for(;f<=g;){const v=f+g>>1;if(h[v]===a)return!0;h[v]>a?g=v-1:f=v+1}return!1}(n.properties()[e.value],r.value,0,r.value.length-1)],all:{type:ct,overloads:[[[ct,ct],(n,[e,r])=>e.evaluate(n)&&r.evaluate(n)],[Ss(ct),(n,e)=>{for(const r of e)if(!r.evaluate(n))return!1;return!0}]]},any:{type:ct,overloads:[[[ct,ct],(n,[e,r])=>e.evaluate(n)||r.evaluate(n)],[Ss(ct),(n,e)=>{for(const r of e)if(r.evaluate(n))return!0;return!1}]]},"!":[ct,[ct],(n,[e])=>!e.evaluate(n)],"is-supported-script":[ct,[gt],(n,[e])=>{const r=n.globals&&n.globals.isSupportedScript;return!r||r(e.evaluate(n))}],upcase:[gt,[gt],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[gt,[gt],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[gt,Ss(ft),(n,e)=>e.map(r=>Mt(r.evaluate(n))).join("")],"resolved-locale":[gt,[Dr],(n,[e])=>e.evaluate(n).resolvedLocale()]});class iu{constructor(e,r){var a;this.expression=e,this._warningHistory={},this._evaluator=new Vl,this._defaultValue=r?(a=r).type==="color"&&Jt(a.default)?new Ft(0,0,0,0):a.type==="color"?Ft.parse(a.default)||null:a.type==="padding"?Cn.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?$n.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,a,h,f,g){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(e,r,a,h,f,g){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new ri(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Na(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in to}function Va(n,e){const r=new Ca(to,Ma,[],e?function(h){const f={color:en,string:gt,number:Re,enum:gt,boolean:ct,formatted:Z,padding:A,resolvedImage:D,variableAnchorOffsetCollection:V};return h.type==="array"?H(f[h.value]||ft,h.length):f[h.type]}(e):void 0),a=r.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Gc(new iu(a,e)):os(r.errors)}class nu{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!Uo(r.expression)}evaluateWithoutErrorHandling(e,r,a,h,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,f,g)}evaluate(e,r,a,h,f,g){return this._styleExpression.evaluate(e,r,a,h,f,g)}}class Ua{constructor(e,r,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Uo(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,r,a,h,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,f,g)}evaluate(e,r,a,h,f,g){return this._styleExpression.evaluate(e,r,a,h,f,g)}interpolationFactor(e,r,a){return this.interpolationType?In.interpolationFactor(this.interpolationType,e,r,a):0}}function ru(n,e){const r=Va(n,e);if(r.result==="error")return r;const a=r.value.expression,h=za(a);if(!h&&!io(e))return os([new ni("","data expressions not supported")]);const f=Aa(a,["zoom"]);if(!f&&!Hc(e))return os([new ni("","zoom expressions not supported")]);const g=qo(a);return g||f?g instanceof ni?os([g]):g instanceof In&&!tu(e)?os([new ni("",'"interpolate" expressions cannot be used with this property')]):Gc(g?new Ua(h?"camera":"composite",r.value,g.labels,g instanceof In?g.interpolation:void 0):new nu(h?"constant":"source",r.value)):os([new ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $o{constructor(e,r){this._parameters=e,this._specification=r,mr(this,Tt(this._parameters,this._specification))}static deserialize(e){return new $o(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function qo(n){let e=null;if(n instanceof Ra)e=qo(n.result);else if(n instanceof Da){for(const r of n.args)if(e=qo(r),e)break}else(n instanceof ss||n instanceof In)&&n.input instanceof Zn&&n.input.name==="zoom"&&(e=n);return e instanceof ni||n.eachChild(r=>{const a=qo(r);a instanceof ni?e=a:!e&&a?e=new ni("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new ni("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Zo(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Zo(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const gp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function su(n){if(n==null)return{filter:()=>!0,needGeometry:!1};Zo(n)||(n=ja(n));const e=Va(n,gp);if(e.result==="error")throw new Error(e.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,a,h)=>e.value.evaluate(r,a,{},h),needGeometry:Xc(n)}}function yp(n,e){return n<e?-1:n>e?1:0}function Xc(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(Xc(n[e]))return!0;return!1}function ja(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?ou(n[1],n[2],"=="):e==="!="?Go(ou(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ou(n[1],n[2],e):e==="any"?(r=n.slice(1),["any"].concat(r.map(ja))):e==="all"?["all"].concat(n.slice(1).map(ja)):e==="none"?["all"].concat(n.slice(1).map(ja).map(Go)):e==="in"?Kc(n[1],n.slice(2)):e==="!in"?Go(Kc(n[1],n.slice(2))):e==="has"?Yc(n[1]):e==="!has"?Go(Yc(n[1])):e!=="within"||n;var r}function ou(n,e,r){switch(n){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,n,e]}}function Kc(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",n,["literal",e.sort(yp)]]:["filter-in-small",n,["literal",e]]}}function Yc(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Go(n){return["!",n]}function $a(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let h="[";for(const f of n)h+=`${$a(f)},`;return`${h}]`}const r=Object.keys(n).sort();let a="{";for(let h=0;h<r.length;h++)a+=`${JSON.stringify(r[h])}:${$a(n[r[h]])},`;return`${a}}`}function qa(n){let e="";for(const r of dn)e+=`/${$a(n[r])}`;return e}function Qc(n){const e=n.value;return e?[new Ae(n.key,e,"constants have been deprecated as of v8")]:[]}function si(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function ks(n){if(Array.isArray(n))return n.map(ks);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const r in n)e[r]=ks(n[r]);return e}return si(n)}function pn(n){const e=n.key,r=n.value,a=n.valueSpec||{},h=n.objectElementValidators||{},f=n.style,g=n.styleSpec,v=n.validateSpec;let b=[];const k=zt(r);if(k!=="object")return[new Ae(e,r,`object expected, ${k} found`)];for(const E in r){const z=E.split(".")[0],L=a[z]||a["*"];let B;if(h[z])B=h[z];else if(a[z])B=v;else if(h["*"])B=h["*"];else{if(!a["*"]){b.push(new Ae(e,r[E],`unknown property "${E}"`));continue}B=v}b=b.concat(B({key:(e&&`${e}.`)+E,value:r[E],valueSpec:L,style:f,styleSpec:g,object:r,objectKey:E,validateSpec:v},r))}for(const E in a)h[E]||a[E].required&&a[E].default===void 0&&r[E]===void 0&&b.push(new Ae(e,r,`missing required property "${E}"`));return b}function no(n){const e=n.value,r=n.valueSpec,a=n.style,h=n.styleSpec,f=n.key,g=n.arrayElementValidator||n.validateSpec;if(zt(e)!=="array")return[new Ae(f,e,`array expected, ${zt(e)} found`)];if(r.length&&e.length!==r.length)return[new Ae(f,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new Ae(f,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),zt(r.value)==="object"&&(v=r.value);let b=[];for(let k=0;k<e.length;k++)b=b.concat(g({array:e,arrayIndex:k,value:e[k],valueSpec:v,validateSpec:n.validateSpec,style:a,styleSpec:h,key:`${f}[${k}]`}));return b}function Ho(n){const e=n.key,r=n.value,a=n.valueSpec;let h=zt(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new Ae(e,r,`number expected, ${h} found`)]:"minimum"in a&&r<a.minimum?[new Ae(e,r,`${r} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&r>a.maximum?[new Ae(e,r,`${r} is greater than the maximum value ${a.maximum}`)]:[]}function Za(n){const e=n.valueSpec,r=si(n.value.type);let a,h,f,g={};const v=r!=="categorical"&&n.value.property===void 0,b=!v,k=zt(n.value.stops)==="array"&&zt(n.value.stops[0])==="array"&&zt(n.value.stops[0][0])==="object",E=pn({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(B){if(r==="identity")return[new Ae(B.key,B.value,'identity function may not have a "stops" property')];let O=[];const j=B.value;return O=O.concat(no({key:B.key,value:j,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:z})),zt(j)==="array"&&j.length===0&&O.push(new Ae(B.key,j,"array must have at least one stop")),O},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return r==="identity"&&v&&E.push(new Ae(n.key,n.value,'missing required property "property"')),r==="identity"||n.value.stops||E.push(new Ae(n.key,n.value,'missing required property "stops"')),r==="exponential"&&n.valueSpec.expression&&!tu(n.valueSpec)&&E.push(new Ae(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(b&&!io(n.valueSpec)?E.push(new Ae(n.key,n.value,"property functions not supported")):v&&!Hc(n.valueSpec)&&E.push(new Ae(n.key,n.value,"zoom functions not supported"))),r!=="categorical"&&!k||n.value.property!==void 0||E.push(new Ae(n.key,n.value,'"property" property is required')),E;function z(B){let O=[];const j=B.value,W=B.key;if(zt(j)!=="array")return[new Ae(W,j,`array expected, ${zt(j)} found`)];if(j.length!==2)return[new Ae(W,j,`array length 2 expected, length ${j.length} found`)];if(k){if(zt(j[0])!=="object")return[new Ae(W,j,`object expected, ${zt(j[0])} found`)];if(j[0].zoom===void 0)return[new Ae(W,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Ae(W,j,"object stop key must have value")];if(f&&f>si(j[0].zoom))return[new Ae(W,j[0].zoom,"stop zoom values must appear in ascending order")];si(j[0].zoom)!==f&&(f=si(j[0].zoom),h=void 0,g={}),O=O.concat(pn({key:`${W}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Ho,value:L}}))}else O=O.concat(L({key:`${W}[0]`,value:j[0],valueSpec:{},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},j));return Na(ks(j[1]))?O.concat([new Ae(`${W}[1]`,j[1],"expressions are not allowed in function stops.")]):O.concat(B.validateSpec({key:`${W}[1]`,value:j[1],valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function L(B,O){const j=zt(B.value),W=si(B.value),Q=B.value!==null?B.value:O;if(a){if(j!==a)return[new Ae(B.key,Q,`${j} stop domain type must match previous stop domain type ${a}`)]}else a=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new Ae(B.key,Q,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&r!=="categorical"){let ue=`number expected, ${j} found`;return io(e)&&r===void 0&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ae(B.key,Q,ue)]}return r!=="categorical"||j!=="number"||isFinite(W)&&Math.floor(W)===W?r!=="categorical"&&j==="number"&&h!==void 0&&W<h?[new Ae(B.key,Q,"stop domain values must appear in ascending order")]:(h=W,r==="categorical"&&W in g?[new Ae(B.key,Q,"stop domain values must be unique")]:(g[W]=!0,[])):[new Ae(B.key,Q,`integer expected, found ${W}`)]}}function Cs(n){const e=(n.expressionContext==="property"?ru:Va)(ks(n.value),n.valueSpec);if(e.result==="error")return e.value.map(a=>new Ae(`${n.key}${a.key}`,n.value,a.message));const r=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!r.outputDefined())return[new Ae(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Uo(r))return[new Ae(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Uo(r))return[new Ae(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Aa(r,["zoom","feature-state"]))return[new Ae(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!za(r))return[new Ae(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wo(n){const e=n.key,r=n.value,a=n.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(si(r))===-1&&h.push(new Ae(e,r,`expected one of [${a.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(a.values).indexOf(si(r))===-1&&h.push(new Ae(e,r,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function ro(n){return Zo(ks(n.value))?Cs(mr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Jc(n)}function Jc(n){const e=n.value,r=n.key;if(zt(e)!=="array")return[new Ae(r,e,`array expected, ${zt(e)} found`)];const a=n.styleSpec;let h,f=[];if(e.length<1)return[new Ae(r,e,"filter array must have at least 1 element")];switch(f=f.concat(Wo({key:`${r}[0]`,value:e[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),si(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&si(e[1])==="$type"&&f.push(new Ae(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new Ae(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=zt(e[1]),h!=="string"&&f.push(new Ae(`${r}[1]`,e[1],`string expected, ${h} found`)));for(let g=2;g<e.length;g++)h=zt(e[g]),si(e[1])==="$type"?f=f.concat(Wo({key:`${r}[${g}]`,value:e[g],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&f.push(new Ae(`${r}[${g}]`,e[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)f=f.concat(Jc({key:`${r}[${g}]`,value:e[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=zt(e[1]),e.length!==2?f.push(new Ae(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&f.push(new Ae(`${r}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=zt(e[1]),e.length!==2?f.push(new Ae(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&f.push(new Ae(`${r}[1]`,e[1],`object expected, ${h} found`))}return f}function eh(n,e){const r=n.key,a=n.validateSpec,h=n.style,f=n.styleSpec,g=n.value,v=n.objectKey,b=f[`${e}_${n.layerType}`];if(!b)return[];const k=v.match(/^(.*)-transition$/);if(e==="paint"&&k&&b[k[1]]&&b[k[1]].transition)return a({key:r,value:g,valueSpec:f.transition,style:h,styleSpec:f});const E=n.valueSpec||b[v];if(!E)return[new Ae(r,g,`unknown property "${v}"`)];let z;if(zt(g)==="string"&&io(E)&&!E.tokens&&(z=/^{([^}]+)}$/.exec(g)))return[new Ae(r,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const L=[];return n.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&L.push(new Ae(r,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Jt(ks(g))&&si(g.type)==="identity"&&L.push(new Ae(r,g,'"text-font" does not support identity functions'))),L.concat(a({key:n.key,value:g,valueSpec:E,style:h,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:v}))}function th(n){return eh(n,"paint")}function ih(n){return eh(n,"layout")}function nh(n){let e=[];const r=n.value,a=n.key,h=n.style,f=n.styleSpec;r.type||r.ref||e.push(new Ae(a,r,'either "type" or "ref" is required'));let g=si(r.type);const v=si(r.ref);if(r.id){const b=si(r.id);for(let k=0;k<n.arrayIndex;k++){const E=h.layers[k];si(E.id)===b&&e.push(new Ae(a,r.id,`duplicate layer id "${r.id}", previously used at line ${E.id.__line__}`))}}if("ref"in r){let b;["type","source","source-layer","filter","layout"].forEach(k=>{k in r&&e.push(new Ae(a,r[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{si(k.id)===v&&(b=k)}),b?b.ref?e.push(new Ae(a,r.ref,"ref cannot reference another ref layer")):g=si(b.type):e.push(new Ae(a,r.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(r.source){const b=h.sources&&h.sources[r.source],k=b&&si(b.type);b?k==="vector"&&g==="raster"?e.push(new Ae(a,r.source,`layer "${r.id}" requires a raster source`)):k!=="raster-dem"&&g==="hillshade"?e.push(new Ae(a,r.source,`layer "${r.id}" requires a raster-dem source`)):k==="raster"&&g!=="raster"?e.push(new Ae(a,r.source,`layer "${r.id}" requires a vector source`)):k!=="vector"||r["source-layer"]?k==="raster-dem"&&g!=="hillshade"?e.push(new Ae(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!r.paint||!r.paint["line-gradient"]||k==="geojson"&&b.lineMetrics||e.push(new Ae(a,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ae(a,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new Ae(a,r.source,`source "${r.source}" not found`))}else e.push(new Ae(a,r,'missing required property "source"'));return e=e.concat(pn({key:a,value:r,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${a}.type`,value:r.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:r,objectKey:"type"}),filter:ro,layout:b=>pn({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":k=>ih(mr({layerType:g},k))}}),paint:b=>pn({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":k=>th(mr({layerType:g},k))}})}})),e}function yr(n){const e=n.value,r=n.key,a=zt(e);return a!=="string"?[new Ae(r,e,`string expected, ${a} found`)]:[]}const Xo={promoteId:function({key:n,value:e}){if(zt(e)==="string")return yr({key:n,value:e});{const r=[];for(const a in e)r.push(...yr({key:`${n}.${a}`,value:e[a]}));return r}}};function Pn(n){const e=n.value,r=n.key,a=n.styleSpec,h=n.style,f=n.validateSpec;if(!e.type)return[new Ae(r,e,'"type" is required')];const g=si(e.type);let v;switch(g){case"vector":case"raster":return v=pn({key:r,value:e,valueSpec:a[`source_${g.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:Xo,validateSpec:f}),v;case"raster-dem":return v=function(b){var k;const E=(k=b.sourceName)!==null&&k!==void 0?k:"",z=b.value,L=b.styleSpec,B=L.source_raster_dem,O=b.style;let j=[];const W=zt(z);if(z===void 0)return j;if(W!=="object")return j.push(new Ae("source_raster_dem",z,`object expected, ${W} found`)),j;const Q=si(z.encoding)==="custom",ue=["redFactor","greenFactor","blueFactor","baseShift"],ie=b.value.encoding?`"${b.value.encoding}"`:"Default";for(const he in z)!Q&&ue.includes(he)?j.push(new Ae(he,z[he],`In "${E}": "${he}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):B[he]?j=j.concat(b.validateSpec({key:he,value:z[he],valueSpec:B[he],validateSpec:b.validateSpec,style:O,styleSpec:L})):j.push(new Ae(he,z[he],`unknown property "${he}"`));return j}({sourceName:r,value:e,style:n.style,styleSpec:a,validateSpec:f}),v;case"geojson":if(v=pn({key:r,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:f,objectElementValidators:Xo}),e.cluster)for(const b in e.clusterProperties){const[k,E]=e.clusterProperties[b],z=typeof k=="string"?[k,["accumulated"],["get",b]]:k;v.push(...Cs({key:`${r}.${b}.map`,value:E,validateSpec:f,expressionContext:"cluster-map"})),v.push(...Cs({key:`${r}.${b}.reduce`,value:z,validateSpec:f,expressionContext:"cluster-reduce"}))}return v;case"video":return pn({key:r,value:e,valueSpec:a.source_video,style:h,validateSpec:f,styleSpec:a});case"image":return pn({key:r,value:e,valueSpec:a.source_image,style:h,validateSpec:f,styleSpec:a});case"canvas":return[new Ae(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wo({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:f,styleSpec:a})}}function Ko(n){const e=n.value,r=n.styleSpec,a=r.light,h=n.style;let f=[];const g=zt(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Ae("light",e,`object expected, ${g} found`)]),f;for(const v in e){const b=v.match(/^(.*)-transition$/);f=f.concat(b&&a[b[1]]&&a[b[1]].transition?n.validateSpec({key:v,value:e[v],valueSpec:r.transition,validateSpec:n.validateSpec,style:h,styleSpec:r}):a[v]?n.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:n.validateSpec,style:h,styleSpec:r}):[new Ae(v,e[v],`unknown property "${v}"`)])}return f}function rh(n){const e=n.value,r=n.styleSpec,a=r.terrain,h=n.style;let f=[];const g=zt(e);if(e===void 0)return f;if(g!=="object")return f=f.concat([new Ae("terrain",e,`object expected, ${g} found`)]),f;for(const v in e)f=f.concat(a[v]?n.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:n.validateSpec,style:h,styleSpec:r}):[new Ae(v,e[v],`unknown property "${v}"`)]);return f}function sh(n){let e=[];const r=n.value,a=n.key;if(Array.isArray(r)){const h=[],f=[];for(const g in r)r[g].id&&h.includes(r[g].id)&&e.push(new Ae(a,r,`all the sprites' ids must be unique, but ${r[g].id} is duplicated`)),h.push(r[g].id),r[g].url&&f.includes(r[g].url)&&e.push(new Ae(a,r,`all the sprites' URLs must be unique, but ${r[g].url} is duplicated`)),f.push(r[g].url),e=e.concat(pn({key:`${a}[${g}]`,value:r[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return yr({key:a,value:r})}const oh={"*":()=>[],array:no,boolean:function(n){const e=n.value,r=n.key,a=zt(e);return a!=="boolean"?[new Ae(r,e,`boolean expected, ${a} found`)]:[]},number:Ho,color:function(n){const e=n.key,r=n.value,a=zt(r);return a!=="string"?[new Ae(e,r,`color expected, ${a} found`)]:Ft.parse(String(r))?[]:[new Ae(e,r,`color expected, "${r}" found`)]},constants:Qc,enum:Wo,filter:ro,function:Za,layer:nh,object:pn,source:Pn,light:Ko,terrain:rh,string:yr,formatted:function(n){return yr(n).length===0?[]:Cs(n)},resolvedImage:function(n){return yr(n).length===0?[]:Cs(n)},padding:function(n){const e=n.key,r=n.value;if(zt(r)==="array"){if(r.length<1||r.length>4)return[new Ae(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const a={type:"number"};let h=[];for(let f=0;f<r.length;f++)h=h.concat(n.validateSpec({key:`${e}[${f}]`,value:r[f],validateSpec:n.validateSpec,valueSpec:a}));return h}return Ho({key:e,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(n){const e=n.key,r=n.value,a=zt(r),h=n.styleSpec;if(a!=="array"||r.length<1||r.length%2!=0)return[new Ae(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let f=[];for(let g=0;g<r.length;g+=2)f=f.concat(Wo({key:`${e}[${g}]`,value:r[g],valueSpec:h.layout_symbol["text-anchor"]})),f=f.concat(no({key:`${e}[${g+1}]`,value:r[g+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:h}));return f},sprite:sh};function Rr(n){const e=n.value,r=n.valueSpec,a=n.styleSpec;return n.validateSpec=Rr,r.expression&&Jt(si(e))?Za(n):r.expression&&Na(ks(e))?Cs(n):r.type&&oh[r.type]?oh[r.type](n):pn(mr({},n,{valueSpec:r.type?a[r.type]:r}))}function ah(n){const e=n.value,r=n.key,a=yr(n);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Ae(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Ae(r,e,'"glyphs" url must include a "{range}" token'))),a}function Gn(n,e=ye){let r=[];return r=r.concat(Rr({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:Rr,objectElementValidators:{glyphs:ah,"*":()=>[]}})),n.constants&&(r=r.concat(Qc({key:"constants",value:n.constants,style:n,styleSpec:e,validateSpec:Rr}))),Ga(r)}function Fr(n){return function(e){return n({...e,validateSpec:Rr})}}function Ga(n){return[].concat(n).sort((e,r)=>e.line-r.line)}function Br(n){return function(...e){return Ga(n.apply(this,e))}}Gn.source=Br(Fr(Pn)),Gn.sprite=Br(Fr(sh)),Gn.glyphs=Br(Fr(ah)),Gn.light=Br(Fr(Ko)),Gn.terrain=Br(Fr(rh)),Gn.layer=Br(Fr(nh)),Gn.filter=Br(Fr(ro)),Gn.paintProperty=Br(Fr(th)),Gn.layoutProperty=Br(Fr(ih));const Or=Gn,_p=Or.light,au=Or.paintProperty,lh=Or.layoutProperty;function Ha(n,e){let r=!1;if(e&&e.length)for(const a of e)n.fire(new ts(new Error(a.message))),r=!0;return r}class so{constructor(e,r,a){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const g=new Int32Array(this.arrayBuffer);e=g[0],this.d=(r=g[1])+2*(a=g[2]);for(let b=0;b<this.d*this.d;b++){const k=g[3+b],E=g[3+b+1];h.push(k===E?null:g.subarray(k,E))}const v=g[3+h.length+1];this.keys=g.subarray(g[3+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*a;for(let g=0;g<this.d*this.d;g++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=a,this.scale=r/e,this.uid=0;const f=a/r*e;this.min=-f,this.max=e+f}insert(e,r,a,h,f){this._forEachCell(r,a,h,f,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(f)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,a,h,f,g){this.cells[f].push(g)}query(e,r,a,h,f){const g=this.min,v=this.max;if(e<=g&&r<=g&&v<=a&&v<=h&&!f)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,r,a,h,this._queryCell,b,{},f),b}}_queryCell(e,r,a,h,f,g,v,b){const k=this.cells[f];if(k!==null){const E=this.keys,z=this.bboxes;for(let L=0;L<k.length;L++){const B=k[L];if(v[B]===void 0){const O=4*B;(b?b(z[O+0],z[O+1],z[O+2],z[O+3]):e<=z[O+2]&&r<=z[O+3]&&a>=z[O+0]&&h>=z[O+1])?(v[B]=!0,g.push(E[B])):v[B]=!1}}}}_forEachCell(e,r,a,h,f,g,v,b){const k=this._convertToCellCoord(e),E=this._convertToCellCoord(r),z=this._convertToCellCoord(a),L=this._convertToCellCoord(h);for(let B=k;B<=z;B++)for(let O=E;O<=L;O++){const j=this.d*O+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(O),this._convertFromCellCoord(B+1),this._convertFromCellCoord(O+1)))&&f.call(this,e,r,a,h,j,g,v,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const h=new Int32Array(r+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let f=r;for(let g=0;g<e.length;g++){const v=e[g];h[3+g]=f,h.set(v,f),f+=v.length}return h[3+e.length]=f,h.set(this.keys,f),f+=this.keys.length,h[3+e.length+1]=f,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer}static serialize(e,r){const a=e.toArrayBuffer();return r&&r.push(a),{buffer:a}}static deserialize(e){return new so(e.buffer)}}const Nr={};function qe(n,e,r={}){if(Nr[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),Nr[n]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}qe("Object",Object),qe("TransferableGridIndex",so),qe("Color",Ft),qe("Error",Error),qe("AJAXError",Qr),qe("ResolvedImage",Bi),qe("StylePropertyFunction",$o),qe("StyleExpression",iu,{omit:["_evaluator"]}),qe("ZoomDependentExpression",Ua),qe("ZoomConstantExpression",nu),qe("CompoundExpression",Zn,{omit:["_evaluate"]});for(const n in to)to[n]._classRegistryKey||qe(`Expression_${n}`,to[n]);function Wa(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function as(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob)return n;if(Wa(n)||dt(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const r=n;return e&&e.push(r.buffer),r}if(n instanceof ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const r=[];for(const a of n)r.push(as(a,e));return r}if(typeof n=="object"){const r=n.constructor,a=r._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");if(!Nr[a])throw new Error(`${a} is not registered.`);const h=r.serialize?r.serialize(n,e):{};if(r.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const f in n){if(!n.hasOwnProperty(f)||Nr[a].omit.indexOf(f)>=0)continue;const g=n[f];h[f]=Nr[a].shallow.indexOf(f)>=0?g:as(g,e)}n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof n)}function oo(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||Wa(n)||dt(n)||ArrayBuffer.isView(n)||n instanceof ImageData)return n;if(Array.isArray(n))return n.map(oo);if(typeof n=="object"){const e=n.$name||"Object";if(!Nr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=Nr[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(n);const a=Object.create(r.prototype);for(const h of Object.keys(n)){if(h==="$name")continue;const f=n[h];a[h]=Nr[e].shallow.indexOf(h)>=0?f:oo(f)}return a}throw new Error("can't deserialize object of type "+typeof n)}class uh{constructor(){this.first=!0}update(e,r){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const je={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function lu(n){for(const e of n)if(cu(e.charCodeAt(0)))return!0;return!1}function uu(n){for(const e of n)if(!vp(e.charCodeAt(0)))return!1;return!0}function vp(n){return!(je.Arabic(n)||je["Arabic Supplement"](n)||je["Arabic Extended-A"](n)||je["Arabic Presentation Forms-A"](n)||je["Arabic Presentation Forms-B"](n))}function cu(n){return!(n!==746&&n!==747&&(n<4352||!(je["Bopomofo Extended"](n)||je.Bopomofo(n)||je["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||je["CJK Compatibility Ideographs"](n)||je["CJK Compatibility"](n)||je["CJK Radicals Supplement"](n)||je["CJK Strokes"](n)||!(!je["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||je["CJK Unified Ideographs Extension A"](n)||je["CJK Unified Ideographs"](n)||je["Enclosed CJK Letters and Months"](n)||je["Hangul Compatibility Jamo"](n)||je["Hangul Jamo Extended-A"](n)||je["Hangul Jamo Extended-B"](n)||je["Hangul Jamo"](n)||je["Hangul Syllables"](n)||je.Hiragana(n)||je["Ideographic Description Characters"](n)||je.Kanbun(n)||je["Kangxi Radicals"](n)||je["Katakana Phonetic Extensions"](n)||je.Katakana(n)&&n!==12540||!(!je["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!je["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||je["Unified Canadian Aboriginal Syllabics"](n)||je["Unified Canadian Aboriginal Syllabics Extended"](n)||je["Vertical Forms"](n)||je["Yijing Hexagram Symbols"](n)||je["Yi Syllables"](n)||je["Yi Radicals"](n))))}function ch(n){return!(cu(n)||function(e){return!!(je["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||je["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||je["Letterlike Symbols"](e)||je["Number Forms"](e)||je["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||je["Control Pictures"](e)&&e!==9251||je["Optical Character Recognition"](e)||je["Enclosed Alphanumerics"](e)||je["Geometric Shapes"](e)||je["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||je["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||je["CJK Symbols and Punctuation"](e)||je.Katakana(e)||je["Private Use Area"](e)||je["CJK Compatibility Forms"](e)||je["Small Form Variants"](e)||je["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function hh(n){return n>=1424&&n<=2303||je["Arabic Presentation Forms-A"](n)||je["Arabic Presentation Forms-B"](n)}function dh(n,e){return!(!e&&hh(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||je.Khmer(n))}function xp(n){for(const e of n)if(hh(e.charCodeAt(0)))return!0;return!1}const hu="deferred",du="loading",pu="loaded";let fu=null,fn="unavailable",ls=null;const Yo=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(fn="error"),fu&&fu(n)};function mu(){Qo.fire(new es("pluginStateChange",{pluginStatus:fn,pluginURL:ls}))}const Qo=new _s,gu=function(){return fn},ph=function(){if(fn!==hu||!ls)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fn=du,mu(),ls&&No({url:ls},n=>{n?Yo(n):(fn=pu,mu())})},Mn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fn===pu||Mn.applyArabicShaping!=null,isLoading:()=>fn===du,setState(n){if(!qi())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");fn=n.pluginStatus,ls=n.pluginURL},isParsed(){if(!qi())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Mn.applyArabicShaping!=null&&Mn.processBidirectionalText!=null&&Mn.processStyledBidirectionalText!=null},getPluginURL(){if(!qi())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ls}};class Ht{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new uh,this.transition={})}isSupportedScript(e){return function(r,a){for(const h of r)if(!dh(h.charCodeAt(0),a))return!1;return!0}(e,Mn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*r}}}class Xa{constructor(e,r){this.property=e,this.value=r,this.expression=function(a,h){if(Jt(a))return new $o(a,h);if(Na(a)){const f=ru(a,h);if(f.result==="error")throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=a;return h.type==="color"&&typeof a=="string"?f=Ft.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)&&(f=$n.parse(a)):f=Cn.parse(a),{kind:"constant",evaluate:()=>f}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,a){return this.property.possiblyEvaluate(this,e,r,a)}}class yu{constructor(e){this.property=e,this.value=new Xa(e,void 0)}transitioned(e,r){return new mh(this.property,this.value,r,Be({},e.transition,this.transition),e.now)}untransitioned(){return new mh(this.property,this.value,null,{},0)}}class fh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ui(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new yu(this._values[e].property)),this._values[e].value=new Xa(this._values[e].property,r===null?void 0:ui(r))}getTransition(e){return ui(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new yu(this._values[e].property)),this._values[e].transition=ui(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a);const h=this.getTransition(r);h!==void 0&&(e[`${r}-transition`]=h)}return e}transitioned(e,r){const a=new gh(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,r._values[h]);return a}untransitioned(){const e=new gh(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class mh{constructor(e,r,a,h,f){this.property=e,this.value=r,this.begin=f+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,r,a){const h=e.now||0,f=this.value.possiblyEvaluate(e,r,a),g=this.prior;if(g){if(h>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(h<this.begin)return g.possiblyEvaluate(e,r,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,r,a),f,function(b){if(b<=0)return 0;if(b>=1)return 1;const k=b*b,E=k*b;return 4*(b<.5?E:3*(b-k)+E-.75)}(v))}}return f}}class gh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,a){const h=new Ka(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,r,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class wp{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return ui(this._values[e].value)}setValue(e,r){this._values[e]=new Xa(this._values[e].property,r===null?void 0:ui(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a)}return e}possiblyEvaluate(e,r,a){const h=new Ka(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,r,a);return h}}class tn{constructor(e,r,a){this.property=e,this.value=r,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,a,h){return this.property.evaluate(this.value,this.parameters,e,r,a,h)}}class Ka{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Je{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,a){const h=En[this.specification.type];return h?h(e,r,a):e}}class ot{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,a,h){return new tn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},a,h)}:e.expression,r)}interpolate(e,r,a){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new tn(this,{kind:"constant",value:void 0},e.parameters);const h=En[this.specification.type];if(h){const f=h(e.value.value,r.value.value,a);return new tn(this,{kind:"constant",value:f},e.parameters)}return e}evaluate(e,r,a,h,f,g){return e.kind==="constant"?e.value:e.evaluate(r,a,h,f,g)}}class Jo extends ot{possiblyEvaluate(e,r,a,h){if(e.value===void 0)return new tn(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const f=e.expression.evaluate(r,null,{},a,h),g=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,v=this._calculate(g,g,g,r);return new tn(this,{kind:"constant",value:v},r)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new tn(this,{kind:"constant",value:f},r)}return new tn(this,e.expression,r)}evaluate(e,r,a,h,f,g){if(e.kind==="source"){const v=e.evaluate(r,a,h,f,g);return this._calculate(v,v,v,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},a,h),e.evaluate({zoom:Math.floor(r.zoom)},a,h),e.evaluate({zoom:Math.floor(r.zoom)+1},a,h),r):e.value}_calculate(e,r,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:a,to:r}}interpolate(e){return e}}class _u{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(r,null,{},a,h);return this._calculate(f,f,f,r)}return this._calculate(e.expression.evaluate(new Ht(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Ht(Math.floor(r.zoom),r)),e.expression.evaluate(new Ht(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:a,to:r}}interpolate(e){return e}}class vu{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,h){return!!e.expression.evaluate(r,null,{},a,h)}interpolate(){return!1}}class mi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const a=e[r];a.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new Xa(a,void 0),f=this.defaultTransitionablePropertyValues[r]=new yu(a);this.defaultTransitioningPropertyValues[r]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}qe("DataDrivenProperty",ot),qe("DataConstantProperty",Je),qe("CrossFadedDataDrivenProperty",Jo),qe("CrossFadedProperty",_u),qe("ColorRampProperty",vu);const xu="-transition";class Hn extends _s{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new wp(r.layout)),r.paint)){this._transitionablePaint=new fh(r.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ka(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,a={}){r!=null&&this._validate(lh,`layers.${this.id}.layout.${e}`,e,r,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(xu)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,a={}){if(r!=null&&this._validate(au,`layers.${this.id}.paint.${e}`,e,r,a))return!1;if(e.endsWith(xu))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[e],f=h.property.specification["property-type"]==="cross-faded-data-driven",g=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||g||f||this._handleOverridablePaintPropertyUpdate(e,v,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ot(e,(r,a)=>!(r===void 0||a==="layout"&&!Object.keys(r).length||a==="paint"&&!Object.keys(r).length))}_validate(e,r,a,h,f={}){return(!f||f.validate!==!1)&&Ha(this,e.call(Or,{key:r,layerType:this.type,objectKey:a,value:h,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof tn&&io(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const yh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Es{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class oi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ti(n,e=1){let r=0,a=0;return{members:n.map(h=>{const f=yh[h.type].BYTES_PER_ELEMENT,g=r=ao(r,Math.max(e,f)),v=h.components||1;return a=Math.max(a,f),r+=f*v,{name:h.name,type:h.type,components:v,offset:g}}),size:ao(r,Math.max(a,e)),alignment:e}}function ao(n,e){return Math.ceil(n/e)*e}class ea extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.int16[h+0]=r,this.int16[h+1]=a,e}}ea.prototype.bytesPerElement=4,qe("StructArrayLayout2i4",ea);class ta extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const f=3*e;return this.int16[f+0]=r,this.int16[f+1]=a,this.int16[f+2]=h,e}}ta.prototype.bytesPerElement=6,qe("StructArrayLayout3i6",ta);class Is extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,a,h)}emplace(e,r,a,h,f){const g=4*e;return this.int16[g+0]=r,this.int16[g+1]=a,this.int16[g+2]=h,this.int16[g+3]=f,e}}Is.prototype.bytesPerElement=8,qe("StructArrayLayout4i8",Is);class wu extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,h,f,g)}emplace(e,r,a,h,f,g,v){const b=6*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.int16[b+2]=h,this.int16[b+3]=f,this.int16[b+4]=g,this.int16[b+5]=v,e}}wu.prototype.bytesPerElement=12,qe("StructArrayLayout2i4i12",wu);class bu extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,h,f,g)}emplace(e,r,a,h,f,g,v){const b=4*e,k=8*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.uint8[k+4]=h,this.uint8[k+5]=f,this.uint8[k+6]=g,this.uint8[k+7]=v,e}}bu.prototype.bytesPerElement=8,qe("StructArrayLayout2i4ub8",bu);class lo extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.float32[h+0]=r,this.float32[h+1]=a,e}}lo.prototype.bytesPerElement=8,qe("StructArrayLayout2f8",lo);class Su extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g,v,b,k,E){const z=this.length;return this.resize(z+1),this.emplace(z,e,r,a,h,f,g,v,b,k,E)}emplace(e,r,a,h,f,g,v,b,k,E,z){const L=10*e;return this.uint16[L+0]=r,this.uint16[L+1]=a,this.uint16[L+2]=h,this.uint16[L+3]=f,this.uint16[L+4]=g,this.uint16[L+5]=v,this.uint16[L+6]=b,this.uint16[L+7]=k,this.uint16[L+8]=E,this.uint16[L+9]=z,e}}Su.prototype.bytesPerElement=20,qe("StructArrayLayout10ui20",Su);class Tu extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g,v,b,k,E,z,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,r,a,h,f,g,v,b,k,E,z,L)}emplace(e,r,a,h,f,g,v,b,k,E,z,L,B){const O=12*e;return this.int16[O+0]=r,this.int16[O+1]=a,this.int16[O+2]=h,this.int16[O+3]=f,this.uint16[O+4]=g,this.uint16[O+5]=v,this.uint16[O+6]=b,this.uint16[O+7]=k,this.int16[O+8]=E,this.int16[O+9]=z,this.int16[O+10]=L,this.int16[O+11]=B,e}}Tu.prototype.bytesPerElement=24,qe("StructArrayLayout4i4ui4i24",Tu);class At extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const f=3*e;return this.float32[f+0]=r,this.float32[f+1]=a,this.float32[f+2]=h,e}}At.prototype.bytesPerElement=12,qe("StructArrayLayout3f12",At);class p extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}p.prototype.bytesPerElement=4,qe("StructArrayLayout1ul4",p);class t extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g,v,b,k){const E=this.length;return this.resize(E+1),this.emplace(E,e,r,a,h,f,g,v,b,k)}emplace(e,r,a,h,f,g,v,b,k,E){const z=10*e,L=5*e;return this.int16[z+0]=r,this.int16[z+1]=a,this.int16[z+2]=h,this.int16[z+3]=f,this.int16[z+4]=g,this.int16[z+5]=v,this.uint32[L+3]=b,this.uint16[z+8]=k,this.uint16[z+9]=E,e}}t.prototype.bytesPerElement=20,qe("StructArrayLayout6i1ul2ui20",t);class o extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,h,f,g)}emplace(e,r,a,h,f,g,v){const b=6*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.int16[b+2]=h,this.int16[b+3]=f,this.int16[b+4]=g,this.int16[b+5]=v,e}}o.prototype.bytesPerElement=12,qe("StructArrayLayout2i2i2i12",o);class c extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,a,h,f)}emplace(e,r,a,h,f,g){const v=4*e,b=8*e;return this.float32[v+0]=r,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[b+6]=f,this.int16[b+7]=g,e}}c.prototype.bytesPerElement=16,qe("StructArrayLayout2f1f2i16",c);class d extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,a,h)}emplace(e,r,a,h,f){const g=12*e,v=3*e;return this.uint8[g+0]=r,this.uint8[g+1]=a,this.float32[v+1]=h,this.float32[v+2]=f,e}}d.prototype.bytesPerElement=12,qe("StructArrayLayout2ub2f12",d);class m extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const f=3*e;return this.uint16[f+0]=r,this.uint16[f+1]=a,this.uint16[f+2]=h,e}}m.prototype.bytesPerElement=6,qe("StructArrayLayout3ui6",m);class x extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q){const ue=this.length;return this.resize(ue+1),this.emplace(ue,e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q)}emplace(e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q,ue){const ie=24*e,he=12*e,fe=48*e;return this.int16[ie+0]=r,this.int16[ie+1]=a,this.uint16[ie+2]=h,this.uint16[ie+3]=f,this.uint32[he+2]=g,this.uint32[he+3]=v,this.uint32[he+4]=b,this.uint16[ie+10]=k,this.uint16[ie+11]=E,this.uint16[ie+12]=z,this.float32[he+7]=L,this.float32[he+8]=B,this.uint8[fe+36]=O,this.uint8[fe+37]=j,this.uint8[fe+38]=W,this.uint32[he+10]=Q,this.int16[ie+22]=ue,e}}x.prototype.bytesPerElement=48,qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class w extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q,ue,ie,he,fe,be,$e,Ke,Ue,Ve,ze,Ze){const De=this.length;return this.resize(De+1),this.emplace(De,e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q,ue,ie,he,fe,be,$e,Ke,Ue,Ve,ze,Ze)}emplace(e,r,a,h,f,g,v,b,k,E,z,L,B,O,j,W,Q,ue,ie,he,fe,be,$e,Ke,Ue,Ve,ze,Ze,De){const Ee=32*e,nt=16*e;return this.int16[Ee+0]=r,this.int16[Ee+1]=a,this.int16[Ee+2]=h,this.int16[Ee+3]=f,this.int16[Ee+4]=g,this.int16[Ee+5]=v,this.int16[Ee+6]=b,this.int16[Ee+7]=k,this.uint16[Ee+8]=E,this.uint16[Ee+9]=z,this.uint16[Ee+10]=L,this.uint16[Ee+11]=B,this.uint16[Ee+12]=O,this.uint16[Ee+13]=j,this.uint16[Ee+14]=W,this.uint16[Ee+15]=Q,this.uint16[Ee+16]=ue,this.uint16[Ee+17]=ie,this.uint16[Ee+18]=he,this.uint16[Ee+19]=fe,this.uint16[Ee+20]=be,this.uint16[Ee+21]=$e,this.uint16[Ee+22]=Ke,this.uint32[nt+12]=Ue,this.float32[nt+13]=Ve,this.float32[nt+14]=ze,this.uint16[Ee+30]=Ze,this.uint16[Ee+31]=De,e}}w.prototype.bytesPerElement=64,qe("StructArrayLayout8i15ui1ul2f2ui64",w);class T extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}T.prototype.bytesPerElement=4,qe("StructArrayLayout1f4",T);class C extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const f=3*e;return this.uint16[6*e+0]=r,this.float32[f+1]=a,this.float32[f+2]=h,e}}C.prototype.bytesPerElement=12,qe("StructArrayLayout1ui2f12",C);class I extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,r,a)}emplace(e,r,a,h){const f=4*e;return this.uint32[2*e+0]=r,this.uint16[f+2]=a,this.uint16[f+3]=h,e}}I.prototype.bytesPerElement=8,qe("StructArrayLayout1ul2ui8",I);class P extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const h=2*e;return this.uint16[h+0]=r,this.uint16[h+1]=a,e}}P.prototype.bytesPerElement=4,qe("StructArrayLayout2ui4",P);class F extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}F.prototype.bytesPerElement=2,qe("StructArrayLayout1ui2",F);class q extends oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,r,a,h)}emplace(e,r,a,h,f){const g=4*e;return this.float32[g+0]=r,this.float32[g+1]=a,this.float32[g+2]=h,this.float32[g+3]=f,e}}q.prototype.bytesPerElement=16,qe("StructArrayLayout4f16",q);class $ extends Es{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new te(this.anchorPointX,this.anchorPointY)}}$.prototype.size=20;class G extends t{get(e){return new $(this,e)}}qe("CollisionBoxArray",G);class U extends Es{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}U.prototype.size=48;class oe extends x{get(e){return new U(this,e)}}qe("PlacedSymbolArray",oe);class pe extends Es{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}pe.prototype.size=64;class K extends w{get(e){return new pe(this,e)}}qe("SymbolInstanceArray",K);class ae extends T{getoffsetX(e){return this.float32[1*e+0]}}qe("GlyphOffsetArray",ae);class me extends ta{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}qe("SymbolLineVertexArray",me);class ge extends Es{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ge.prototype.size=12;class we extends C{get(e){return new ge(this,e)}}qe("TextAnchorOffsetArray",we);class Ce extends Es{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ce.prototype.size=8;class Te extends I{get(e){return new Ce(this,e)}}qe("FeatureIndexArray",Te);class Ie extends ea{}class Xe extends ea{}class xt extends ea{}class Ne extends wu{}class at extends bu{}class Ye extends lo{}class Bt extends Su{}class vt extends Tu{}class mt extends At{}class wt extends p{}class hi extends o{}class Zt extends d{}class Oi extends m{}class ki extends P{}const gi=ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:zn}=gi;class Wt{constructor(e=[]){this.segments=e}prepareSegment(e,r,a,h){let f=this.segments[this.segments.length-1];return e>Wt.MAX_VERTEX_ARRAY_LENGTH&&Di(`Max vertices per segment is ${Wt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Wt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==h)&&(f={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(f.sortKey=h),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,a,h){return new Wt([{vertexOffset:e,primitiveOffset:r,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function _r(n,e){return 256*(n=Oe(Math.floor(n),0,255))+Oe(Math.floor(e),0,255)}Wt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qe("SegmentVector",Wt);const vr=ti([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var us={exports:{}},Ps={exports:{}};Ps.exports=function(n,e){var r,a,h,f,g,v,b,k;for(a=n.length-(r=3&n.length),h=e,g=3432918353,v=461845907,k=0;k<a;)b=255&n.charCodeAt(k)|(255&n.charCodeAt(++k))<<8|(255&n.charCodeAt(++k))<<16|(255&n.charCodeAt(++k))<<24,++k,h=27492+(65535&(f=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,r){case 3:b^=(255&n.charCodeAt(k+2))<<16;case 2:b^=(255&n.charCodeAt(k+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&n.charCodeAt(k)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var uo=Ps.exports,Hi={exports:{}};Hi.exports=function(n,e){for(var r,a=n.length,h=e^a,f=0;a>=4;)r=1540483477*(65535&(r=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(r>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++f;switch(a){case 3:h^=(255&n.charCodeAt(f+2))<<16;case 2:h^=(255&n.charCodeAt(f+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(f)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Ni=uo,nn=Hi.exports;us.exports=Ni,us.exports.murmur3=Ni,us.exports.murmur2=nn;var Ms=R(us.exports);class di{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,a,h){this.ids.push(Ci(e)),this.positions.push(r,a,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Ci(e);let a=0,h=this.ids.length-1;for(;a<h;){const g=a+h>>1;this.ids[g]>=r?h=g:a=g+1}const f=[];for(;this.ids[a]===r;)f.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return f}static serialize(e,r){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return mn(a,h,0,a.length-1),r&&r.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const r=new di;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Ci(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ms(String(n))}function mn(n,e,r,a){for(;r<a;){const h=n[r+a>>1];let f=r-1,g=a+1;for(;;){do f++;while(n[f]<h);do g--;while(n[g]>h);if(f>=g)break;pi(n,f,g),pi(e,3*f,3*g),pi(e,3*f+1,3*g+1),pi(e,3*f+2,3*g+2)}g-r<a-g?(mn(n,e,r,g),r=g+1):(mn(n,e,g+1,a),a=g)}}function pi(n,e,r){const a=n[e];n[e]=n[r],n[r]=a}qe("FeaturePositionMap",di);class zs{constructor(e,r){this.gl=e.gl,this.location=r}}class Ya extends zs{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class _h extends zs{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class vh extends zs{constructor(e,r){super(e,r),this.current=Ft.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const bp=new Float32Array(16);function ku(n){return[_r(255*n.r,255*n.g),_r(255*n.b,255*n.a)]}class xr{constructor(e,r,a){this.value=e,this.uniformNames=r.map(h=>`u_${h}`),this.type=a}setUniform(e,r,a){e.set(a.constantOr(this.value))}getBinding(e,r,a){return this.type==="color"?new vh(e,r):new Ya(e,r)}}class As{constructor(e,r){this.uniformNames=r.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,a,h){const f=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)}getBinding(e,r,a){return a.substr(0,9)==="u_pattern"?new _h(e,r):new Ya(e,r)}}class wr{constructor(e,r,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(f=>({name:`a_${f}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,r,a,h,f){const g=this.paintVertexArray.length,v=this.expression.evaluate(new Ht(0),r,{},h,[],f);this.paintVertexArray.resize(e),this._setPaintValue(g,e,v)}updatePaintArray(e,r,a,h){const f=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(e,r,f)}_setPaintValue(e,r,a){if(this.type==="color"){const h=ku(a);for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,h[0],h[1])}else{for(let h=e;h<r;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wn{constructor(e,r,a,h,f,g){this.expression=e,this.uniformNames=r.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=r.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,a,h,f){const g=this.expression.evaluate(new Ht(this.zoom),r,{},h,[],f),v=this.expression.evaluate(new Ht(this.zoom+1),r,{},h,[],f),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,g,v)}updatePaintArray(e,r,a,h){const f=this.expression.evaluate({zoom:this.zoom},a,h),g=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(e,r,f,g)}_setPaintValue(e,r,a,h){if(this.type==="color"){const f=ku(a),g=ku(h);for(let v=e;v<r;v++)this.paintVertexArray.emplace(v,f[0],f[1],g[0],g[1])}else{for(let f=e;f<r;f++)this.paintVertexArray.emplace(f,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const a=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=Oe(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,r,a){return new Ya(e,r)}}class br{constructor(e,r,a,h,f,g){this.expression=e,this.type=r,this.useIntegerZoom=a,this.zoom=h,this.layerId=g,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(e,r,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,r.patterns&&r.patterns[this.layerId],a)}updatePaintArray(e,r,a,h,f){this._setPaintValues(e,r,a.patterns&&a.patterns[this.layerId],f)}_setPaintValues(e,r,a,h){if(!h||!a)return;const{min:f,mid:g,max:v}=a,b=h[f],k=h[g],E=h[v];if(b&&k&&E)for(let z=e;z<r;z++)this.zoomInPaintVertexArray.emplace(z,k.tl[0],k.tl[1],k.br[0],k.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],k.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,k.tl[0],k.tl[1],k.br[0],k.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],k.pixelRatio,E.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,vr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,vr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cu{constructor(e,r,a){this.binders={},this._buffers=[];const h=[];for(const f in e.paint._values){if(!a(f))continue;const g=e.paint.get(f);if(!(g instanceof tn&&io(g.property.specification)))continue;const v=i1(f,e.type),b=g.value,k=g.property.specification.type,E=g.property.useIntegerZoom,z=g.property.specification["property-type"],L=z==="cross-faded"||z==="cross-faded-data-driven";if(b.kind==="constant")this.binders[f]=L?new As(b.value,v):new xr(b.value,v,k),h.push(`/u_${f}`);else if(b.kind==="source"||L){const B=Dg(f,k,"source");this.binders[f]=L?new br(b,k,E,r,B,e.id):new wr(b,v,k,B),h.push(`/a_${f}`)}else{const B=Dg(f,k,"composite");this.binders[f]=new Wn(b,v,k,E,r,B),h.push(`/z_${f}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof wr||r instanceof Wn?r.maxValue:0}populatePaintArrays(e,r,a,h,f){for(const g in this.binders){const v=this.binders[g];(v instanceof wr||v instanceof Wn||v instanceof br)&&v.populatePaintArray(e,r,a,h,f)}}setConstantPatternPositions(e,r){for(const a in this.binders){const h=this.binders[a];h instanceof As&&h.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,a,h,f){let g=!1;for(const v in e){const b=r.getPositions(v);for(const k of b){const E=a.feature(k.index);for(const z in this.binders){const L=this.binders[z];if((L instanceof wr||L instanceof Wn||L instanceof br)&&L.expression.isStateDependent===!0){const B=h.paint.get(z);L.expression=B.value,L.updatePaintArray(k.start,k.end,E,e[v],f),g=!0}}}}return g}defines(){const e=[];for(const r in this.binders){const a=this.binders[r];(a instanceof xr||a instanceof As)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof wr||a instanceof Wn)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name);else if(a instanceof br)for(let h=0;h<vr.members.length;h++)e.push(vr.members[h].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof xr||a instanceof As||a instanceof Wn)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const a=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof xr||f instanceof As||f instanceof Wn){for(const g of f.uniformNames)if(r[g]){const v=f.getBinding(e,r[g],g);a.push({name:g,property:h,binding:v})}}}return a}setUniforms(e,r,a,h){for(const{name:f,property:g,binding:v}of r)this.binders[g].setUniform(v,h,a.get(g),f)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const a=this.binders[r];if(e&&a instanceof br){const h=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof wr||a instanceof Wn)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const r in this.binders){const a=this.binders[r];(a instanceof wr||a instanceof Wn||a instanceof br)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof wr||r instanceof Wn||r instanceof br)&&r.destroy()}}}class Vr{constructor(e,r,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Cu(h,r,a);this.needsUpload=!1,this._featureMap=new di,this._bufferOffset=0}populatePaintArrays(e,r,a,h,f,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,r,h,f,g);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,a,h){for(const f of a)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(e,this._featureMap,r,f,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function i1(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function Dg(n,e,r){const a={color:{source:lo,composite:q},number:{source:T,composite:lo}},h=function(f){return{"line-pattern":{source:Bt,composite:Bt},"fill-pattern":{source:Bt,composite:Bt},"fill-extrusion-pattern":{source:Bt,composite:Bt}}[f]}(n);return h&&h[r]||a[e][r]}qe("ConstantBinder",xr),qe("CrossFadedConstantBinder",As),qe("SourceExpressionBinder",wr),qe("CrossFadedCompositeBinder",br),qe("CompositeExpressionBinder",Wn),qe("ProgramConfiguration",Cu,{omit:["_buffers"]}),qe("ProgramConfigurationSet",Vr);const bi=8192,Sp=Math.pow(2,14)-1,Rg=-Sp-1;function ia(n){const e=bi/n.extent,r=n.loadGeometry();for(let a=0;a<r.length;a++){const h=r[a];for(let f=0;f<h.length;f++){const g=h[f],v=Math.round(g.x*e),b=Math.round(g.y*e);g.x=Oe(v,Rg,Sp),g.y=Oe(b,Rg,Sp),(v<g.x||v>g.x+1||b<g.y||b>g.y+1)&&Di("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function na(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?ia(n):[]}}function xh(n,e,r,a,h){n.emplaceBack(2*e+(a+1)/2,2*r+(h+1)/2)}class Tp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xe,this.indexArray=new Oi,this.segments=new Wt,this.programConfigurations=new Vr(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){const h=this.layers[0],f=[];let g=null,v=!1;h.type==="circle"&&(g=h.layout.get("circle-sort-key"),v=!g.isConstant());for(const{feature:b,id:k,index:E,sourceLayerIndex:z}of e){const L=this.layers[0]._featureFilter.needGeometry,B=na(b,L);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),B,a))continue;const O=v?g.evaluate(B,{},a):void 0,j={id:k,properties:b.properties,type:b.type,sourceLayerIndex:z,index:E,geometry:L?B.geometry:ia(b),patterns:{},sortKey:O};f.push(j)}v&&f.sort((b,k)=>b.sortKey-k.sortKey);for(const b of f){const{geometry:k,index:E,sourceLayerIndex:z}=b,L=e[E].feature;this.addFeature(b,k,E,a),r.featureIndex.insert(L,k,E,z,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,a,h){for(const f of r)for(const g of f){const v=g.x,b=g.y;if(v<0||v>=bi||b<0||b>=bi)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),E=k.vertexLength;xh(this.layoutVertexArray,v,b,-1,-1),xh(this.layoutVertexArray,v,b,1,-1),xh(this.layoutVertexArray,v,b,1,1),xh(this.layoutVertexArray,v,b,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h)}}function Fg(n,e){for(let r=0;r<n.length;r++)if(Qa(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(Qa(n,e[r]))return!0;return!!kp(n,e)}function n1(n,e,r){return!!Qa(n,e)||!!Cp(e,n,r)}function Bg(n,e){if(n.length===1)return Ng(e,n[0]);for(let r=0;r<e.length;r++){const a=e[r];for(let h=0;h<a.length;h++)if(Qa(n,a[h]))return!0}for(let r=0;r<n.length;r++)if(Ng(e,n[r]))return!0;for(let r=0;r<e.length;r++)if(kp(n,e[r]))return!0;return!1}function r1(n,e,r){if(n.length>1){if(kp(n,e))return!0;for(let a=0;a<e.length;a++)if(Cp(e[a],n,r))return!0}for(let a=0;a<n.length;a++)if(Cp(n[a],e,r))return!0;return!1}function kp(n,e){if(n.length===0||e.length===0)return!1;for(let r=0;r<n.length-1;r++){const a=n[r],h=n[r+1];for(let f=0;f<e.length-1;f++)if(s1(a,h,e[f],e[f+1]))return!0}return!1}function s1(n,e,r,a){return Ji(n,r,a)!==Ji(e,r,a)&&Ji(n,e,r)!==Ji(n,e,a)}function Cp(n,e,r){const a=r*r;if(e.length===1)return n.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(Og(n,e[h-1],e[h])<a)return!0;return!1}function Og(n,e,r){const a=e.distSqr(r);if(a===0)return n.distSqr(e);const h=((n.x-e.x)*(r.x-e.x)+(n.y-e.y)*(r.y-e.y))/a;return n.distSqr(h<0?e:h>1?r:r.sub(e)._mult(h)._add(e))}function Ng(n,e){let r,a,h,f=!1;for(let g=0;g<n.length;g++){r=n[g];for(let v=0,b=r.length-1;v<r.length;b=v++)a=r[v],h=r[b],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(f=!f)}return f}function Qa(n,e){let r=!1;for(let a=0,h=n.length-1;a<n.length;h=a++){const f=n[a],g=n[h];f.y>e.y!=g.y>e.y&&e.x<(g.x-f.x)*(e.y-f.y)/(g.y-f.y)+f.x&&(r=!r)}return r}function o1(n,e,r){const a=r[0],h=r[2];if(n.x<a.x&&e.x<a.x||n.x>h.x&&e.x>h.x||n.y<a.y&&e.y<a.y||n.y>h.y&&e.y>h.y)return!1;const f=Ji(n,e,r[0]);return f!==Ji(n,e,r[1])||f!==Ji(n,e,r[2])||f!==Ji(n,e,r[3])}function Eu(n,e,r){const a=e.paint.get(n).value;return a.kind==="constant"?a.value:r.programConfigurations.get(e.id).getMaxValue(n)}function wh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function bh(n,e,r,a,h){if(!e[0]&&!e[1])return n;const f=te.convert(e)._mult(h);r==="viewport"&&f._rotate(-a);const g=[];for(let v=0;v<n.length;v++)g.push(n[v].sub(f));return g}let Vg,Ug;qe("CircleBucket",Tp,{omit:["layers"]});var a1={get paint(){return Ug=Ug||new mi({"circle-radius":new ot(ye.paint_circle["circle-radius"]),"circle-color":new ot(ye.paint_circle["circle-color"]),"circle-blur":new ot(ye.paint_circle["circle-blur"]),"circle-opacity":new ot(ye.paint_circle["circle-opacity"]),"circle-translate":new Je(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Je(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Je(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Je(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ot(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ot(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ot(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return Vg=Vg||new mi({"circle-sort-key":new ot(ye.layout_circle["circle-sort-key"])})}},gn=1e-6,Ja=typeof Float32Array<"u"?Float32Array:Array;function Ep(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function jg(n,e,r){var a=e[0],h=e[1],f=e[2],g=e[3],v=e[4],b=e[5],k=e[6],E=e[7],z=e[8],L=e[9],B=e[10],O=e[11],j=e[12],W=e[13],Q=e[14],ue=e[15],ie=r[0],he=r[1],fe=r[2],be=r[3];return n[0]=ie*a+he*v+fe*z+be*j,n[1]=ie*h+he*b+fe*L+be*W,n[2]=ie*f+he*k+fe*B+be*Q,n[3]=ie*g+he*E+fe*O+be*ue,n[4]=(ie=r[4])*a+(he=r[5])*v+(fe=r[6])*z+(be=r[7])*j,n[5]=ie*h+he*b+fe*L+be*W,n[6]=ie*f+he*k+fe*B+be*Q,n[7]=ie*g+he*E+fe*O+be*ue,n[8]=(ie=r[8])*a+(he=r[9])*v+(fe=r[10])*z+(be=r[11])*j,n[9]=ie*h+he*b+fe*L+be*W,n[10]=ie*f+he*k+fe*B+be*Q,n[11]=ie*g+he*E+fe*O+be*ue,n[12]=(ie=r[12])*a+(he=r[13])*v+(fe=r[14])*z+(be=r[15])*j,n[13]=ie*h+he*b+fe*L+be*W,n[14]=ie*f+he*k+fe*B+be*Q,n[15]=ie*g+he*E+fe*O+be*ue,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Iu,l1=jg;function Sh(n,e,r){var a=e[0],h=e[1],f=e[2],g=e[3];return n[0]=r[0]*a+r[4]*h+r[8]*f+r[12]*g,n[1]=r[1]*a+r[5]*h+r[9]*f+r[13]*g,n[2]=r[2]*a+r[6]*h+r[10]*f+r[14]*g,n[3]=r[3]*a+r[7]*h+r[11]*f+r[15]*g,n}Iu=new Ja(4),Ja!=Float32Array&&(Iu[0]=0,Iu[1]=0,Iu[2]=0,Iu[3]=0);class u1 extends Hn{constructor(e){super(e,a1)}createBucket(e){return new Tp(e)}queryRadius(e){const r=e;return Eu("circle-radius",this,r)+Eu("circle-stroke-width",this,r)+wh(this.paint.get("circle-translate"))}queryIntersectsFeature(e,r,a,h,f,g,v,b){const k=bh(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,v),E=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a),z=this.paint.get("circle-pitch-alignment")==="map",L=z?k:function(O,j){return O.map(W=>$g(W,j))}(k,b),B=z?E*v:E;for(const O of h)for(const j of O){const W=z?j:$g(j,b);let Q=B;const ue=Sh([],[j.x,j.y,0,1],b);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=ue[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=g.cameraToCenterDistance/ue[3]),n1(L,W,Q))return!0}return!1}}function $g(n,e){const r=Sh([],[n.x,n.y,0,1],e);return new te(r[0]/r[3],r[1]/r[3])}class qg extends Tp{}let Zg;qe("HeatmapBucket",qg,{omit:["layers"]});var c1={get paint(){return Zg=Zg||new mi({"heatmap-radius":new ot(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ot(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Je(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new vu(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Je(ye.paint_heatmap["heatmap-opacity"])})}};function Ip(n,{width:e,height:r},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*r*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*r*a}`)}else h=new Uint8Array(e*r*a);return n.width=e,n.height=r,n.data=h,n}function Gg(n,{width:e,height:r},a){if(e===n.width&&r===n.height)return;const h=Ip({},{width:e,height:r},a);Pp(n,h,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,r)},a),n.width=e,n.height=r,n.data=h.data}function Pp(n,e,r,a,h,f){if(h.width===0||h.height===0)return e;if(h.width>n.width||h.height>n.height||r.x>n.width-h.width||r.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,v=e.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<h.height;b++){const k=((r.y+b)*n.width+r.x)*f,E=((a.y+b)*e.width+a.x)*f;for(let z=0;z<h.width*f;z++)v[E+z]=g[k+z]}return e}class Pu{constructor(e,r){Ip(this,e,1,r)}resize(e){Gg(this,e,1)}clone(){return new Pu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,f){Pp(e,r,a,h,f,1)}}class rr{constructor(e,r){Ip(this,e,4,r)}resize(e){Gg(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new rr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,h,f){Pp(e,r,a,h,f,4)}}function Hg(n){const e={},r=n.resolution||256,a=n.clips?n.clips.length:1,h=n.image||new rr({width:r,height:a});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const f=(g,v,b)=>{e[n.evaluationKey]=b;const k=n.expression.evaluate(e);h.data[g+v+0]=Math.floor(255*k.r/k.a),h.data[g+v+1]=Math.floor(255*k.g/k.a),h.data[g+v+2]=Math.floor(255*k.b/k.a),h.data[g+v+3]=Math.floor(255*k.a)};if(n.clips)for(let g=0,v=0;g<a;++g,v+=4*r)for(let b=0,k=0;b<r;b++,k+=4){const E=b/(r-1),{start:z,end:L}=n.clips[g];f(v,k,z*(1-E)+L*E)}else for(let g=0,v=0;g<r;g++,v+=4)f(0,v,g/(r-1));return h}qe("AlphaImage",Pu),qe("RGBAImage",rr);class h1 extends Hn{createBucket(e){return new qg(e)}constructor(e){super(e,c1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Hg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Wg;var d1={get paint(){return Wg=Wg||new mi({"hillshade-illumination-direction":new Je(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Je(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Je(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Je(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Je(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Je(ye.paint_hillshade["hillshade-accent-color"])})}};class p1 extends Hn{constructor(e){super(e,d1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const f1=ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:m1}=f1;var Mp={exports:{}};function Th(n,e,r){r=r||2;var a,h,f,g,v,b,k,E=e&&e.length,z=E?e[0]*r:n.length,L=Xg(n,0,z,r,!0),B=[];if(!L||L.next===L.prev)return B;if(E&&(L=function(j,W,Q,ue){var ie,he,fe,be=[];for(ie=0,he=W.length;ie<he;ie++)(fe=Xg(j,W[ie]*ue,ie<he-1?W[ie+1]*ue:j.length,ue,!1))===fe.next&&(fe.steiner=!0),be.push(S1(fe));for(be.sort(x1),ie=0;ie<be.length;ie++)Q=w1(be[ie],Q);return Q}(n,e,L,r)),n.length>80*r){a=f=n[0],h=g=n[1];for(var O=r;O<z;O+=r)(v=n[O])<a&&(a=v),(b=n[O+1])<h&&(h=b),v>f&&(f=v),b>g&&(g=b);k=(k=Math.max(f-a,g-h))!==0?32767/k:0}return Mu(L,B,r,a,h,k,0),B}function Xg(n,e,r,a,h){var f,g;if(h===Lp(n,e,r,a)>0)for(f=e;f<r;f+=a)g=Qg(f,n[f],n[f+1],g);else for(f=r-a;f>=e;f-=a)g=Qg(f,n[f],n[f+1],g);return g&&kh(g,g.next)&&(Au(g),g=g.next),g}function ra(n,e){if(!n)return n;e||(e=n);var r,a=n;do if(r=!1,a.steiner||!kh(a,a.next)&&yi(a.prev,a,a.next)!==0)a=a.next;else{if(Au(a),(a=e=a.prev)===a.next)break;r=!0}while(r||a!==e);return e}function Mu(n,e,r,a,h,f,g){if(n){!g&&f&&function(E,z,L,B){var O=E;do O.z===0&&(O.z=zp(O.x,O.y,z,L,B)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==E);O.prevZ.nextZ=null,O.prevZ=null,function(j){var W,Q,ue,ie,he,fe,be,$e,Ke=1;do{for(Q=j,j=null,he=null,fe=0;Q;){for(fe++,ue=Q,be=0,W=0;W<Ke&&(be++,ue=ue.nextZ);W++);for($e=Ke;be>0||$e>0&&ue;)be!==0&&($e===0||!ue||Q.z<=ue.z)?(ie=Q,Q=Q.nextZ,be--):(ie=ue,ue=ue.nextZ,$e--),he?he.nextZ=ie:j=ie,ie.prevZ=he,he=ie;Q=ue}he.nextZ=null,Ke*=2}while(fe>1)}(O)}(n,a,h,f);for(var v,b,k=n;n.prev!==n.next;)if(v=n.prev,b=n.next,f?y1(n,a,h,f):g1(n))e.push(v.i/r|0),e.push(n.i/r|0),e.push(b.i/r|0),Au(n),n=b.next,k=b.next;else if((n=b)===k){g?g===1?Mu(n=_1(ra(n),e,r),e,r,a,h,f,2):g===2&&v1(n,e,r,a,h,f):Mu(ra(n),e,r,a,h,f,1);break}}}function g1(n){var e=n.prev,r=n,a=n.next;if(yi(e,r,a)>=0)return!1;for(var h=e.x,f=r.x,g=a.x,v=e.y,b=r.y,k=a.y,E=h<f?h<g?h:g:f<g?f:g,z=v<b?v<k?v:k:b<k?b:k,L=h>f?h>g?h:g:f>g?f:g,B=v>b?v>k?v:k:b>k?b:k,O=a.next;O!==e;){if(O.x>=E&&O.x<=L&&O.y>=z&&O.y<=B&&el(h,v,f,b,g,k,O.x,O.y)&&yi(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function y1(n,e,r,a){var h=n.prev,f=n,g=n.next;if(yi(h,f,g)>=0)return!1;for(var v=h.x,b=f.x,k=g.x,E=h.y,z=f.y,L=g.y,B=v<b?v<k?v:k:b<k?b:k,O=E<z?E<L?E:L:z<L?z:L,j=v>b?v>k?v:k:b>k?b:k,W=E>z?E>L?E:L:z>L?z:L,Q=zp(B,O,e,r,a),ue=zp(j,W,e,r,a),ie=n.prevZ,he=n.nextZ;ie&&ie.z>=Q&&he&&he.z<=ue;){if(ie.x>=B&&ie.x<=j&&ie.y>=O&&ie.y<=W&&ie!==h&&ie!==g&&el(v,E,b,z,k,L,ie.x,ie.y)&&yi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,he.x>=B&&he.x<=j&&he.y>=O&&he.y<=W&&he!==h&&he!==g&&el(v,E,b,z,k,L,he.x,he.y)&&yi(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;ie&&ie.z>=Q;){if(ie.x>=B&&ie.x<=j&&ie.y>=O&&ie.y<=W&&ie!==h&&ie!==g&&el(v,E,b,z,k,L,ie.x,ie.y)&&yi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;he&&he.z<=ue;){if(he.x>=B&&he.x<=j&&he.y>=O&&he.y<=W&&he!==h&&he!==g&&el(v,E,b,z,k,L,he.x,he.y)&&yi(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function _1(n,e,r){var a=n;do{var h=a.prev,f=a.next.next;!kh(h,f)&&Kg(h,a,a.next,f)&&zu(h,f)&&zu(f,h)&&(e.push(h.i/r|0),e.push(a.i/r|0),e.push(f.i/r|0),Au(a),Au(a.next),a=n=f),a=a.next}while(a!==n);return ra(a)}function v1(n,e,r,a,h,f){var g=n;do{for(var v=g.next.next;v!==g.prev;){if(g.i!==v.i&&T1(g,v)){var b=Yg(g,v);return g=ra(g,g.next),b=ra(b,b.next),Mu(g,e,r,a,h,f,0),void Mu(b,e,r,a,h,f,0)}v=v.next}g=g.next}while(g!==n)}function x1(n,e){return n.x-e.x}function w1(n,e){var r=function(h,f){var g,v=f,b=h.x,k=h.y,E=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){var z=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(z<=b&&z>E&&(E=z,g=v.x<v.next.x?v:v.next,z===b))return g}v=v.next}while(v!==f);if(!g)return null;var L,B=g,O=g.x,j=g.y,W=1/0;v=g;do b>=v.x&&v.x>=O&&b!==v.x&&el(k<j?b:E,k,O,j,k<j?E:b,k,v.x,v.y)&&(L=Math.abs(k-v.y)/(b-v.x),zu(v,h)&&(L<W||L===W&&(v.x>g.x||v.x===g.x&&b1(g,v)))&&(g=v,W=L)),v=v.next;while(v!==B);return g}(n,e);if(!r)return e;var a=Yg(r,n);return ra(a,a.next),ra(r,r.next)}function b1(n,e){return yi(n.prev,n,e.prev)<0&&yi(e.next,n,n.next)<0}function zp(n,e,r,a,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function S1(n){var e=n,r=n;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==n);return r}function el(n,e,r,a,h,f,g,v){return(h-g)*(e-v)>=(n-g)*(f-v)&&(n-g)*(a-v)>=(r-g)*(e-v)&&(r-g)*(f-v)>=(h-g)*(a-v)}function T1(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(r,a){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==a.i&&h.next.i!==a.i&&Kg(h,h.next,r,a))return!0;h=h.next}while(h!==r);return!1}(n,e)&&(zu(n,e)&&zu(e,n)&&function(r,a){var h=r,f=!1,g=(r.x+a.x)/2,v=(r.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&g<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==r);return f}(n,e)&&(yi(n.prev,n,e.prev)||yi(n,e.prev,e))||kh(n,e)&&yi(n.prev,n,n.next)>0&&yi(e.prev,e,e.next)>0)}function yi(n,e,r){return(e.y-n.y)*(r.x-e.x)-(e.x-n.x)*(r.y-e.y)}function kh(n,e){return n.x===e.x&&n.y===e.y}function Kg(n,e,r,a){var h=Eh(yi(n,e,r)),f=Eh(yi(n,e,a)),g=Eh(yi(r,a,n)),v=Eh(yi(r,a,e));return h!==f&&g!==v||!(h!==0||!Ch(n,r,e))||!(f!==0||!Ch(n,a,e))||!(g!==0||!Ch(r,n,a))||!(v!==0||!Ch(r,e,a))}function Ch(n,e,r){return e.x<=Math.max(n.x,r.x)&&e.x>=Math.min(n.x,r.x)&&e.y<=Math.max(n.y,r.y)&&e.y>=Math.min(n.y,r.y)}function Eh(n){return n>0?1:n<0?-1:0}function zu(n,e){return yi(n.prev,n,n.next)<0?yi(n,e,n.next)>=0&&yi(n,n.prev,e)>=0:yi(n,e,n.prev)<0||yi(n,n.next,e)<0}function Yg(n,e){var r=new Ap(n.i,n.x,n.y),a=new Ap(e.i,e.x,e.y),h=n.next,f=e.prev;return n.next=e,e.prev=n,r.next=h,h.prev=r,a.next=r,r.prev=a,f.next=a,a.prev=f,a}function Qg(n,e,r,a){var h=new Ap(n,e,r);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function Au(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Ap(n,e,r){this.i=n,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lp(n,e,r,a){for(var h=0,f=e,g=r-a;f<r;f+=a)h+=(n[g]-n[f])*(n[f+1]+n[g+1]),g=f;return h}Mp.exports=Th,Mp.exports.default=Th,Th.deviation=function(n,e,r,a){var h=e&&e.length,f=Math.abs(Lp(n,0,h?e[0]*r:n.length,r));if(h)for(var g=0,v=e.length;g<v;g++)f-=Math.abs(Lp(n,e[g]*r,g<v-1?e[g+1]*r:n.length,r));var b=0;for(g=0;g<a.length;g+=3){var k=a[g]*r,E=a[g+1]*r,z=a[g+2]*r;b+=Math.abs((n[k]-n[z])*(n[E+1]-n[k+1])-(n[k]-n[E])*(n[z+1]-n[k+1]))}return f===0&&b===0?0:Math.abs((b-f)/f)},Th.flatten=function(n){for(var e=n[0][0].length,r={vertices:[],holes:[],dimensions:e},a=0,h=0;h<n.length;h++){for(var f=0;f<n[h].length;f++)for(var g=0;g<e;g++)r.vertices.push(n[h][f][g]);h>0&&r.holes.push(a+=n[h-1].length)}return r};var Jg=R(Mp.exports);function k1(n,e,r,a,h){ey(n,e,r||0,a||n.length-1,h||C1)}function ey(n,e,r,a,h){for(;a>r;){if(a-r>600){var f=a-r+1,g=e-r+1,v=Math.log(f),b=.5*Math.exp(2*v/3),k=.5*Math.sqrt(v*b*(f-b)/f)*(g-f/2<0?-1:1);ey(n,e,Math.max(r,Math.floor(e-g*b/f+k)),Math.min(a,Math.floor(e+(f-g)*b/f+k)),h)}var E=n[e],z=r,L=a;for(Lu(n,r,e),h(n[a],E)>0&&Lu(n,r,a);z<L;){for(Lu(n,z,L),z++,L--;h(n[z],E)<0;)z++;for(;h(n[L],E)>0;)L--}h(n[r],E)===0?Lu(n,r,L):Lu(n,++L,a),L<=e&&(r=L+1),e<=L&&(a=L-1)}}function Lu(n,e,r){var a=n[e];n[e]=n[r],n[r]=a}function C1(n,e){return n<e?-1:n>e?1:0}function Dp(n,e){const r=n.length;if(r<=1)return[n];const a=[];let h,f;for(let g=0;g<r;g++){const v=kn(n[g]);v!==0&&(n[g].area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(h&&a.push(h),h=[n[g]]):h.push(n[g]))}if(h&&a.push(h),e>1)for(let g=0;g<a.length;g++)a[g].length<=e||(k1(a[g],e,1,a[g].length-1,E1),a[g]=a[g].slice(0,e));return a}function E1(n,e){return e.area-n.area}function Rp(n,e,r){const a=r.patternDependencies;let h=!1;for(const f of e){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(h=!0);const v=g.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function Fp(n,e,r,a,h){const f=h.patternDependencies;for(const g of e){const v=g.paint.get(`${n}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:a-1},r,{},h.availableImages),k=v.evaluate({zoom:a},r,{},h.availableImages),E=v.evaluate({zoom:a+1},r,{},h.availableImages);b=b&&b.name?b.name:b,k=k&&k.name?k.name:k,E=E&&E.name?E.name:E,f[b]=!0,f[k]=!0,f[E]=!0,r.patterns[g.id]={min:b,mid:k,max:E}}}return r}class Bp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new xt,this.indexArray=new Oi,this.indexArray2=new ki,this.programConfigurations=new Vr(e.layers,e.zoom),this.segments=new Wt,this.segments2=new Wt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.hasPattern=Rp("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),f=!h.isConstant(),g=[];for(const{feature:v,id:b,index:k,sourceLayerIndex:E}of e){const z=this.layers[0]._featureFilter.needGeometry,L=na(v,z);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),L,a))continue;const B=f?h.evaluate(L,{},a,r.availableImages):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:E,index:k,geometry:z?L.geometry:ia(v),patterns:{},sortKey:B};g.push(O)}f&&g.sort((v,b)=>v.sortKey-b.sortKey);for(const v of g){const{geometry:b,index:k,sourceLayerIndex:E}=v;if(this.hasPattern){const z=Fp("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(z)}else this.addFeature(v,b,k,a,{});r.featureIndex.insert(e[k].feature,b,k,E,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}addFeatures(e,r,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,m1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,a,h,f){for(const g of Dp(r,500)){let v=0;for(const B of g)v+=B.length;const b=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),k=b.vertexLength,E=[],z=[];for(const B of g){if(B.length===0)continue;B!==g[0]&&z.push(E.length/2);const O=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),j=O.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(j+B.length-1,j),E.push(B[0].x),E.push(B[0].y);for(let W=1;W<B.length;W++)this.layoutVertexArray.emplaceBack(B[W].x,B[W].y),this.indexArray2.emplaceBack(j+W-1,j+W),E.push(B[W].x),E.push(B[W].y);O.vertexLength+=B.length,O.primitiveLength+=B.length}const L=Jg(E,z);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(k+L[B],k+L[B+1],k+L[B+2]);b.vertexLength+=v,b.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)}}let ty,iy;qe("FillBucket",Bp,{omit:["layers","patternFeatures"]});var I1={get paint(){return iy=iy||new mi({"fill-antialias":new Je(ye.paint_fill["fill-antialias"]),"fill-opacity":new ot(ye.paint_fill["fill-opacity"]),"fill-color":new ot(ye.paint_fill["fill-color"]),"fill-outline-color":new ot(ye.paint_fill["fill-outline-color"]),"fill-translate":new Je(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Je(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new Jo(ye.paint_fill["fill-pattern"])})},get layout(){return ty=ty||new mi({"fill-sort-key":new ot(ye.layout_fill["fill-sort-key"])})}};class P1 extends Hn{constructor(e){super(e,I1)}recalculate(e,r){super.recalculate(e,r);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Bp(e)}queryRadius(){return wh(this.paint.get("fill-translate"))}queryIntersectsFeature(e,r,a,h,f,g,v){return Bg(bh(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,v),h)}isTileClipped(){return!0}}const M1=ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),z1=ti([{name:"a_centroid",components:2,type:"Int16"}],4),{members:A1}=M1;var co={},L1=re,ny=tl;function tl(n,e,r,a,h){this.properties={},this.extent=r,this.type=0,this._pbf=n,this._geometry=-1,this._keys=a,this._values=h,n.readFields(D1,this,e)}function D1(n,e,r){n==1?e.id=r.readVarint():n==2?function(a,h){for(var f=a.readVarint()+a.pos;a.pos<f;){var g=h._keys[a.readVarint()],v=h._values[a.readVarint()];h.properties[g]=v}}(r,e):n==3?e.type=r.readVarint():n==4&&(e._geometry=r.pos)}function R1(n){for(var e,r,a=0,h=0,f=n.length,g=f-1;h<f;g=h++)a+=((r=n[g]).x-(e=n[h]).x)*(e.y+r.y);return a}tl.types=["Unknown","Point","LineString","Polygon"],tl.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,r=n.readVarint()+n.pos,a=1,h=0,f=0,g=0,v=[];n.pos<r;){if(h<=0){var b=n.readVarint();a=7&b,h=b>>3}if(h--,a===1||a===2)f+=n.readSVarint(),g+=n.readSVarint(),a===1&&(e&&v.push(e),e=[]),e.push(new L1(f,g));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&v.push(e),v},tl.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,r=1,a=0,h=0,f=0,g=1/0,v=-1/0,b=1/0,k=-1/0;n.pos<e;){if(a<=0){var E=n.readVarint();r=7&E,a=E>>3}if(a--,r===1||r===2)(h+=n.readSVarint())<g&&(g=h),h>v&&(v=h),(f+=n.readSVarint())<b&&(b=f),f>k&&(k=f);else if(r!==7)throw new Error("unknown command "+r)}return[g,b,v,k]},tl.prototype.toGeoJSON=function(n,e,r){var a,h,f=this.extent*Math.pow(2,r),g=this.extent*n,v=this.extent*e,b=this.loadGeometry(),k=tl.types[this.type];function E(B){for(var O=0;O<B.length;O++){var j=B[O];B[O]=[360*(j.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(a=0;a<b.length;a++)z[a]=b[a][0];E(b=z);break;case 2:for(a=0;a<b.length;a++)E(b[a]);break;case 3:for(b=function(B){var O=B.length;if(O<=1)return[B];for(var j,W,Q=[],ue=0;ue<O;ue++){var ie=R1(B[ue]);ie!==0&&(W===void 0&&(W=ie<0),W===ie<0?(j&&Q.push(j),j=[B[ue]]):j.push(B[ue]))}return j&&Q.push(j),Q}(b),a=0;a<b.length;a++)for(h=0;h<b[a].length;h++)E(b[a][h])}b.length===1?b=b[0]:k="Multi"+k;var L={type:"Feature",geometry:{type:k,coordinates:b},properties:this.properties};return"id"in this&&(L.id=this.id),L};var F1=ny,ry=sy;function sy(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(B1,this,e),this.length=this._features.length}function B1(n,e,r){n===15?e.version=r.readVarint():n===1?e.name=r.readString():n===5?e.extent=r.readVarint():n===2?e._features.push(r.pos):n===3?e._keys.push(r.readString()):n===4&&e._values.push(function(a){for(var h=null,f=a.readVarint()+a.pos;a.pos<f;){var g=a.readVarint()>>3;h=g===1?a.readString():g===2?a.readFloat():g===3?a.readDouble():g===4?a.readVarint64():g===5?a.readVarint():g===6?a.readSVarint():g===7?a.readBoolean():null}return h}(r))}sy.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new F1(this._pbf,e,this.extent,this._keys,this._values)};var O1=ry;function N1(n,e,r){if(n===3){var a=new O1(r,r.readVarint()+r.pos);a.length&&(e[a.name]=a)}}co.VectorTile=function(n,e){this.layers=n.readFields(N1,{},e)},co.VectorTileFeature=ny,co.VectorTileLayer=ry;const V1=co.VectorTileFeature.types,Op=Math.pow(2,13);function Du(n,e,r,a,h,f,g,v){n.emplaceBack(e,r,2*Math.floor(a*Op)+g,h*Op*2,f*Op*2,Math.round(v))}class Np{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ne,this.centroidVertexArray=new Ie,this.indexArray=new Oi,this.programConfigurations=new Vr(e.layers,e.zoom),this.segments=new Wt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.features=[],this.hasPattern=Rp("fill-extrusion",this.layers,r);for(const{feature:h,id:f,index:g,sourceLayerIndex:v}of e){const b=this.layers[0]._featureFilter.needGeometry,k=na(h,b);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),k,a))continue;const E={id:f,sourceLayerIndex:v,index:g,geometry:b?k.geometry:ia(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Fp("fill-extrusion",this.layers,E,this.zoom,r)):this.addFeature(E,E.geometry,g,a,{}),r.featureIndex.insert(h,E.geometry,g,v,this.index,!0)}}addFeatures(e,r,a){for(const h of this.features){const{geometry:f}=h;this.addFeature(h,f,h.index,r,a)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,A1),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,z1.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,a,h,f){const g={x:0,y:0,vertexCount:0};for(const v of Dp(r,500)){let b=0;for(const O of v)b+=O.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const O of v){if(O.length===0||j1(O))continue;let j=0;for(let W=0;W<O.length;W++){const Q=O[W];if(W>=1){const ue=O[W-1];if(!U1(Q,ue)){k.vertexLength+4>Wt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=Q.sub(ue)._perp()._unit(),he=ue.dist(Q);j+he>32768&&(j=0),Du(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,0,j),Du(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,1,j),g.x+=2*Q.x,g.y+=2*Q.y,g.vertexCount+=2,j+=he,Du(this.layoutVertexArray,ue.x,ue.y,ie.x,ie.y,0,0,j),Du(this.layoutVertexArray,ue.x,ue.y,ie.x,ie.y,0,1,j),g.x+=2*ue.x,g.y+=2*ue.y,g.vertexCount+=2;const fe=k.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+b>Wt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),V1[e.type]!=="Polygon")continue;const E=[],z=[],L=k.vertexLength;for(const O of v)if(O.length!==0){O!==v[0]&&z.push(E.length/2);for(let j=0;j<O.length;j++){const W=O[j];Du(this.layoutVertexArray,W.x,W.y,0,0,1,1,0),g.x+=W.x,g.y+=W.y,g.vertexCount+=1,E.push(W.x),E.push(W.y)}}const B=Jg(E,z);for(let O=0;O<B.length;O+=3)this.indexArray.emplaceBack(L+B[O],L+B[O+2],L+B[O+1]);k.primitiveLength+=B.length/3,k.vertexLength+=b}for(let v=0;v<g.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(g.x/g.vertexCount),Math.floor(g.y/g.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)}}function U1(n,e){return n.x===e.x&&(n.x<0||n.x>bi)||n.y===e.y&&(n.y<0||n.y>bi)}function j1(n){return n.every(e=>e.x<0)||n.every(e=>e.x>bi)||n.every(e=>e.y<0)||n.every(e=>e.y>bi)}let oy;qe("FillExtrusionBucket",Np,{omit:["layers","features"]});var $1={get paint(){return oy=oy||new mi({"fill-extrusion-opacity":new Je(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ot(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Je(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Je(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Jo(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ot(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ot(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Je(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class q1 extends Hn{constructor(e){super(e,$1)}createBucket(e){return new Np(e)}queryRadius(){return wh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,r,a,h,f,g,v,b){const k=bh(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,v),E=this.paint.get("fill-extrusion-height").evaluate(r,a),z=this.paint.get("fill-extrusion-base").evaluate(r,a),L=function(O,j,W,Q){const ue=[];for(const ie of O){const he=[ie.x,ie.y,0,1];Sh(he,he,j),ue.push(new te(he[0]/he[3],he[1]/he[3]))}return ue}(k,b),B=function(O,j,W,Q){const ue=[],ie=[],he=Q[8]*j,fe=Q[9]*j,be=Q[10]*j,$e=Q[11]*j,Ke=Q[8]*W,Ue=Q[9]*W,Ve=Q[10]*W,ze=Q[11]*W;for(const Ze of O){const De=[],Ee=[];for(const nt of Ze){const Qe=nt.x,_t=nt.y,Xt=Q[0]*Qe+Q[4]*_t+Q[12],Yt=Q[1]*Qe+Q[5]*_t+Q[13],Ii=Q[2]*Qe+Q[6]*_t+Q[14],Xn=Q[3]*Qe+Q[7]*_t+Q[15],yn=Ii+be,Si=Xn+$e,Vi=Xt+Ke,Xi=Yt+Ue,_n=Ii+Ve,vn=Xn+ze,Pi=new te((Xt+he)/Si,(Yt+fe)/Si);Pi.z=yn/Si,De.push(Pi);const Mi=new te(Vi/vn,Xi/vn);Mi.z=_n/vn,Ee.push(Mi)}ue.push(De),ie.push(Ee)}return[ue,ie]}(h,z,E,b);return function(O,j,W){let Q=1/0;Bg(W,j)&&(Q=ay(W,j[0]));for(let ue=0;ue<j.length;ue++){const ie=j[ue],he=O[ue];for(let fe=0;fe<ie.length-1;fe++){const be=ie[fe],$e=[be,ie[fe+1],he[fe+1],he[fe],be];Fg(W,$e)&&(Q=Math.min(Q,ay(W,$e)))}}return Q!==1/0&&Q}(B[0],B[1],L)}}function Ru(n,e){return n.x*e.x+n.y*e.y}function ay(n,e){if(n.length===1){let r=0;const a=e[r++];let h;for(;!h||a.equals(h);)if(h=e[r++],!h)return 1/0;for(;r<e.length;r++){const f=e[r],g=n[0],v=h.sub(a),b=f.sub(a),k=g.sub(a),E=Ru(v,v),z=Ru(v,b),L=Ru(b,b),B=Ru(k,v),O=Ru(k,b),j=E*L-z*z,W=(L*B-z*O)/j,Q=(E*O-z*B)/j,ue=a.z*(1-W-Q)+h.z*W+f.z*Q;if(isFinite(ue))return ue}return 1/0}{let r=1/0;for(const a of e)r=Math.min(r,a.z);return r}}const Z1=ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:G1}=Z1,H1=ti([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:W1}=H1,X1=co.VectorTileFeature.types,K1=Math.cos(Math.PI/180*37.5),ly=Math.pow(2,14)/.5;class Vp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new at,this.layoutVertexArray2=new Ye,this.indexArray=new Oi,this.programConfigurations=new Vr(e.layers,e.zoom),this.segments=new Wt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.hasPattern=Rp("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),f=!h.isConstant(),g=[];for(const{feature:v,id:b,index:k,sourceLayerIndex:E}of e){const z=this.layers[0]._featureFilter.needGeometry,L=na(v,z);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),L,a))continue;const B=f?h.evaluate(L,{},a):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:E,index:k,geometry:z?L.geometry:ia(v),patterns:{},sortKey:B};g.push(O)}f&&g.sort((v,b)=>v.sortKey-b.sortKey);for(const v of g){const{geometry:b,index:k,sourceLayerIndex:E}=v;if(this.hasPattern){const z=Fp("line",this.layers,v,this.zoom,r);this.patternFeatures.push(z)}else this.addFeature(v,b,k,a,{});r.featureIndex.insert(e[k].feature,b,k,E,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}addFeatures(e,r,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,W1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,a,h,f){const g=this.layers[0].layout,v=g.get("line-join").evaluate(e,{}),b=g.get("line-cap"),k=g.get("line-miter-limit"),E=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const z of r)this.addLine(z,e,v,b,k,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)}addLine(e,r,a,h,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=X1[r.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let k=0;for(;k<b-1&&e[k].equals(e[k+1]);)k++;if(b<(v?3:2))return;a==="bevel"&&(f=1.05);const E=this.overscaling<=16?15*bi/(512*this.overscaling):0,z=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let L,B,O,j,W;this.e1=this.e2=-1,v&&(L=e[b-2],W=e[k].sub(L)._unit()._perp());for(let Q=k;Q<b;Q++){if(O=Q===b-1?v?e[k+1]:void 0:e[Q+1],O&&e[Q].equals(O))continue;W&&(j=W),L&&(B=L),L=e[Q],W=O?O.sub(L)._unit()._perp():j,j=j||W;let ue=j.add(W);ue.x===0&&ue.y===0||ue._unit();const ie=j.x*W.x+j.y*W.y,he=ue.x*W.x+ue.y*W.y,fe=he!==0?1/he:1/0,be=2*Math.sqrt(2-2*he),$e=he<K1&&B&&O,Ke=j.x*W.y-j.y*W.x>0;if($e&&Q>k){const ze=L.dist(B);if(ze>2*E){const Ze=L.sub(L.sub(B)._mult(E/ze)._round());this.updateDistance(B,Ze),this.addCurrentVertex(Ze,j,0,0,z),B=Ze}}const Ue=B&&O;let Ve=Ue?a:v?"butt":h;if(Ue&&Ve==="round"&&(fe<g?Ve="miter":fe<=2&&(Ve="fakeround")),Ve==="miter"&&fe>f&&(Ve="bevel"),Ve==="bevel"&&(fe>2&&(Ve="flipbevel"),fe<f&&(Ve="miter")),B&&this.updateDistance(B,L),Ve==="miter")ue._mult(fe),this.addCurrentVertex(L,ue,0,0,z);else if(Ve==="flipbevel"){if(fe>100)ue=W.mult(-1);else{const ze=fe*j.add(W).mag()/j.sub(W).mag();ue._perp()._mult(ze*(Ke?-1:1))}this.addCurrentVertex(L,ue,0,0,z),this.addCurrentVertex(L,ue.mult(-1),0,0,z)}else if(Ve==="bevel"||Ve==="fakeround"){const ze=-Math.sqrt(fe*fe-1),Ze=Ke?ze:0,De=Ke?0:ze;if(B&&this.addCurrentVertex(L,j,Ze,De,z),Ve==="fakeround"){const Ee=Math.round(180*be/Math.PI/20);for(let nt=1;nt<Ee;nt++){let Qe=nt/Ee;if(Qe!==.5){const Xt=Qe-.5;Qe+=Qe*Xt*(Qe-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Xt*Xt+(.848013+ie*(.215638*ie-1.06021)))}const _t=W.sub(j)._mult(Qe)._add(j)._unit()._mult(Ke?-1:1);this.addHalfVertex(L,_t.x,_t.y,!1,Ke,0,z)}}O&&this.addCurrentVertex(L,W,-Ze,-De,z)}else if(Ve==="butt")this.addCurrentVertex(L,ue,0,0,z);else if(Ve==="square"){const ze=B?1:-1;this.addCurrentVertex(L,ue,ze,ze,z)}else Ve==="round"&&(B&&(this.addCurrentVertex(L,j,0,0,z),this.addCurrentVertex(L,j,1,1,z,!0)),O&&(this.addCurrentVertex(L,W,-1,-1,z,!0),this.addCurrentVertex(L,W,0,0,z)));if($e&&Q<b-1){const ze=L.dist(O);if(ze>2*E){const Ze=L.add(O.sub(L)._mult(E/ze)._round());this.updateDistance(L,Ze),this.addCurrentVertex(Ze,W,0,0,z),L=Ze}}}}addCurrentVertex(e,r,a,h,f,g=!1){const v=r.y*h-r.x,b=-r.y-r.x*h;this.addHalfVertex(e,r.x+r.y*a,r.y-r.x*a,g,!1,a,f),this.addHalfVertex(e,v,b,g,!0,-h,f),this.distance>ly/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,a,h,f,g))}addHalfVertex({x:e,y:r},a,h,f,g,v,b){const k=.5*(this.lineClips?this.scaledDistance*(ly-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(r<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),b.primitiveLength++),g?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}let uy,cy;qe("LineBucket",Vp,{omit:["layers","patternFeatures"]});var hy={get paint(){return cy=cy||new mi({"line-opacity":new ot(ye.paint_line["line-opacity"]),"line-color":new ot(ye.paint_line["line-color"]),"line-translate":new Je(ye.paint_line["line-translate"]),"line-translate-anchor":new Je(ye.paint_line["line-translate-anchor"]),"line-width":new ot(ye.paint_line["line-width"]),"line-gap-width":new ot(ye.paint_line["line-gap-width"]),"line-offset":new ot(ye.paint_line["line-offset"]),"line-blur":new ot(ye.paint_line["line-blur"]),"line-dasharray":new _u(ye.paint_line["line-dasharray"]),"line-pattern":new Jo(ye.paint_line["line-pattern"]),"line-gradient":new vu(ye.paint_line["line-gradient"])})},get layout(){return uy=uy||new mi({"line-cap":new Je(ye.layout_line["line-cap"]),"line-join":new ot(ye.layout_line["line-join"]),"line-miter-limit":new Je(ye.layout_line["line-miter-limit"]),"line-round-limit":new Je(ye.layout_line["line-round-limit"]),"line-sort-key":new ot(ye.layout_line["line-sort-key"])})}};class Y1 extends ot{possiblyEvaluate(e,r){return r=new Ht(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,a,h){return r=Be({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,a,h)}}let Ih;class Q1 extends Hn{constructor(e){super(e,hy),this.gradientVersion=0,Ih||(Ih=new Y1(hy.paint.properties["line-width"].specification),Ih.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof ss,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=Ih.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Vp(e)}queryRadius(e){const r=e,a=dy(Eu("line-width",this,r),Eu("line-gap-width",this,r)),h=Eu("line-offset",this,r);return a/2+Math.abs(h)+wh(this.paint.get("line-translate"))}queryIntersectsFeature(e,r,a,h,f,g,v){const b=bh(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,v),k=v/2*dy(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),E=this.paint.get("line-offset").evaluate(r,a);return E&&(h=function(z,L){const B=[];for(let O=0;O<z.length;O++){const j=z[O],W=[];for(let Q=0;Q<j.length;Q++){const ue=j[Q-1],ie=j[Q],he=j[Q+1],fe=Q===0?new te(0,0):ie.sub(ue)._unit()._perp(),be=Q===j.length-1?new te(0,0):he.sub(ie)._unit()._perp(),$e=fe._add(be)._unit(),Ke=$e.x*be.x+$e.y*be.y;Ke!==0&&$e._mult(1/Ke),W.push($e._mult(L)._add(ie))}B.push(W)}return B}(h,E*v)),function(z,L,B){for(let O=0;O<L.length;O++){const j=L[O];if(z.length>=3){for(let W=0;W<j.length;W++)if(Qa(z,j[W]))return!0}if(r1(z,j,B))return!0}return!1}(b,h,k)}isTileClipped(){return!0}}function dy(n,e){return e>0?e+2*n:n}const J1=ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ew=ti([{name:"a_projected_pos",components:3,type:"Float32"}],4);ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const tw=ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ti([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const py=ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),iw=ti([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function nw(n,e,r){return n.sections.forEach(a=>{a.text=function(h,f,g){const v=f.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Mn.applyArabicShaping&&(h=Mn.applyArabicShaping(h)),h}(a.text,e,r)}),n}ti([{name:"triangle",components:3,type:"Uint16"}]),ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ti([{type:"Float32",name:"offsetX"}]),ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ti([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Fu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ei=24,fy=Ut,my=function(n,e,r,a,h){var f,g,v=8*h-a-1,b=(1<<v)-1,k=b>>1,E=-7,z=r?h-1:0,L=r?-1:1,B=n[e+z];for(z+=L,f=B&(1<<-E)-1,B>>=-E,E+=v;E>0;f=256*f+n[e+z],z+=L,E-=8);for(g=f&(1<<-E)-1,f>>=-E,E+=a;E>0;g=256*g+n[e+z],z+=L,E-=8);if(f===0)f=1-k;else{if(f===b)return g?NaN:1/0*(B?-1:1);g+=Math.pow(2,a),f-=k}return(B?-1:1)*g*Math.pow(2,f-a)},gy=function(n,e,r,a,h,f){var g,v,b,k=8*f-h-1,E=(1<<k)-1,z=E>>1,L=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=a?0:f-1,O=a?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,g=E):(g=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-g))<1&&(g--,b*=2),(e+=g+z>=1?L/b:L*Math.pow(2,1-z))*b>=2&&(g++,b/=2),g+z>=E?(v=0,g=E):g+z>=1?(v=(e*b-1)*Math.pow(2,h),g+=z):(v=e*Math.pow(2,z-1)*Math.pow(2,h),g=0));h>=8;n[r+B]=255&v,B+=O,v/=256,h-=8);for(g=g<<h|v,k+=h;k>0;n[r+B]=255&g,B+=O,g/=256,k-=8);n[r+B-O]|=128*j};function Ut(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Ut.Varint=0,Ut.Fixed64=1,Ut.Bytes=2,Ut.Fixed32=5;var Up=4294967296,yy=1/Up,_y=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ls(n){return n.type===Ut.Bytes?n.readVarint()+n.pos:n.pos+1}function il(n,e,r){return r?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function vy(n,e,r){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(a);for(var h=r.pos-1;h>=n;h--)r.buf[h+a]=r.buf[h]}function rw(n,e){for(var r=0;r<n.length;r++)e.writeVarint(n[r])}function sw(n,e){for(var r=0;r<n.length;r++)e.writeSVarint(n[r])}function ow(n,e){for(var r=0;r<n.length;r++)e.writeFloat(n[r])}function aw(n,e){for(var r=0;r<n.length;r++)e.writeDouble(n[r])}function lw(n,e){for(var r=0;r<n.length;r++)e.writeBoolean(n[r])}function uw(n,e){for(var r=0;r<n.length;r++)e.writeFixed32(n[r])}function cw(n,e){for(var r=0;r<n.length;r++)e.writeSFixed32(n[r])}function hw(n,e){for(var r=0;r<n.length;r++)e.writeFixed64(n[r])}function dw(n,e){for(var r=0;r<n.length;r++)e.writeSFixed64(n[r])}function Ph(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function nl(n,e,r){n[r]=e,n[r+1]=e>>>8,n[r+2]=e>>>16,n[r+3]=e>>>24}function xy(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}Ut.prototype={destroy:function(){this.buf=null},readFields:function(n,e,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),h=a>>3,f=this.pos;this.type=7&a,n(h,e,this),this.pos===f&&this.skip(a)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Ph(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=xy(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Ph(this.buf,this.pos)+Ph(this.buf,this.pos+4)*Up;return this.pos+=8,n},readSFixed64:function(){var n=Ph(this.buf,this.pos)+xy(this.buf,this.pos+4)*Up;return this.pos+=8,n},readFloat:function(){var n=my(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=my(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,r,a=this.buf;return e=127&(r=a[this.pos++]),r<128?e:(e|=(127&(r=a[this.pos++]))<<7,r<128?e:(e|=(127&(r=a[this.pos++]))<<14,r<128?e:(e|=(127&(r=a[this.pos++]))<<21,r<128?e:function(h,f,g){var v,b,k=g.buf;if(v=(112&(b=k[g.pos++]))>>4,b<128||(v|=(127&(b=k[g.pos++]))<<3,b<128)||(v|=(127&(b=k[g.pos++]))<<10,b<128)||(v|=(127&(b=k[g.pos++]))<<17,b<128)||(v|=(127&(b=k[g.pos++]))<<24,b<128)||(v|=(1&(b=k[g.pos++]))<<31,b<128))return il(h,v,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=a[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&_y?function(r,a,h){return _y.decode(r.subarray(a,h))}(this.buf,e,n):function(r,a,h){for(var f="",g=a;g<h;){var v,b,k,E=r[g],z=null,L=E>239?4:E>223?3:E>191?2:1;if(g+L>h)break;L===1?E<128&&(z=E):L===2?(192&(v=r[g+1]))==128&&(z=(31&E)<<6|63&v)<=127&&(z=null):L===3?(b=r[g+2],(192&(v=r[g+1]))==128&&(192&b)==128&&((z=(15&E)<<12|(63&v)<<6|63&b)<=2047||z>=55296&&z<=57343)&&(z=null)):L===4&&(b=r[g+2],k=r[g+3],(192&(v=r[g+1]))==128&&(192&b)==128&&(192&k)==128&&((z=(15&E)<<18|(63&v)<<12|(63&b)<<6|63&k)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,L=1):z>65535&&(z-=65536,f+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),f+=String.fromCharCode(z),g+=L}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Ut.Bytes)return n.push(this.readVarint(e));var r=Ls(this);for(n=n||[];this.pos<r;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Ut.Bytes)return n.push(this.readSVarint());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Ut.Bytes)return n.push(this.readBoolean());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Ut.Bytes)return n.push(this.readFloat());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Ut.Bytes)return n.push(this.readDouble());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Ut.Bytes)return n.push(this.readFixed32());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Ut.Bytes)return n.push(this.readSFixed32());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Ut.Bytes)return n.push(this.readFixed64());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Ut.Bytes)return n.push(this.readSFixed64());var e=Ls(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===Ut.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ut.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ut.Fixed32)this.pos+=4;else{if(e!==Ut.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),nl(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),nl(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),nl(this.buf,-1&n,this.pos),nl(this.buf,Math.floor(n*yy),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),nl(this.buf,-1&n,this.pos),nl(this.buf,Math.floor(n*yy),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,r){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(f,g,v){v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7)}(a,0,r),function(f,g){var v=(7&f)<<4;g.buf[g.pos++]|=v|((f>>>=3)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f|((f>>>=7)?128:0),f&&(g.buf[g.pos++]=127&f)))))}(h,r)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(a,h,f){for(var g,v,b=0;b<h.length;b++){if((g=h.charCodeAt(b))>55295&&g<57344){if(!v){g>56319||b+1===h.length?(a[f++]=239,a[f++]=191,a[f++]=189):v=g;continue}if(g<56320){a[f++]=239,a[f++]=191,a[f++]=189,v=g;continue}g=v-55296<<10|g-56320|65536,v=null}else v&&(a[f++]=239,a[f++]=191,a[f++]=189,v=null);g<128?a[f++]=g:(g<2048?a[f++]=g>>6|192:(g<65536?a[f++]=g>>12|224:(a[f++]=g>>18|240,a[f++]=g>>12&63|128),a[f++]=g>>6&63|128),a[f++]=63&g|128)}return f}(this.buf,n,this.pos);var r=this.pos-e;r>=128&&vy(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(n){this.realloc(4),gy(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),gy(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=n[r]},writeRawMessage:function(n,e){this.pos++;var r=this.pos;n(e,this);var a=this.pos-r;a>=128&&vy(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(n,e,r){this.writeTag(n,Ut.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,rw,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,sw,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,lw,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,ow,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,aw,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,uw,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,cw,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,hw,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,dw,e)},writeBytesField:function(n,e){this.writeTag(n,Ut.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Ut.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Ut.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Ut.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Ut.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Ut.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Ut.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Ut.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Ut.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Ut.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var jp=R(fy);const $p=3;function pw(n,e,r){n===1&&r.readMessage(fw,e)}function fw(n,e,r){if(n===3){const{id:a,bitmap:h,width:f,height:g,left:v,top:b,advance:k}=r.readMessage(mw,{});e.push({id:a,bitmap:new Pu({width:f+2*$p,height:g+2*$p},h),metrics:{width:f,height:g,left:v,top:b,advance:k}})}}function mw(n,e,r){n===1?e.id=r.readVarint():n===2?e.bitmap=r.readBytes():n===3?e.width=r.readVarint():n===4?e.height=r.readVarint():n===5?e.left=r.readSVarint():n===6?e.top=r.readSVarint():n===7&&(e.advance=r.readVarint())}const wy=$p;function by(n){let e=0,r=0;for(const g of n)e+=g.w*g.h,r=Math.max(r,g.w);n.sort((g,v)=>v.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let h=0,f=0;for(const g of n)for(let v=a.length-1;v>=0;v--){const b=a[v];if(!(g.w>b.w||g.h>b.h)){if(g.x=b.x,g.y=b.y,f=Math.max(f,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===b.w&&g.h===b.h){const k=a.pop();v<a.length&&(a[v]=k)}else g.h===b.h?(b.x+=g.w,b.w-=g.w):g.w===b.w?(b.y+=g.h,b.h-=g.h):(a.push({x:b.x+g.w,y:b.y,w:b.w-g.w,h:g.h}),b.y+=g.h,b.h-=g.h);break}}return{w:h,h:f,fill:e/(h*f)||0}}const An=1;class qp{constructor(e,{pixelRatio:r,version:a,stretchX:h,stretchY:f,content:g}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=h,this.stretchY=f,this.content=g,this.version=a}get tl(){return[this.paddedRect.x+An,this.paddedRect.y+An]}get br(){return[this.paddedRect.x+this.paddedRect.w-An,this.paddedRect.y+this.paddedRect.h-An]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*An)/this.pixelRatio,(this.paddedRect.h-2*An)/this.pixelRatio]}}class Sy{constructor(e,r){const a={},h={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,a,f),this.addImages(r,h,f);const{w:g,h:v}=by(f),b=new rr({width:g||1,height:v||1});for(const k in e){const E=e[k],z=a[k].paddedRect;rr.copy(E.data,b,{x:0,y:0},{x:z.x+An,y:z.y+An},E.data)}for(const k in r){const E=r[k],z=h[k].paddedRect,L=z.x+An,B=z.y+An,O=E.data.width,j=E.data.height;rr.copy(E.data,b,{x:0,y:0},{x:L,y:B},E.data),rr.copy(E.data,b,{x:0,y:j-1},{x:L,y:B-1},{width:O,height:1}),rr.copy(E.data,b,{x:0,y:0},{x:L,y:B+j},{width:O,height:1}),rr.copy(E.data,b,{x:O-1,y:0},{x:L-1,y:B},{width:1,height:j}),rr.copy(E.data,b,{x:0,y:0},{x:L+O,y:B},{width:1,height:j})}this.image=b,this.iconPositions=a,this.patternPositions=h}addImages(e,r,a){for(const h in e){const f=e[h],g={x:0,y:0,w:f.data.width+2*An,h:f.data.height+2*An};a.push(g),r[h]=new qp(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),r)}patchUpdatedImage(e,r,a){if(!e||!r||e.version===r.version)return;e.version=r.version;const[h,f]=e.tl;a.update(r.data,void 0,{x:h,y:f})}}var ho;qe("ImagePosition",qp),qe("ImageAtlas",Sy),l.ai=void 0,(ho=l.ai||(l.ai={}))[ho.none=0]="none",ho[ho.horizontal=1]="horizontal",ho[ho.vertical=2]="vertical",ho[ho.horizontalOnly=3]="horizontalOnly";const Bu=-17;class Ou{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const a=new Ou;return a.scale=e||1,a.fontStack=r,a}static forImage(e){const r=new Ou;return r.imageName=e,r}}class rl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const a=new rl;for(let h=0;h<e.sections.length;h++){const f=e.sections[h];f.image?a.addImageSection(f):a.addTextSection(f,r)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let r="";for(let a=0;a<e.length;a++){const h=e.charCodeAt(a+1)||null,f=e.charCodeAt(a-1)||null;r+=h&&ch(h)&&!Fu[e[a+1]]||f&&ch(f)&&!Fu[e[a-1]]||!Fu[e[a]]?e[a]:Fu[e[a]]}return r}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&zh[this.text.charCodeAt(a)];a++)e++;let r=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&zh[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const a=new rl;return a.text=this.text.substring(e,r),a.sectionIndex=this.sectionIndex.slice(e,r),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Ou.forText(e.scale,e.fontStack||r));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void Di("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Ou.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Di("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Mh(n,e,r,a,h,f,g,v,b,k,E,z,L,B,O,j){const W=rl.fromFeature(n,h);let Q;z===l.ai.vertical&&W.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:ie}=Mn;if(ue&&W.sections.length===1){Q=[];const be=ue(W.toString(),Zp(W,k,f,e,a,B,O));for(const $e of be){const Ke=new rl;Ke.text=$e,Ke.sections=W.sections;for(let Ue=0;Ue<$e.length;Ue++)Ke.sectionIndex.push(0);Q.push(Ke)}}else if(ie){Q=[];const be=ie(W.text,W.sectionIndex,Zp(W,k,f,e,a,B,O));for(const $e of be){const Ke=new rl;Ke.text=$e[0],Ke.sectionIndex=$e[1],Ke.sections=W.sections,Q.push(Ke)}}else Q=function(be,$e){const Ke=[],Ue=be.text;let Ve=0;for(const ze of $e)Ke.push(be.substring(Ve,ze)),Ve=ze;return Ve<Ue.length&&Ke.push(be.substring(Ve,Ue.length)),Ke}(W,Zp(W,k,f,e,a,B,O));const he=[],fe={positionedLines:he,text:W.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(be,$e,Ke,Ue,Ve,ze,Ze,De,Ee,nt,Qe,_t){let Xt=0,Yt=Bu,Ii=0,Xn=0;const yn=De==="right"?1:De==="left"?0:.5;let Si=0;for(const Pi of Ve){Pi.trim();const Mi=Pi.getMaxScale(),rn=(Mi-1)*Ei,xn={positionedGlyphs:[],lineOffset:0};be.positionedLines[Si]=xn;const sn=xn.positionedGlyphs;let Ln=0;if(!Pi.length()){Yt+=ze,++Si;continue}for(let zi=0;zi<Pi.length();zi++){const bt=Pi.getSection(zi),on=Pi.getSectionIndex(zi),Ki=Pi.getCharCode(zi);let Ai=0,Sr=null,Ur=null,jr=null,Ds=Ei;const Tr=!(Ee===l.ai.horizontal||!Qe&&!cu(Ki)||Qe&&(zh[Ki]||(Vi=Ki,je.Arabic(Vi)||je["Arabic Supplement"](Vi)||je["Arabic Extended-A"](Vi)||je["Arabic Presentation Forms-A"](Vi)||je["Arabic Presentation Forms-B"](Vi))));if(bt.imageName){const or=Ue[bt.imageName];if(!or)continue;jr=bt.imageName,be.iconsInText=be.iconsInText||!0,Ur=or.paddedRect;const Rn=or.displaySize;bt.scale=bt.scale*Ei/_t,Sr={width:Rn[0],height:Rn[1],left:An,top:-wy,advance:Tr?Rn[1]:Rn[0]},Ai=rn+(Ei-Rn[1]*bt.scale),Ds=Sr.advance;const Rs=Tr?Rn[0]*bt.scale-Ei*Mi:Rn[1]*bt.scale-Ei*Mi;Rs>0&&Rs>Ln&&(Ln=Rs)}else{const or=Ke[bt.fontStack],Rn=or&&or[Ki];if(Rn&&Rn.rect)Ur=Rn.rect,Sr=Rn.metrics;else{const Rs=$e[bt.fontStack],$u=Rs&&Rs[Ki];if(!$u)continue;Sr=$u.metrics}Ai=(Mi-bt.scale)*Ei}Tr?(be.verticalizable=!0,sn.push({glyph:Ki,imageName:jr,x:Xt,y:Yt+Ai,vertical:Tr,scale:bt.scale,fontStack:bt.fontStack,sectionIndex:on,metrics:Sr,rect:Ur}),Xt+=Ds*bt.scale+nt):(sn.push({glyph:Ki,imageName:jr,x:Xt,y:Yt+Ai,vertical:Tr,scale:bt.scale,fontStack:bt.fontStack,sectionIndex:on,metrics:Sr,rect:Ur}),Xt+=Sr.advance*bt.scale+nt)}sn.length!==0&&(Ii=Math.max(Xt-nt,Ii),_w(sn,0,sn.length-1,yn,Ln)),Xt=0;const Dn=ze*Mi+Ln;xn.lineOffset=Math.max(Ln,rn),Yt+=Dn,Xn=Math.max(Dn,Xn),++Si}var Vi;const Xi=Yt-Bu,{horizontalAlign:_n,verticalAlign:vn}=Gp(Ze);(function(Pi,Mi,rn,xn,sn,Ln,Dn,zi,bt){const on=(Mi-rn)*sn;let Ki=0;Ki=Ln!==Dn?-zi*xn-Bu:(-xn*bt+.5)*Dn;for(const Ai of Pi)for(const Sr of Ai.positionedGlyphs)Sr.x+=on,Sr.y+=Ki})(be.positionedLines,yn,_n,vn,Ii,Xn,ze,Xi,Ve.length),be.top+=-vn*Xi,be.bottom=be.top+Xi,be.left+=-_n*Ii,be.right=be.left+Ii}(fe,e,r,a,Q,g,v,b,z,k,L,j),!function(be){for(const $e of be)if($e.positionedGlyphs.length!==0)return!1;return!0}(he)&&fe}const zh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ty(n,e,r,a,h,f){if(e.imageName){const g=a[e.imageName];return g?g.displaySize[0]*e.scale*Ei/f+h:0}{const g=r[e.fontStack],v=g&&g[n];return v?v.metrics.advance*e.scale+h:0}}function ky(n,e,r,a){const h=Math.pow(n-e,2);return a?n<e?h/2:2*h:h+Math.abs(r)*r}function yw(n,e,r){let a=0;return n===10&&(a-=1e4),r&&(a+=150),n!==40&&n!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Cy(n,e,r,a,h,f){let g=null,v=ky(e,r,h,f);for(const b of a){const k=ky(e-b.x,r,h,f)+b.badness;k<=v&&(g=b,v=k)}return{index:n,x:e,priorBreak:g,badness:v}}function Ey(n){return n?Ey(n.priorBreak).concat(n.index):[]}function Zp(n,e,r,a,h,f,g){if(f!=="point")return[];if(!n)return[];const v=[],b=function(L,B,O,j,W,Q){let ue=0;for(let ie=0;ie<L.length();ie++){const he=L.getSection(ie);ue+=Ty(L.getCharCode(ie),he,j,W,B,Q)}return ue/Math.max(1,Math.ceil(ue/O))}(n,e,r,a,h,g),k=n.text.indexOf("")>=0;let E=0;for(let L=0;L<n.length();L++){const B=n.getSection(L),O=n.getCharCode(L);if(zh[O]||(E+=Ty(O,B,a,h,e,g)),L<n.length()-1){const j=!((z=O)<11904||!(je["Bopomofo Extended"](z)||je.Bopomofo(z)||je["CJK Compatibility Forms"](z)||je["CJK Compatibility Ideographs"](z)||je["CJK Compatibility"](z)||je["CJK Radicals Supplement"](z)||je["CJK Strokes"](z)||je["CJK Symbols and Punctuation"](z)||je["CJK Unified Ideographs Extension A"](z)||je["CJK Unified Ideographs"](z)||je["Enclosed CJK Letters and Months"](z)||je["Halfwidth and Fullwidth Forms"](z)||je.Hiragana(z)||je["Ideographic Description Characters"](z)||je["Kangxi Radicals"](z)||je["Katakana Phonetic Extensions"](z)||je.Katakana(z)||je["Vertical Forms"](z)||je["Yi Radicals"](z)||je["Yi Syllables"](z)));(gw[O]||j||B.imageName)&&v.push(Cy(L+1,E,b,v,yw(O,n.getCharCode(L+1),j&&k),!1))}}var z;return Ey(Cy(n.length(),E,b,v,0,!0))}function Gp(n){let e=.5,r=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function _w(n,e,r,a,h){if(!a&&!h)return;const f=n[r],g=(n[r].x+f.metrics.advance*f.scale)*a;for(let v=e;v<=r;v++)n[v].x-=g,n[v].y+=h}function vw(n,e,r){const{horizontalAlign:a,verticalAlign:h}=Gp(r),f=e[0]-n.displaySize[0]*a,g=e[1]-n.displaySize[1]*h;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function Iy(n,e,r,a,h,f){const g=n.image;let v;if(g.content){const W=g.content,Q=g.pixelRatio||1;v=[W[0]/Q,W[1]/Q,g.displaySize[0]-W[2]/Q,g.displaySize[1]-W[3]/Q]}const b=e.left*f,k=e.right*f;let E,z,L,B;r==="width"||r==="both"?(B=h[0]+b-a[3],z=h[0]+k+a[1]):(B=h[0]+(b+k-g.displaySize[0])/2,z=B+g.displaySize[0]);const O=e.top*f,j=e.bottom*f;return r==="height"||r==="both"?(E=h[1]+O-a[0],L=h[1]+j+a[2]):(E=h[1]+(O+j-g.displaySize[1])/2,L=E+g.displaySize[1]),{image:g,top:E,right:z,bottom:L,left:B,collisionPadding:v}}const Nu=255,cs=128,po=Nu*cs;function Py(n,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ht(n+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=r;let f=0;for(;f<a.length&&a[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<a.length&&a[g]<n+1;)g++;g=Math.min(a.length-1,g);const v=a[f],b=a[g];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:b,minSize:r.evaluate(new Ht(v)),maxSize:r.evaluate(new Ht(b)),interpolationType:h}}}function Hp(n,e,r){let a="never";const h=n.get(e);return h?a=h:n.get(r)&&(a="always"),a}const xw=co.VectorTileFeature.types,ww=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ah(n,e,r,a,h,f,g,v,b,k,E,z,L){const B=v?Math.min(po,Math.round(v[0])):0,O=v?Math.min(po,Math.round(v[1])):0;n.emplaceBack(e,r,Math.round(32*a),Math.round(32*h),f,g,(B<<1)+(b?1:0),O,16*k,16*E,256*z,256*L)}function Wp(n,e,r){n.emplaceBack(e.x,e.y,r),n.emplaceBack(e.x,e.y,r),n.emplaceBack(e.x,e.y,r),n.emplaceBack(e.x,e.y,r)}function bw(n){for(const e of n.sections)if(xp(e.text))return!0;return!1}class Xp{constructor(e){this.layoutVertexArray=new vt,this.indexArray=new Oi,this.programConfigurations=e,this.segments=new Wt,this.dynamicLayoutVertexArray=new mt,this.opacityVertexArray=new wt,this.hasVisibleVertices=!1,this.placedSymbolArray=new oe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ew.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ww,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}qe("SymbolBuffers",Xp);class Kp{constructor(e,r,a){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new a,this.segments=new Wt,this.collisionVertexArray=new Zt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,tw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}qe("CollisionBuffers",Kp);class sl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ep([]),this.placementViewportMatrix=Ep([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Py(this.zoom,r["text-size"]),this.iconSizeData=Py(this.zoom,r["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),f=a.get("symbol-z-order");this.canOverlap=Hp(a,"text-overlap","text-allow-overlap")!=="never"||Hp(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>l.ai[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID}createArrays(){this.text=new Xp(new Vr(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Xp(new Vr(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ae,this.lineVertexArray=new me,this.symbolInstances=new K,this.textAnchorOffsets=new we}calculateGlyphDependencies(e,r,a,h,f){for(let g=0;g<e.length;g++)if(r[e.charCodeAt(g)]=!0,(a||h)&&f){const v=Fu[e.charAt(g)];v&&(r[v.charCodeAt(0)]=!0)}}populate(e,r,a){const h=this.layers[0],f=h.layout,g=f.get("text-font"),v=f.get("text-field"),b=f.get("icon-image"),k=(v.value.kind!=="constant"||v.value.value instanceof Gi&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),E=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,z=f.get("symbol-sort-key");if(this.features=[],!k&&!E)return;const L=r.iconDependencies,B=r.glyphDependencies,O=r.availableImages,j=new Ht(this.zoom);for(const{feature:W,id:Q,index:ue,sourceLayerIndex:ie}of e){const he=h._featureFilter.needGeometry,fe=na(W,he);if(!h._featureFilter.filter(j,fe,a))continue;let be,$e;if(he||(fe.geometry=ia(W)),k){const Ue=h.getValueAndResolveTokens("text-field",fe,a,O),Ve=Gi.factory(Ue);bw(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||gu()==="unavailable"||this.hasRTLText&&Mn.isParsed())&&(be=nw(Ve,h,fe))}if(E){const Ue=h.getValueAndResolveTokens("icon-image",fe,a,O);$e=Ue instanceof Bi?Ue:Bi.fromString(Ue)}if(!be&&!$e)continue;const Ke=this.sortFeaturesByKey?z.evaluate(fe,{},a):void 0;if(this.features.push({id:Q,text:be,icon:$e,index:ue,sourceLayerIndex:ie,geometry:fe.geometry,properties:W.properties,type:xw[W.type],sortKey:Ke}),$e&&(L[$e.name]=!0),be){const Ue=g.evaluate(fe,{},a).join(","),Ve=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ai.vertical)>=0;for(const ze of be.sections)if(ze.image)L[ze.image.name]=!0;else{const Ze=lu(be.toString()),De=ze.fontStack||Ue,Ee=B[De]=B[De]||{};this.calculateGlyphDependencies(ze.text,Ee,Ve,this.allowVerticalPlacement,Ze)}}}f.get("symbol-placement")==="line"&&(this.features=function(W){const Q={},ue={},ie=[];let he=0;function fe(Ue){ie.push(W[Ue]),he++}function be(Ue,Ve,ze){const Ze=ue[Ue];return delete ue[Ue],ue[Ve]=Ze,ie[Ze].geometry[0].pop(),ie[Ze].geometry[0]=ie[Ze].geometry[0].concat(ze[0]),Ze}function $e(Ue,Ve,ze){const Ze=Q[Ve];return delete Q[Ve],Q[Ue]=Ze,ie[Ze].geometry[0].shift(),ie[Ze].geometry[0]=ze[0].concat(ie[Ze].geometry[0]),Ze}function Ke(Ue,Ve,ze){const Ze=ze?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Ue}:${Ze.x}:${Ze.y}`}for(let Ue=0;Ue<W.length;Ue++){const Ve=W[Ue],ze=Ve.geometry,Ze=Ve.text?Ve.text.toString():null;if(!Ze){fe(Ue);continue}const De=Ke(Ze,ze),Ee=Ke(Ze,ze,!0);if(De in ue&&Ee in Q&&ue[De]!==Q[Ee]){const nt=$e(De,Ee,ze),Qe=be(De,Ee,ie[nt].geometry);delete Q[De],delete ue[Ee],ue[Ke(Ze,ie[Qe].geometry,!0)]=Qe,ie[nt].geometry=null}else De in ue?be(De,Ee,ze):Ee in Q?$e(De,Ee,ze):(fe(Ue),Q[De]=he-1,ue[Ee]=he-1)}return ie.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,Q)=>W.sortKey-Q.sortKey)}update(e,r,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const a=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(r[e.segment+1]),f=e.dist(r[e.segment]);const g={};for(let v=e.segment+1;v<r.length;v++)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=e.segment||0;v>=0;v--)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:f},v>0&&(f+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const b=g[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,r,a,h,f,g,v,b,k,E,z,L){const B=e.indexArray,O=e.layoutVertexArray,j=e.segments.prepareSegment(4*r.length,O,B,this.canOverlap?g.sortKey:void 0),W=this.glyphOffsetArray.length,Q=j.vertexLength,ue=this.allowVerticalPlacement&&v===l.ai.vertical?Math.PI/2:0,ie=g.text&&g.text.sections;for(let he=0;he<r.length;he++){const{tl:fe,tr:be,bl:$e,br:Ke,tex:Ue,pixelOffsetTL:Ve,pixelOffsetBR:ze,minFontScaleX:Ze,minFontScaleY:De,glyphOffset:Ee,isSDF:nt,sectionIndex:Qe}=r[he],_t=j.vertexLength,Xt=Ee[1];Ah(O,b.x,b.y,fe.x,Xt+fe.y,Ue.x,Ue.y,a,nt,Ve.x,Ve.y,Ze,De),Ah(O,b.x,b.y,be.x,Xt+be.y,Ue.x+Ue.w,Ue.y,a,nt,ze.x,Ve.y,Ze,De),Ah(O,b.x,b.y,$e.x,Xt+$e.y,Ue.x,Ue.y+Ue.h,a,nt,Ve.x,ze.y,Ze,De),Ah(O,b.x,b.y,Ke.x,Xt+Ke.y,Ue.x+Ue.w,Ue.y+Ue.h,a,nt,ze.x,ze.y,Ze,De),Wp(e.dynamicLayoutVertexArray,b,ue),B.emplaceBack(_t,_t+1,_t+2),B.emplaceBack(_t+1,_t+2,_t+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ee[0]),he!==r.length-1&&Qe===r[he+1].sectionIndex||e.programConfigurations.populatePaintArrays(O.length,g,g.index,{},L,ie&&ie[Qe])}e.placedSymbolArray.emplaceBack(b.x,b.y,W,this.glyphOffsetArray.length-W,Q,k,E,b.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,z)}_addCollisionDebugVertex(e,r,a,h,f,g){return r.emplaceBack(0,0),e.emplaceBack(a.x,a.y,h,f,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(e,r,a,h,f,g,v){const b=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),k=b.vertexLength,E=f.layoutVertexArray,z=f.collisionVertexArray,L=v.anchorX,B=v.anchorY;this._addCollisionDebugVertex(E,z,g,L,B,new te(e,r)),this._addCollisionDebugVertex(E,z,g,L,B,new te(a,r)),this._addCollisionDebugVertex(E,z,g,L,B,new te(a,h)),this._addCollisionDebugVertex(E,z,g,L,B,new te(e,h)),b.vertexLength+=4;const O=f.indexArray;O.emplaceBack(k,k+1),O.emplaceBack(k+1,k+2),O.emplaceBack(k+2,k+3),O.emplaceBack(k+3,k),b.primitiveLength+=4}addDebugCollisionBoxes(e,r,a,h){for(let f=e;f<r;f++){const g=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,h?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kp(hi,py.members,ki),this.iconCollisionBox=new Kp(hi,py.members,ki);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,a,h,f,g,v,b,k){const E={};for(let z=r;z<a;z++){const L=e.get(z);E.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},E.textFeatureIndex=L.featureIndex;break}for(let z=h;z<f;z++){const L=e.get(z);E.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},E.verticalTextFeatureIndex=L.featureIndex;break}for(let z=g;z<v;z++){const L=e.get(z);E.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},E.iconFeatureIndex=L.featureIndex;break}for(let z=b;z<k;z++){const L=e.get(z);E.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},E.verticalIconFeatureIndex=L.featureIndex;break}return E}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const a=e.placedSymbolArray.get(r),h=a.vertexStartIndex+4*a.numGlyphs;for(let f=a.vertexStartIndex;f<h;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),a=Math.cos(e),h=[],f=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const b=this.symbolInstances.get(v);h.push(0|Math.round(r*b.anchorX+a*b.anchorY)),f.push(b.featureIndex)}return g.sort((v,b)=>h[v]-h[b]||f[b]-f[v]),g}addToSortKeyRanges(e,r){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,f,g)=>{h>=0&&g.indexOf(h)===f&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let My,zy;qe("SymbolBucket",sl,{omit:["layers","collisionBoxArray","features","compareText"]}),sl.MAX_GLYPHS=65535,sl.addDynamicAttributes=Wp;var Yp={get paint(){return zy=zy||new mi({"icon-opacity":new ot(ye.paint_symbol["icon-opacity"]),"icon-color":new ot(ye.paint_symbol["icon-color"]),"icon-halo-color":new ot(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new ot(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ot(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Je(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Je(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new ot(ye.paint_symbol["text-opacity"]),"text-color":new ot(ye.paint_symbol["text-color"],{runtimeType:en,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ot(ye.paint_symbol["text-halo-color"]),"text-halo-width":new ot(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new ot(ye.paint_symbol["text-halo-blur"]),"text-translate":new Je(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Je(ye.paint_symbol["text-translate-anchor"])})},get layout(){return My=My||new mi({"symbol-placement":new Je(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Je(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Je(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ot(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Je(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Je(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Je(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Je(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Je(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Je(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new ot(ye.layout_symbol["icon-size"]),"icon-text-fit":new Je(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Je(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new ot(ye.layout_symbol["icon-image"]),"icon-rotate":new ot(ye.layout_symbol["icon-rotate"]),"icon-padding":new ot(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Je(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new ot(ye.layout_symbol["icon-offset"]),"icon-anchor":new ot(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Je(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Je(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Je(ye.layout_symbol["text-rotation-alignment"]),"text-field":new ot(ye.layout_symbol["text-field"]),"text-font":new ot(ye.layout_symbol["text-font"]),"text-size":new ot(ye.layout_symbol["text-size"]),"text-max-width":new ot(ye.layout_symbol["text-max-width"]),"text-line-height":new Je(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new ot(ye.layout_symbol["text-letter-spacing"]),"text-justify":new ot(ye.layout_symbol["text-justify"]),"text-radial-offset":new ot(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Je(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ot(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ot(ye.layout_symbol["text-anchor"]),"text-max-angle":new Je(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Je(ye.layout_symbol["text-writing-mode"]),"text-rotate":new ot(ye.layout_symbol["text-rotate"]),"text-padding":new Je(ye.layout_symbol["text-padding"]),"text-keep-upright":new Je(ye.layout_symbol["text-keep-upright"]),"text-transform":new ot(ye.layout_symbol["text-transform"]),"text-offset":new ot(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Je(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new Je(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new Je(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Je(ye.layout_symbol["text-optional"])})}};class Ay{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Lr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}qe("FormatSectionOverride",Ay,{omit:["defaultValue"]});class Lh extends Hn{constructor(e){super(e,Yp)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const f of a)h.indexOf(f)<0&&h.push(f);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,a,h){const f=this.layout.get(e).evaluate(r,{},a,h),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||Na(g.value)||!f?f:function(v,b){return b.replace(/{([^{}]+)}/g,(k,E)=>v&&E in v?String(v[E]):"")}(r.properties,f)}createBucket(e){return new sl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Yp.paint.overridableProperties){if(!Lh.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),a=new Ay(r),h=new iu(a,r.property.specification);let f=null;f=r.value.kind==="constant"||r.value.kind==="source"?new nu("source",h):new Ua("composite",h,r.value.zoomStops),this.paint._values[e]=new tn(r.property,f,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven())&&Lh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const a=e.get("text-field"),h=Yp.paint.properties[r];let f=!1;const g=v=>{for(const b of v)if(h.overrides&&h.overrides.hasOverride(b))return void(f=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Gi)g(a.value.value.sections);else if(a.value.kind==="source"){const v=k=>{f||(k instanceof ws&&Qt(k.value)===Z?g(k.value.sections):k instanceof Oa?g(k.sections):k.eachChild(v))},b=a.value;b._styleExpression&&v(b._styleExpression.expression)}return f}}let Ly;var Sw={get paint(){return Ly=Ly||new mi({"background-color":new Je(ye.paint_background["background-color"]),"background-pattern":new _u(ye.paint_background["background-pattern"]),"background-opacity":new Je(ye.paint_background["background-opacity"])})}};class Tw extends Hn{constructor(e){super(e,Sw)}}let Dy;var kw={get paint(){return Dy=Dy||new mi({"raster-opacity":new Je(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Je(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Je(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Je(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Je(ye.paint_raster["raster-saturation"]),"raster-contrast":new Je(ye.paint_raster["raster-contrast"]),"raster-resampling":new Je(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Je(ye.paint_raster["raster-fade-duration"])})}};class Cw extends Hn{constructor(e){super(e,kw)}}class Ew extends Hn{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Iw{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Qp=63710088e-1;class fo{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fo(Ge(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,a=this.lat*r,h=e.lat*r,f=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*r);return Qp*Math.acos(Math.min(f,1))}static convert(e){if(e instanceof fo)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ry=2*Math.PI*Qp;function Fy(n){return Ry*Math.cos(n*Math.PI/180)}function By(n){return(180+n)/360}function Oy(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Ny(n,e){return n/Fy(e)}function Vy(n){return 360*n-180}function Jp(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}class Dh{constructor(e,r,a=0){this.x=+e,this.y=+r,this.z=+a}static fromLngLat(e,r=0){const a=fo.convert(e);return new Dh(By(a.lng),Oy(a.lat),Ny(r,a.lat))}toLngLat(){return new fo(Vy(this.x),Jp(this.y))}toAltitude(){return this.z*Fy(Jp(this.y))}meterInMercatorCoordinateUnits(){return 1/Ry*(e=Jp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Uy(n,e,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[n*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class ef{constructor(e,r,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error(`x=${r}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=a,this.key=Vu(0,e,e,r,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,a){const h=(g=this.y,v=this.z,b=Uy(256*(f=this.x),256*(g=Math.pow(2,v)-g-1),v),k=Uy(256*(f+1),256*(g+1),v),b[0]+","+b[1]+","+k[0]+","+k[1]);var f,g,v,b,k;const E=function(z,L,B){let O,j="";for(let W=z;W>0;W--)O=1<<W-1,j+=(L&O?1:0)+(B&O?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new te((e.x*r-this.x)*bi,(e.y*r-this.y)*bi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class jy{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Vu(e,r.z,r.z,r.x,r.y)}}class sr{constructor(e,r,a,h,f){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=r,this.canonical=new ef(a,+h,+f),this.key=Vu(r,e,a,h,f)}clone(){return new sr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new sr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sr(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?Vu(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Vu(this.wrap*+r,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new sr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new sr(r,this.wrap,r,a,h),new sr(r,this.wrap,r,a+1,h),new sr(r,this.wrap,r,a,h+1),new sr(r,this.wrap,r,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new sr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new sr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new jy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Dh(e.x-this.wrap,e.y))}}function Vu(n,e,r,a,h){(n*=2)<0&&(n=-1*n-1);const f=1<<r;return(f*f*n+f*h+a).toString(36)+r.toString(36)+e.toString(36)}qe("CanonicalTileID",ef),qe("OverscaledTileID",sr,{omit:["posMatrix"]});class $y{constructor(e,r,a,h=1,f=1,g=1,v=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void Di(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const b=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=f,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<b;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(b,k)]=this.data[this._idx(b-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,b)]=this.data[this._idx(k,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<b;k++)for(let E=0;E<b;E++){const z=this.get(k,E);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(e,r){const a=new Uint8Array(this.data.buffer),h=4*this._idx(e,r);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,a){return e*this.redFactor+r*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new rr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,f=r*this.dim+this.dim,g=a*this.dim,v=a*this.dim+this.dim;switch(r){case-1:h=f-1;break;case 1:f=h+1}switch(a){case-1:g=v-1;break;case 1:v=g+1}const b=-r*this.dim,k=-a*this.dim;for(let E=g;E<v;E++)for(let z=h;z<f;z++)this.data[this._idx(z,E)]=e.data[this._idx(z+b,E+k)]}}qe("DEMData",$y);class qy{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const a=e[r];this._stringToNumber[a]=r,this._numberToString[r]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Zy{constructor(e,r,a,h,f){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=a,e._y=h,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Gy{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new so(bi,16,0),this.grid3D=new so(bi,16,0),this.featureIndexArray=new Te,this.promoteId=r}insert(e,r,a,h,f,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,f);const b=g?this.grid3D:this.grid;for(let k=0;k<r.length;k++){const E=r[k],z=[1/0,1/0,-1/0,-1/0];for(let L=0;L<E.length;L++){const B=E[L];z[0]=Math.min(z[0],B.x),z[1]=Math.min(z[1],B.y),z[2]=Math.max(z[2],B.x),z[3]=Math.max(z[3],B.y)}z[0]<bi&&z[1]<bi&&z[2]>=0&&z[3]>=0&&b.insert(v,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new co.VectorTile(new jp(this.rawTileData)).layers,this.sourceLayerCoder=new qy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,a,h){this.loadVTLayers();const f=e.params||{},g=bi/e.tileSize/e.scale,v=su(f.filter),b=e.queryGeometry,k=e.queryPadding*g,E=Wy(b),z=this.grid.query(E.minX-k,E.minY-k,E.maxX+k,E.maxY+k),L=Wy(e.cameraQueryGeometry),B=this.grid3D.query(L.minX-k,L.minY-k,L.maxX+k,L.maxY+k,(W,Q,ue,ie)=>function(he,fe,be,$e,Ke){for(const Ve of he)if(fe<=Ve.x&&be<=Ve.y&&$e>=Ve.x&&Ke>=Ve.y)return!0;const Ue=[new te(fe,be),new te(fe,Ke),new te($e,Ke),new te($e,be)];if(he.length>2){for(const Ve of Ue)if(Qa(he,Ve))return!0}for(let Ve=0;Ve<he.length-1;Ve++)if(o1(he[Ve],he[Ve+1],Ue))return!0;return!1}(e.cameraQueryGeometry,W-k,Q-k,ue+k,ie+k));for(const W of B)z.push(W);z.sort(Pw);const O={};let j;for(let W=0;W<z.length;W++){const Q=z[W];if(Q===j)continue;j=Q;const ue=this.featureIndexArray.get(Q);let ie=null;this.loadMatchingFeature(O,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,v,f.layers,f.availableImages,r,a,h,(he,fe,be)=>(ie||(ie=ia(he)),fe.queryIntersectsFeature(b,he,be,ie,this.z,e.transform,g,e.pixelPosMatrix)))}return O}loadMatchingFeature(e,r,a,h,f,g,v,b,k,E,z){const L=this.bucketLayerIDs[r];if(g&&!function(W,Q){for(let ue=0;ue<W.length;ue++)if(Q.indexOf(W[ue])>=0)return!0;return!1}(g,L))return;const B=this.sourceLayerCoder.decode(a),O=this.vtLayers[B].feature(h);if(f.needGeometry){const W=na(O,!0);if(!f.filter(new Ht(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!f.filter(new Ht(this.tileID.overscaledZ),O))return;const j=this.getId(O,B);for(let W=0;W<L.length;W++){const Q=L[W];if(g&&g.indexOf(Q)<0)continue;const ue=b[Q];if(!ue)continue;let ie={};j&&E&&(ie=E.getState(ue.sourceLayer||"_geojsonTileLayer",j));const he=Be({},k[Q]);he.paint=Hy(he.paint,ue.paint,O,ie,v),he.layout=Hy(he.layout,ue.layout,O,ie,v);const fe=!z||z(O,ue,ie);if(!fe)continue;const be=new Zy(O,this.z,this.x,this.y,j);be.layer=he;let $e=e[Q];$e===void 0&&($e=e[Q]=[]),$e.push({featureIndex:h,feature:be,intersectionZ:fe})}}lookupSymbolFeatures(e,r,a,h,f,g,v,b){const k={};this.loadVTLayers();const E=su(f);for(const z of e)this.loadMatchingFeature(k,a,h,z,E,g,v,b,r);return k}hasLayer(e){for(const r of this.bucketLayerIDs)for(const a of r)if(e===a)return!0;return!1}getId(e,r){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof a=="boolean"&&(a=Number(a))),a}}function Hy(n,e,r,a,h){return tt(n,(f,g)=>{const v=e instanceof Ka?e.get(g):null;return v&&v.evaluate?v.evaluate(r,a,h):v})}function Wy(n){let e=1/0,r=1/0,a=-1/0,h=-1/0;for(const f of n)e=Math.min(e,f.x),r=Math.min(r,f.y),a=Math.max(a,f.x),h=Math.max(h,f.y);return{minX:e,minY:r,maxX:a,maxY:h}}function Pw(n,e){return e-n}function Xy(n,e,r,a,h){const f=[];for(let g=0;g<n.length;g++){const v=n[g];let b;for(let k=0;k<v.length-1;k++){let E=v[k],z=v[k+1];E.x<e&&z.x<e||(E.x<e?E=new te(e,E.y+(e-E.x)/(z.x-E.x)*(z.y-E.y))._round():z.x<e&&(z=new te(e,E.y+(e-E.x)/(z.x-E.x)*(z.y-E.y))._round()),E.y<r&&z.y<r||(E.y<r?E=new te(E.x+(r-E.y)/(z.y-E.y)*(z.x-E.x),r)._round():z.y<r&&(z=new te(E.x+(r-E.y)/(z.y-E.y)*(z.x-E.x),r)._round()),E.x>=a&&z.x>=a||(E.x>=a?E=new te(a,E.y+(a-E.x)/(z.x-E.x)*(z.y-E.y))._round():z.x>=a&&(z=new te(a,E.y+(a-E.x)/(z.x-E.x)*(z.y-E.y))._round()),E.y>=h&&z.y>=h||(E.y>=h?E=new te(E.x+(h-E.y)/(z.y-E.y)*(z.x-E.x),h)._round():z.y>=h&&(z=new te(E.x+(h-E.y)/(z.y-E.y)*(z.x-E.x),h)._round()),b&&E.equals(b[b.length-1])||(b=[E],f.push(b)),b.push(z)))))}}return f}qe("FeatureIndex",Gy,{omit:["rawTileData","sourceLayerCoder"]});class mo extends te{constructor(e,r,a,h){super(e,r),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new mo(this.x,this.y,this.angle,this.segment)}}function Ky(n,e,r,a,h){if(e.segment===void 0||r===0)return!0;let f=e,g=e.segment+1,v=0;for(;v>-r/2;){if(g--,g<0)return!1;v-=n[g].dist(f),f=n[g]}v+=n[g].dist(n[g+1]),g++;const b=[];let k=0;for(;v<r/2;){const E=n[g],z=n[g+1];if(!z)return!1;let L=n[g-1].angleTo(E)-E.angleTo(z);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:L}),k+=L;v-b[0].distance>a;)k-=b.shift().angleDelta;if(k>h)return!1;g++,v+=E.dist(z)}return!0}function Yy(n){let e=0;for(let r=0;r<n.length-1;r++)e+=n[r].dist(n[r+1]);return e}function Qy(n,e,r){return n?.6*e*r:0}function Jy(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function Mw(n,e,r,a,h,f){const g=Qy(r,h,f),v=Jy(r,a)*f;let b=0;const k=Yy(n)/2;for(let E=0;E<n.length-1;E++){const z=n[E],L=n[E+1],B=z.dist(L);if(b+B>k){const O=(k-b)/B,j=En.number(z.x,L.x,O),W=En.number(z.y,L.y,O),Q=new mo(j,W,L.angleTo(z),E);return Q._round(),!g||Ky(n,Q,v,g,e)?Q:void 0}b+=B}}function zw(n,e,r,a,h,f,g,v,b){const k=Qy(a,f,g),E=Jy(a,h),z=E*g,L=n[0].x===0||n[0].x===b||n[0].y===0||n[0].y===b;return e-z<e/4&&(e=z+e/4),e_(n,L?e/2*v%e:(E/2+2*f)*g*v%e,e,k,r,z,L,!1,b)}function e_(n,e,r,a,h,f,g,v,b){const k=f/2,E=Yy(n);let z=0,L=e-r,B=[];for(let O=0;O<n.length-1;O++){const j=n[O],W=n[O+1],Q=j.dist(W),ue=W.angleTo(j);for(;L+r<z+Q;){L+=r;const ie=(L-z)/Q,he=En.number(j.x,W.x,ie),fe=En.number(j.y,W.y,ie);if(he>=0&&he<b&&fe>=0&&fe<b&&L-k>=0&&L+k<=E){const be=new mo(he,fe,ue,O);be._round(),a&&!Ky(n,be,f,a,h)||B.push(be)}}z+=Q}return v||B.length||g||(B=e_(n,z/2,r,a,h,f,g,!0,b)),B}qe("Anchor",mo);const ol=An;function t_(n,e,r,a){const h=[],f=n.image,g=f.pixelRatio,v=f.paddedRect.w-2*ol,b=f.paddedRect.h-2*ol,k=n.right-n.left,E=n.bottom-n.top,z=f.stretchX||[[0,v]],L=f.stretchY||[[0,b]],B=(ze,Ze)=>ze+Ze[1]-Ze[0],O=z.reduce(B,0),j=L.reduce(B,0),W=v-O,Q=b-j;let ue=0,ie=O,he=0,fe=j,be=0,$e=W,Ke=0,Ue=Q;if(f.content&&a){const ze=f.content;ue=Rh(z,0,ze[0]),he=Rh(L,0,ze[1]),ie=Rh(z,ze[0],ze[2]),fe=Rh(L,ze[1],ze[3]),be=ze[0]-ue,Ke=ze[1]-he,$e=ze[2]-ze[0]-ie,Ue=ze[3]-ze[1]-fe}const Ve=(ze,Ze,De,Ee)=>{const nt=Fh(ze.stretch-ue,ie,k,n.left),Qe=Bh(ze.fixed-be,$e,ze.stretch,O),_t=Fh(Ze.stretch-he,fe,E,n.top),Xt=Bh(Ze.fixed-Ke,Ue,Ze.stretch,j),Yt=Fh(De.stretch-ue,ie,k,n.left),Ii=Bh(De.fixed-be,$e,De.stretch,O),Xn=Fh(Ee.stretch-he,fe,E,n.top),yn=Bh(Ee.fixed-Ke,Ue,Ee.stretch,j),Si=new te(nt,_t),Vi=new te(Yt,_t),Xi=new te(Yt,Xn),_n=new te(nt,Xn),vn=new te(Qe/g,Xt/g),Pi=new te(Ii/g,yn/g),Mi=e*Math.PI/180;if(Mi){const sn=Math.sin(Mi),Ln=Math.cos(Mi),Dn=[Ln,-sn,sn,Ln];Si._matMult(Dn),Vi._matMult(Dn),_n._matMult(Dn),Xi._matMult(Dn)}const rn=ze.stretch+ze.fixed,xn=Ze.stretch+Ze.fixed;return{tl:Si,tr:Vi,bl:_n,br:Xi,tex:{x:f.paddedRect.x+ol+rn,y:f.paddedRect.y+ol+xn,w:De.stretch+De.fixed-rn,h:Ee.stretch+Ee.fixed-xn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vn,pixelOffsetBR:Pi,minFontScaleX:$e/g/k,minFontScaleY:Ue/g/E,isSDF:r}};if(a&&(f.stretchX||f.stretchY)){const ze=i_(z,W,O),Ze=i_(L,Q,j);for(let De=0;De<ze.length-1;De++){const Ee=ze[De],nt=ze[De+1];for(let Qe=0;Qe<Ze.length-1;Qe++)h.push(Ve(Ee,Ze[Qe],nt,Ze[Qe+1]))}}else h.push(Ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return h}function Rh(n,e,r){let a=0;for(const h of n)a+=Math.max(e,Math.min(r,h[1]))-Math.max(e,Math.min(r,h[0]));return a}function i_(n,e,r){const a=[{fixed:-ol,stretch:0}];for(const[h,f]of n){const g=a[a.length-1];a.push({fixed:h-g.stretch,stretch:g.stretch}),a.push({fixed:h-g.stretch,stretch:g.stretch+(f-h)})}return a.push({fixed:e+ol,stretch:r}),a}function Fh(n,e,r,a){return n/e*r+a}function Bh(n,e,r,a){return n-e*r/a}class Oh{constructor(e,r,a,h,f,g,v,b,k,E){if(this.boxStartIndex=e.length,k){let z=g.top,L=g.bottom;const B=g.collisionPadding;B&&(z-=B[1],L+=B[3]);let O=L-z;O>0&&(O=Math.max(10,O),this.circleDiameter=O)}else{let z=g.top*v-b[0],L=g.bottom*v+b[2],B=g.left*v-b[3],O=g.right*v+b[1];const j=g.collisionPadding;if(j&&(B-=j[0]*v,z-=j[1]*v,O+=j[2]*v,L+=j[3]*v),E){const W=new te(B,z),Q=new te(O,z),ue=new te(B,L),ie=new te(O,L),he=E*Math.PI/180;W._rotate(he),Q._rotate(he),ue._rotate(he),ie._rotate(he),B=Math.min(W.x,Q.x,ue.x,ie.x),O=Math.max(W.x,Q.x,ue.x,ie.x),z=Math.min(W.y,Q.y,ue.y,ie.y),L=Math.max(W.y,Q.y,ue.y,ie.y)}e.emplaceBack(r.x,r.y,B,z,O,L,a,h,f)}this.boxEndIndex=e.length}}class Aw{constructor(e=[],r=Lw){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:a}=this,h=r[e];for(;e>0;){const f=e-1>>1,g=r[f];if(a(h,g)>=0)break;r[e]=g,e=f}r[e]=h}_down(e){const{data:r,compare:a}=this,h=this.length>>1,f=r[e];for(;e<h;){let g=1+(e<<1),v=r[g];const b=g+1;if(b<this.length&&a(r[b],v)<0&&(g=b,v=r[b]),a(v,f)>=0)break;r[e]=v,e=g}r[e]=f}}function Lw(n,e){return n<e?-1:n>e?1:0}function Dw(n,e=1,r=!1){let a=1/0,h=1/0,f=-1/0,g=-1/0;const v=n[0];for(let B=0;B<v.length;B++){const O=v[B];(!B||O.x<a)&&(a=O.x),(!B||O.y<h)&&(h=O.y),(!B||O.x>f)&&(f=O.x),(!B||O.y>g)&&(g=O.y)}const b=Math.min(f-a,g-h);let k=b/2;const E=new Aw([],Rw);if(b===0)return new te(a,h);for(let B=a;B<f;B+=b)for(let O=h;O<g;O+=b)E.push(new al(B+k,O+k,k,n));let z=function(B){let O=0,j=0,W=0;const Q=B[0];for(let ue=0,ie=Q.length,he=ie-1;ue<ie;he=ue++){const fe=Q[ue],be=Q[he],$e=fe.x*be.y-be.x*fe.y;j+=(fe.x+be.x)*$e,W+=(fe.y+be.y)*$e,O+=3*$e}return new al(j/O,W/O,0,B)}(n),L=E.length;for(;E.length;){const B=E.pop();(B.d>z.d||!z.d)&&(z=B,r&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-z.d<=e||(k=B.h/2,E.push(new al(B.p.x-k,B.p.y-k,k,n)),E.push(new al(B.p.x+k,B.p.y-k,k,n)),E.push(new al(B.p.x-k,B.p.y+k,k,n)),E.push(new al(B.p.x+k,B.p.y+k,k,n)),L+=4)}return r&&(console.log(`num probes: ${L}`),console.log(`best distance: ${z.d}`)),z.p}function Rw(n,e){return e.max-n.max}function al(n,e,r,a){this.p=new te(n,e),this.h=r,this.d=function(h,f){let g=!1,v=1/0;for(let b=0;b<f.length;b++){const k=f[b];for(let E=0,z=k.length,L=z-1;E<z;L=E++){const B=k[E],O=k[L];B.y>h.y!=O.y>h.y&&h.x<(O.x-B.x)*(h.y-B.y)/(O.y-B.y)+B.x&&(g=!g),v=Math.min(v,Og(h,B,O))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var Wi;l.aq=void 0,(Wi=l.aq||(l.aq={}))[Wi.center=1]="center",Wi[Wi.left=2]="left",Wi[Wi.right=3]="right",Wi[Wi.top=4]="top",Wi[Wi.bottom=5]="bottom",Wi[Wi["top-left"]=6]="top-left",Wi[Wi["top-right"]=7]="top-right",Wi[Wi["bottom-left"]=8]="bottom-left",Wi[Wi["bottom-right"]=9]="bottom-right";const go=7,tf=Number.POSITIVE_INFINITY;function n_(n,e){return e[1]!==tf?function(r,a,h){let f=0,g=0;switch(a=Math.abs(a),h=Math.abs(h),r){case"top-right":case"top-left":case"top":g=h-go;break;case"bottom-right":case"bottom-left":case"bottom":g=-h+go}switch(r){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}return[f,g]}(n,e[0],e[1]):function(r,a){let h=0,f=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(r){case"top-right":case"top-left":f=g-go;break;case"bottom-right":case"bottom-left":f=-g+go;break;case"bottom":f=-a+go;break;case"top":f=a-go}switch(r){case"top-right":case"bottom-right":h=-g;break;case"top-left":case"bottom-left":h=g;break;case"left":h=a;break;case"right":h=-a}return[h,f]}(n,e[0])}function r_(n,e,r){var a;const h=n.layout,f=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(e,{},r);if(f){const v=f.values,b=[];for(let k=0;k<v.length;k+=2){const E=b[k]=v[k],z=v[k+1].map(L=>L*Ei);E.startsWith("top")?z[1]-=go:E.startsWith("bottom")&&(z[1]+=go),b[k+1]=z}return new $n(b)}const g=h.get("text-variable-anchor");if(g){let v;v=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},r)*Ei,tf]:h.get("text-offset").evaluate(e,{},r).map(k=>k*Ei);const b=[];for(const k of g)b.push(k,n_(k,v));return new $n(b)}return null}function nf(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Fw(n,e,r,a,h,f,g,v,b,k,E){let z=f.textMaxSize.evaluate(e,{});z===void 0&&(z=g);const L=n.layers[0].layout,B=L.get("icon-offset").evaluate(e,{},E),O=o_(r.horizontal),j=g/24,W=n.tilePixelRatio*j,Q=n.tilePixelRatio*z/24,ue=n.tilePixelRatio*v,ie=n.tilePixelRatio*L.get("symbol-spacing"),he=L.get("text-padding")*n.tilePixelRatio,fe=function(Ee,nt,Qe,_t=1){const Xt=Ee.get("icon-padding").evaluate(nt,{},Qe),Yt=Xt&&Xt.values;return[Yt[0]*_t,Yt[1]*_t,Yt[2]*_t,Yt[3]*_t]}(L,e,E,n.tilePixelRatio),be=L.get("text-max-angle")/180*Math.PI,$e=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Ke=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ue=L.get("symbol-placement"),Ve=ie/2,ze=L.get("icon-text-fit");let Ze;a&&ze!=="none"&&(n.allowVerticalPlacement&&r.vertical&&(Ze=Iy(a,r.vertical,ze,L.get("icon-text-fit-padding"),B,j)),O&&(a=Iy(a,O,ze,L.get("icon-text-fit-padding"),B,j)));const De=(Ee,nt)=>{nt.x<0||nt.x>=bi||nt.y<0||nt.y>=bi||function(Qe,_t,Xt,Yt,Ii,Xn,yn,Si,Vi,Xi,_n,vn,Pi,Mi,rn,xn,sn,Ln,Dn,zi,bt,on,Ki,Ai,Sr){const Ur=Qe.addToLineVertexArray(_t,Xt);let jr,Ds,Tr,or,Rn=0,Rs=0,$u=0,c_=0,hf=-1,df=-1;const Fs={};let h_=Ms("");if(Qe.allowVerticalPlacement&&Yt.vertical){const an=Si.layout.get("text-rotate").evaluate(bt,{},Ai)+90;Tr=new Oh(Vi,_t,Xi,_n,vn,Yt.vertical,Pi,Mi,rn,an),yn&&(or=new Oh(Vi,_t,Xi,_n,vn,yn,sn,Ln,rn,an))}if(Ii){const an=Si.layout.get("icon-rotate").evaluate(bt,{}),ar=Si.layout.get("icon-text-fit")!=="none",sa=t_(Ii,an,Ki,ar),qr=yn?t_(yn,an,Ki,ar):void 0;Ds=new Oh(Vi,_t,Xi,_n,vn,Ii,sn,Ln,!1,an),Rn=4*sa.length;const oa=Qe.iconSizeData;let hs=null;oa.kind==="source"?(hs=[cs*Si.layout.get("icon-size").evaluate(bt,{})],hs[0]>po&&Di(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Nu}. Reduce your "icon-size".`)):oa.kind==="composite"&&(hs=[cs*on.compositeIconSizes[0].evaluate(bt,{},Ai),cs*on.compositeIconSizes[1].evaluate(bt,{},Ai)],(hs[0]>po||hs[1]>po)&&Di(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Nu}. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,sa,hs,zi,Dn,bt,l.ai.none,_t,Ur.lineStartIndex,Ur.lineLength,-1,Ai),hf=Qe.icon.placedSymbolArray.length-1,qr&&(Rs=4*qr.length,Qe.addSymbols(Qe.icon,qr,hs,zi,Dn,bt,l.ai.vertical,_t,Ur.lineStartIndex,Ur.lineLength,-1,Ai),df=Qe.icon.placedSymbolArray.length-1)}const d_=Object.keys(Yt.horizontal);for(const an of d_){const ar=Yt.horizontal[an];if(!jr){h_=Ms(ar.text);const qr=Si.layout.get("text-rotate").evaluate(bt,{},Ai);jr=new Oh(Vi,_t,Xi,_n,vn,ar,Pi,Mi,rn,qr)}const sa=ar.positionedLines.length===1;if($u+=s_(Qe,_t,ar,Xn,Si,rn,bt,xn,Ur,Yt.vertical?l.ai.horizontal:l.ai.horizontalOnly,sa?d_:[an],Fs,hf,on,Ai),sa)break}Yt.vertical&&(c_+=s_(Qe,_t,Yt.vertical,Xn,Si,rn,bt,xn,Ur,l.ai.vertical,["vertical"],Fs,df,on,Ai));const Nw=jr?jr.boxStartIndex:Qe.collisionBoxArray.length,Vw=jr?jr.boxEndIndex:Qe.collisionBoxArray.length,Uw=Tr?Tr.boxStartIndex:Qe.collisionBoxArray.length,jw=Tr?Tr.boxEndIndex:Qe.collisionBoxArray.length,$w=Ds?Ds.boxStartIndex:Qe.collisionBoxArray.length,qw=Ds?Ds.boxEndIndex:Qe.collisionBoxArray.length,Zw=or?or.boxStartIndex:Qe.collisionBoxArray.length,Gw=or?or.boxEndIndex:Qe.collisionBoxArray.length;let $r=-1;const Vh=(an,ar)=>an&&an.circleDiameter?Math.max(an.circleDiameter,ar):ar;$r=Vh(jr,$r),$r=Vh(Tr,$r),$r=Vh(Ds,$r),$r=Vh(or,$r);const p_=$r>-1?1:0;p_&&($r*=Sr/Ei),Qe.glyphOffsetArray.length>=sl.MAX_GLYPHS&&Di("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bt.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,bt.sortKey);const Hw=r_(Si,bt,Ai),[Ww,Xw]=function(an,ar){const sa=an.length,qr=ar==null?void 0:ar.values;if((qr==null?void 0:qr.length)>0)for(let oa=0;oa<qr.length;oa+=2){const hs=qr[oa+1];an.emplaceBack(l.aq[qr[oa]],hs[0],hs[1])}return[sa,an.length]}(Qe.textAnchorOffsets,Hw);Qe.symbolInstances.emplaceBack(_t.x,_t.y,Fs.right>=0?Fs.right:-1,Fs.center>=0?Fs.center:-1,Fs.left>=0?Fs.left:-1,Fs.vertical||-1,hf,df,h_,Nw,Vw,Uw,jw,$w,qw,Zw,Gw,Xi,$u,c_,Rn,Rs,p_,0,Pi,$r,Ww,Xw)}(n,nt,Ee,r,a,h,Ze,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,W,[he,he,he,he],$e,b,ue,fe,Ke,B,e,f,k,E,g)};if(Ue==="line")for(const Ee of Xy(e.geometry,0,0,bi,bi)){const nt=zw(Ee,ie,be,r.vertical||O,a,24,Q,n.overscaling,bi);for(const Qe of nt)O&&Bw(n,O.text,Ve,Qe)||De(Ee,Qe)}else if(Ue==="line-center"){for(const Ee of e.geometry)if(Ee.length>1){const nt=Mw(Ee,be,r.vertical||O,a,24,Q);nt&&De(Ee,nt)}}else if(e.type==="Polygon")for(const Ee of Dp(e.geometry,0)){const nt=Dw(Ee,16);De(Ee[0],new mo(nt.x,nt.y,0))}else if(e.type==="LineString")for(const Ee of e.geometry)De(Ee,new mo(Ee[0].x,Ee[0].y,0));else if(e.type==="Point")for(const Ee of e.geometry)for(const nt of Ee)De([nt],new mo(nt.x,nt.y,0))}function s_(n,e,r,a,h,f,g,v,b,k,E,z,L,B,O){const j=function(ue,ie,he,fe,be,$e,Ke,Ue){const Ve=fe.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,ze=[];for(const Ze of ie.positionedLines)for(const De of Ze.positionedGlyphs){if(!De.rect)continue;const Ee=De.rect||{};let nt=wy+1,Qe=!0,_t=1,Xt=0;const Yt=(be||Ue)&&De.vertical,Ii=De.metrics.advance*De.scale/2;if(Ue&&ie.verticalizable&&(Xt=Ze.lineOffset/2-(De.imageName?-(Ei-De.metrics.width*De.scale)/2:(De.scale-1)*Ei)),De.imageName){const zi=Ke[De.imageName];Qe=zi.sdf,_t=zi.pixelRatio,nt=An/_t}const Xn=be?[De.x+Ii,De.y]:[0,0];let yn=be?[0,0]:[De.x+Ii+he[0],De.y+he[1]-Xt],Si=[0,0];Yt&&(Si=yn,yn=[0,0]);const Vi=De.metrics.isDoubleResolution?2:1,Xi=(De.metrics.left-nt)*De.scale-Ii+yn[0],_n=(-De.metrics.top-nt)*De.scale+yn[1],vn=Xi+Ee.w/Vi*De.scale/_t,Pi=_n+Ee.h/Vi*De.scale/_t,Mi=new te(Xi,_n),rn=new te(vn,_n),xn=new te(Xi,Pi),sn=new te(vn,Pi);if(Yt){const zi=new te(-Ii,Ii-Bu),bt=-Math.PI/2,on=Ei/2-Ii,Ki=new te(5-Bu-on,-(De.imageName?on:0)),Ai=new te(...Si);Mi._rotateAround(bt,zi)._add(Ki)._add(Ai),rn._rotateAround(bt,zi)._add(Ki)._add(Ai),xn._rotateAround(bt,zi)._add(Ki)._add(Ai),sn._rotateAround(bt,zi)._add(Ki)._add(Ai)}if(Ve){const zi=Math.sin(Ve),bt=Math.cos(Ve),on=[bt,-zi,zi,bt];Mi._matMult(on),rn._matMult(on),xn._matMult(on),sn._matMult(on)}const Ln=new te(0,0),Dn=new te(0,0);ze.push({tl:Mi,tr:rn,bl:xn,br:sn,tex:Ee,writingMode:ie.writingMode,glyphOffset:Xn,sectionIndex:De.sectionIndex,isSDF:Qe,pixelOffsetTL:Ln,pixelOffsetBR:Dn,minFontScaleX:0,minFontScaleY:0})}return ze}(0,r,v,h,f,g,a,n.allowVerticalPlacement),W=n.textSizeData;let Q=null;W.kind==="source"?(Q=[cs*h.layout.get("text-size").evaluate(g,{})],Q[0]>po&&Di(`${n.layerIds[0]}: Value for "text-size" is >= ${Nu}. Reduce your "text-size".`)):W.kind==="composite"&&(Q=[cs*B.compositeTextSizes[0].evaluate(g,{},O),cs*B.compositeTextSizes[1].evaluate(g,{},O)],(Q[0]>po||Q[1]>po)&&Di(`${n.layerIds[0]}: Value for "text-size" is >= ${Nu}. Reduce your "text-size".`)),n.addSymbols(n.text,j,Q,v,f,g,k,e,b.lineStartIndex,b.lineLength,L,O);for(const ue of E)z[ue]=n.text.placedSymbolArray.length-1;return 4*j.length}function o_(n){for(const e in n)return n[e];return null}function Bw(n,e,r,a){const h=n.compareText;if(e in h){const f=h[e];for(let g=f.length-1;g>=0;g--)if(a.dist(f[g])<r)return!0}else h[e]=[];return h[e].push(a),!1}const a_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class rf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,a]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const f=a_[15&a];if(!f)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new rf(v,g,f,e)}constructor(e,r=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=a_.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+b),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=r,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return sf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:v}=this,b=[0,f.length-1,0],k=[];for(;b.length;){const E=b.pop()||0,z=b.pop()||0,L=b.pop()||0;if(z-L<=v){for(let W=L;W<=z;W++){const Q=g[2*W],ue=g[2*W+1];Q>=e&&Q<=a&&ue>=r&&ue<=h&&k.push(f[W])}continue}const B=L+z>>1,O=g[2*B],j=g[2*B+1];O>=e&&O<=a&&j>=r&&j<=h&&k.push(f[B]),(E===0?e<=O:r<=j)&&(b.push(L),b.push(B-1),b.push(1-E)),(E===0?a>=O:h>=j)&&(b.push(B+1),b.push(z),b.push(1-E))}return k}within(e,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:f,nodeSize:g}=this,v=[0,h.length-1,0],b=[],k=a*a;for(;v.length;){const E=v.pop()||0,z=v.pop()||0,L=v.pop()||0;if(z-L<=g){for(let W=L;W<=z;W++)u_(f[2*W],f[2*W+1],e,r)<=k&&b.push(h[W]);continue}const B=L+z>>1,O=f[2*B],j=f[2*B+1];u_(O,j,e,r)<=k&&b.push(h[B]),(E===0?e-a<=O:r-a<=j)&&(v.push(L),v.push(B-1),v.push(1-E)),(E===0?e+a>=O:r+a>=j)&&(v.push(B+1),v.push(z),v.push(1-E))}return b}}function sf(n,e,r,a,h,f){if(h-a<=r)return;const g=a+h>>1;l_(n,e,g,a,h,f),sf(n,e,r,a,g-1,1-f),sf(n,e,r,g+1,h,1-f)}function l_(n,e,r,a,h,f){for(;h>a;){if(h-a>600){const k=h-a+1,E=r-a+1,z=Math.log(k),L=.5*Math.exp(2*z/3),B=.5*Math.sqrt(z*L*(k-L)/k)*(E-k/2<0?-1:1);l_(n,e,r,Math.max(a,Math.floor(r-E*L/k+B)),Math.min(h,Math.floor(r+(k-E)*L/k+B)),f)}const g=e[2*r+f];let v=a,b=h;for(Uu(n,e,a,r),e[2*h+f]>g&&Uu(n,e,a,h);v<b;){for(Uu(n,e,v,b),v++,b--;e[2*v+f]<g;)v++;for(;e[2*b+f]>g;)b--}e[2*a+f]===g?Uu(n,e,a,b):(b++,Uu(n,e,b,h)),b<=r&&(a=b+1),r<=b&&(h=b-1)}}function Uu(n,e,r,a){of(n,r,a),of(e,2*r,2*a),of(e,2*r+1,2*a+1)}function of(n,e,r){const a=n[e];n[e]=n[r],n[r]=a}function u_(n,e,r,a){const h=n-r,f=e-a;return h*h+f*f}var af;l.bh=void 0,(af=l.bh||(l.bh={})).create="create",af.load="load",af.fullLoad="fullLoad";let Nh=null,ju=[];const lf=1e3/60,uf="loadTime",cf="fullLoadTime",Ow={mark(n){performance.mark(n)},frame(n){const e=n;Nh!=null&&ju.push(e-Nh),Nh=e},clearMetrics(){Nh=null,ju=[],performance.clearMeasures(uf),performance.clearMeasures(cf);for(const n in l.bh)performance.clearMarks(l.bh[n])},getPerformanceMetrics(){performance.measure(uf,l.bh.create,l.bh.load),performance.measure(cf,l.bh.create,l.bh.fullLoad);const n=performance.getEntriesByName(uf)[0].duration,e=performance.getEntriesByName(cf)[0].duration,r=ju.length,a=1/(ju.reduce((f,g)=>f+g,0)/r/1e3),h=ju.filter(f=>f>lf).reduce((f,g)=>f+(g-lf)/lf,0);return{loadTime:n,fullLoadTime:e,fps:a,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};l.$=function(n,e,r){var a,h,f,g,v,b,k,E,z,L,B,O,j=r[0],W=r[1],Q=r[2];return e===n?(n[12]=e[0]*j+e[4]*W+e[8]*Q+e[12],n[13]=e[1]*j+e[5]*W+e[9]*Q+e[13],n[14]=e[2]*j+e[6]*W+e[10]*Q+e[14],n[15]=e[3]*j+e[7]*W+e[11]*Q+e[15]):(h=e[1],f=e[2],g=e[3],v=e[4],b=e[5],k=e[6],E=e[7],z=e[8],L=e[9],B=e[10],O=e[11],n[0]=a=e[0],n[1]=h,n[2]=f,n[3]=g,n[4]=v,n[5]=b,n[6]=k,n[7]=E,n[8]=z,n[9]=L,n[10]=B,n[11]=O,n[12]=a*j+v*W+z*Q+e[12],n[13]=h*j+b*W+L*Q+e[13],n[14]=f*j+k*W+B*Q+e[14],n[15]=g*j+E*W+O*Q+e[15]),n},l.A=Ja,l.B=En,l.C=class{constructor(n,e,r){this.receive=a=>{const h=a.data,f=h.id;if(f&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){delete this.tasks[f];const g=this.cancelCallbacks[f];delete this.cancelCallbacks[f],g&&g()}else qi()||h.mustQueue?(this.tasks[f]=h,this.taskQueue.push(f),this.invoker.trigger()):this.processTask(f,h)},this.process=()=>{if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),h=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),h&&this.processTask(a,h)},this.target=n,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Iw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=qi()?n:window}send(n,e,r,a,h=!1){const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[f]=r);const g=[],v={id:f,type:n,hasCallback:!!r,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:as(e,g)};return this.target.postMessage(v,{transfer:g}),{cancel:()=>{r&&delete this.callbacks[f],this.target.postMessage({id:f,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}processTask(n,e){if(e.type==="<response>"){const r=this.callbacks[n];delete this.callbacks[n],r&&(e.error?r(oo(e.error)):r(null,oo(e.data)))}else{let r=!1;const a=[],h=e.hasCallback?(v,b)=>{r=!0,delete this.cancelCallbacks[n];const k={id:n,type:"<response>",sourceMapId:this.mapId,error:v?as(v):null,data:as(b,a)};this.target.postMessage(k,{transfer:a})}:v=>{r=!0};let f=null;const g=oo(e.data);if(this.parent[e.type])f=this.parent[e.type](e.sourceMapId,g,h);else if("getWorkerSource"in this.parent){const v=e.type.split(".");f=this.parent.getWorkerSource(e.sourceMapId,v[0],g.source)[v[1]](g,h)}else h(new Error(`Could not find function ${e.type}`));!r&&f&&f.cancel&&(this.cancelCallbacks[n]=f.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.D=Je,l.E=_s,l.F=function(n,e){const r={};for(let a=0;a<e.length;a++){const h=e[a];h in n&&(r[h]=n[h])}return r},l.G=By,l.H=Oy,l.I=qp,l.J=Y,l.K=se,l.L=fo,l.M=$t,l.N=bi,l.O=sr,l.P=te,l.Q=ti,l.R=rr,l.S=Wt,l.T=fh,l.U=Dh,l.V=class extends Is{},l.W=ef,l.X=function(n,e){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let a=0;a<n.length;a++){const h=window.document.createElement("source");zr(n[a])||(r.crossOrigin="Anonymous"),h.src=n[a],r.appendChild(h)}return{cancel:()=>{}}},l.Y=Ae,l.Z=function(){var n=new Ja(16);return Ja!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},l._=N,l.a=dt,l.a$=class extends F{},l.a0=function(n,e,r){var a=r[0],h=r[1],f=r[2];return n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n[3]=e[3]*a,n[4]=e[4]*h,n[5]=e[5]*h,n[6]=e[6]*h,n[7]=e[7]*h,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},l.a1=jg,l.a2=function(){return Et++},l.a3=G,l.a4=sl,l.a5=function(){Mn.isLoading()||Mn.isLoaded()||gu()!=="deferred"||ph()},l.a6=su,l.a7=na,l.a8=Ht,l.a9=Zy,l.aA=Yo,l.aB=function(n){n=n.slice();const e=Object.create(null);for(let r=0;r<n.length;r++)e[n[r].id]=n[r];for(let r=0;r<n.length;r++)"ref"in n[r]&&(n[r]=Un(n[r],e[n[r].ref]));return n},l.aC=function(n){if(n.type==="custom")return new Ew(n);switch(n.type){case"background":return new Tw(n);case"circle":return new u1(n);case"fill":return new P1(n);case"fill-extrusion":return new q1(n);case"heatmap":return new h1(n);case"hillshade":return new p1(n);case"line":return new Q1(n);case"raster":return new Cw(n);case"symbol":return new Lh(n)}},l.aD=ui,l.aE=function(n,e){if(!n)return[{command:It.setStyle,args:[e]}];let r=[];try{if(!jt(n.version,e.version))return[{command:It.setStyle,args:[e]}];jt(n.center,e.center)||r.push({command:It.setCenter,args:[e.center]}),jt(n.zoom,e.zoom)||r.push({command:It.setZoom,args:[e.zoom]}),jt(n.bearing,e.bearing)||r.push({command:It.setBearing,args:[e.bearing]}),jt(n.pitch,e.pitch)||r.push({command:It.setPitch,args:[e.pitch]}),jt(n.sprite,e.sprite)||r.push({command:It.setSprite,args:[e.sprite]}),jt(n.glyphs,e.glyphs)||r.push({command:It.setGlyphs,args:[e.glyphs]}),jt(n.transition,e.transition)||r.push({command:It.setTransition,args:[e.transition]}),jt(n.light,e.light)||r.push({command:It.setLight,args:[e.light]});const a={},h=[];(function(g,v,b,k){let E;for(E in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,E)&&(Object.prototype.hasOwnProperty.call(v,E)||Ws(E,b,k));for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&(Object.prototype.hasOwnProperty.call(g,E)?jt(g[E],v[E])||(g[E].type==="geojson"&&v[E].type==="geojson"&&ba(g,v,E)?b.push({command:It.setGeoJSONSourceData,args:[E,v[E].data]}):Ar(E,v,b,k)):fr(E,v,b))})(n.sources,e.sources,h,a);const f=[];n.layers&&n.layers.forEach(g=>{a[g.source]?r.push({command:It.removeLayer,args:[g.id]}):f.push(g)}),r=r.concat(h),function(g,v,b){v=v||[];const k=(g=g||[]).map(is),E=v.map(is),z=g.reduce(vs,{}),L=v.reduce(vs,{}),B=k.slice(),O=Object.create(null);let j,W,Q,ue,ie,he,fe;for(j=0,W=0;j<k.length;j++)Q=k[j],Object.prototype.hasOwnProperty.call(L,Q)?W++:(b.push({command:It.removeLayer,args:[Q]}),B.splice(B.indexOf(Q,W),1));for(j=0,W=0;j<E.length;j++)Q=E[E.length-1-j],B[B.length-1-j]!==Q&&(Object.prototype.hasOwnProperty.call(z,Q)?(b.push({command:It.removeLayer,args:[Q]}),B.splice(B.lastIndexOf(Q,B.length-W),1)):W++,he=B[B.length-j],b.push({command:It.addLayer,args:[L[Q],he]}),B.splice(B.length-j,0,Q),O[Q]=!0);for(j=0;j<E.length;j++)if(Q=E[j],ue=z[Q],ie=L[Q],!O[Q]&&!jt(ue,ie))if(jt(ue.source,ie.source)&&jt(ue["source-layer"],ie["source-layer"])&&jt(ue.type,ie.type)){for(fe in Xs(ue.layout,ie.layout,b,Q,null,It.setLayoutProperty),Xs(ue.paint,ie.paint,b,Q,null,It.setPaintProperty),jt(ue.filter,ie.filter)||b.push({command:It.setFilter,args:[Q,ie.filter]}),jt(ue.minzoom,ie.minzoom)&&jt(ue.maxzoom,ie.maxzoom)||b.push({command:It.setLayerZoomRange,args:[Q,ie.minzoom,ie.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Xs(ue[fe],ie[fe],b,Q,fe.slice(6),It.setPaintProperty):jt(ue[fe],ie[fe])||b.push({command:It.setLayerProperty,args:[Q,fe,ie[fe]]}));for(fe in ie)Object.prototype.hasOwnProperty.call(ie,fe)&&!Object.prototype.hasOwnProperty.call(ue,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Xs(ue[fe],ie[fe],b,Q,fe.slice(6),It.setPaintProperty):jt(ue[fe],ie[fe])||b.push({command:It.setLayerProperty,args:[Q,fe,ie[fe]]}))}else b.push({command:It.removeLayer,args:[Q]}),he=B[B.lastIndexOf(Q)+1],b.push({command:It.addLayer,args:[ie,he]})}(f,e.layers,r)}catch(a){console.warn("Unable to compute style diff:",a),r=[{command:It.setStyle,args:[e]}]}return r},l.aF=function(n){const e=[],r=n.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},l.aG=function n(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let a=0;a<e.length;a++)if(!n(e[a],r[a]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(!n(e[a],r[a]))return!1;return!0}return e===r},l.aH=tt,l.aI=Ot,l.aJ=Qo,l.aK=function(n){return n({pluginStatus:fn,pluginURL:ls}),Qo.on("pluginStateChange",n),n},l.aL=class extends zs{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},l.aM=Ya,l.aN=class extends zs{constructor(n,e){super(n,e),this.current=bp}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},l.aO=_h,l.aP=class extends zs{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},l.aQ=class extends zs{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},l.aR=vh,l.aS=function(n,e,r,a,h,f,g){var v=1/(e-r),b=1/(a-h),k=1/(f-g);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*b,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*k,n[11]=0,n[12]=(e+r)*v,n[13]=(h+a)*b,n[14]=(g+f)*k,n[15]=1,n},l.aT=Ft,l.aU=l1,l.aV=class extends c{},l.aW=iw,l.aX=class extends m{},l.aY=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},l.aZ=Hg,l.a_=Ie,l.aa=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,a,h,f)=>{const g=h||f;return e[a]=!g||g.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},l.ab=function(n,e){const r=[];for(const a in n)a in e||r.push(a);return r},l.ac=function(n){if(He==null){const e=n.navigator?n.navigator.userAgent:null;He=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return He},l.ad=Oe,l.ae=function(n,e,r){var a=Math.sin(r),h=Math.cos(r),f=e[0],g=e[1],v=e[2],b=e[3],k=e[4],E=e[5],z=e[6],L=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*h+k*a,n[1]=g*h+E*a,n[2]=v*h+z*a,n[3]=b*h+L*a,n[4]=k*h-f*a,n[5]=E*h-g*a,n[6]=z*h-v*a,n[7]=L*h-b*a,n},l.af=function(n){var e=new Ja(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},l.ag=Sh,l.ah=function(n,e){let r=0,a=0;if(n.kind==="constant")a=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:f,maxZoom:g}=n,v=h?Oe(In.interpolationFactor(h,e,f,g),0,1):0;n.kind==="camera"?a=En.number(n.minSize,n.maxSize,v):r=v}return{uSizeT:r,uSize:a}},l.aj=function(n,{uSize:e,uSizeT:r},{lowerSize:a,upperSize:h}){return n.kind==="source"?a/cs:n.kind==="composite"?En.number(a/cs,h/cs,r):e},l.ak=Wp,l.al=function(n,e,r,a){const h=e.y-n.y,f=e.x-n.x,g=a.y-r.y,v=a.x-r.x,b=g*f-v*h;if(b===0)return null;const k=(v*(n.y-r.y)-g*(n.x-r.x))/b;return new te(n.x+k*f,n.y+k*h)},l.am=Xy,l.an=Fg,l.ao=Ep,l.ap=Ei,l.ar=Hp,l.as=function(n,e){var r=e[0],a=e[1],h=e[2],f=e[3],g=e[4],v=e[5],b=e[6],k=e[7],E=e[8],z=e[9],L=e[10],B=e[11],O=e[12],j=e[13],W=e[14],Q=e[15],ue=r*v-a*g,ie=r*b-h*g,he=r*k-f*g,fe=a*b-h*v,be=a*k-f*v,$e=h*k-f*b,Ke=E*j-z*O,Ue=E*W-L*O,Ve=E*Q-B*O,ze=z*W-L*j,Ze=z*Q-B*j,De=L*Q-B*W,Ee=ue*De-ie*Ze+he*ze+fe*Ve-be*Ue+$e*Ke;return Ee?(n[0]=(v*De-b*Ze+k*ze)*(Ee=1/Ee),n[1]=(h*Ze-a*De-f*ze)*Ee,n[2]=(j*$e-W*be+Q*fe)*Ee,n[3]=(L*be-z*$e-B*fe)*Ee,n[4]=(b*Ve-g*De-k*Ue)*Ee,n[5]=(r*De-h*Ve+f*Ue)*Ee,n[6]=(W*he-O*$e-Q*ie)*Ee,n[7]=(E*$e-L*he+B*ie)*Ee,n[8]=(g*Ze-v*Ve+k*Ke)*Ee,n[9]=(a*Ve-r*Ze-f*Ke)*Ee,n[10]=(O*be-j*he+Q*ue)*Ee,n[11]=(z*he-E*be-B*ue)*Ee,n[12]=(v*Ue-g*ze-b*Ke)*Ee,n[13]=(r*ze-a*Ue+h*Ke)*Ee,n[14]=(j*ie-O*fe-W*ue)*Ee,n[15]=(E*fe-z*ie+L*ue)*Ee,n):null},l.at=nf,l.au=Gp,l.av=rf,l.aw=function(){const n={},e=ye.$version;for(const r in ye.$root){const a=ye.$root[r];if(a.required){let h=null;h=r==="version"?e:a.type==="array"?[]:{},h!=null&&(n[r]=h)}}return n},l.ax=It,l.ay=uh,l.az=nr,l.b=function(n,e){const r=new Blob([new Uint8Array(n)],{type:"image/png"});createImageBitmap(r).then(a=>{e(null,a)}).catch(a=>{e(new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.b0=Oi,l.b1=function(n,e){var r=n[0],a=n[1],h=n[2],f=n[3],g=n[4],v=n[5],b=n[6],k=n[7],E=n[8],z=n[9],L=n[10],B=n[11],O=n[12],j=n[13],W=n[14],Q=n[15],ue=e[0],ie=e[1],he=e[2],fe=e[3],be=e[4],$e=e[5],Ke=e[6],Ue=e[7],Ve=e[8],ze=e[9],Ze=e[10],De=e[11],Ee=e[12],nt=e[13],Qe=e[14],_t=e[15];return Math.abs(r-ue)<=gn*Math.max(1,Math.abs(r),Math.abs(ue))&&Math.abs(a-ie)<=gn*Math.max(1,Math.abs(a),Math.abs(ie))&&Math.abs(h-he)<=gn*Math.max(1,Math.abs(h),Math.abs(he))&&Math.abs(f-fe)<=gn*Math.max(1,Math.abs(f),Math.abs(fe))&&Math.abs(g-be)<=gn*Math.max(1,Math.abs(g),Math.abs(be))&&Math.abs(v-$e)<=gn*Math.max(1,Math.abs(v),Math.abs($e))&&Math.abs(b-Ke)<=gn*Math.max(1,Math.abs(b),Math.abs(Ke))&&Math.abs(k-Ue)<=gn*Math.max(1,Math.abs(k),Math.abs(Ue))&&Math.abs(E-Ve)<=gn*Math.max(1,Math.abs(E),Math.abs(Ve))&&Math.abs(z-ze)<=gn*Math.max(1,Math.abs(z),Math.abs(ze))&&Math.abs(L-Ze)<=gn*Math.max(1,Math.abs(L),Math.abs(Ze))&&Math.abs(B-De)<=gn*Math.max(1,Math.abs(B),Math.abs(De))&&Math.abs(O-Ee)<=gn*Math.max(1,Math.abs(O),Math.abs(Ee))&&Math.abs(j-nt)<=gn*Math.max(1,Math.abs(j),Math.abs(nt))&&Math.abs(W-Qe)<=gn*Math.max(1,Math.abs(W),Math.abs(Qe))&&Math.abs(Q-_t)<=gn*Math.max(1,Math.abs(Q),Math.abs(_t))},l.b2=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},l.b3=function(n,e,r){return n[0]=e[0]*r[0],n[1]=e[1]*r[1],n[2]=e[2]*r[2],n[3]=e[3]*r[3],n},l.b4=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},l.b5=Ge,l.b6=jy,l.b7=Ny,l.b8=function(n,e,r,a,h){var f,g=1/Math.tan(e/2);return n[0]=g/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+a)*(f=1/(a-h)),n[14]=2*h*a*f):(n[10]=-1,n[14]=-2*a),n},l.b9=function(n,e,r){var a=Math.sin(r),h=Math.cos(r),f=e[4],g=e[5],v=e[6],b=e[7],k=e[8],E=e[9],z=e[10],L=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*h+k*a,n[5]=g*h+E*a,n[6]=v*h+z*a,n[7]=b*h+L*a,n[8]=k*h-f*a,n[9]=E*h-g*a,n[10]=z*h-v*a,n[11]=L*h-b*a,n},l.bA=re,l.bB=fy,l.bC=Va,l.bD=Mn,l.ba=ve,l.bb=Fe,l.bc=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},l.bd=class extends ta{},l.be=Qp,l.bf=Vy,l.bg=Ow,l.bi=Qr,l.bj=function(n,e,r=!1){if(fn===hu||fn===du||fn===pu)throw new Error("setRTLTextPlugin cannot be called multiple times.");ls=hn.resolveURL(n),fn=hu,fu=e,mu(),r||ph()},l.bk=gu,l.bl=function(n,e){const r={};for(let h=0;h<n.length;h++){const f=e&&e[n[h].id]||qa(n[h]);e&&(e[n[h].id]=f);let g=r[f];g||(g=r[f]=[]),g.push(n[h])}const a=[];for(const h in r)a.push(r[h]);return a},l.bm=qe,l.bn=qy,l.bo=Gy,l.bp=Sy,l.bq=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=bi/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],r=e.layout,a=e._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new Ht(n.bucket.zoom+1),n.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new Ht(n.bucket.zoom+1),n.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new Ht(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=n.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Ht(k),n.canonical),a["text-size"].possiblyEvaluate(new Ht(E),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=n.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Ht(k),n.canonical),a["icon-size"].possiblyEvaluate(new Ht(E),n.canonical)]}const f=r.get("text-line-height")*Ei,g=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),b=r.get("text-size");for(const k of n.bucket.features){const E=r.get("text-font").evaluate(k,{},n.canonical).join(","),z=b.evaluate(k,{},n.canonical),L=h.layoutTextSize.evaluate(k,{},n.canonical),B=h.layoutIconSize.evaluate(k,{},n.canonical),O={horizontal:{},vertical:void 0},j=k.text;let W,Q=[0,0];if(j){const he=j.toString(),fe=r.get("text-letter-spacing").evaluate(k,{},n.canonical)*Ei,be=uu(he)?fe:0,$e=r.get("text-anchor").evaluate(k,{},n.canonical),Ke=r_(e,k,n.canonical);if(!Ke){const De=r.get("text-radial-offset").evaluate(k,{},n.canonical);Q=De?n_($e,[De*Ei,tf]):r.get("text-offset").evaluate(k,{},n.canonical).map(Ee=>Ee*Ei)}let Ue=g?"center":r.get("text-justify").evaluate(k,{},n.canonical);const Ve=r.get("symbol-placement"),ze=Ve==="point"?r.get("text-max-width").evaluate(k,{},n.canonical)*Ei:0,Ze=()=>{n.bucket.allowVerticalPlacement&&lu(he)&&(O.vertical=Mh(j,n.glyphMap,n.glyphPositions,n.imagePositions,E,ze,f,$e,"left",be,Q,l.ai.vertical,!0,Ve,L,z))};if(!g&&Ke){const De=new Set;if(Ue==="auto")for(let nt=0;nt<Ke.values.length;nt+=2)De.add(nf(Ke.values[nt]));else De.add(Ue);let Ee=!1;for(const nt of De)if(!O.horizontal[nt])if(Ee)O.horizontal[nt]=O.horizontal[0];else{const Qe=Mh(j,n.glyphMap,n.glyphPositions,n.imagePositions,E,ze,f,"center",nt,be,Q,l.ai.horizontal,!1,Ve,L,z);Qe&&(O.horizontal[nt]=Qe,Ee=Qe.positionedLines.length===1)}Ze()}else{Ue==="auto"&&(Ue=nf($e));const De=Mh(j,n.glyphMap,n.glyphPositions,n.imagePositions,E,ze,f,$e,Ue,be,Q,l.ai.horizontal,!1,Ve,L,z);De&&(O.horizontal[Ue]=De),Ze(),lu(he)&&g&&v&&(O.vertical=Mh(j,n.glyphMap,n.glyphPositions,n.imagePositions,E,ze,f,$e,Ue,be,Q,l.ai.vertical,!1,Ve,L,z))}}let ue=!1;if(k.icon&&k.icon.name){const he=n.imageMap[k.icon.name];he&&(W=vw(n.imagePositions[k.icon.name],r.get("icon-offset").evaluate(k,{},n.canonical),r.get("icon-anchor").evaluate(k,{},n.canonical)),ue=!!he.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=ue:n.bucket.sdfIcons!==ue&&Di("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(he.pixelRatio!==n.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const ie=o_(O.horizontal)||O.vertical;n.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||W)&&Fw(n.bucket,k,O,W,n.imageMap,h,L,B,Q,ue,n.canonical)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},l.br=Vp,l.bs=Bp,l.bt=Np,l.bu=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},l.bv=jp,l.bw=co,l.bx=function(n,e,r,a,h){return N(this,void 0,void 0,function*(){if(se())try{return yield $t(n,e,r,a,h)}catch{}return function(f,g,v,b,k){const E=f.width,z=f.height;Nt&&Dt||(Nt=new OffscreenCanvas(E,z),Dt=Nt.getContext("2d",{willReadFrequently:!0})),Nt.width=E,Nt.height=z,Dt.drawImage(f,0,0,E,z);const L=Dt.getImageData(g,v,b,k);return Dt.clearRect(0,0,E,z),L.data}(n,e,r,a,h)})},l.by=$y,l.bz=R,l.c=ir,l.d=function(n,e){const r=new Image;r.onload=()=>{e(null,r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=yt})},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const a=new Blob([new Uint8Array(n)],{type:"image/png"});r.src=n.byteLength?URL.createObjectURL(a):yt},l.e=Be,l.f=function(n,e){return Jr(Be(n,{type:"json"}),e)},l.g=Vn,l.h=hn,l.i=qi,l.j=ts,l.k=es,l.l=No,l.m=Jr,l.n=function(n){return new jp(n).readFields(pw,[])},l.o=function(n,e,r){if(!n.length)return r(null,[]);let a=n.length;const h=new Array(n.length);let f=null;n.forEach((g,v)=>{e(g,(b,k)=>{b&&(f=b),h[v]=k,--a==0&&r(f,h)})})},l.p=by,l.q=Pu,l.r=mi,l.s=zr,l.t=_p,l.u=je,l.v=ye,l.w=Di,l.x=Ha,l.y=Or,l.z=function([n,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(r),y:n*Math.sin(e)*Math.sin(r),z:n*Math.cos(r)}}}),S(["./shared"],function(l){class N{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,D){for(const H of A){this._layerConfigs[H.id]=H;const X=this._layers[H.id]=l.aC(H);X._featureFilter=l.a6(X.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of D)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const V=l.bl(Object.values(this._layerConfigs),this.keyCache);for(const H of V){const X=H.map(xe=>this._layers[xe.id]),ce=X[0];if(ce.visibility==="none")continue;const ne=ce.source||"";let J=this.familiesBySource[ne];J||(J=this.familiesBySource[ne]={});const le=ce.sourceLayer||"_geojsonTileLayer";let _e=J[le];_e||(_e=J[le]=[]),_e.push(X)}}}class R{constructor(A){const D={},V=[];for(const ne in A){const J=A[ne],le=D[ne]={};for(const _e in J){const xe=J[+_e];if(!xe||xe.bitmap.width===0||xe.bitmap.height===0)continue;const Se={x:0,y:0,w:xe.bitmap.width+2,h:xe.bitmap.height+2};V.push(Se),le[_e]={rect:Se,metrics:xe.metrics}}}const{w:H,h:X}=l.p(V),ce=new l.q({width:H||1,height:X||1});for(const ne in A){const J=A[ne];for(const le in J){const _e=J[+le];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;const xe=D[ne][le].rect;l.q.copy(_e.bitmap,ce,{x:0,y:0},{x:xe.x+1,y:xe.y+1},_e.bitmap)}}this.image=ce,this.positions=D}}l.bm("GlyphAtlas",R);class re{constructor(A){this.tileID=new l.O(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(A,D,V,H,X){this.status="parsing",this.data=A,this.collisionBoxArray=new l.a3;const ce=new l.bn(Object.keys(A.layers).sort()),ne=new l.bo(this.tileID,this.promoteId);ne.bucketLayerIDs=[];const J={},le={featureIndex:ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},_e=D.familiesBySource[this.source];for(const Ct in _e){const kt=A.layers[Ct];if(!kt)continue;kt.version===1&&l.w(`Vector tile source "${this.source}" layer "${Ct}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Zi=ce.encode(Ct),qt=[];for(let wi=0;wi<kt.length;wi++){const Fi=kt.feature(wi),jn=ne.getId(Fi,Ct);qt.push({feature:Fi,id:jn,index:wi,sourceLayerIndex:Zi})}for(const wi of _e[Ct]){const Fi=wi[0];Fi.source!==this.source&&l.w(`layer.source = ${Fi.source} does not equal this.source = ${this.source}`),Fi.minzoom&&this.zoom<Math.floor(Fi.minzoom)||Fi.maxzoom&&this.zoom>=Fi.maxzoom||Fi.visibility!=="none"&&(de(wi,this.zoom,V),(J[Fi.id]=Fi.createBucket({index:ne.bucketLayerIDs.length,layers:wi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Zi,sourceID:this.source})).populate(qt,le,this.tileID.canonical),ne.bucketLayerIDs.push(wi.map(jn=>jn.id)))}}let xe,Se,it,lt;const We=l.aH(le.glyphDependencies,Ct=>Object.keys(Ct).map(Number));this.inFlightDependencies.forEach(Ct=>Ct==null?void 0:Ct.cancel()),this.inFlightDependencies=[];const rt=++this.dependencySentinel;Object.keys(We).length?this.inFlightDependencies.push(H.send("getGlyphs",{uid:this.uid,stacks:We,source:this.source,tileID:this.tileID,type:"glyphs"},(Ct,kt)=>{rt===this.dependencySentinel&&(xe||(xe=Ct,Se=kt,Vt.call(this)))})):Se={};const ht=Object.keys(le.iconDependencies);ht.length?this.inFlightDependencies.push(H.send("getImages",{icons:ht,source:this.source,tileID:this.tileID,type:"icons"},(Ct,kt)=>{rt===this.dependencySentinel&&(xe||(xe=Ct,it=kt,Vt.call(this)))})):it={};const Lt=Object.keys(le.patternDependencies);function Vt(){if(xe)return X(xe);if(Se&&it&&lt){const Ct=new R(Se),kt=new l.bp(it,lt);for(const Zi in J){const qt=J[Zi];qt instanceof l.a4?(de(qt.layers,this.zoom,V),l.bq({bucket:qt,glyphMap:Se,glyphPositions:Ct.positions,imageMap:it,imagePositions:kt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):qt.hasPattern&&(qt instanceof l.br||qt instanceof l.bs||qt instanceof l.bt)&&(de(qt.layers,this.zoom,V),qt.addFeatures(le,this.tileID.canonical,kt.patternPositions))}this.status="done",X(null,{buckets:Object.values(J).filter(Zi=>!Zi.isEmpty()),featureIndex:ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ct.image,imageAtlas:kt,glyphMap:this.returnDependencies?Se:null,iconMap:this.returnDependencies?it:null,glyphPositions:this.returnDependencies?Ct.positions:null})}}Lt.length?this.inFlightDependencies.push(H.send("getImages",{icons:Lt,source:this.source,tileID:this.tileID,type:"patterns"},(Ct,kt)=>{rt===this.dependencySentinel&&(xe||(xe=Ct,lt=kt,Vt.call(this)))})):lt={},Vt.call(this)}}function de(Z,A,D){const V=new l.a8(A);for(const H of Z)H.recalculate(V,D)}function te(Z,A){const D=l.l(Z.request,(V,H,X,ce)=>{if(V)A(V);else if(H)try{const ne=new l.bw.VectorTile(new l.bv(H));A(null,{vectorTile:ne,rawData:H,cacheControl:X,expires:ce})}catch(ne){const J=new Uint8Array(H);let le=`Unable to parse the tile at ${Z.request.url}, `;le+=J[0]===31&&J[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.messge}`,A(new Error(le))}});return()=>{D.cancel(),A()}}class Pe{constructor(A,D,V,H){this.actor=A,this.layerIndex=D,this.availableImages=V,this.loadVectorData=H||te,this.fetching={},this.loading={},this.loaded={}}loadTile(A,D){const V=A.uid;this.loading||(this.loading={});const H=!!(A&&A.request&&A.request.collectResourceTiming)&&new l.bu(A.request),X=this.loading[V]=new re(A);X.abort=this.loadVectorData(A,(ce,ne)=>{if(delete this.loading[V],ce||!ne)return X.status="done",this.loaded[V]=X,D(ce);const J=ne.rawData,le={};ne.expires&&(le.expires=ne.expires),ne.cacheControl&&(le.cacheControl=ne.cacheControl);const _e={};if(H){const xe=H.finish();xe&&(_e.resourceTiming=JSON.parse(JSON.stringify(xe)))}X.vectorTile=ne.vectorTile,X.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,(xe,Se)=>{if(delete this.fetching[V],xe||!Se)return D(xe);D(null,l.e({rawTileData:J.slice(0)},Se,le,_e))}),this.loaded=this.loaded||{},this.loaded[V]=X,this.fetching[V]={rawTileData:J,cacheControl:le,resourceTiming:_e}})}reloadTile(A,D){const V=this.loaded,H=A.uid;if(V&&V[H]){const X=V[H];X.showCollisionBoxes=A.showCollisionBoxes,X.status==="parsing"?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,(ce,ne)=>{if(ce||!ne)return D(ce,ne);let J;if(this.fetching[H]){const{rawTileData:le,cacheControl:_e,resourceTiming:xe}=this.fetching[H];delete this.fetching[H],J=l.e({rawTileData:le.slice(0)},ne,_e,xe)}else J=ne;D(null,J)}):X.status==="done"&&(X.vectorTile?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,D):D())}}abortTile(A,D){const V=this.loading,H=A.uid;V&&V[H]&&V[H].abort&&(V[H].abort(),delete V[H]),D()}removeTile(A,D){const V=this.loaded,H=A.uid;V&&V[H]&&delete V[H],D()}}class ke{constructor(){this.loaded={}}loadTile(A,D){return l._(this,void 0,void 0,function*(){const{uid:V,encoding:H,rawImageData:X,redFactor:ce,greenFactor:ne,blueFactor:J,baseShift:le}=A,_e=X.width+2,xe=X.height+2,Se=l.a(X)?new l.R({width:_e,height:xe},yield l.bx(X,-1,-1,_e,xe)):X,it=new l.by(V,Se,H,ce,ne,J,le);this.loaded=this.loaded||{},this.loaded[V]=it,D(null,it)})}removeTile(A){const D=this.loaded,V=A.uid;D&&D[V]&&delete D[V]}}function Me(Z,A){if(Z.length!==0){ut(Z[0],A);for(var D=1;D<Z.length;D++)ut(Z[D],!A)}}function ut(Z,A){for(var D=0,V=0,H=0,X=Z.length,ce=X-1;H<X;ce=H++){var ne=(Z[H][0]-Z[ce][0])*(Z[ce][1]+Z[H][1]),J=D+ne;V+=Math.abs(D)>=Math.abs(ne)?D-J+ne:ne-J+D,D=J}D+V>=0!=!!A&&Z.reverse()}var ee=l.bz(function Z(A,D){var V,H=A&&A.type;if(H==="FeatureCollection")for(V=0;V<A.features.length;V++)Z(A.features[V],D);else if(H==="GeometryCollection")for(V=0;V<A.geometries.length;V++)Z(A.geometries[V],D);else if(H==="Feature")Z(A.geometry,D);else if(H==="Polygon")Me(A.coordinates,D);else if(H==="MultiPolygon")for(V=0;V<A.coordinates.length;V++)Me(A.coordinates[V],D);return A});const Y=l.bw.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},ve=l.bA,Fe=l.bw.VectorTileFeature,Oe=Ge;function Ge(Z,A){this.options=A||{},this.features=Z,this.length=Z.length}function Be(Z,A){this.id=typeof Z.id=="number"?Z.id:void 0,this.type=Z.type,this.rawGeometry=Z.type===1?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=A||4096}Ge.prototype.feature=function(Z){return new Be(this.features[Z],this.options.extent)},Be.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var A=0;A<Z.length;A++){for(var D=Z[A],V=[],H=0;H<D.length;H++)V.push(new ve(D[H][0],D[H][1]));this.geometry.push(V)}return this.geometry},Be.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,A=1/0,D=-1/0,V=1/0,H=-1/0,X=0;X<Z.length;X++)for(var ce=Z[X],ne=0;ne<ce.length;ne++){var J=ce[ne];A=Math.min(A,J.x),D=Math.max(D,J.x),V=Math.min(V,J.y),H=Math.max(H,J.y)}return[A,V,D,H]},Be.prototype.toGeoJSON=Fe.prototype.toGeoJSON;var Et=l.bB,tt=Oe;function Ot(Z){var A=new Et;return function(D,V){for(var H in D.layers)V.writeMessage(3,ui,D.layers[H])}(Z,A),A.finish()}function ui(Z,A){var D;A.writeVarintField(15,Z.version||1),A.writeStringField(1,Z.name||""),A.writeVarintField(5,Z.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(D=0;D<Z.length;D++)V.feature=Z.feature(D),A.writeMessage(2,$i,V);var H=V.keys;for(D=0;D<H.length;D++)A.writeStringField(3,H[D]);var X=V.values;for(D=0;D<X.length;D++)A.writeMessage(4,He,X[D])}function $i(Z,A){var D=Z.feature;D.id!==void 0&&A.writeVarintField(1,D.id),A.writeMessage(2,Di,Z),A.writeVarintField(3,D.type),A.writeMessage(4,qi,D)}function Di(Z,A){var D=Z.feature,V=Z.keys,H=Z.values,X=Z.keycache,ce=Z.valuecache;for(var ne in D.properties){var J=D.properties[ne],le=X[ne];if(J!==null){le===void 0&&(V.push(ne),X[ne]=le=V.length-1),A.writeVarint(le);var _e=typeof J;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(J=JSON.stringify(J));var xe=_e+":"+J,Se=ce[xe];Se===void 0&&(H.push(J),ce[xe]=Se=H.length-1),A.writeVarint(Se)}}}function Ji(Z,A){return(A<<3)+(7&Z)}function kn(Z){return Z<<1^Z>>31}function qi(Z,A){for(var D=Z.loadGeometry(),V=Z.type,H=0,X=0,ce=D.length,ne=0;ne<ce;ne++){var J=D[ne],le=1;V===1&&(le=J.length),A.writeVarint(Ji(1,le));for(var _e=V===3?J.length-1:J.length,xe=0;xe<_e;xe++){xe===1&&V!==1&&A.writeVarint(Ji(2,_e-1));var Se=J[xe].x-H,it=J[xe].y-X;A.writeVarint(kn(Se)),A.writeVarint(kn(it)),H+=Se,X+=it}V===3&&A.writeVarint(Ji(7,1))}}function He(Z,A){var D=typeof Z;D==="string"?A.writeStringField(1,Z):D==="boolean"?A.writeBooleanField(7,Z):D==="number"&&(Z%1!=0?A.writeDoubleField(3,Z):Z<0?A.writeSVarintField(6,Z):A.writeVarintField(5,Z))}se.exports=Ot,se.exports.fromVectorTileJs=Ot,se.exports.fromGeojsonVt=function(Z,A){A=A||{};var D={};for(var V in Z)D[V]=new tt(Z[V].features,A),D[V].name=V,D[V].version=A.version,D[V].extent=A.extent;return Ot({layers:D})},se.exports.GeoJSONWrapper=tt;var dt=l.bz(se.exports);const yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Z=>Z},$t=Math.fround||(Nt=new Float32Array(1),Z=>(Nt[0]=+Z,Nt[0]));var Nt;const Dt=3,ci=5,tr=6;class hn{constructor(A){this.options=Object.assign(Object.create(yt),A),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(A){const{log:D,minZoom:V,maxZoom:H}=this.options;D&&console.time("total time");const X=`prepare ${A.length} points`;D&&console.time(X),this.points=A;const ce=[];for(let J=0;J<A.length;J++){const le=A[J];if(!le.geometry)continue;const[_e,xe]=le.geometry.coordinates,Se=$t(nr(_e)),it=$t(Vn(xe));ce.push(Se,it,1/0,J,-1,1),this.options.reduce&&ce.push(0)}let ne=this.trees[H+1]=this._createTree(ce);D&&console.timeEnd(X);for(let J=H;J>=V;J--){const le=+Date.now();ne=this.trees[J]=this._createTree(this._cluster(ne,J)),D&&console.log("z%d: %d clusters in %dms",J,ne.numItems,+Date.now()-le)}return D&&console.timeEnd("total time"),this}getClusters(A,D){let V=((A[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,A[1]));let X=A[2]===180?180:((A[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)V=-180,X=180;else if(V>X){const xe=this.getClusters([V,H,180,ce],D),Se=this.getClusters([-180,H,X,ce],D);return xe.concat(Se)}const ne=this.trees[this._limitZoom(D)],J=ne.range(nr(V),Vn(ce),nr(X),Vn(H)),le=ne.data,_e=[];for(const xe of J){const Se=this.stride*xe;_e.push(le[Se+ci]>1?ir(le,Se,this.clusterProps):this.points[le[Se+Dt]])}return _e}getChildren(A){const D=this._getOriginId(A),V=this._getOriginZoom(A),H="No cluster with the specified id.",X=this.trees[V];if(!X)throw new Error(H);const ce=X.data;if(D*this.stride>=ce.length)throw new Error(H);const ne=this.options.radius/(this.options.extent*Math.pow(2,V-1)),J=X.within(ce[D*this.stride],ce[D*this.stride+1],ne),le=[];for(const _e of J){const xe=_e*this.stride;ce[xe+4]===A&&le.push(ce[xe+ci]>1?ir(ce,xe,this.clusterProps):this.points[ce[xe+Dt]])}if(le.length===0)throw new Error(H);return le}getLeaves(A,D,V){const H=[];return this._appendLeaves(H,A,D=D||10,V=V||0,0),H}getTile(A,D,V){const H=this.trees[this._limitZoom(A)],X=Math.pow(2,A),{extent:ce,radius:ne}=this.options,J=ne/ce,le=(V-J)/X,_e=(V+1+J)/X,xe={features:[]};return this._addTileFeatures(H.range((D-J)/X,le,(D+1+J)/X,_e),H.data,D,V,X,xe),D===0&&this._addTileFeatures(H.range(1-J/X,le,1,_e),H.data,X,V,X,xe),D===X-1&&this._addTileFeatures(H.range(0,le,J/X,_e),H.data,-1,V,X,xe),xe.features.length?xe:null}getClusterExpansionZoom(A){let D=this._getOriginZoom(A)-1;for(;D<=this.options.maxZoom;){const V=this.getChildren(A);if(D++,V.length!==1)break;A=V[0].properties.cluster_id}return D}_appendLeaves(A,D,V,H,X){const ce=this.getChildren(D);for(const ne of ce){const J=ne.properties;if(J&&J.cluster?X+J.point_count<=H?X+=J.point_count:X=this._appendLeaves(A,J.cluster_id,V,H,X):X<H?X++:A.push(ne),A.length===V)break}return X}_createTree(A){const D=new l.av(A.length/this.stride|0,this.options.nodeSize,Float32Array);for(let V=0;V<A.length;V+=this.stride)D.add(A[V],A[V+1]);return D.finish(),D.data=A,D}_addTileFeatures(A,D,V,H,X,ce){for(const ne of A){const J=ne*this.stride,le=D[J+ci]>1;let _e,xe,Se;if(le)_e=Qr(D,J,this.clusterProps),xe=D[J],Se=D[J+1];else{const We=this.points[D[J+Dt]];_e=We.properties;const[rt,ht]=We.geometry.coordinates;xe=nr(rt),Se=Vn(ht)}const it={type:1,geometry:[[Math.round(this.options.extent*(xe*X-V)),Math.round(this.options.extent*(Se*X-H))]],tags:_e};let lt;lt=le||this.options.generateId?D[J+Dt]:this.points[D[J+Dt]].id,lt!==void 0&&(it.id=lt),ce.features.push(it)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,D){const{radius:V,extent:H,reduce:X,minPoints:ce}=this.options,ne=V/(H*Math.pow(2,D)),J=A.data,le=[],_e=this.stride;for(let xe=0;xe<J.length;xe+=_e){if(J[xe+2]<=D)continue;J[xe+2]=D;const Se=J[xe],it=J[xe+1],lt=A.within(J[xe],J[xe+1],ne),We=J[xe+ci];let rt=We;for(const ht of lt){const Lt=ht*_e;J[Lt+2]>D&&(rt+=J[Lt+ci])}if(rt>We&&rt>=ce){let ht,Lt=Se*We,Vt=it*We,Ct=-1;const kt=((xe/_e|0)<<5)+(D+1)+this.points.length;for(const Zi of lt){const qt=Zi*_e;if(J[qt+2]<=D)continue;J[qt+2]=D;const wi=J[qt+ci];Lt+=J[qt]*wi,Vt+=J[qt+1]*wi,J[qt+4]=kt,X&&(ht||(ht=this._map(J,xe,!0),Ct=this.clusterProps.length,this.clusterProps.push(ht)),X(ht,this._map(J,qt)))}J[xe+4]=kt,le.push(Lt/rt,Vt/rt,1/0,kt,-1,rt),X&&le.push(Ct)}else{for(let ht=0;ht<_e;ht++)le.push(J[xe+ht]);if(rt>1)for(const ht of lt){const Lt=ht*_e;if(!(J[Lt+2]<=D)){J[Lt+2]=D;for(let Vt=0;Vt<_e;Vt++)le.push(J[Lt+Vt])}}}}return le}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,D,V){if(A[D+ci]>1){const ce=this.clusterProps[A[D+tr]];return V?Object.assign({},ce):ce}const H=this.points[A[D+Dt]].properties,X=this.options.map(H);return V&&X===H?Object.assign({},X):X}}function ir(Z,A,D){return{type:"Feature",id:Z[A+Dt],properties:Qr(Z,A,D),geometry:{type:"Point",coordinates:[(V=Z[A],360*(V-.5)),Oo(Z[A+1])]}};var V}function Qr(Z,A,D){const V=Z[A+ci],H=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V,X=Z[A+tr],ce=X===-1?{}:Object.assign({},D[X]);return Object.assign(ce,{cluster:!0,cluster_id:Z[A+Dt],point_count:V,point_count_abbreviated:H})}function nr(Z){return Z/360+.5}function Vn(Z){const A=Math.sin(Z*Math.PI/180),D=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return D<0?0:D>1?1:D}function Oo(Z){const A=(180-360*Z)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function Jr(Z,A,D,V){for(var H,X=V,ce=D-A>>1,ne=D-A,J=Z[A],le=Z[A+1],_e=Z[D],xe=Z[D+1],Se=A+3;Se<D;Se+=3){var it=No(Z[Se],Z[Se+1],J,le,_e,xe);if(it>X)H=Se,X=it;else if(it===X){var lt=Math.abs(Se-ce);lt<ne&&(H=Se,ne=lt)}}X>V&&(H-A>3&&Jr(Z,A,H,V),Z[H+2]=X,D-H>3&&Jr(Z,H,D,V))}function No(Z,A,D,V,H,X){var ce=H-D,ne=X-V;if(ce!==0||ne!==0){var J=((Z-D)*ce+(A-V)*ne)/(ce*ce+ne*ne);J>1?(D=H,V=X):J>0&&(D+=ce*J,V+=ne*J)}return(ce=Z-D)*ce+(ne=A-V)*ne}function zr(Z,A,D,V){var H={id:Z===void 0?null:Z,type:A,geometry:D,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(X){var ce=X.geometry,ne=X.type;if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Hs(X,ce);else if(ne==="Polygon"||ne==="MultiLineString")for(var J=0;J<ce.length;J++)Hs(X,ce[J]);else if(ne==="MultiPolygon")for(J=0;J<ce.length;J++)for(var le=0;le<ce[J].length;le++)Hs(X,ce[J][le])}(H),H}function Hs(Z,A){for(var D=0;D<A.length;D+=3)Z.minX=Math.min(Z.minX,A[D]),Z.minY=Math.min(Z.minY,A[D+1]),Z.maxX=Math.max(Z.maxX,A[D]),Z.maxY=Math.max(Z.maxY,A[D+1])}function ys(Z,A,D,V){if(A.geometry){var H=A.geometry.coordinates,X=A.geometry.type,ce=Math.pow(D.tolerance/((1<<D.maxZoom)*D.extent),2),ne=[],J=A.id;if(D.promoteId?J=A.properties[D.promoteId]:D.generateId&&(J=V||0),X==="Point")es(H,ne);else if(X==="MultiPoint")for(var le=0;le<H.length;le++)es(H[le],ne);else if(X==="LineString")ts(H,ne,ce,!1);else if(X==="MultiLineString"){if(D.lineMetrics){for(le=0;le<H.length;le++)ts(H[le],ne=[],ce,!1),Z.push(zr(J,"LineString",ne,A.properties));return}_s(H,ne,ce,!1)}else if(X==="Polygon")_s(H,ne,ce,!0);else{if(X!=="MultiPolygon"){if(X==="GeometryCollection"){for(le=0;le<A.geometry.geometries.length;le++)ys(Z,{id:J,geometry:A.geometry.geometries[le],properties:A.properties},D,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(le=0;le<H.length;le++){var _e=[];_s(H[le],_e,ce,!0),ne.push(_e)}}Z.push(zr(J,X,ne,A.properties))}}function es(Z,A){A.push(ye(Z[0])),A.push(dn(Z[1])),A.push(0)}function ts(Z,A,D,V){for(var H,X,ce=0,ne=0;ne<Z.length;ne++){var J=ye(Z[ne][0]),le=dn(Z[ne][1]);A.push(J),A.push(le),A.push(0),ne>0&&(ce+=V?(H*le-J*X)/2:Math.sqrt(Math.pow(J-H,2)+Math.pow(le-X,2))),H=J,X=le}var _e=A.length-3;A[2]=1,Jr(A,0,_e,D),A[_e+2]=1,A.size=Math.abs(ce),A.start=0,A.end=A.size}function _s(Z,A,D,V){for(var H=0;H<Z.length;H++){var X=[];ts(Z[H],X,D,V),A.push(X)}}function ye(Z){return Z/360+.5}function dn(Z){var A=Math.sin(Z*Math.PI/180),D=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return D<0?0:D>1?1:D}function Un(Z,A,D,V,H,X,ce,ne){if(V/=A,X>=(D/=A)&&ce<V)return Z;if(ce<D||X>=V)return null;for(var J=[],le=0;le<Z.length;le++){var _e=Z[le],xe=_e.geometry,Se=_e.type,it=H===0?_e.minX:_e.minY,lt=H===0?_e.maxX:_e.maxY;if(it>=D&&lt<V)J.push(_e);else if(!(lt<D||it>=V)){var We=[];if(Se==="Point"||Se==="MultiPoint")jt(xe,We,D,V,H);else if(Se==="LineString")It(xe,We,D,V,H,!1,ne.lineMetrics);else if(Se==="MultiLineString")Ws(xe,We,D,V,H,!1);else if(Se==="Polygon")Ws(xe,We,D,V,H,!0);else if(Se==="MultiPolygon")for(var rt=0;rt<xe.length;rt++){var ht=[];Ws(xe[rt],ht,D,V,H,!0),ht.length&&We.push(ht)}if(We.length){if(ne.lineMetrics&&Se==="LineString"){for(rt=0;rt<We.length;rt++)J.push(zr(_e.id,Se,We[rt],_e.tags));continue}Se!=="LineString"&&Se!=="MultiLineString"||(We.length===1?(Se="LineString",We=We[0]):Se="MultiLineString"),Se!=="Point"&&Se!=="MultiPoint"||(Se=We.length===3?"Point":"MultiPoint"),J.push(zr(_e.id,Se,We,_e.tags))}}}return J.length?J:null}function jt(Z,A,D,V,H){for(var X=0;X<Z.length;X+=3){var ce=Z[X+H];ce>=D&&ce<=V&&(A.push(Z[X]),A.push(Z[X+1]),A.push(Z[X+2]))}}function It(Z,A,D,V,H,X,ce){for(var ne,J,le=fr(Z),_e=H===0?ba:Xs,xe=Z.start,Se=0;Se<Z.length-3;Se+=3){var it=Z[Se],lt=Z[Se+1],We=Z[Se+2],rt=Z[Se+3],ht=Z[Se+4],Lt=H===0?it:lt,Vt=H===0?rt:ht,Ct=!1;ce&&(ne=Math.sqrt(Math.pow(it-rt,2)+Math.pow(lt-ht,2))),Lt<D?Vt>D&&(J=_e(le,it,lt,rt,ht,D),ce&&(le.start=xe+ne*J)):Lt>V?Vt<V&&(J=_e(le,it,lt,rt,ht,V),ce&&(le.start=xe+ne*J)):Ar(le,it,lt,We),Vt<D&&Lt>=D&&(J=_e(le,it,lt,rt,ht,D),Ct=!0),Vt>V&&Lt<=V&&(J=_e(le,it,lt,rt,ht,V),Ct=!0),!X&&Ct&&(ce&&(le.end=xe+ne*J),A.push(le),le=fr(Z)),ce&&(xe+=ne)}var kt=Z.length-3;it=Z[kt],lt=Z[kt+1],We=Z[kt+2],(Lt=H===0?it:lt)>=D&&Lt<=V&&Ar(le,it,lt,We),kt=le.length-3,X&&kt>=3&&(le[kt]!==le[0]||le[kt+1]!==le[1])&&Ar(le,le[0],le[1],le[2]),le.length&&A.push(le)}function fr(Z){var A=[];return A.size=Z.size,A.start=Z.start,A.end=Z.end,A}function Ws(Z,A,D,V,H,X){for(var ce=0;ce<Z.length;ce++)It(Z[ce],A,D,V,H,X,!1)}function Ar(Z,A,D,V){Z.push(A),Z.push(D),Z.push(V)}function ba(Z,A,D,V,H,X){var ce=(X-A)/(V-A);return Z.push(X),Z.push(D+(H-D)*ce),Z.push(1),ce}function Xs(Z,A,D,V,H,X){var ce=(X-D)/(H-D);return Z.push(A+(V-A)*ce),Z.push(X),Z.push(1),ce}function is(Z,A){for(var D=[],V=0;V<Z.length;V++){var H,X=Z[V],ce=X.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")H=vs(X.geometry,A);else if(ce==="MultiLineString"||ce==="Polygon"){H=[];for(var ne=0;ne<X.geometry.length;ne++)H.push(vs(X.geometry[ne],A))}else if(ce==="MultiPolygon")for(H=[],ne=0;ne<X.geometry.length;ne++){for(var J=[],le=0;le<X.geometry[ne].length;le++)J.push(vs(X.geometry[ne][le],A));H.push(J)}D.push(zr(X.id,ce,H,X.tags))}return D}function vs(Z,A){var D=[];D.size=Z.size,Z.start!==void 0&&(D.start=Z.start,D.end=Z.end);for(var V=0;V<Z.length;V+=3)D.push(Z[V]+A,Z[V+1],Z[V+2]);return D}function Ae(Z,A){if(Z.transformed)return Z;var D,V,H,X=1<<Z.z,ce=Z.x,ne=Z.y;for(D=0;D<Z.features.length;D++){var J=Z.features[D],le=J.geometry,_e=J.type;if(J.geometry=[],_e===1)for(V=0;V<le.length;V+=2)J.geometry.push(mr(le[V],le[V+1],A,X,ce,ne));else for(V=0;V<le.length;V++){var xe=[];for(H=0;H<le[V].length;H+=2)xe.push(mr(le[V][H],le[V][H+1],A,X,ce,ne));J.geometry.push(xe)}}return Z.transformed=!0,Z}function mr(Z,A,D,V,H,X){return[Math.round(D*(Z*V-H)),Math.round(D*(A*V-X))]}function ni(Z,A,D,V,H){for(var X=A===H.maxZoom?0:H.tolerance/((1<<A)*H.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:D,y:V,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ne=0;ne<Z.length;ne++){ce.numFeatures++,xs(ce,Z[ne],X,H);var J=Z[ne].minX,le=Z[ne].minY,_e=Z[ne].maxX,xe=Z[ne].maxY;J<ce.minX&&(ce.minX=J),le<ce.minY&&(ce.minY=le),_e>ce.maxX&&(ce.maxX=_e),xe>ce.maxY&&(ce.maxY=xe)}return ce}function xs(Z,A,D,V){var H=A.geometry,X=A.type,ce=[];if(X==="Point"||X==="MultiPoint")for(var ne=0;ne<H.length;ne+=3)ce.push(H[ne]),ce.push(H[ne+1]),Z.numPoints++,Z.numSimplified++;else if(X==="LineString")Lr(ce,H,Z,D,!1,!1);else if(X==="MultiLineString"||X==="Polygon")for(ne=0;ne<H.length;ne++)Lr(ce,H[ne],Z,D,X==="Polygon",ne===0);else if(X==="MultiPolygon")for(var J=0;J<H.length;J++){var le=H[J];for(ne=0;ne<le.length;ne++)Lr(ce,le[ne],Z,D,!0,ne===0)}if(ce.length){var _e=A.tags||null;if(X==="LineString"&&V.lineMetrics){for(var xe in _e={},A.tags)_e[xe]=A.tags[xe];_e.mapbox_clip_start=H.start/H.size,_e.mapbox_clip_end=H.end/H.size}var Se={geometry:ce,type:X==="Polygon"||X==="MultiPolygon"?3:X==="LineString"||X==="MultiLineString"?2:1,tags:_e};A.id!==null&&(Se.id=A.id),Z.features.push(Se)}}function Lr(Z,A,D,V,H,X){var ce=V*V;if(V>0&&A.size<(H?ce:V))D.numPoints+=A.length/3;else{for(var ne=[],J=0;J<A.length;J+=3)(V===0||A[J+2]>ce)&&(D.numSimplified++,ne.push(A[J]),ne.push(A[J+1])),D.numPoints++;H&&function(le,_e){for(var xe=0,Se=0,it=le.length,lt=it-2;Se<it;lt=Se,Se+=2)xe+=(le[Se]-le[lt])*(le[Se+1]+le[lt+1]);if(xe>0===_e)for(Se=0,it=le.length;Se<it/2;Se+=2){var We=le[Se],rt=le[Se+1];le[Se]=le[it-2-Se],le[Se+1]=le[it-1-Se],le[it-2-Se]=We,le[it-1-Se]=rt}}(ne,X),Z.push(ne)}}function Re(Z,A){var D=(A=this.options=function(H,X){for(var ce in X)H[ce]=X[ce];return H}(Object.create(this.options),A)).debug;if(D&&console.time("preprocess data"),A.maxZoom<0||A.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(A.promoteId&&A.generateId)throw new Error("promoteId and generateId cannot be used together.");var V=function(H,X){var ce=[];if(H.type==="FeatureCollection")for(var ne=0;ne<H.features.length;ne++)ys(ce,H.features[ne],X,ne);else ys(ce,H.type==="Feature"?H:{geometry:H},X);return ce}(Z,A);this.tiles={},this.tileCoords=[],D&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",A.indexMaxZoom,A.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),V=function(H,X){var ce=X.buffer/X.extent,ne=H,J=Un(H,1,-1-ce,ce,0,-1,2,X),le=Un(H,1,1-ce,2+ce,0,-1,2,X);return(J||le)&&(ne=Un(H,1,-ce,1+ce,0,-1,2,X)||[],J&&(ne=is(J,1).concat(ne)),le&&(ne=ne.concat(is(le,-1)))),ne}(V,A),V.length&&this.splitTile(V,0,0,0),D&&(V.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gt(Z,A,D){return 32*((1<<Z)*D+A)+Z}function ct(Z,A){return A?Z.properties[A]:Z.id}function en(Z,A){if(Z==null)return!0;if(Z.type==="Feature")return ct(Z,A)!=null;if(Z.type==="FeatureCollection"){const D=new Set;for(const V of Z.features){const H=ct(V,A);if(H==null||D.has(H))return!1;D.add(H)}return!0}return!1}function gr(Z,A){const D=new Map;if(Z!=null)if(Z.type==="Feature")D.set(ct(Z,A),Z);else for(const V of Z.features)D.set(ct(V,A),V);return D}Re.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Re.prototype.splitTile=function(Z,A,D,V,H,X,ce){for(var ne=[Z,A,D,V],J=this.options,le=J.debug;ne.length;){V=ne.pop(),D=ne.pop(),A=ne.pop(),Z=ne.pop();var _e=1<<A,xe=gt(A,D,V),Se=this.tiles[xe];if(!Se&&(le>1&&console.time("creation"),Se=this.tiles[xe]=ni(Z,A,D,V,J),this.tileCoords.push({z:A,x:D,y:V}),le)){le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",A,D,V,Se.numFeatures,Se.numPoints,Se.numSimplified),console.timeEnd("creation"));var it="z"+A;this.stats[it]=(this.stats[it]||0)+1,this.total++}if(Se.source=Z,H){if(A===J.maxZoom||A===H)continue;var lt=1<<H-A;if(D!==Math.floor(X/lt)||V!==Math.floor(ce/lt))continue}else if(A===J.indexMaxZoom||Se.numPoints<=J.indexMaxPoints)continue;if(Se.source=null,Z.length!==0){le>1&&console.time("clipping");var We,rt,ht,Lt,Vt,Ct,kt=.5*J.buffer/J.extent,Zi=.5-kt,qt=.5+kt,wi=1+kt;We=rt=ht=Lt=null,Vt=Un(Z,_e,D-kt,D+qt,0,Se.minX,Se.maxX,J),Ct=Un(Z,_e,D+Zi,D+wi,0,Se.minX,Se.maxX,J),Z=null,Vt&&(We=Un(Vt,_e,V-kt,V+qt,1,Se.minY,Se.maxY,J),rt=Un(Vt,_e,V+Zi,V+wi,1,Se.minY,Se.maxY,J),Vt=null),Ct&&(ht=Un(Ct,_e,V-kt,V+qt,1,Se.minY,Se.maxY,J),Lt=Un(Ct,_e,V+Zi,V+wi,1,Se.minY,Se.maxY,J),Ct=null),le>1&&console.timeEnd("clipping"),ne.push(We||[],A+1,2*D,2*V),ne.push(rt||[],A+1,2*D,2*V+1),ne.push(ht||[],A+1,2*D+1,2*V),ne.push(Lt||[],A+1,2*D+1,2*V+1)}}},Re.prototype.getTile=function(Z,A,D){var V=this.options,H=V.extent,X=V.debug;if(Z<0||Z>24)return null;var ce=1<<Z,ne=gt(Z,A=(A%ce+ce)%ce,D);if(this.tiles[ne])return Ae(this.tiles[ne],H);X>1&&console.log("drilling down to z%d-%d-%d",Z,A,D);for(var J,le=Z,_e=A,xe=D;!J&&le>0;)le--,_e=Math.floor(_e/2),xe=Math.floor(xe/2),J=this.tiles[gt(le,_e,xe)];return J&&J.source?(X>1&&console.log("found parent tile z%d-%d-%d",le,_e,xe),X>1&&console.time("drilling down"),this.splitTile(J.source,le,_e,xe,Z,A,D),X>1&&console.timeEnd("drilling down"),this.tiles[ne]?Ae(this.tiles[ne],H):null):null};class ft extends Pe{constructor(A,D,V,H){super(A,D,V),this._dataUpdateable=new Map,this.loadGeoJSON=(X,ce)=>{const{promoteId:ne}=X;if(X.request)return l.f(X.request,(J,le,_e,xe)=>{this._dataUpdateable=en(le,ne)?gr(le,ne):void 0,ce(J,le,_e,xe)});if(typeof X.data=="string")try{const J=JSON.parse(X.data);this._dataUpdateable=en(J,ne)?gr(J,ne):void 0,ce(null,J)}catch{ce(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`))}else X.dataDiff?this._dataUpdateable?(function(J,le,_e){var xe,Se,it,lt;if(le.removeAll&&J.clear(),le.remove)for(const We of le.remove)J.delete(We);if(le.add)for(const We of le.add){const rt=ct(We,_e);rt!=null&&J.set(rt,We)}if(le.update)for(const We of le.update){let rt=J.get(We.id);if(rt==null)continue;const ht=!We.removeAllProperties&&(((xe=We.removeProperties)===null||xe===void 0?void 0:xe.length)>0||((Se=We.addOrUpdateProperties)===null||Se===void 0?void 0:Se.length)>0);if((We.newGeometry||We.removeAllProperties||ht)&&(rt=Object.assign({},rt),J.set(We.id,rt),ht&&(rt.properties=Object.assign({},rt.properties))),We.newGeometry&&(rt.geometry=We.newGeometry),We.removeAllProperties)rt.properties={};else if(((it=We.removeProperties)===null||it===void 0?void 0:it.length)>0)for(const Lt of We.removeProperties)Object.prototype.hasOwnProperty.call(rt.properties,Lt)&&delete rt.properties[Lt];if(((lt=We.addOrUpdateProperties)===null||lt===void 0?void 0:lt.length)>0)for(const{key:Lt,value:Vt}of We.addOrUpdateProperties)rt.properties[Lt]=Vt}}(this._dataUpdateable,X.dataDiff,ne),ce(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ce(new Error(`Cannot update existing geojson data in ${X.source}`)):ce(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,H&&(this.loadGeoJSON=H)}loadGeoJSONTile(A,D){const V=A.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const H=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!H)return D(null,null);const X=new class{constructor(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.N,this.length=ne.length,this._features=ne}feature(ne){return new class{constructor(J){this._feature=J,this.extent=l.N,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))}loadGeometry(){if(this._feature.type===1){const J=[];for(const le of this._feature.geometry)J.push([new l.P(le[0],le[1])]);return J}{const J=[];for(const le of this._feature.geometry){const _e=[];for(const xe of le)_e.push(new l.P(xe[0],xe[1]));J.push(_e)}return J}}toGeoJSON(J,le,_e){return Y.call(this,J,le,_e)}}(this._features[ne])}}(H.features);let ce=dt(X);ce.byteOffset===0&&ce.byteLength===ce.buffer.byteLength||(ce=new Uint8Array(ce)),D(null,{vectorTile:X,rawData:ce.buffer})}loadData(A,D){var V;(V=this._pendingRequest)===null||V===void 0||V.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const H=!!(A&&A.request&&A.request.collectResourceTiming)&&new l.bu(A.request);this._pendingCallback=D,this._pendingRequest=this.loadGeoJSON(A,(X,ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,X||!ce)return D(X);if(typeof ce!="object")return D(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`));{ee(ce,!0);try{if(A.filter){const J=l.bC(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(_e=>J.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=A.cluster?new hn(function({superclusterOptions:J,clusterProperties:le}){if(!le||!J)return J;const _e={},xe={},Se={accumulated:null,zoom:0},it={properties:null},lt=Object.keys(le);for(const We of lt){const[rt,ht]=le[We],Lt=l.bC(ht),Vt=l.bC(typeof rt=="string"?[rt,["accumulated"],["get",We]]:rt);_e[We]=Lt.value,xe[We]=Vt.value}return J.map=We=>{it.properties=We;const rt={};for(const ht of lt)rt[ht]=_e[ht].evaluate(Se,it);return rt},J.reduce=(We,rt)=>{it.properties=rt;for(const ht of lt)Se.accumulated=We[ht],We[ht]=xe[ht].evaluate(Se,it)},J}(A)).load(ce.features):function(J,le){return new Re(J,le)}(ce,A.geojsonVtOptions)}catch(J){return D(J)}this.loaded={};const ne={};if(H){const J=H.finish();J&&(ne.resourceTiming={},ne.resourceTiming[A.source]=JSON.parse(JSON.stringify(J)))}D(null,ne)}})}reloadTile(A,D){const V=this.loaded;return V&&V[A.uid]?super.reloadTile(A,D):this.loadTile(A,D)}removeSource(A,D){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),D()}getClusterExpansionZoom(A,D){try{D(null,this._geoJSONIndex.getClusterExpansionZoom(A.clusterId))}catch(V){D(V)}}getClusterChildren(A,D){try{D(null,this._geoJSONIndex.getChildren(A.clusterId))}catch(V){D(V)}}getClusterLeaves(A,D){try{D(null,this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset))}catch(V){D(V)}}}class Dr{constructor(A){this.self=A,this.actor=new l.C(A,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Pe,geojson:ft},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(D,V)=>{if(this.workerSourceTypes[D])throw new Error(`Worker source with name "${D}" already registered.`);this.workerSourceTypes[D]=V},this.self.registerRTLTextPlugin=D=>{if(l.bD.isParsed())throw new Error("RTL text plugin already registered.");l.bD.applyArabicShaping=D.applyArabicShaping,l.bD.processBidirectionalText=D.processBidirectionalText,l.bD.processStyledBidirectionalText=D.processStyledBidirectionalText}}setReferrer(A,D){this.referrer=D}setImages(A,D,V){this.availableImages[A]=D;for(const H in this.workerSources[A]){const X=this.workerSources[A][H];for(const ce in X)X[ce].availableImages=D}V()}setLayers(A,D,V){this.getLayerIndex(A).replace(D),V()}updateLayers(A,D,V){this.getLayerIndex(A).update(D.layers,D.removedIds),V()}loadTile(A,D,V){this.getWorkerSource(A,D.type,D.source).loadTile(D,V)}loadDEMTile(A,D,V){this.getDEMWorkerSource(A,D.source).loadTile(D,V)}reloadTile(A,D,V){this.getWorkerSource(A,D.type,D.source).reloadTile(D,V)}abortTile(A,D,V){this.getWorkerSource(A,D.type,D.source).abortTile(D,V)}removeTile(A,D,V){this.getWorkerSource(A,D.type,D.source).removeTile(D,V)}removeDEMTile(A,D){this.getDEMWorkerSource(A,D.source).removeTile(D)}removeSource(A,D,V){if(!this.workerSources[A]||!this.workerSources[A][D.type]||!this.workerSources[A][D.type][D.source])return;const H=this.workerSources[A][D.type][D.source];delete this.workerSources[A][D.type][D.source],H.removeSource!==void 0?H.removeSource(D,V):V()}loadWorkerSource(A,D,V){try{this.self.importScripts(D.url),V()}catch(H){V(H.toString())}}syncRTLPluginState(A,D,V){try{l.bD.setState(D);const H=l.bD.getPluginURL();if(l.bD.isLoaded()&&!l.bD.isParsed()&&H!=null){this.self.importScripts(H);const X=l.bD.isParsed();V(X?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),X)}}catch(H){V(H.toString())}}getAvailableImages(A){let D=this.availableImages[A];return D||(D=[]),D}getLayerIndex(A){let D=this.layerIndexes[A];return D||(D=this.layerIndexes[A]=new N),D}getWorkerSource(A,D,V){return this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][D]||(this.workerSources[A][D]={}),this.workerSources[A][D][V]||(this.workerSources[A][D][V]=new this.workerSourceTypes[D]({send:(H,X,ce)=>{this.actor.send(H,X,ce,A)}},this.getLayerIndex(A),this.getAvailableImages(A))),this.workerSources[A][D][V]}getDEMWorkerSource(A,D){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][D]||(this.demWorkerSources[A][D]=new ke),this.demWorkerSources[A][D]}}return l.i()&&(self.worker=new Dr(self)),Dr}),S(["./shared"],function(l){var N="3.6.2";class R{static testProp(t){if(!R.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in R.docStyle)return t[o];return t[0]}static create(t,o,c){const d=window.document.createElement(t);return o!==void 0&&(d.className=o),c&&c.appendChild(d),d}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){R.docStyle&&R.selectProp&&(R.userSelect=R.docStyle[R.selectProp],R.docStyle[R.selectProp]="none")}static enableDrag(){R.docStyle&&R.selectProp&&(R.docStyle[R.selectProp]=R.userSelect)}static setTransform(t,o){t.style[R.transformProp]=o}static addEventListener(t,o,c,d={}){t.addEventListener(o,c,"passive"in d?d:d.capture)}static removeEventListener(t,o,c,d={}){t.removeEventListener(o,c,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",R.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",R.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",R.suppressClickInternal,!0)},0)}static mousePos(t,o){const c=t.getBoundingClientRect();return new l.P(o.clientX-c.left-t.clientLeft,o.clientY-c.top-t.clientTop)}static touchPos(t,o){const c=t.getBoundingClientRect(),d=[];for(let m=0;m<o.length;m++)d.push(new l.P(o[m].clientX-c.left-t.clientLeft,o[m].clientY-c.top-t.clientTop));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}R.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,R.selectProp=R.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),R.transformProp=R.testProp(["transform","WebkitTransform"]);const re={supported:!1,testSupport:function(p){!Pe&&te&&(ke?Me(p):de=p)}};let de,te,Pe=!1,ke=!1;function Me(p){const t=p.createTexture();p.bindTexture(p.TEXTURE_2D,t);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,te),p.isContextLost())return;re.supported=!0}catch{}p.deleteTexture(t),Pe=!0}var ut,ee;typeof document<"u"&&(te=document.createElement("img"),te.onload=function(){de&&Me(de),de=null,ke=!0},te.onerror=function(){Pe=!0,de=null},te.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let t,o,c,d;p.resetRequestQueue=()=>{t=[],o=0,c=0,d={}},p.addThrottleControl=C=>{const I=c++;return d[I]=C,I},p.removeThrottleControl=C=>{delete d[C],w()},p.getImage=(C,I,P=!0)=>{re.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*");const F={requestParameters:C,supportImageRefresh:P,callback:I,cancelled:!1,completed:!1,cancel:()=>{F.completed||F.cancelled||(F.cancelled=!0,F.innerRequest&&(F.innerRequest.cancel(),o--),w())}};return t.push(F),w(),F};const m=C=>{const{requestParameters:I,supportImageRefresh:P,callback:F}=C;return l.e(I,{type:"image"}),(P!==!1||l.i()||l.g(I.url)||I.headers&&!Object.keys(I.headers).reduce((q,$)=>q&&$==="accept",!0)?l.m:T)(I,(q,$,G,U)=>{x(C,F,q,$,G,U)})},x=(C,I,P,F,q,$)=>{P?I(P):F instanceof HTMLImageElement||l.a(F)?I(null,F):F&&((G,U)=>{typeof createImageBitmap=="function"?l.b(G,U):l.d(G,U)})(F,(G,U)=>{G!=null?I(G):U!=null&&I(null,U,{cacheControl:q,expires:$})}),C.cancelled||(C.completed=!0,o--,w())},w=()=>{const C=(()=>{const I=Object.keys(d);let P=!1;if(I.length>0){for(const F of I)if(P=d[F](),P)break}return P})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=o;I<C&&t.length>0;I++){const P=t.shift();if(P.cancelled){I--;continue}const F=m(P);o++,P.innerRequest=F}},T=(C,I)=>{const P=new Image,F=C.url;let q=!1;const $=C.credentials;return $&&$==="include"?P.crossOrigin="use-credentials":($&&$==="same-origin"||!l.s(F))&&(P.crossOrigin="anonymous"),P.fetchPriority="high",P.onload=()=>{I(null,P),P.onerror=P.onload=null},P.onerror=()=>{q||I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),P.onerror=P.onload=null},P.src=F,{cancel:()=>{q=!0,P.src=""}}}}(ut||(ut={})),ut.resetRequestQueue(),function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"}(ee||(ee={}));class Y{constructor(t){this._transformRequestFn=t}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}normalizeSpriteURL(t,o,c){const d=function(m){const x=m.match(se);if(!x)throw new Error(`Unable to parse URL "${m}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(t);return d.path+=`${o}${c}`,function(m){const x=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${x}`}(d)}setTransformRequest(t){this._transformRequestFn=t}}const se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(p){var t=new l.A(3);return t[0]=p[0],t[1]=p[1],t[2]=p[2],t}var Fe,Oe=function(p,t,o){return p[0]=t[0]-o[0],p[1]=t[1]-o[1],p[2]=t[2]-o[2],p};Fe=new l.A(3),l.A!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0);var Ge=function(p){var t=p[0],o=p[1];return t*t+o*o};function Be(p){const t=[];if(typeof p=="string")t.push({id:"default",url:p});else if(p&&p.length>0){const o=[];for(const{id:c,url:d}of p){const m=`${c}${d}`;o.indexOf(m)===-1&&(o.push(m),t.push({id:c,url:d}))}}return t}function Et(p,t,o,c,d){if(c)return void p(c);if(d!==Object.values(t).length||d!==Object.values(o).length)return;const m={};for(const x in t){m[x]={};const w=l.h.getImageCanvasContext(o[x]),T=t[x];for(const C in T){const{width:I,height:P,x:F,y:q,sdf:$,pixelRatio:G,stretchX:U,stretchY:oe,content:pe}=T[C];m[x][C]={data:null,pixelRatio:G,sdf:$,stretchX:U,stretchY:oe,content:pe,spriteData:{width:I,height:P,x:F,y:q,context:w}}}}p(null,m)}(function(){var p=new l.A(2);l.A!=Float32Array&&(p[0]=0,p[1]=0)})();class tt{constructor(t,o,c,d){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(o,d)}update(t,o,c){const{width:d,height:m}=t,x=!(this.size&&this.size[0]===d&&this.size[1]===m||c),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(o&&o.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[d,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.a(t)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,t):T.texImage2D(T.TEXTURE_2D,0,this.format,d,m,0,this.format,T.UNSIGNED_BYTE,t.data);else{const{x:C,y:I}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.a(t)?T.texSubImage2D(T.TEXTURE_2D,0,C,I,T.RGBA,T.UNSIGNED_BYTE,t):T.texSubImage2D(T.TEXTURE_2D,0,C,I,d,m,T.RGBA,T.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(t,o,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||t),this.filter=t),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Ot(p){const{userImage:t}=p;return!!(t&&t.render&&t.render())&&(p.data.replace(new Uint8Array(t.data.buffer)),!0)}class ui extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,callback:c}of this.requestors)this._notify(o,c);this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const c=o.spriteData;o.data=new l.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let c=!0;const d=o.data||o.spriteData;return this._validateStretch(o.stretchX,d&&d.width)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,d&&d.height)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,o){if(!t)return!0;let c=0;for(const d of t){if(d[0]<c||d[1]<d[0]||o<d[1])return!1;c=d[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const c=o.spriteData,d=c&&c.width||o.data.width,m=c&&c.height||o.data.height;return!(t[0]<0||d<t[0]||t[1]<0||m<t[1]||t[2]<0||d<t[2]||t[3]<0||m<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,c=!0){const d=this.getImage(t);if(c&&(d.data.width!==o.data.width||d.data.height!==o.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=d.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,o){let c=!0;if(!this.isLoaded())for(const d of t)this.images[d]||(c=!1);this.isLoaded()||c?this._notify(t,o):this.requestors.push({ids:t,callback:o})}_notify(t,o){const c={};for(const d of t){let m=this.getImage(d);m||(this.fire(new l.k("styleimagemissing",{id:d})),m=this.getImage(d)),m?c[d]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:l.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,c)}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],c=this.getImage(t);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new l.I(d,c);this.patterns[t]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new tt(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:o,h:c}=l.p(t),d=this.atlasImage;d.resize({width:o||1,height:c||1});for(const m in this.patterns){const{bin:x}=this.patterns[m],w=x.x+1,T=x.y+1,C=this.getImage(m).data,I=C.width,P=C.height;l.R.copy(C,d,{x:0,y:0},{x:w,y:T},{width:I,height:P}),l.R.copy(C,d,{x:0,y:P-1},{x:w,y:T-1},{width:I,height:1}),l.R.copy(C,d,{x:0,y:0},{x:w,y:T+P},{width:I,height:1}),l.R.copy(C,d,{x:I-1,y:0},{x:w-1,y:T},{width:1,height:P}),l.R.copy(C,d,{x:0,y:0},{x:w+I,y:T},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.getImage(o);c||l.w(`Image with ID: "${o}" was not found`),Ot(c)&&this.updateImage(o,c)}}}const $i=1e20;function Di(p,t,o,c,d,m,x,w,T){for(let C=t;C<t+c;C++)Ji(p,o*m+C,m,d,x,w,T);for(let C=o;C<o+d;C++)Ji(p,C*m+t,1,c,x,w,T)}function Ji(p,t,o,c,d,m,x){m[0]=0,x[0]=-$i,x[1]=$i,d[0]=p[t];for(let w=1,T=0,C=0;w<c;w++){d[w]=p[t+w*o];const I=w*w;do{const P=m[T];C=(d[w]-d[P]+I-P*P)/(w-P)/2}while(C<=x[T]&&--T>-1);T++,m[T]=w,x[T]=C,x[T+1]=$i}for(let w=0,T=0;w<c;w++){for(;x[T+1]<w;)T++;const C=m[T],I=w-C;p[t+w*o]=d[C]+I*I}}class kn{constructor(t,o){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={}}setURL(t){this.url=t}getGlyphs(t,o){const c=[];for(const d in t)for(const m of t[d])c.push({stack:d,id:m});l.o(c,({stack:d,id:m},x)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{}});let T=w.glyphs[m];if(T!==void 0)return void x(null,{stack:d,id:m,glyph:T});if(T=this._tinySDF(w,d,m),T)return w.glyphs[m]=T,void x(null,{stack:d,id:m,glyph:T});const C=Math.floor(m/256);if(256*C>65535)return void x(new Error("glyphs > 65535 not supported"));if(w.ranges[C])return void x(null,{stack:d,id:m,glyph:T});if(!this.url)return void x(new Error("glyphsUrl is not set"));let I=w.requests[C];I||(I=w.requests[C]=[],kn.loadGlyphRange(d,C,this.url,this.requestManager,(P,F)=>{if(F){for(const q in F)this._doesCharSupportLocalGlyph(+q)||(w.glyphs[+q]=F[+q]);w.ranges[C]=!0}for(const q of I)q(P,F);delete w.requests[C]})),I.push((P,F)=>{P?x(P):F&&x(null,{stack:d,id:m,glyph:F[m]||null})})},(d,m)=>{if(d)o(d);else if(m){const x={};for(const{stack:w,id:T,glyph:C}of m)(x[w]||(x[w]={}))[T]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};o(null,x)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(l.u["CJK Unified Ideographs"](t)||l.u["Hangul Syllables"](t)||l.u.Hiragana(t)||l.u.Katakana(t))}_tinySDF(t,o,c){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let m=t.tinySDF;if(!m){let w="400";/bold/i.test(o)?w="900":/medium/i.test(o)?w="500":/light/i.test(o)&&(w="200"),m=t.tinySDF=new kn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:w})}const x=m.draw(String.fromCharCode(c));return{id:c,bitmap:new l.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}kn.loadGlyphRange=function(p,t,o,c,d){const m=256*t,x=m+255,w=c.transformRequest(o.replace("{fontstack}",p).replace("{range}",`${m}-${x}`),ee.Glyphs);l.l(w,(T,C)=>{if(T)d(T);else if(C){const I={};for(const P of l.n(C))I[P.id]=P;d(null,I)}})},kn.TinySDF=class{constructor({fontSize:p=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=o;const w=this.size=p+4*t,T=this._createCanvas(w),C=this.ctx=T.getContext("2d",{willReadFrequently:!0});C.font=`${x} ${m} ${p}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(p){const t=document.createElement("canvas");return t.width=t.height=p,t}draw(p){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(p),x=Math.ceil(o),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),T=Math.min(this.size-this.buffer,x+Math.ceil(c)),C=w+2*this.buffer,I=T+2*this.buffer,P=Math.max(C*I,0),F=new Uint8ClampedArray(P),q={data:F,width:C,height:I,glyphWidth:w,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(w===0||T===0)return q;const{ctx:$,buffer:G,gridInner:U,gridOuter:oe}=this;$.clearRect(G,G,w,T),$.fillText(p,G,G+x);const pe=$.getImageData(G,G,w,T);oe.fill($i,0,P),U.fill(0,0,P);for(let K=0;K<T;K++)for(let ae=0;ae<w;ae++){const me=pe.data[4*(K*w+ae)+3]/255;if(me===0)continue;const ge=(K+G)*C+ae+G;if(me===1)oe[ge]=0,U[ge]=$i;else{const we=.5-me;oe[ge]=we>0?we*we:0,U[ge]=we<0?we*we:0}}Di(oe,0,0,C,I,C,this.f,this.v,this.z),Di(U,G,G,w,T,C,this.f,this.v,this.z);for(let K=0;K<P;K++){const ae=Math.sqrt(oe[K])-Math.sqrt(U[K]);F[K]=Math.round(255-255*(ae/this.radius+this.cutoff))}return q}};class qi{constructor(){this.specification=l.v.light.position}possiblyEvaluate(t,o){return l.z(t.expression.evaluate(o))}interpolate(t,o,c){return{x:l.B.number(t.x,o.x,c),y:l.B.number(t.y,o.y,c),z:l.B.number(t.z,o.z,c)}}}let He;class dt extends l.E{constructor(t){super(),He=He||new l.r({anchor:new l.D(l.v.light.anchor),position:new qi,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(He),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(l.t,t,o))for(const c in t){const d=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c){return(!c||c.validate!==!1)&&l.x(this,t.call(l.y,l.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}}class yt{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const c=t.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,o)),this.dashEntry[c]}getDashRanges(t,o,c){const d=[];let m=t.length%2==1?-t[t.length-1]*c:0,x=t[0]*c,w=!0;d.push({left:m,right:x,isDash:w,zeroLength:t[0]===0});let T=t[0];for(let C=1;C<t.length;C++){w=!w;const I=t[C];m=T*c,T+=I,x=T*c,d.push({left:m,right:x,isDash:w,zeroLength:I===0})}return d}addRoundDash(t,o,c){const d=o/2;for(let m=-c;m<=c;m++){const x=this.width*(this.nextRow+c+m);let w=0,T=t[w];for(let C=0;C<this.width;C++){C/T.right>1&&(T=t[++w]);const I=Math.abs(C-T.left),P=Math.abs(C-T.right),F=Math.min(I,P);let q;const $=m/c*(d+1);if(T.isDash){const G=d-Math.abs($);q=Math.sqrt(F*F+G*G)}else q=d-Math.sqrt(F*F+$*$);this.data[x+C]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(t){for(let w=t.length-1;w>=0;--w){const T=t[w],C=t[w+1];T.zeroLength?t.splice(w,1):C&&C.isDash===T.isDash&&(C.left=T.left,t.splice(w,1))}const o=t[0],c=t[t.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const d=this.width*this.nextRow;let m=0,x=t[m];for(let w=0;w<this.width;w++){w/x.right>1&&(x=t[++m]);const T=Math.abs(w-x.left),C=Math.abs(w-x.right),I=Math.min(T,C);this.data[d+w]=Math.max(0,Math.min(255,(x.isDash?I:-I)+128))}}addDash(t,o){const c=o?7:0,d=2*c+1;if(this.nextRow+d>this.height)return l.w("LineAtlas out of space"),null;let m=0;for(let w=0;w<t.length;w++)m+=t[w];if(m!==0){const w=this.width/m,T=this.getDashRanges(t,this.width,w);o?this.addRoundDash(T,w,c):this.addRegularDash(T)}const x={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=d,this.dirty=!0,x}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}class $t{constructor(t,o,c){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c;const d=this.workerPool.acquire(c);for(let m=0;m<d.length;m++){const x=new l.C(d[m],o,c);x.name=`Worker ${m}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o,c){l.o(this.actors,(d,m)=>{d.send(t,o,m)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}}function Nt(p,t,o){const c=function(d,m){if(d)return o(d);if(m){const x=l.F(l.e(m,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(x.vectorLayers=m.vector_layers,x.vectorLayerIds=x.vectorLayers.map(w=>w.id)),o(null,x)}};return p.url?l.f(t.transformRequest(p.url,ee.Source),c):l.h.frame(()=>c(null,p))}class Dt{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.L?new l.L(t.lng,t.lat):l.L.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.L?new l.L(t.lng,t.lat):l.L.convert(t),this}extend(t){const o=this._sw,c=this._ne;let d,m;if(t instanceof l.L)d=t,m=t;else{if(!(t instanceof Dt))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Dt.convert(t)):this.extend(l.L.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.L.convert(t)):this;if(d=t._sw,m=t._ne,!d||!m)return this}return o||c?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new l.L(d.lng,d.lat),this._ne=new l.L(m.lng,m.lat)),this}getCenter(){return new l.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.L(this.getWest(),this.getNorth())}getSouthEast(){return new l.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=l.L.convert(t);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(t){return t instanceof Dt?t:t&&new Dt(t)}static fromLngLat(t,o=0){const c=360*o/40075017,d=c/Math.cos(Math.PI/180*t.lat);return new Dt(new l.L(t.lng-d,t.lat-c),new l.L(t.lng+d,t.lat+c))}}class ci{constructor(t,o,c){this.bounds=Dt.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),c=Math.floor(l.G(this.bounds.getWest())*o),d=Math.floor(l.H(this.bounds.getNorth())*o),m=Math.ceil(l.G(this.bounds.getEast())*o),x=Math.ceil(l.H(this.bounds.getSouth())*o);return t.x>=c&&t.x<m&&t.y>=d&&t.y<x}}class tr extends l.E{constructor(t,o,c,d){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Nt(this._options,this.map._requestManager,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),m?this.fire(new l.j(m)):x&&(l.e(this,x),x.bounds&&(this.tileBounds=new ci(x.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.e({},this._options),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.F(o,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(c,ee.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function m(x,w){return delete t.request,t.aborted?o(null):x&&x.status!==404?o(x):(w&&w.resourceTiming&&(t.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&t.setExpiryData(w),t.loadVectorData(w,this.map.painter),o(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=o:t.request=t.actor.send("reloadTile",d,m.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",d,m.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class hn extends l.E{constructor(t,o,c,d){super(),this.id=t,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},o),l.e(this,l.F(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Nt(this._options,this.map._requestManager,(t,o)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new l.j(t)):o&&(l.e(this,o),o.bounds&&(this.tileBounds=new ci(o.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=ut.getImage(this.map._requestManager.transformRequest(c,ee.Tile),(d,m,x)=>{if(delete t.request,t.aborted)t.state="unloaded",o(null);else if(d)t.state="errored",o(d);else if(m){this.map._refreshExpiredTiles&&x&&t.setExpiryData(x);const w=this.map.painter.context,T=w.gl;t.texture=this.map.painter.getTileTexture(m.width),t.texture?t.texture.update(m,{useMipmap:!0}):(t.texture=new tt(w,m,T.RGBA,{useMipmap:!0}),t.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.extTextureFilterAnisotropic&&T.texParameterf(T.TEXTURE_2D,w.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,w.extTextureFilterAnisotropicMax)),t.state="loaded",o(null)}},this.map._refreshExpiredTiles)}abortTile(t,o){t.request&&(t.request.cancel(),delete t.request),o()}unloadTile(t,o){t.texture&&this.map.painter.saveTileTexture(t.texture),o()}hasTransition(){return!1}}class ir extends hn{constructor(t,o,c,d){super(t,o,c,d),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(c,ee.Tile);function m(x,w){x&&(t.state="errored",o(x)),w&&(t.dem=w,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",o(null))}t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.request=ut.getImage(d,(x,w,T)=>l._(this,void 0,void 0,function*(){if(delete t.request,t.aborted)t.state="unloaded",o(null);else if(x)t.state="errored",o(x);else if(w){this.map._refreshExpiredTiles&&t.setExpiryData(T);const C=l.a(w)&&l.J()?w:yield function(P){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.K()){const F=P.width+2,q=P.height+2;try{return new l.R({width:F,height:q},yield l.M(P,-1,-1,F,q))}catch{}}return l.h.getImageData(P,1)})}(w),I={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:C,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",I,m))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(t){const o=t.canonical,c=Math.pow(2,o.z),d=(o.x-1+c)%c,m=o.x===0?t.wrap-1:t.wrap,x=(o.x+1+c)%c,w=o.x+1===c?t.wrap+1:t.wrap,T={};return T[new l.O(t.overscaledZ,m,o.z,d,o.y).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,o.z,x,o.y).key]={backfilled:!1},o.y>0&&(T[new l.O(t.overscaledZ,m,o.z,d,o.y-1).key]={backfilled:!1},T[new l.O(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,o.z,x,o.y-1).key]={backfilled:!1}),o.y+1<c&&(T[new l.O(t.overscaledZ,m,o.z,d,o.y+1).key]={backfilled:!1},T[new l.O(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,o.z,x,o.y+1).key]={backfilled:!1}),T}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class Qr extends l.E{constructor(t,o,c,d){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.e({},this._options,{type:this.type,data:this._data}),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(d),this._data=o.data,this._options=l.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const m=l.N/this.tileSize;this.workerOptions=l.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*m,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*m,extent:l.N,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:l.N,radius:(o.clusterRadius||50)*m,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},o),this}getClusterChildren(t,o){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},o),this}getClusterLeaves(t,o,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:o,offset:c},d),this}_updateWorkerData(t){const o=l.e({},this.workerOptions);t?o.dataDiff=t:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(l.h.resolveURL(this._data),ee.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,o,(c,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new l.k("dataabort",{dataType:"source"}));let m=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(m=d.resourceTiming[this.id].slice(0)),c)return void this.fire(new l.j(c));const x={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&l.e(x,{resourceTiming:m}),this.fire(new l.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new l.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(t,o){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,d,(m,x)=>(delete t.request,t.unloadVectorData(),t.aborted?o(null):m?o(m):(t.loadVectorData(x,this.map.painter,c==="reloadTile"),o(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var nr=l.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vn extends l.E{constructor(t,o,c,d){super(),this.load=(m,x)=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=ut.getImage(this.map._requestManager.transformRequest(this.url,ee.Image),(w,T)=>{this._request=null,this._loaded=!0,w?this.fire(new l.j(w)):T&&(this.image=T,m&&(this.coordinates=m),x&&x(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const m=this.map.painter.context,x=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,nr.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new tt(m,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const C=this.tiles[T];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,w=!0)}w&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=o}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(l.U.fromLngLat);this.tileID=function(d){let m=1/0,x=1/0,w=-1/0,T=-1/0;for(const F of d)m=Math.min(m,F.x),x=Math.min(x,F.y),w=Math.max(w,F.x),T=Math.max(T,F.y);const C=Math.max(w-m,T-x),I=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),P=Math.pow(2,I);return new l.W(I,Math.floor((m+w)/2*P),Math.floor((x+T)/2*P))}(o),this.minzoom=this.maxzoom=this.tileID.z;const c=o.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new l.V,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,l.N,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,l.N),this._boundsArray.emplaceBack(c[2].x,c[2].y,l.N,l.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}hasTransition(){return!1}}class Oo extends Vn{constructor(t,o,c,d){super(t,o,c,d),this.load=()=>{this._loaded=!1;const m=this.options;this.urls=[];for(const x of m.urls)this.urls.push(this.map._requestManager.transformRequest(x,ee.Source).url);l.X(this.urls,(x,w)=>{this._loaded=!0,x?this.fire(new l.j(x)):w&&(this.video=w,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,x=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,nr.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new tt(m,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const C=this.tiles[T];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,w=!0)}w&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=o}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new l.j(new l.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Jr extends Vn{constructor(t,o,c,d){super(t,o,c,d),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const x=this.map.painter.context,w=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,nr.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new tt(x,this.canvas,w.RGBA,{premultiply:!0});let T=!1;for(const C in this.tiles){const I=this.tiles[C];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,T=!0)}T&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(x=>typeof x!="number"))||this.fire(new l.j(new l.Y(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.j(new l.Y(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new l.j(new l.Y(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new l.j(new l.Y(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.j(new l.Y(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const No={},zr=p=>{switch(p){case"geojson":return Qr;case"image":return Vn;case"raster":return hn;case"raster-dem":return ir;case"vector":return tr;case"video":return Oo;case"canvas":return Jr}return No[p]};function Hs(p,t){const o=l.Z();return l.$(o,o,[1,1,0]),l.a0(o,o,[.5*p.width,.5*p.height,1]),l.a1(o,o,p.calculatePosMatrix(t.toUnwrapped()))}function ys(p,t,o,c,d,m){const x=function(P,F,q){if(P)for(const $ of P){const G=F[$];if(G&&G.source===q&&G.type==="fill-extrusion")return!0}else for(const $ in F){const G=F[$];if(G.source===q&&G.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,p.id),w=m.maxPitchScaleFactor(),T=p.tilesIn(c,w,x);T.sort(es);const C=[];for(const P of T)C.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,o,p._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,d,m,w,Hs(p.transform,P.tileID))});const I=function(P){const F={},q={};for(const $ of P){const G=$.queryResults,U=$.wrappedTileID,oe=q[U]=q[U]||{};for(const pe in G){const K=G[pe],ae=oe[pe]=oe[pe]||{},me=F[pe]=F[pe]||[];for(const ge of K)ae[ge.featureIndex]||(ae[ge.featureIndex]=!0,me.push(ge))}}return F}(C);for(const P in I)I[P].forEach(F=>{const q=F.feature,$=p.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=$});return I}function es(p,t){const o=p.tileID,c=t.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}class ts{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=l.a2(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const o=t+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,m){const x={};if(!m)return x;for(const w of d){const T=w.layerIds.map(C=>m.getLayer(C)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(C=>T.filter(I=>I.id===C)[0]));for(const C of T)x[C.id]=w}}return x}(t.buckets,o.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof l.a4){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof l.a4&&m.hasRTLText){this.hasRTLText=!0,l.a5();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(d).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.a3}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new tt(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new tt(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,c,d,m,x,w,T,C,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:I,transform:T,params:w,queryPadding:this.queryPadding*C},t,o,c):{}}querySourceFeatures(t,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",x=d._geojsonTileLayer||d[m];if(!x)return;const w=l.a6(o&&o.filter),{z:T,x:C,y:I}=this.tileID.canonical,P={z:T,x:C,y:I};for(let F=0;F<x.length;F++){const q=x.feature(F);if(w.needGeometry){const U=l.a7(q,!0);if(!w.filter(new l.a8(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!w.filter(new l.a8(this.tileID.overscaledZ),q))continue;const $=c.getId(q,m),G=new l.a9(q,T,C,I,$);G.tile=P,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const c=l.aa(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(o)if(this.expirationTime<o)d=!0;else{const m=this.expirationTime-o;m?this.expirationTime=c+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!o.style.hasLayer(d))continue;const m=this.buckets[d],x=m.layers[0].sourceLayer||"_geojsonTileLayer",w=c[x],T=t[x];if(!w||!T||Object.keys(T).length===0)continue;m.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=o&&o.style&&o.style.getLayer(d);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=l.h.now()+t}setDependencies(t,o){const c={};for(const d of o)c[d]=!0;this.dependencies[t]=c}hasDependency(t,o){for(const c of t){const d=this.dependencies[c];if(d){for(const m of o)if(d[m])return!0}}return!1}}class _s{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,c){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:o,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(t,m)},c)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const c=t.wrapped().key,d=o===void 0?0:this.data[c].indexOf(o),m=this.data[c][d];return this.data[c].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const c in this.data)for(const d of this.data[c])t(d.value)||o.push(d);for(const c of o)this.remove(c.value.tileID,c)}}class ye{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,c){const d=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},l.e(this.stateChanges[t][d],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==d&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const m in this.state[t][d])c[m]||(this.deletedStates[t][d][m]=null)}else for(const m in c)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][m]===null&&delete this.deletedStates[t][d][m]}removeFeatureState(t,o,c){if(this.deletedStates[t]===null)return;const d=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&o!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][c]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(c in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][c]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,o){const c=String(o),d=l.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][o];if(m===null)return{};for(const x in m)delete d[x]}return d}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),l.e(this.state[d][x],this.stateChanges[d][x]),m[x]=this.state[d][x];c[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const x in this.state[d])m[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const w of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][w];m[x]=this.state[d][x]}c[d]=c[d]||{},l.e(c[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in t)t[d].setFeatureState(c,o)}}class dn extends l.E{constructor(t,o,c){super(),this.id=t,this.dispatcher=c,this.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,x,w)=>{const T=new(zr(m.type))(d,m,x,w);if(T.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${T.id}`);return T})(t,o,c,this),this._tiles={},this._cache=new _s(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ye,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o){return this._source.loadTile(t,o)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new l.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Un).map(t=>t.key)}getRenderableIds(t){const o=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&o.push(this._tiles[c]);return t?o.sort((c,d)=>{const m=c.tileID,x=d.tileID,w=new l.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),T=new l.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-x.overscaledZ||T.y-w.y||T.x-w.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(Un).map(c=>c.key)}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,o){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,t,o)))}_tileLoaded(t,o,c,d){if(d)return t.state="errored",void(d.status!==404?this._source.fire(new l.j(d,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=l.h.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const o=this.getRenderableIds();for(let d=0;d<o.length;d++){const m=o[d];if(t.neighboringTiles&&t.neighboringTiles[m]){const x=this.getTileByID(m);c(t,x),c(x,t)}}function c(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-d.tileID.canonical.x;const w=m.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),C=m.tileID.key;x===0&&w===0||Math.abs(w)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,x,w),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,c,d){for(const m in this._tiles){let x=this._tiles[m];if(d[m]||!x.hasData()||x.tileID.overscaledZ<=o||x.tileID.overscaledZ>c)continue;let w=x.tileID;for(;x&&x.tileID.overscaledZ>o+1;){const C=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[C.key],x&&x.hasData()&&(w=C)}let T=w;for(;T.overscaledZ>o;)if(T=T.scaledTo(T.overscaledZ-1),t[T.key]){d[w.key]=w;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=t.overscaledZ-1;c>=o;c--){const d=t.scaledTo(c),m=this._getLoadedTile(d);if(m)return m}}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(o*c*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const c={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),c[m.tileID.key]=m}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(t,o){if(this.transform=t,this.terrain=o,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new l.O(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(c=c.filter(I=>this._source.hasTile(I)))):c=[];const d=t.coveringZoomLevel(this._source),m=Math.max(d-dn.maxOverzooming,this._source.minzoom),x=Math.max(d+dn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const I={};for(const P of c)if(P.canonical.z>this._source.minzoom){const F=P.scaledTo(P.canonical.z-1);I[F.key]=F;const q=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));I[q.key]=q}c=c.concat(Object.values(I))}const w=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new l.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(c,d);if(jt(this._source.type)){const I={},P={},F=Object.keys(T),q=l.h.now();for(const $ of F){const G=T[$],U=this._tiles[$];if(!U||U.fadeEndTime!==0&&U.fadeEndTime<=q)continue;const oe=this.findLoadedParent(G,m);oe&&(this._addTile(oe.tileID),I[oe.tileID.key]=oe.tileID),P[$]=G}this._retainLoadedChildren(P,d,x,T);for(const $ in I)T[$]||(this._coveredTiles[$]=!0,T[$]=I[$]);if(o){const $={},G={};for(const U of c)this._tiles[U.key].hasData()?$[U.key]=U:G[U.key]=U;for(const U in G){const oe=G[U].children(this._source.maxzoom);this._tiles[oe[0].key]&&this._tiles[oe[1].key]&&this._tiles[oe[2].key]&&this._tiles[oe[3].key]&&($[oe[0].key]=T[oe[0].key]=oe[0],$[oe[1].key]=T[oe[1].key]=oe[1],$[oe[2].key]=T[oe[2].key]=oe[2],$[oe[3].key]=T[oe[3].key]=oe[3],delete G[U])}for(const U in G){const oe=this.findLoadedParent(G[U],this._source.minzoom);if(oe){$[oe.tileID.key]=T[oe.tileID.key]=oe.tileID;for(const pe in $)$[pe].isChildOf(oe.tileID)&&delete $[pe]}}for(const U in this._tiles)$[U]||(this._coveredTiles[U]=!0)}}for(const I in T)this._tiles[I].clearFadeHold();const C=l.ab(this._tiles,T);for(const I of C){const P=this._tiles[I];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(I)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){const c={},d={},m=Math.max(o-dn.maxOverzooming,this._source.minzoom),x=Math.max(o+dn.maxUnderzooming,this._source.minzoom),w={};for(const T of t){const C=this._addTile(T);c[T.key]=T,C.hasData()||o<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,o,x,c);for(const T of t){let C=this._tiles[T.key];if(C.hasData())continue;if(o+1>this._source.maxzoom){const P=T.children(this._source.maxzoom)[0],F=this.getTile(P);if(F&&F.hasData()){c[P.key]=P;continue}}else{const P=T.children(this._source.maxzoom);if(c[P[0].key]&&c[P[1].key]&&c[P[2].key]&&c[P[3].key])continue}let I=C.wasRequested();for(let P=T.overscaledZ-1;P>=m;--P){const F=T.scaledTo(P);if(d[F.key])break;if(d[F.key]=!0,C=this.getTile(F),!C&&I&&(C=this._addTile(F)),C){const q=C.hasData();if((I||q)&&(c[F.key]=F),I=C.wasRequested(),q)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let c,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}o.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;d=m}for(const m of o)this._loadedParentTiles[m]=c}}_addTile(t){let o=this._tiles[t.key];if(o)return o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const c=o;return o||(o=new ts(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,t.key,o.state))),o.uses++,this._tiles[t.key]=o,c||this._source.fire(new l.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=o.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,o,c){const d=[],m=this.transform;if(!m)return d;const x=c?m.getCameraQueryGeometry(t):t,w=t.map($=>m.pointCoordinate($,this.terrain)),T=x.map($=>m.pointCoordinate($,this.terrain)),C=this.getIds();let I=1/0,P=1/0,F=-1/0,q=-1/0;for(const $ of T)I=Math.min(I,$.x),P=Math.min(P,$.y),F=Math.max(F,$.x),q=Math.max(q,$.y);for(let $=0;$<C.length;$++){const G=this._tiles[C[$]];if(G.holdingForFade())continue;const U=G.tileID,oe=Math.pow(2,m.zoom-G.tileID.overscaledZ),pe=o*G.queryPadding*l.N/G.tileSize/oe,K=[U.getTilePoint(new l.U(I,P)),U.getTilePoint(new l.U(F,q))];if(K[0].x-pe<l.N&&K[0].y-pe<l.N&&K[1].x+pe>=0&&K[1].y+pe>=0){const ae=w.map(ge=>U.getTilePoint(ge)),me=T.map(ge=>U.getTilePoint(ge));d.push({tile:G,tileID:U,queryGeometry:ae,cameraQueryGeometry:me,scale:oe})}}return d}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of o)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(jt(this._source.type)){const t=l.h.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=t)return!0}return!1}setFeatureState(t,o,c){this._state.updateState(t=t||"_geojsonTileLayer",o,c)}removeFeatureState(t,o,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,c)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,c){const d=this._tiles[t];d&&d.setDependencies(o,c)}reloadTilesForDependencies(t,o){for(const c in this._tiles)this._tiles[c].hasDependency(t,o)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,o))}}function Un(p,t){const o=Math.abs(2*p.wrap)-+(p.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return p.overscaledZ-t.overscaledZ||c-o||t.canonical.y-p.canonical.y||t.canonical.x-p.canonical.x}function jt(p){return p==="raster"||p==="image"||p==="video"}dn.maxOverzooming=10,dn.maxUnderzooming=3;const It="mapboxgl_preloaded_worker_pool";class fr{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<fr.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const Ws=Math.floor(l.h.hardwareConcurrency/2);let Ar;function ba(){return Ar||(Ar=new fr),Ar}fr.workerCount=l.ac(globalThis)?Math.max(Math.min(Ws,3),1):1;class Xs{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.ad(t,0,1);let o=1,c=this._distances[o];const d=t*this.paddedLength+this.padding;for(;c<d&&o<this._distances.length;)c=this._distances[++o];const m=o-1,x=this._distances[m],w=c-x,T=w>0?(d-x)/w:0;return this.points[m].mult(1-T).add(this.points[o].mult(T))}}function is(p,t){let o=!0;return p==="always"||p!=="never"&&t!=="never"||(o=!1),o}class vs{constructor(t,o,c){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(o/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,c,d,m){this._forEachCell(o,c,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(t,o,c,d){this._forEachCell(o-d,c-d,o+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(c),this.circles.push(d)}_insertBoxCell(t,o,c,d,m,x){this.boxCells[m].push(x)}_insertCircleCell(t,o,c,d,m,x){this.circleCells[m].push(x)}_query(t,o,c,d,m,x,w){if(c<0||t>this.width||d<0||o>this.height)return[];const T=[];if(t<=0&&o<=0&&this.width<=c&&this.height<=d){if(m)return[{key:null,x1:t,y1:o,x2:c,y2:d}];for(let C=0;C<this.boxKeys.length;C++)T.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const I=this.circles[3*C],P=this.circles[3*C+1],F=this.circles[3*C+2];T.push({key:this.circleKeys[C],x1:I-F,y1:P-F,x2:I+F,y2:P+F})}}else this._forEachCell(t,o,c,d,this._queryCell,T,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},w);return T}query(t,o,c,d){return this._query(t,o,c,d,!1,null)}hitTest(t,o,c,d,m,x){return this._query(t,o,c,d,!0,m,x).length>0}hitTestCircle(t,o,c,d,m){const x=t-c,w=t+c,T=o-c,C=o+c;if(w<0||x>this.width||C<0||T>this.height)return!1;const I=[];return this._forEachCell(x,T,w,C,this._queryCellCircle,I,{hitTest:!0,overlapMode:d,circle:{x:t,y:o,radius:c},seenUids:{box:{},circle:{}}},m),I.length>0}_queryCell(t,o,c,d,m,x,w,T){const{seenUids:C,hitTest:I,overlapMode:P}=w,F=this.boxCells[m];if(F!==null){const $=this.bboxes;for(const G of F)if(!C.box[G]){C.box[G]=!0;const U=4*G,oe=this.boxKeys[G];if(t<=$[U+2]&&o<=$[U+3]&&c>=$[U+0]&&d>=$[U+1]&&(!T||T(oe))&&(!I||!is(P,oe.overlapMode))&&(x.push({key:oe,x1:$[U],y1:$[U+1],x2:$[U+2],y2:$[U+3]}),I))return!0}}const q=this.circleCells[m];if(q!==null){const $=this.circles;for(const G of q)if(!C.circle[G]){C.circle[G]=!0;const U=3*G,oe=this.circleKeys[G];if(this._circleAndRectCollide($[U],$[U+1],$[U+2],t,o,c,d)&&(!T||T(oe))&&(!I||!is(P,oe.overlapMode))){const pe=$[U],K=$[U+1],ae=$[U+2];if(x.push({key:oe,x1:pe-ae,y1:K-ae,x2:pe+ae,y2:K+ae}),I)return!0}}}return!1}_queryCellCircle(t,o,c,d,m,x,w,T){const{circle:C,seenUids:I,overlapMode:P}=w,F=this.boxCells[m];if(F!==null){const $=this.bboxes;for(const G of F)if(!I.box[G]){I.box[G]=!0;const U=4*G,oe=this.boxKeys[G];if(this._circleAndRectCollide(C.x,C.y,C.radius,$[U+0],$[U+1],$[U+2],$[U+3])&&(!T||T(oe))&&!is(P,oe.overlapMode))return x.push(!0),!0}}const q=this.circleCells[m];if(q!==null){const $=this.circles;for(const G of q)if(!I.circle[G]){I.circle[G]=!0;const U=3*G,oe=this.circleKeys[G];if(this._circlesCollide($[U],$[U+1],$[U+2],C.x,C.y,C.radius)&&(!T||T(oe))&&!is(P,oe.overlapMode))return x.push(!0),!0}}}_forEachCell(t,o,c,d,m,x,w,T){const C=this._convertToXCellCoord(t),I=this._convertToYCellCoord(o),P=this._convertToXCellCoord(c),F=this._convertToYCellCoord(d);for(let q=C;q<=P;q++)for(let $=I;$<=F;$++)if(m.call(this,t,o,c,d,this.xCellCount*$+q,x,w,T))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,c,d,m,x){const w=d-t,T=m-o,C=c+x;return C*C>w*w+T*T}_circleAndRectCollide(t,o,c,d,m,x,w){const T=(x-d)/2,C=Math.abs(t-(d+T));if(C>T+c)return!1;const I=(w-m)/2,P=Math.abs(o-(m+I));if(P>I+c)return!1;if(C<=T||P<=I)return!0;const F=C-T,q=P-I;return F*F+q*q<=c*c}}function Ae(p,t,o,c,d){const m=l.Z();return t?(l.a0(m,m,[1/d,1/d,1]),o||l.ae(m,m,c.angle)):l.a1(m,c.labelPlaneMatrix,p),m}function mr(p,t,o,c,d){if(t){const m=l.af(p);return l.a0(m,m,[d,d,1]),o||l.ae(m,m,-c.angle),m}return c.glCoordMatrix}function ni(p,t,o){let c;o?(c=[p.x,p.y,o(p.x,p.y),1],l.ag(c,c,t)):(c=[p.x,p.y,0,1],H(c,c,t));const d=c[3];return{point:new l.P(c[0]/d,c[1]/d),signedDistanceFromCamera:d}}function xs(p,t){return .5+p/t*.5}function Lr(p,t){const o=p[0]/p[3],c=p[1]/p[3];return o>=-t[0]&&o<=t[0]&&c>=-t[1]&&c<=t[1]}function Re(p,t,o,c,d,m,x,w,T,C){const I=c?p.textSizeData:p.iconSizeData,P=l.ah(I,o.transform.zoom),F=[256/o.width*2+1,256/o.height*2+1],q=c?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;q.clear();const $=p.lineVertexArray,G=c?p.text.placedSymbolArray:p.icon.placedSymbolArray,U=o.transform.width/o.transform.height;let oe=!1;for(let pe=0;pe<G.length;pe++){const K=G.get(pe);if(K.hidden||K.writingMode===l.ai.vertical&&!oe){V(K.numGlyphs,q);continue}let ae;if(oe=!1,C?(ae=[K.anchorX,K.anchorY,C(K.anchorX,K.anchorY),1],l.ag(ae,ae,t)):(ae=[K.anchorX,K.anchorY,0,1],H(ae,ae,t)),!Lr(ae,F)){V(K.numGlyphs,q);continue}const me=xs(o.transform.cameraToCenterDistance,ae[3]),ge=l.aj(I,P,K),we=x?ge/me:ge*me,Ce=new l.P(K.anchorX,K.anchorY),Te=ni(Ce,d,C).point,Ie={projections:{},offsets:{}},Xe=en(K,we,!1,w,t,d,m,p.glyphOffsetArray,$,q,Te,Ce,Ie,U,T,C);oe=Xe.useVertical,(Xe.notEnoughRoom||oe||Xe.needsFlipping&&en(K,we,!0,w,t,d,m,p.glyphOffsetArray,$,q,Te,Ce,Ie,U,T,C).notEnoughRoom)&&V(K.numGlyphs,q)}c?p.text.dynamicLayoutVertexBuffer.updateData(q):p.icon.dynamicLayoutVertexBuffer.updateData(q)}function gt(p,t,o,c,d,m,x,w,T,C,I,P,F){const q=w.glyphStartIndex+w.numGlyphs,$=w.lineStartIndex,G=w.lineStartIndex+w.lineLength,U=t.getoffsetX(w.glyphStartIndex),oe=t.getoffsetX(q-1),pe=A(p*U,o,c,d,m,x,w.segment,$,G,T,C,I,P,F);if(!pe)return null;const K=A(p*oe,o,c,d,m,x,w.segment,$,G,T,C,I,P,F);return K?{first:pe,last:K}:null}function ct(p,t,o,c){return p===l.ai.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*c?{useVertical:!0}:(p===l.ai.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function en(p,t,o,c,d,m,x,w,T,C,I,P,F,q,$,G){const U=t/24,oe=p.lineOffsetX*U,pe=p.lineOffsetY*U;let K;if(p.numGlyphs>1){const ae=p.glyphStartIndex+p.numGlyphs,me=p.lineStartIndex,ge=p.lineStartIndex+p.lineLength,we=gt(U,w,oe,pe,o,I,P,p,T,m,F,$,G);if(!we)return{notEnoughRoom:!0};const Ce=ni(we.first.point,x,G).point,Te=ni(we.last.point,x,G).point;if(c&&!o){const Ie=ct(p.writingMode,Ce,Te,q);if(Ie)return Ie}K=[we.first];for(let Ie=p.glyphStartIndex+1;Ie<ae-1;Ie++)K.push(A(U*w.getoffsetX(Ie),oe,pe,o,I,P,p.segment,me,ge,T,m,F,$,G));K.push(we.last)}else{if(c&&!o){const me=ni(P,d,G).point,ge=p.lineStartIndex+p.segment+1,we=new l.P(T.getx(ge),T.gety(ge)),Ce=ni(we,d,G),Te=Ce.signedDistanceFromCamera>0?Ce.point:gr(P,we,me,1,d,G),Ie=ct(p.writingMode,me,Te,q);if(Ie)return Ie}const ae=A(U*w.getoffsetX(p.glyphStartIndex),oe,pe,o,I,P,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,T,m,F,$,G);if(!ae)return{notEnoughRoom:!0};K=[ae]}for(const ae of K)l.ak(C,ae.point,ae.angle);return{}}function gr(p,t,o,c,d,m){const x=ni(p.add(p.sub(t)._unit()),d,m).point,w=o.sub(x);return o.add(w._mult(c/w.mag()))}function ft(p,t){const{projectionCache:o,lineVertexArray:c,labelPlaneMatrix:d,tileAnchorPoint:m,distanceFromAnchor:x,getElevation:w,previousVertex:T,direction:C,absOffsetX:I}=t;if(o.projections[p])return o.projections[p];const P=new l.P(c.getx(p),c.gety(p)),F=ni(P,d,w);if(F.signedDistanceFromCamera>0)return o.projections[p]=F.point,F.point;const q=p-C;return gr(x===0?m:new l.P(c.getx(q),c.gety(q)),P,T,I-x+1,d,w)}function Dr(p,t,o){return p._unit()._perp()._mult(t*o)}function Z(p,t,o,c,d,m,x,w){const{projectionCache:T,direction:C}=w;if(T.offsets[p])return T.offsets[p];const I=o.add(t);if(p+C<c||p+C>=d)return T.offsets[p]=I,I;const P=ft(p+C,w),F=Dr(P.sub(o),x,C),q=o.add(F),$=P.add(F);return T.offsets[p]=l.al(m,I,q,$)||I,T.offsets[p]}function A(p,t,o,c,d,m,x,w,T,C,I,P,F,q){const $=c?p-t:p+t;let G=$>0?1:-1,U=0;c&&(G*=-1,U=Math.PI),G<0&&(U+=Math.PI);let oe,pe,K=G>0?w+x:w+x+1,ae=d,me=d,ge=0,we=0;const Ce=Math.abs($),Te=[];let Ie;for(;ge+we<=Ce;){if(K+=G,K<w||K>=T)return null;ge+=we,me=ae,pe=oe;const Ne={projectionCache:P,lineVertexArray:C,labelPlaneMatrix:I,tileAnchorPoint:m,distanceFromAnchor:ge,getElevation:q,previousVertex:me,direction:G,absOffsetX:Ce};if(ae=ft(K,Ne),o===0)Te.push(me),Ie=ae.sub(me);else{let at;const Ye=ae.sub(me);at=Ye.mag()===0?Dr(ft(K+G,Ne).sub(ae),o,G):Dr(Ye,o,G),pe||(pe=me.add(at)),oe=Z(K,at,ae,w,T,pe,o,Ne),Te.push(pe),Ie=oe.sub(pe)}we=Ie.mag()}const Xe=Ie._mult((Ce-ge)/we)._add(pe||me),xt=U+Math.atan2(ae.y-me.y,ae.x-me.x);return Te.push(Xe),{point:Xe,angle:F?xt:0,path:Te}}const D=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function V(p,t){for(let o=0;o<p;o++){const c=t.length;t.resize(c+4),t.float32.set(D,3*c)}}function H(p,t,o){const c=t[0],d=t[1];return p[0]=o[0]*c+o[4]*d+o[12],p[1]=o[1]*c+o[5]*d+o[13],p[3]=o[3]*c+o[7]*d+o[15],p}const X=100;class ce{constructor(t,o=new vs(t.width+200,t.height+200,25),c=new vs(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+X,this.screenBottomBoundary=t.height+X,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,c,d,m,x){const w=this.projectAndGetPerspectiveRatio(d,t.anchorPointX,t.anchorPointY,x),T=c*w.perspectiveRatio,C=t.x1*T+w.point.x,I=t.y1*T+w.point.y,P=t.x2*T+w.point.x,F=t.y2*T+w.point.y;return!this.isInsideGrid(C,I,P,F)||o!=="always"&&this.grid.hitTest(C,I,P,F,o,m)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[C,I,P,F],offscreen:this.isOffscreen(C,I,P,F)}}placeCollisionCircles(t,o,c,d,m,x,w,T,C,I,P,F,q,$){const G=[],U=new l.P(o.anchorX,o.anchorY),oe=ni(U,x,$),pe=xs(this.transform.cameraToCenterDistance,oe.signedDistanceFromCamera),K=(I?m/pe:m*pe)/l.ap,ae=ni(U,w,$).point,me=gt(K,d,o.lineOffsetX*K,o.lineOffsetY*K,!1,ae,U,o,c,w,{projections:{},offsets:{}},!1,$);let ge=!1,we=!1,Ce=!0;if(me){const Te=.5*F*pe+q,Ie=new l.P(-100,-100),Xe=new l.P(this.screenRightBoundary,this.screenBottomBoundary),xt=new Xs,Ne=me.first,at=me.last;let Ye=[];for(let mt=Ne.path.length-1;mt>=1;mt--)Ye.push(Ne.path[mt]);for(let mt=1;mt<at.path.length;mt++)Ye.push(at.path[mt]);const Bt=2.5*Te;if(T){const mt=Ye.map(wt=>ni(wt,T,$));Ye=mt.some(wt=>wt.signedDistanceFromCamera<=0)?[]:mt.map(wt=>wt.point)}let vt=[];if(Ye.length>0){const mt=Ye[0].clone(),wt=Ye[0].clone();for(let hi=1;hi<Ye.length;hi++)mt.x=Math.min(mt.x,Ye[hi].x),mt.y=Math.min(mt.y,Ye[hi].y),wt.x=Math.max(wt.x,Ye[hi].x),wt.y=Math.max(wt.y,Ye[hi].y);vt=mt.x>=Ie.x&&wt.x<=Xe.x&&mt.y>=Ie.y&&wt.y<=Xe.y?[Ye]:wt.x<Ie.x||mt.x>Xe.x||wt.y<Ie.y||mt.y>Xe.y?[]:l.am([Ye],Ie.x,Ie.y,Xe.x,Xe.y)}for(const mt of vt){xt.reset(mt,.25*Te);let wt=0;wt=xt.length<=.5*Te?1:Math.ceil(xt.paddedLength/Bt)+1;for(let hi=0;hi<wt;hi++){const Zt=hi/Math.max(wt-1,1),Oi=xt.lerp(Zt),ki=Oi.x+X,gi=Oi.y+X;G.push(ki,gi,Te,0);const zn=ki-Te,Wt=gi-Te,_r=ki+Te,vr=gi+Te;if(Ce=Ce&&this.isOffscreen(zn,Wt,_r,vr),we=we||this.isInsideGrid(zn,Wt,_r,vr),t!=="always"&&this.grid.hitTestCircle(ki,gi,Te,t,P)&&(ge=!0,!C))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!C&&ge||!we||pe<this.perspectiveRatioCutoff?[]:G,offscreen:Ce,collisionDetected:ge}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,d=1/0,m=-1/0,x=-1/0;for(const I of t){const P=new l.P(I.x+X,I.y+X);c=Math.min(c,P.x),d=Math.min(d,P.y),m=Math.max(m,P.x),x=Math.max(x,P.y),o.push(P)}const w=this.grid.query(c,d,m,x).concat(this.ignoredGrid.query(c,d,m,x)),T={},C={};for(const I of w){const P=I.key;if(T[P.bucketInstanceId]===void 0&&(T[P.bucketInstanceId]={}),T[P.bucketInstanceId][P.featureIndex])continue;const F=[new l.P(I.x1,I.y1),new l.P(I.x2,I.y1),new l.P(I.x2,I.y2),new l.P(I.x1,I.y2)];l.an(o,F)&&(T[P.bucketInstanceId][P.featureIndex]=!0,C[P.bucketInstanceId]===void 0&&(C[P.bucketInstanceId]=[]),C[P.bucketInstanceId].push(P.featureIndex))}return C}insertCollisionBox(t,o,c,d,m,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:x,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,c,d,m,x){const w=c?this.ignoredGrid:this.grid,T={bucketInstanceId:d,featureIndex:m,collisionGroupID:x,overlapMode:o};for(let C=0;C<t.length;C+=4)w.insertCircle(T,t[C],t[C+1],t[C+2])}projectAndGetPerspectiveRatio(t,o,c,d){let m;return d?(m=[o,c,d(o,c),1],l.ag(m,m,t)):(m=[o,c,0,1],H(m,m,t)),{point:new l.P((m[0]/m[3]+1)/2*this.transform.width+X,(-m[1]/m[3]+1)/2*this.transform.height+X),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}}isOffscreen(t,o,c,d){return c<X||t>=this.screenRightBoundary||d<X||o>this.screenBottomBoundary}isInsideGrid(t,o,c,d){return c>=0&&t<this.gridRightBoundary&&d>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=l.ao([]);return l.$(t,t,[-100,-100,0]),t}}function ne(p,t,o){return t*(l.N/(p.tileSize*Math.pow(2,o-p.tileID.overscaledZ)))}class J{constructor(t,o,c,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class le{constructor(t,o,c,d,m){this.text=new J(t?t.text:null,o,c,m),this.icon=new J(t?t.icon:null,o,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _e{constructor(t,o,c){this.text=t,this.icon=o,this.skipFade=c}}class xe{constructor(){this.invProjMatrix=l.Z(),this.viewportMatrix=l.Z(),this.circles=[]}}class Se{constructor(t,o,c,d,m){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=m}}class it{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[t]}}function lt(p,t,o,c,d){const{horizontalAlign:m,verticalAlign:x}=l.au(p);return new l.P(-(m-.5)*t+c[0]*d,-(x-.5)*o+c[1]*d)}function We(p,t,o,c,d,m){const{x1:x,x2:w,y1:T,y2:C,anchorPointX:I,anchorPointY:P}=p,F=new l.P(t,o);return c&&F._rotate(d?m:-m),{x1:x+F.x,y1:T+F.y,x2:w+F.x,y2:C+F.y,anchorPointX:I,anchorPointY:P}}class rt{constructor(t,o,c,d,m){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new ce(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new it(d),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,o,c,d){const m=c.getBucket(o),x=c.latestFeatureIndex;if(!m||!x||o.id!==m.layerIds[0])return;const w=c.collisionBoxArray,T=m.layers[0].layout,C=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),I=c.tileSize/l.N,P=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),F=T.get("text-pitch-alignment")==="map",q=T.get("text-rotation-alignment")==="map",$=ne(c,1,this.transform.zoom),G=Ae(P,F,q,this.transform,$);let U=null;if(F){const pe=mr(P,F,q,this.transform,$);U=l.a1([],this.transform.labelPlaneMatrix,pe)}this.retainedQueryData[m.bucketInstanceId]=new Se(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,c.tileID);const oe={bucket:m,layout:T,posMatrix:P,textLabelPlaneMatrix:G,labelToScreenMatrix:U,scale:C,textPixelRatio:I,holdingForFade:c.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:l.ah(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const pe of m.sortKeyRanges){const{sortKey:K,symbolInstanceStart:ae,symbolInstanceEnd:me}=pe;t.push({sortKey:K,symbolInstanceStart:ae,symbolInstanceEnd:me,parameters:oe})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(t,o,c,d,m,x,w,T,C,I,P,F,q,$,G,U){const oe=l.aq[t.textAnchor],pe=[t.textOffset0,t.textOffset1],K=lt(oe,c,d,pe,m),ae=this.collisionIndex.placeCollisionBox(We(o,K.x,K.y,x,w,this.transform.angle),P,T,C,I.predicate,U);if((!G||this.collisionIndex.placeCollisionBox(We(G,K.x,K.y,x,w,this.transform.angle),P,T,C,I.predicate,U).box.length!==0)&&ae.box.length>0){let me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(me=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:pe,width:c,height:d,anchor:oe,textBoxScale:m,prevAnchor:me},this.markUsedJustification(q,oe,F,$),q.allowVerticalPlacement&&(this.markUsedOrientation(q,$,F),this.placedOrientations[F.crossTileID]=$),{shift:K,placedGlyphBoxes:ae}}}placeLayerBucketPart(t,o,c){const{bucket:d,layout:m,posMatrix:x,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:C,holdingForFade:I,collisionBoxArray:P,partiallyEvaluatedTextSize:F,collisionGroup:q}=t.parameters,$=m.get("text-optional"),G=m.get("icon-optional"),U=l.ar(m,"text-overlap","text-allow-overlap"),oe=U==="always",pe=l.ar(m,"icon-overlap","icon-allow-overlap"),K=pe==="always",ae=m.get("text-rotation-alignment")==="map",me=m.get("text-pitch-alignment")==="map",ge=m.get("icon-text-fit")!=="none",we=m.get("symbol-z-order")==="viewport-y",Ce=oe&&(K||!d.hasIconData()||G),Te=K&&(oe||!d.hasTextData()||$);!d.collisionArrays&&P&&d.deserializeCollisionBoxes(P);const Ie=this.retainedQueryData[d.bucketInstanceId].tileID,Xe=this.terrain?(Ne,at)=>this.terrain.getElevation(Ie,Ne,at):null,xt=(Ne,at)=>{var Ye,Bt;if(o[Ne.crossTileID])return;if(I)return void(this.placements[Ne.crossTileID]=new _e(!1,!1,!1));let vt=!1,mt=!1,wt=!0,hi=null,Zt={box:null,offscreen:null},Oi={box:null,offscreen:null},ki=null,gi=null,zn=null,Wt=0,_r=0,vr=0;at.textFeatureIndex?Wt=at.textFeatureIndex:Ne.useRuntimeCollisionCircles&&(Wt=Ne.featureIndex),at.verticalTextFeatureIndex&&(_r=at.verticalTextFeatureIndex);const us=at.textBox;if(us){const Hi=di=>{let Ci=l.ai.horizontal;if(d.allowVerticalPlacement&&!di&&this.prevPlacement){const mn=this.prevPlacement.placedOrientations[Ne.crossTileID];mn&&(this.placedOrientations[Ne.crossTileID]=mn,Ci=mn,this.markUsedOrientation(d,Ci,Ne))}return Ci},Ni=(di,Ci)=>{if(d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&at.verticalTextBox){for(const mn of d.writingModes)if(mn===l.ai.vertical?(Zt=Ci(),Oi=Zt):Zt=di(),Zt&&Zt.box&&Zt.box.length)break}else Zt=di()},nn=Ne.textAnchorOffsetStartIndex,Ms=Ne.textAnchorOffsetEndIndex;if(Ms===nn){const di=(Ci,mn)=>{const pi=this.collisionIndex.placeCollisionBox(Ci,U,C,x,q.predicate,Xe);return pi&&pi.box&&pi.box.length&&(this.markUsedOrientation(d,mn,Ne),this.placedOrientations[Ne.crossTileID]=mn),pi};Ni(()=>di(us,l.ai.horizontal),()=>{const Ci=at.verticalTextBox;return d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&Ci?di(Ci,l.ai.vertical):{box:null,offscreen:null}}),Hi(Zt&&Zt.box&&Zt.box.length)}else{let di=l.aq[(Bt=(Ye=this.prevPlacement)===null||Ye===void 0?void 0:Ye.variableOffsets[Ne.crossTileID])===null||Bt===void 0?void 0:Bt.anchor];const Ci=(pi,zs,Ya)=>{const _h=pi.x2-pi.x1,vh=pi.y2-pi.y1,bp=Ne.textBoxScale,ku=ge&&pe==="never"?zs:null;let xr={box:[],offscreen:!1},As=U==="never"?1:2,wr="never";di&&As++;for(let Wn=0;Wn<As;Wn++){for(let br=nn;br<Ms;br++){const Cu=d.textAnchorOffsets.get(br);if(di&&Cu.textAnchor!==di)continue;const Vr=this.attemptAnchorPlacement(Cu,pi,_h,vh,bp,ae,me,C,x,q,wr,Ne,d,Ya,ku,Xe);if(Vr&&(xr=Vr.placedGlyphBoxes,xr&&xr.box&&xr.box.length))return vt=!0,hi=Vr.shift,xr}di?di=null:wr=U}return xr};Ni(()=>Ci(us,at.iconBox,l.ai.horizontal),()=>{const pi=at.verticalTextBox;return d.allowVerticalPlacement&&!(Zt&&Zt.box&&Zt.box.length)&&Ne.numVerticalGlyphVertices>0&&pi?Ci(pi,at.verticalIconBox,l.ai.vertical):{box:null,offscreen:null}}),Zt&&(vt=Zt.box,wt=Zt.offscreen);const mn=Hi(Zt&&Zt.box);if(!vt&&this.prevPlacement){const pi=this.prevPlacement.variableOffsets[Ne.crossTileID];pi&&(this.variableOffsets[Ne.crossTileID]=pi,this.markUsedJustification(d,pi.anchor,Ne,mn))}}}if(ki=Zt,vt=ki&&ki.box&&ki.box.length>0,wt=ki&&ki.offscreen,Ne.useRuntimeCollisionCircles){const Hi=d.text.placedSymbolArray.get(Ne.centerJustifiedTextSymbolIndex),Ni=l.aj(d.textSizeData,F,Hi),nn=m.get("text-padding");gi=this.collisionIndex.placeCollisionCircles(U,Hi,d.lineVertexArray,d.glyphOffsetArray,Ni,x,w,T,c,me,q.predicate,Ne.collisionCircleDiameter,nn,Xe),gi.circles.length&&gi.collisionDetected&&!c&&l.w("Collisions detected, but collision boxes are not shown"),vt=oe||gi.circles.length>0&&!gi.collisionDetected,wt=wt&&gi.offscreen}if(at.iconFeatureIndex&&(vr=at.iconFeatureIndex),at.iconBox){const Hi=Ni=>{const nn=ge&&hi?We(Ni,hi.x,hi.y,ae,me,this.transform.angle):Ni;return this.collisionIndex.placeCollisionBox(nn,pe,C,x,q.predicate,Xe)};Oi&&Oi.box&&Oi.box.length&&at.verticalIconBox?(zn=Hi(at.verticalIconBox),mt=zn.box.length>0):(zn=Hi(at.iconBox),mt=zn.box.length>0),wt=wt&&zn.offscreen}const Ps=$||Ne.numHorizontalGlyphVertices===0&&Ne.numVerticalGlyphVertices===0,uo=G||Ne.numIconVertices===0;if(Ps||uo?uo?Ps||(mt=mt&&vt):vt=mt&&vt:mt=vt=mt&&vt,vt&&ki&&ki.box&&this.collisionIndex.insertCollisionBox(ki.box,U,m.get("text-ignore-placement"),d.bucketInstanceId,Oi&&Oi.box&&_r?_r:Wt,q.ID),mt&&zn&&this.collisionIndex.insertCollisionBox(zn.box,pe,m.get("icon-ignore-placement"),d.bucketInstanceId,vr,q.ID),gi&&(vt&&this.collisionIndex.insertCollisionCircles(gi.circles,U,m.get("text-ignore-placement"),d.bucketInstanceId,Wt,q.ID),c)){const Hi=d.bucketInstanceId;let Ni=this.collisionCircleArrays[Hi];Ni===void 0&&(Ni=this.collisionCircleArrays[Hi]=new xe);for(let nn=0;nn<gi.circles.length;nn+=4)Ni.circles.push(gi.circles[nn+0]),Ni.circles.push(gi.circles[nn+1]),Ni.circles.push(gi.circles[nn+2]),Ni.circles.push(gi.collisionDetected?1:0)}if(Ne.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ne.crossTileID]=new _e(vt||Ce,mt||Te,wt||d.justReloaded),o[Ne.crossTileID]=!0};if(we){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ne=d.getSortedSymbolIndexes(this.transform.angle);for(let at=Ne.length-1;at>=0;--at){const Ye=Ne[at];xt(d.symbolInstances.get(Ye),d.collisionArrays[Ye])}}else for(let Ne=t.symbolInstanceStart;Ne<t.symbolInstanceEnd;Ne++)xt(d.symbolInstances.get(Ne),d.collisionArrays[Ne]);if(c&&d.bucketInstanceId in this.collisionCircleArrays){const Ne=this.collisionCircleArrays[d.bucketInstanceId];l.as(Ne.invProjMatrix,x),Ne.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,o,c,d){let m;m=d===l.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.at(o)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const w of x)w>=0&&(t.text.placedSymbolArray.get(w).crossTileID=m>=0&&w!==m?0:c.crossTileID)}markUsedOrientation(t,o,c){const d=o===l.ai.horizontal||o===l.ai.horizontalOnly?o:0,m=o===l.ai.vertical?o:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const w of x)t.text.placedSymbolArray.get(w).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const d=o?o.symbolFadeChange(t):1,m=o?o.opacities:{},x=o?o.variableOffsets:{},w=o?o.placedOrientations:{};for(const T in this.placements){const C=this.placements[T],I=m[T];I?(this.opacities[T]=new le(I,d,C.text,C.icon),c=c||C.text!==I.text.placed||C.icon!==I.icon.placed):(this.opacities[T]=new le(null,d,C.text,C.icon,C.skipFade),c=c||C.text||C.icon)}for(const T in m){const C=m[T];if(!this.opacities[T]){const I=new le(C,d,!1,!1);I.isHidden()||(this.opacities[T]=I,c=c||C.text.placed||C.icon.placed)}}for(const T in x)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=x[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const c={};for(const d of o){const m=d.getBucket(t);m&&d.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,c,d.collisionBoxArray)}}updateBucketOpacities(t,o,c){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const d=t.layers[0],m=d.layout,x=new le(null,0,!1,!1,!0),w=m.get("text-allow-overlap"),T=m.get("icon-allow-overlap"),C=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=m.get("text-rotation-alignment")==="map",P=m.get("text-pitch-alignment")==="map",F=m.get("icon-text-fit")!=="none",q=new le(null,0,w&&(T||!t.hasIconData()||m.get("icon-optional")),T&&(w||!t.hasTextData()||m.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const $=(G,U,oe)=>{for(let pe=0;pe<U/4;pe++)G.opacityVertexArray.emplaceBack(oe);G.hasVisibleVertices=G.hasVisibleVertices||oe!==jn};for(let G=0;G<t.symbolInstances.length;G++){const U=t.symbolInstances.get(G),{numHorizontalGlyphVertices:oe,numVerticalGlyphVertices:pe,crossTileID:K}=U;let ae=this.opacities[K];o[K]?ae=x:ae||(ae=q,this.opacities[K]=ae),o[K]=!0;const me=U.numIconVertices>0,ge=this.placedOrientations[U.crossTileID],we=ge===l.ai.vertical,Ce=ge===l.ai.horizontal||ge===l.ai.horizontalOnly;if(oe>0||pe>0){const Te=Fi(ae.text);$(t.text,oe,we?jn:Te),$(t.text,pe,Ce?jn:Te);const Ie=ae.text.isHidden();[U.rightJustifiedTextSymbolIndex,U.centerJustifiedTextSymbolIndex,U.leftJustifiedTextSymbolIndex].forEach(Ne=>{Ne>=0&&(t.text.placedSymbolArray.get(Ne).hidden=Ie||we?1:0)}),U.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(U.verticalPlacedTextSymbolIndex).hidden=Ie||Ce?1:0);const Xe=this.variableOffsets[U.crossTileID];Xe&&this.markUsedJustification(t,Xe.anchor,U,ge);const xt=this.placedOrientations[U.crossTileID];xt&&(this.markUsedJustification(t,"left",U,xt),this.markUsedOrientation(t,xt,U))}if(me){const Te=Fi(ae.icon),Ie=!(F&&U.verticalPlacedIconSymbolIndex&&we);U.placedIconSymbolIndex>=0&&($(t.icon,U.numIconVertices,Ie?Te:jn),t.icon.placedSymbolArray.get(U.placedIconSymbolIndex).hidden=ae.icon.isHidden()),U.verticalPlacedIconSymbolIndex>=0&&($(t.icon,U.numVerticalIconVertices,Ie?jn:Te),t.icon.placedSymbolArray.get(U.verticalPlacedIconSymbolIndex).hidden=ae.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Te=t.collisionArrays[G];if(Te){let Ie=new l.P(0,0);if(Te.textBox||Te.verticalTextBox){let xt=!0;if(C){const Ne=this.variableOffsets[K];Ne?(Ie=lt(Ne.anchor,Ne.width,Ne.height,Ne.textOffset,Ne.textBoxScale),I&&Ie._rotate(P?this.transform.angle:-this.transform.angle)):xt=!1}Te.textBox&&ht(t.textCollisionBox.collisionVertexArray,ae.text.placed,!xt||we,Ie.x,Ie.y),Te.verticalTextBox&&ht(t.textCollisionBox.collisionVertexArray,ae.text.placed,!xt||Ce,Ie.x,Ie.y)}const Xe=!!(!Ce&&Te.verticalIconBox);Te.iconBox&&ht(t.iconCollisionBox.collisionVertexArray,ae.icon.placed,Xe,F?Ie.x:0,F?Ie.y:0),Te.verticalIconBox&&ht(t.iconCollisionBox.collisionVertexArray,ae.icon.placed,!Xe,F?Ie.x:0,F?Ie.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=G.invProjMatrix,t.placementViewportMatrix=G.viewportMatrix,t.collisionCircleArray=G.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function ht(p,t,o,c,d){p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0)}const Lt=Math.pow(2,25),Vt=Math.pow(2,24),Ct=Math.pow(2,17),kt=Math.pow(2,16),Zi=Math.pow(2,9),qt=Math.pow(2,8),wi=Math.pow(2,1);function Fi(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const t=p.placed?1:0,o=Math.floor(127*p.opacity);return o*Lt+t*Vt+o*Ct+t*kt+o*Zi+t*qt+o*wi+t}const jn=0;class Dc{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,c,d,m){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(x,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<x.length;)if(o.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class Ks{constructor(t,o,c,d,m,x,w,T){this.placement=new rt(t,o,x,w,T),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,o,c){const d=l.h.now(),m=()=>!this._forceFullPlacement&&l.h.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=o[t[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=w)&&(!x.maxzoom||x.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Dc(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ys=512/l.N/2;class sp{constructor(t,o,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let m=0;m<o.length;m++){const x=o.get(m),w=x.key,T=d.get(w);T?T.push(x):d.set(w,[x])}for(const[m,x]of d){const w={positions:x.map(T=>({x:Math.floor(T.anchorX*Ys),y:Math.floor(T.anchorY*Ys)})),crossTileIDs:x.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new l.av(w.positions.length,16,Uint16Array);for(const{x:C,y:I}of w.positions)T.add(C,I);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[m]=w}}getScaledCoordinates(t,o){const{x:c,y:d,z:m}=this.tileID.canonical,{x,y:w,z:T}=o.canonical,C=Ys/Math.pow(2,T-m),I=(w*l.N+t.anchorY)*C,P=d*l.N*Ys;return{x:Math.floor((x*l.N+t.anchorX)*C-c*l.N*Ys),y:Math.floor(I-P)}}findMatches(t,o,c){const d=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<t.length;m++){const x=t.get(m);if(x.crossTileID)continue;const w=this._symbolsByKey[x.key];if(!w)continue;const T=this.getScaledCoordinates(x,o);if(w.index){const C=w.index.range(T.x-d,T.y-d,T.x+d,T.y+d).sort();for(const I of C){const P=w.crossTileIDs[I];if(!c[P]){c[P]=!0,x.crossTileID=P;break}}}else if(w.positions)for(let C=0;C<w.positions.length;C++){const I=w.positions[C],P=w.crossTileIDs[C];if(Math.abs(I.x-T.x)<=d&&Math.abs(I.y-T.y)<=d&&!c[P]){c[P]=!0,x.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Ft{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ol{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const c in this.indexes){const d=this.indexes[c],m={};for(const x in d){const w=d[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),m[w.tileID.key]=w}this.indexes[c]=m}this.lng=t}addBucket(t,o,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const x=this.indexes[m];if(Number(m)>t.overscaledZ)for(const w in x){const T=x[w];T.tileID.isChildOf(t)&&T.findMatches(o.symbolInstances,t,d)}else{const w=x[t.scaledTo(Number(m)).key];w&&w.findMatches(o.symbolInstances,t,d)}}for(let m=0;m<o.symbolInstances.length;m++){const x=o.symbolInstances.get(m);x.crossTileID||(x.crossTileID=c.generate(),d[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new sp(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const c of o.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let o=!1;for(const c in this.indexes){const d=this.indexes[c];for(const m in d)t[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[m]),delete d[m],o=!0)}return o}}class Sa{constructor(){this.layerIndexes={},this.crossTileIDs=new Ft,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,c){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new Ol);let m=!1;const x={};d.handleWrapJump(c);for(const w of o){const T=w.getBucket(t);T&&t.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(w.tileID,T,this.crossTileIDs)&&(m=!0),x[T.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(t){const o={};t.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}const Gi=(p,t)=>l.x(p,t&&t.filter(o=>o.identifier!=="source.canvas")),Cn=l.F(l.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),op=l.F(l.ax,["setCenter","setZoom","setBearing","setPitch"]),$n=l.aw();class Bi extends l.E{constructor(t,o={}){super(),this.map=t,this.dispatcher=new $t(ba(),this,t._getMapId()),this.imageManager=new ui,this.imageManager.setEventedParent(this),this.glyphManager=new kn(t._requestManager,o.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new Sa,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.az());const c=this;this._rtlTextPluginCallback=Bi.registerForPluginStateChange(d=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},(m,x)=>{if(l.aA(m),x&&x.every(w=>w))for(const w in c.sourceCaches){const T=c.sourceCaches[w].getSource().type;T!=="vector"&&T!=="geojson"||c.sourceCaches[w].reload()}})}),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const m=this.sourceCaches[d.sourceId];if(!m)return;const x=m.getSource();if(x&&x.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===x.id&&this._validateLayer(T)}})}loadURL(t,o={},c){this.fire(new l.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const d=this.map._requestManager.transformRequest(t,ee.Style);this._request=l.f(d,(m,x)=>{this._request=null,m?this.fire(new l.j(m)):x&&this._load(x,o,c)})}loadJSON(t,o={},c){this.fire(new l.k("dataloading",{dataType:"style"})),this._request=l.h.frame(()=>{this._request=null,o.validate=o.validate!==!1,this._load(t,o,c)})}loadEmpty(){this.fire(new l.k("dataloading",{dataType:"style"})),this._load($n,{validate:!1})}_load(t,o,c){var d;const m=o.transformStyle?o.transformStyle(c,t):t;if(!o.validate||!Gi(this,l.y(m))){this._loaded=!0,this.stylesheet=m;for(const x in m.sources)this.addSource(x,m.sources[x],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new l.k("data",{dataType:"style"})),this.fire(new l.k("style.load"))}}_createLayers(){const t=l.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of t){const c=l.aC(o);c.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=c}}_loadSprite(t,o=!1,c=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(d,m,x,w){const T=Be(d),C=T.length,I=x>1?"@2x":"",P={},F={},q={};for(const{id:$,url:G}of T){const U=m.transformRequest(m.normalizeSpriteURL(G,I,".json"),ee.SpriteJSON),oe=`${$}_${U.url}`;P[oe]=l.f(U,(ae,me)=>{delete P[oe],F[$]=me,Et(w,F,q,ae,C)});const pe=m.transformRequest(m.normalizeSpriteURL(G,I,".png"),ee.SpriteImage),K=`${$}_${pe.url}`;P[K]=ut.getImage(pe,(ae,me)=>{delete P[K],q[$]=me,Et(w,F,q,ae,C)})}return{cancel(){for(const $ of Object.values(P))$.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),(d,m)=>{if(this._spriteRequest=null,d)this.fire(new l.j(d));else if(m)for(const x in m){this._spritesImagesIds[x]=[];const w=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(T=>!(T in m)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[x]){const C=x==="default"?T:`${x}:${T}`;this._spritesImagesIds[x].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,m[x][T],!1):this.imageManager.addImage(C,m[x][T]),o&&(this._changedImages[C]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"})),c&&c(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}_validateLayer(t){const o=this.sourceCaches[t.source];if(!o)return;const c=t.sourceLayer;if(!c)return;const d=o.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.j(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const o=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o);const c=[];for(const d of t)o[d]&&c.push(o[d]);return c}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const c of o){const d=this._layers[c];d.type!=="custom"&&(t[c]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const x in this._updatedSources){const w=this._updatedSources[x];if(w==="reload")this._reloadSource(x);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];c[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in c){const m=this.sourceCaches[d];c[d]!==m.used&&m.fire(new l.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.z=t.zoom,o&&this.fire(new l.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){this._checkLoaded();const c=this.serialize();if(t=o.transformStyle?o.transformStyle(c,t):t,Gi(this,l.y(t)))return!1;(t=l.aD(t)).layers=l.aB(t.layers);const d=l.aE(c,t).filter(x=>!(x.command in op));if(d.length===0)return!1;const m=d.filter(x=>!(x.command in Cn));if(m.length>0)throw new Error(`Unimplemented: ${m.map(x=>x.command).join(", ")}.`);for(const x of d)x.command!=="setTransition"&&this[x.command].apply(this,x.args);return this.stylesheet=t,this._serializedLayers=null,!0}addImage(t,o){if(this.getImage(t))return this.fire(new l.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(l.y.source,`sources.${t}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const d=this.sourceCaches[t]=new dn(t,o,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new l.j(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],o.fire(new l.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,o,c={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new l.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(t.type==="custom"){if(Gi(this,l.aF(t)))return;m=l.aC(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=l.aD(t),t=l.e(t,{source:d})),this._validate(l.y.layer,`layers.${d}`,t,{arrayIndex:-1},c))return;m=l.aC(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const x=o?this._order.indexOf(o):this._order.length;if(o&&x===-1)this.fire(new l.j(new Error(`Cannot add layer "${d}" before non-existing layer "${o}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const w=this._removedLayers[d];delete this._removedLayers[d],w.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const c=this._order.indexOf(t);this._order.splice(c,1);const d=o?this._order.indexOf(o):this._order.length;o&&d===-1?this.fire(new l.j(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new l.j(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,c){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===o&&d.maxzoom===c||(o!=null&&(d.minzoom=o),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new l.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,c={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!l.aG(d.filter,o))return o==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(l.y.filter,`layers.${d.id}.filter`,o,null,c)||(d.filter=l.aD(o),this._updateLayer(d)))}else this.fire(new l.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.aD(this.getLayer(t).filter)}setLayoutProperty(t,o,c,d={}){this._checkLoaded();const m=this.getLayer(t);m?l.aG(m.getLayoutProperty(o),c)||(m.setLayoutProperty(o,c,d),this._updateLayer(m)):this.fire(new l.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const c=this.getLayer(t);if(c)return c.getLayoutProperty(o);this.fire(new l.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,c,d={}){this._checkLoaded();const m=this.getLayer(t);m?l.aG(m.getPaintProperty(o),c)||(m.setPaintProperty(o,c,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new l.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const c=t.source,d=t.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new l.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=m.getSource().type;x==="geojson"&&d?this.fire(new l.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(t.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,t.id,o)):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const c=t.source,d=this.sourceCaches[c];if(d===void 0)return void this.fire(new l.j(new Error(`The source '${c}' does not exist in the map's style.`)));const m=d.getSource().type,x=m==="vector"?t.sourceLayer:void 0;m!=="vector"||x?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,t.id,o):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,c=t.sourceLayer,d=this.sourceCaches[o];if(d!==void 0)return d.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,t.id)):void this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.aH(this.sourceCaches,m=>m.serialize()),o=this._serializeByIds(this._order),c=this.map.getTerrain()||void 0,d=this.stylesheet;return l.aI({version:d.version,name:d.name,metadata:d.metadata,light:d.light,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:t,layers:o,terrain:c},m=>m!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=x=>this._layers[x].type==="fill-extrusion",c={},d=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(o(w)){c[w]=x;for(const T of t){const C=T[w];if(C)for(const I of C)d.push(I)}}}d.sort((x,w)=>w.intersectionZ-x.intersectionZ);const m=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(o(w))for(let T=d.length-1;T>=0;T--){const C=d[T].feature;if(c[C.layer.id]<x)break;m.push(C),d.pop()}else for(const T of t){const C=T[w];if(C)for(const I of C)m.push(I.feature)}}return m}queryRenderedFeatures(t,o,c){o&&o.filter&&this._validate(l.y.filter,"queryRenderedFeatures.filter",o.filter,null,o);const d={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new l.j(new Error("parameters.layers must be an Array."))),[];for(const w of o.layers){const T=this._layers[w];if(!T)return this.fire(new l.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];d[T.source]=!0}}const m=[];o.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const w in this.sourceCaches)o.layers&&!d[w]||m.push(ys(this.sourceCaches[w],this._layers,x,t,o,c));return this.placement&&m.push(function(w,T,C,I,P,F,q){const $={},G=F.queryRenderedSymbols(I),U=[];for(const oe of Object.keys(G).map(Number))U.push(q[oe]);U.sort(es);for(const oe of U){const pe=oe.featureIndex.lookupSymbolFeatures(G[oe.bucketInstanceId],T,oe.bucketIndex,oe.sourceLayerIndex,P.filter,P.layers,P.availableImages,w);for(const K in pe){const ae=$[K]=$[K]||[],me=pe[K];me.sort((ge,we)=>{const Ce=oe.featureSortOrder;if(Ce){const Te=Ce.indexOf(ge.featureIndex);return Ce.indexOf(we.featureIndex)-Te}return we.featureIndex-ge.featureIndex});for(const ge of me)ae.push(ge)}}for(const oe in $)$[oe].forEach(pe=>{const K=pe.feature,ae=C[w[oe].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=ae});return $}(this._layers,x,this.sourceCaches,t,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,o){o&&o.filter&&this._validate(l.y.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[t];return c?function(d,m){const x=d.getRenderableIds().map(C=>d.getTileByID(C)),w=[],T={};for(let C=0;C<x.length;C++){const I=x[C],P=I.tileID.canonical.key;T[P]||(T[P]=!0,I.querySourceFeatures(w,m))}return w}(c,o):[]}addSourceType(t,o,c){return zr(t)?c(new Error(`A source type called "${t}" already exists.`)):(((d,m)=>{No[d]=m})(t,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:o.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const x in t)if(!l.aG(t[x],c[x])){d=!0;break}if(!d)return;const m={now:l.h.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(m)}_validate(t,o,c,d,m={}){return(!m||m.validate!==!1)&&Gi(this,t.call(l.y,l.e({key:o,style:this.serialize(),value:c,styleSpec:l.v},d)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const c=this.sourceCaches[o];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const o in this.sourceCaches)this.sourceCaches[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,o,c,d,m=!1){let x=!1,w=!1;const T={};for(const C of this._order){const I=this._layers[C];if(I.type!=="symbol")continue;if(!T[I.source]){const F=this.sourceCaches[I.source];T[I.source]=F.getRenderableIds(!0).map(q=>F.getTileByID(q)).sort((q,$)=>$.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan($.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(I,T[I.source],t.center.lng);x=x||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.h.now(),t.zoom))&&(this.pauseablePlacement=new Ks(t,this.map.terrain,this._order,m,o,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.h.now()),w=!0),x&&this.pauseablePlacement.placement.setStale()),w||x)for(const C of this._order){const I=this._layers[C];I.type==="symbol"&&this.placement.updateLayerOpacities(I,T[I.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.h.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o,c){this.imageManager.getImages(o.icons,c),this._updateTilesForChangedImages();const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,o.icons)}getGlyphs(t,o,c){this.glyphManager.getGlyphs(o.stacks,c);const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,[""])}getResource(t,o,c){return l.m(o,c)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(l.y.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,o,c={},d){this._checkLoaded();const m=[{id:t,url:o}],x=[...Be(this.stylesheet.sprite),...m];this._validate(l.y.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,d))}removeSprite(t){this._checkLoaded();const o=Be(this.stylesheet.sprite);if(o.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;o.splice(o.findIndex(c=>c.id===t),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}else this.fire(new l.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Be(this.stylesheet.sprite)}setSprite(t,o={},c){this._checkLoaded(),t&&this._validate(l.y.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}Bi.registerForPluginStateChange=l.aK;var Ta=l.Q([{name:"a_pos",type:"Int16",components:2}]),Qs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Qt={prelude:Mt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Mt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Mt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Mt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Mt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Mt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Mt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Mt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Mt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Mt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Mt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Mt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Mt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Mt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Mt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Mt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Mt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Mt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Mt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Mt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Mt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Mt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Mt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Qs),terrainDepth:Mt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Qs),terrainCoords:Mt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Qs)};function Mt(p,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),d=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(d):d,w={};return{fragmentSource:p=p.replace(o,(T,C,I,P,F)=>(w[F]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = u_${F};
#endif
`)),vertexSource:t=t.replace(o,(T,C,I,P,F)=>{const q=P==="float"?"vec2":"vec4",$=F.match(/color/)?"color":q;return w[F]?C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${q} a_${F};
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${q} a_${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`}),staticAttributes:c,staticUniforms:x}}class ws{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,c,d,m,x,w,T,C){this.context=t;let I=this.boundPaintVertexBuffers.length!==d.length;for(let P=0;!I&&P<d.length;P++)this.boundPaintVertexBuffers[P]!==d[P]&&(I=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||I||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==C?this.freshBind(o,c,d,m,x,w,T,C):(t.bindVertexArray.set(this.vao),w&&w.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),C&&C.bind())}freshBind(t,o,c,d,m,x,w,T){const C=t.numAttributes,I=this.context,P=I.gl;this.vao&&this.destroy(),this.vao=I.createVertexArray(),I.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,o.enableAttributes(P,t);for(const F of c)F.enableAttributes(P,t);x&&x.enableAttributes(P,t),w&&w.enableAttributes(P,t),T&&T.enableAttributes(P,t),o.bind(),o.setVertexAttribPointers(P,t,m);for(const F of c)F.bind(),F.setVertexAttribPointers(P,t,m);x&&(x.bind(),x.setVertexAttribPointers(P,t,m)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(P,t,m)),T&&(T.bind(),T.setVertexAttribPointers(P,t,m)),I.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ri(p){const t=[];for(let o=0;o<p.length;o++){if(p[o]===null)continue;const c=p[o].split(" ");t.push(c.pop())}return t}class ka{constructor(t,o,c,d,m,x){const w=t.gl;this.program=w.createProgram();const T=ri(o.staticAttributes),C=c?c.getBinderAttributes():[],I=T.concat(C),P=Qt.prelude.staticUniforms?ri(Qt.prelude.staticUniforms):[],F=o.staticUniforms?ri(o.staticUniforms):[],q=c?c.getBinderUniforms():[],$=P.concat(F).concat(q),G=[];for(const ge of $)G.indexOf(ge)<0&&G.push(ge);const U=c?c.defines():[];m&&U.push("#define OVERDRAW_INSPECTOR;"),x&&U.push("#define TERRAIN3D;");const oe=U.concat(Qt.prelude.fragmentSource,o.fragmentSource).join(`
`),pe=U.concat(Qt.prelude.vertexSource,o.vertexSource).join(`
`),K=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(K,oe),w.compileShader(K),!w.getShaderParameter(K,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(K)}`);w.attachShader(this.program,K);const ae=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ae,pe),w.compileShader(ae),!w.getShaderParameter(ae,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ae)}`);w.attachShader(this.program,ae),this.attributes={};const me={};this.numAttributes=I.length;for(let ge=0;ge<this.numAttributes;ge++)I[ge]&&(w.bindAttribLocation(this.program,ge,I[ge]),this.attributes[I[ge]]=ge);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ae),w.deleteShader(K);for(let ge=0;ge<G.length;ge++){const we=G[ge];if(we&&!me[we]){const Ce=w.getUniformLocation(this.program,we);Ce&&(me[we]=Ce)}}this.fixedUniforms=d(t,me),this.terrainUniforms=((ge,we)=>({u_depth:new l.aL(ge,we.u_depth),u_terrain:new l.aL(ge,we.u_terrain),u_terrain_dim:new l.aM(ge,we.u_terrain_dim),u_terrain_matrix:new l.aN(ge,we.u_terrain_matrix),u_terrain_unpack:new l.aO(ge,we.u_terrain_unpack),u_terrain_exaggeration:new l.aM(ge,we.u_terrain_exaggeration)}))(t,me),this.binderUniforms=c?c.getUniforms(t,me):[]}draw(t,o,c,d,m,x,w,T,C,I,P,F,q,$,G,U,oe,pe){const K=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(d),t.setColorMode(m),t.setCullFace(x),T){t.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,T.depthTexture),t.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,T.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(T[me])}for(const me in this.fixedUniforms)this.fixedUniforms[me].set(w[me]);G&&G.setUniforms(t,this.binderUniforms,q,{zoom:$});let ae=0;switch(o){case K.LINES:ae=2;break;case K.TRIANGLES:ae=3;break;case K.LINE_STRIP:ae=1}for(const me of F.get()){const ge=me.vaos||(me.vaos={});(ge[C]||(ge[C]=new ws)).bind(t,this,I,G?G.getPaintVertexBuffers():[],P,me.vertexOffset,U,oe,pe),K.drawElements(o,me.primitiveLength*ae,K.UNSIGNED_SHORT,me.primitiveOffset*ae*2)}}}function qn(p,t,o){const c=1/ne(o,1,t.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,t.transform.tileZoom)/d,x=m*(o.tileID.canonical.x+o.tileID.wrap*d),w=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const Nl=(p,t,o,c)=>{const d=t.style.light,m=d.properties.get("position"),x=[m.x,m.y,m.z],w=function(){var C=new l.A(9);return l.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();d.properties.get("anchor")==="viewport"&&function(C,I){var P=Math.sin(I),F=Math.cos(I);C[0]=F,C[1]=P,C[2]=0,C[3]=-P,C[4]=F,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(w,-t.transform.angle),function(C,I,P){var F=I[0],q=I[1],$=I[2];C[0]=F*P[0]+q*P[3]+$*P[6],C[1]=F*P[1]+q*P[4]+$*P[7],C[2]=F*P[2]+q*P[5]+$*P[8]}(x,x,w);const T=d.properties.get("color");return{u_matrix:p,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+o,u_opacity:c}},ns=(p,t,o,c,d,m,x)=>l.e(Nl(p,t,o,c),qn(m,t,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),Rc=p=>({u_matrix:p}),Vl=(p,t,o,c)=>l.e(Rc(p),qn(o,t,c)),Ca=(p,t)=>({u_matrix:p,u_world:t}),Ea=(p,t,o,c,d)=>l.e(Vl(p,t,o,c),{u_world:d}),rs=(p,t,o,c)=>{const d=p.transform;let m,x;if(c.paint.get("circle-pitch-alignment")==="map"){const w=ne(o,1,d.zoom);m=!0,x=[w,w]}else m=!1,x=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(t.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:x}},Ul=(p,t,o)=>{const c=ne(o,1,t.zoom),d=Math.pow(2,t.zoom-o.tileID.overscaledZ),m=o.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*d),t.pixelsToGLUnits[1]/(c*d)],u_overscale_factor:m}},Vo=(p,t,o=1)=>({u_matrix:p,u_color:t,u_overlay:0,u_overlay_scale:o}),Fc=p=>({u_matrix:p}),ap=(p,t,o,c)=>({u_matrix:p,u_extrude_scale:ne(t,1,o),u_intensity:c});function jl(p,t){const o=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new l.U(0,c/o).toLngLat().lat,new l.U(0,(c+1)/o).toLngLat().lat]}const $l=(p,t,o,c)=>{const d=p.transform;return{u_matrix:Ia(p,t,o,c),u_ratio:1/ne(t,1,d.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Bc=(p,t,o,c,d)=>l.e($l(p,t,o,d),{u_image:0,u_image_height:c}),lp=(p,t,o,c,d)=>{const m=p.transform,x=Nc(t,m);return{u_matrix:Ia(p,t,o,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/ne(t,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Oc=(p,t,o,c,d,m)=>{const x=p.lineAtlas,w=Nc(t,p.transform),T=o.layout.get("line-cap")==="round",C=x.getDash(c.from,T),I=x.getDash(c.to,T),P=C.width*d.fromScale,F=I.width*d.toScale;return l.e($l(p,t,o,m),{u_patternscale_a:[w/P,-C.height/2],u_patternscale_b:[w/F,-I.height/2],u_sdfgamma:x.width/(256*Math.min(P,F)*p.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:I.y,u_mix:d.t})};function Nc(p,t){return 1/ne(p,1,t.tileZoom)}function Ia(p,t,o,c){return p.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Vc=(p,t,o,c,d)=>{return{u_matrix:p,u_tl_parent:t,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Uc(d.paint.get("raster-hue-rotate"))};var m,x};function Uc(p){p*=Math.PI/180;const t=Math.sin(p),o=Math.cos(p);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const ql=(p,t,o,c,d,m,x,w,T,C)=>{const I=d.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:I.cameraToCenterDistance,u_pitch:I.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:I.width/I.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:x,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+c,u_texsize:C,u_texture:0}},Zl=(p,t,o,c,d,m,x,w,T,C,I)=>{const P=d.transform;return l.e(ql(p,t,o,c,d,m,x,w,T,C),{u_gamma_scale:c?Math.cos(P._pitch)*P.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:+I})},bs=(p,t,o,c,d,m,x,w,T,C)=>l.e(Zl(p,t,o,c,d,m,x,w,!0,T,!0),{u_texsize_icon:C,u_texture_icon:1}),Pa=(p,t,o)=>({u_matrix:p,u_opacity:t,u_color:o}),Zn=(p,t,o,c,d,m)=>l.e(function(x,w,T,C){const I=T.imageManager.getPattern(x.from.toString()),P=T.imageManager.getPattern(x.to.toString()),{width:F,height:q}=T.imageManager.getPixelSize(),$=Math.pow(2,C.tileID.overscaledZ),G=C.tileSize*Math.pow(2,T.transform.tileZoom)/$,U=G*(C.tileID.canonical.x+C.tileID.wrap*$),oe=G*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[F,q],u_mix:w.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/ne(C,1,T.transform.tileZoom),u_pixel_coord_upper:[U>>16,oe>>16],u_pixel_coord_lower:[65535&U,65535&oe]}}(c,m,o,d),{u_matrix:p,u_opacity:t}),Ma={fillExtrusion:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_lightpos:new l.aP(p,t.u_lightpos),u_lightintensity:new l.aM(p,t.u_lightintensity),u_lightcolor:new l.aP(p,t.u_lightcolor),u_vertical_gradient:new l.aM(p,t.u_vertical_gradient),u_opacity:new l.aM(p,t.u_opacity)}),fillExtrusionPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_lightpos:new l.aP(p,t.u_lightpos),u_lightintensity:new l.aM(p,t.u_lightintensity),u_lightcolor:new l.aP(p,t.u_lightcolor),u_vertical_gradient:new l.aM(p,t.u_vertical_gradient),u_height_factor:new l.aM(p,t.u_height_factor),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade),u_opacity:new l.aM(p,t.u_opacity)}),fill:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix)}),fillPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),fillOutline:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world)}),fillOutlinePattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),circle:(p,t)=>({u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_scale_with_map:new l.aL(p,t.u_scale_with_map),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_extrude_scale:new l.aQ(p,t.u_extrude_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_matrix:new l.aN(p,t.u_matrix)}),collisionBox:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pixels_to_tile_units:new l.aM(p,t.u_pixels_to_tile_units),u_extrude_scale:new l.aQ(p,t.u_extrude_scale),u_overscale_factor:new l.aM(p,t.u_overscale_factor)}),collisionCircle:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_inv_matrix:new l.aN(p,t.u_inv_matrix),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_viewport_size:new l.aQ(p,t.u_viewport_size)}),debug:(p,t)=>({u_color:new l.aR(p,t.u_color),u_matrix:new l.aN(p,t.u_matrix),u_overlay:new l.aL(p,t.u_overlay),u_overlay_scale:new l.aM(p,t.u_overlay_scale)}),clippingMask:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix)}),heatmap:(p,t)=>({u_extrude_scale:new l.aM(p,t.u_extrude_scale),u_intensity:new l.aM(p,t.u_intensity),u_matrix:new l.aN(p,t.u_matrix)}),heatmapTexture:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world),u_image:new l.aL(p,t.u_image),u_color_ramp:new l.aL(p,t.u_color_ramp),u_opacity:new l.aM(p,t.u_opacity)}),hillshade:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_latrange:new l.aQ(p,t.u_latrange),u_light:new l.aQ(p,t.u_light),u_shadow:new l.aR(p,t.u_shadow),u_highlight:new l.aR(p,t.u_highlight),u_accent:new l.aR(p,t.u_accent)}),hillshadePrepare:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_dimension:new l.aQ(p,t.u_dimension),u_zoom:new l.aM(p,t.u_zoom),u_unpack:new l.aO(p,t.u_unpack)}),line:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels)}),lineGradient:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_image:new l.aL(p,t.u_image),u_image_height:new l.aM(p,t.u_image_height)}),linePattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texsize:new l.aQ(p,t.u_texsize),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_image:new l.aL(p,t.u_image),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),lineSDF:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_patternscale_a:new l.aQ(p,t.u_patternscale_a),u_patternscale_b:new l.aQ(p,t.u_patternscale_b),u_sdfgamma:new l.aM(p,t.u_sdfgamma),u_image:new l.aL(p,t.u_image),u_tex_y_a:new l.aM(p,t.u_tex_y_a),u_tex_y_b:new l.aM(p,t.u_tex_y_b),u_mix:new l.aM(p,t.u_mix)}),raster:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_tl_parent:new l.aQ(p,t.u_tl_parent),u_scale_parent:new l.aM(p,t.u_scale_parent),u_buffer_scale:new l.aM(p,t.u_buffer_scale),u_fade_t:new l.aM(p,t.u_fade_t),u_opacity:new l.aM(p,t.u_opacity),u_image0:new l.aL(p,t.u_image0),u_image1:new l.aL(p,t.u_image1),u_brightness_low:new l.aM(p,t.u_brightness_low),u_brightness_high:new l.aM(p,t.u_brightness_high),u_saturation_factor:new l.aM(p,t.u_saturation_factor),u_contrast_factor:new l.aM(p,t.u_contrast_factor),u_spin_weights:new l.aP(p,t.u_spin_weights)}),symbolIcon:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texture:new l.aL(p,t.u_texture)}),symbolSDF:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texture:new l.aL(p,t.u_texture),u_gamma_scale:new l.aM(p,t.u_gamma_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_is_halo:new l.aL(p,t.u_is_halo)}),symbolTextAndIcon:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texsize_icon:new l.aQ(p,t.u_texsize_icon),u_texture:new l.aL(p,t.u_texture),u_texture_icon:new l.aL(p,t.u_texture_icon),u_gamma_scale:new l.aM(p,t.u_gamma_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_is_halo:new l.aL(p,t.u_is_halo)}),background:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_opacity:new l.aM(p,t.u_opacity),u_color:new l.aR(p,t.u_color)}),backgroundPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_opacity:new l.aM(p,t.u_opacity),u_image:new l.aL(p,t.u_image),u_pattern_tl_a:new l.aQ(p,t.u_pattern_tl_a),u_pattern_br_a:new l.aQ(p,t.u_pattern_br_a),u_pattern_tl_b:new l.aQ(p,t.u_pattern_tl_b),u_pattern_br_b:new l.aQ(p,t.u_pattern_br_b),u_texsize:new l.aQ(p,t.u_texsize),u_mix:new l.aM(p,t.u_mix),u_pattern_size_a:new l.aQ(p,t.u_pattern_size_a),u_pattern_size_b:new l.aQ(p,t.u_pattern_size_b),u_scale_a:new l.aM(p,t.u_scale_a),u_scale_b:new l.aM(p,t.u_scale_b),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.aM(p,t.u_tile_units_to_pixels)}),terrain:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texture:new l.aL(p,t.u_texture),u_ele_delta:new l.aM(p,t.u_ele_delta)}),terrainDepth:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ele_delta:new l.aM(p,t.u_ele_delta)}),terrainCoords:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texture:new l.aL(p,t.u_texture),u_terrain_coords_id:new l.aM(p,t.u_terrain_coords_id),u_ele_delta:new l.aM(p,t.u_ele_delta)})};class za{constructor(t,o,c){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Uo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Aa{constructor(t,o,c,d){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=d,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let c=0;c<this.attributes.length;c++){const d=o.attributes[this.attributes[c].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,o,c){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],x=o.attributes[m.name];x!==void 0&&t.vertexAttribPointer(x,m.components,t[Uo[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Js=new WeakMap;function ss(p){var t;if(Js.has(p))return Js.get(p);{const o=(t=p.getParameter(p.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Js.set(p,o),o}}class St{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class La extends St{getDefault(){return l.aT.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class En extends St{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class In extends St{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Gl extends St{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Da extends St{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ra extends St{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Hl extends St{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Wl extends St{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Fa extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class Xl extends St{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Kl extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ba extends St{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class jc extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class $c extends St{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class eo extends St{getDefault(){return l.aT.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class up extends St{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class cp extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class hp extends St{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class dp extends St{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class pp extends St{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class fp extends St{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Yl extends St{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Oa extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ql extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Jl extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class to extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class qc extends St{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Zc extends St{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const c=this.gl;ss(c)?c.bindVertexArray(t):(o=c.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class eu extends St{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ss extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Gc extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class os extends St{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class io extends os{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Hc extends os{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class tu extends os{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class zt{constructor(t,o,c,d,m){this.context=t,this.width=o,this.height=c;const x=t.gl,w=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new io(t,w),d)this.depthAttachment=m?new tu(t,w):new Hc(t,w);else if(m)throw new Error("Stencil cannot be setted without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Jt{constructor(t,o,c){this.blendFunction=t,this.blendColor=o,this.mask=c}}Jt.Replace=[1,0],Jt.disabled=new Jt(Jt.Replace,l.aT.transparent,[!1,!1,!1,!1]),Jt.unblended=new Jt(Jt.Replace,l.aT.transparent,[!0,!0,!0,!0]),Jt.alphaBlended=new Jt([1,771],l.aT.transparent,[!0,!0,!0,!0]);class mp{constructor(t){var o,c;if(this.gl=t,this.clearColor=new La(this),this.clearDepth=new En(this),this.clearStencil=new In(this),this.colorMask=new Gl(this),this.depthMask=new Da(this),this.stencilMask=new Ra(this),this.stencilFunc=new Hl(this),this.stencilOp=new Wl(this),this.stencilTest=new Fa(this),this.depthRange=new Xl(this),this.depthTest=new Kl(this),this.depthFunc=new Ba(this),this.blend=new jc(this),this.blendFunc=new $c(this),this.blendColor=new eo(this),this.blendEquation=new up(this),this.cullFace=new cp(this),this.cullFaceSide=new hp(this),this.frontFace=new dp(this),this.program=new pp(this),this.activeTexture=new fp(this),this.viewport=new Yl(this),this.bindFramebuffer=new Oa(this),this.bindRenderbuffer=new Ql(this),this.bindTexture=new Jl(this),this.bindVertexBuffer=new to(this),this.bindElementBuffer=new qc(this),this.bindVertexArray=new Zc(this),this.pixelStoreUnpack=new eu(this),this.pixelStoreUnpackPremultiplyAlpha=new Ss(this),this.pixelStoreUnpackFlipY=new Gc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ss(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new za(this,t,o)}createVertexBuffer(t,o,c){return new Aa(this,t,o,c)}createRenderbuffer(t,o,c){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,t,o,c),this.bindRenderbuffer.set(null),m}createFramebuffer(t,o,c,d){return new zt(this,t,o,c,d)}clear({color:t,depth:o,stencil:c}){const d=this.gl;let m=0;t&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.aG(t.blendFunction,Jt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ss(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return ss(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Tt{constructor(t,o,c){this.func=t,this.mask=o,this.range=c}}Tt.ReadOnly=!1,Tt.ReadWrite=!0,Tt.disabled=new Tt(519,Tt.ReadOnly,[0,1]);const Ts=7680;class ei{constructor(t,o,c,d,m,x){this.test=t,this.ref=o,this.mask=c,this.fail=d,this.depthFail=m,this.pass=x}}ei.disabled=new ei({func:519,mask:0},0,0,Ts,Ts,Ts);class Kt{constructor(t,o,c){this.enable=t,this.mode=o,this.frontFace=c}}let jo;function Wc(p,t,o,c,d,m,x){const w=p.context,T=w.gl,C=p.useProgram("collisionBox"),I=[];let P=0,F=0;for(let K=0;K<c.length;K++){const ae=c[K],me=t.getTile(ae),ge=me.getBucket(o);if(!ge)continue;let we=ae.posMatrix;d[0]===0&&d[1]===0||(we=p.translatePosMatrix(ae.posMatrix,me,d,m));const Ce=x?ge.textCollisionBox:ge.iconCollisionBox,Te=ge.collisionCircleArray;if(Te.length>0){const Ie=l.Z(),Xe=we;l.aU(Ie,ge.placementInvProjMatrix,p.transform.glCoordMatrix),l.aU(Ie,Ie,ge.placementViewportMatrix),I.push({circleArray:Te,circleOffset:F,transform:Xe,invTransform:Ie,coord:ae}),P+=Te.length/4,F=P}Ce&&C.draw(w,T.LINES,Tt.disabled,ei.disabled,p.colorModeForRenderPass(),Kt.disabled,Ul(we,p.transform,me),p.style.map.terrain&&p.style.map.terrain.getTerrainData(ae),o.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,p.transform.zoom,null,null,Ce.collisionVertexBuffer)}if(!x||!I.length)return;const q=p.useProgram("collisionCircle"),$=new l.aV;$.resize(4*P),$._trim();let G=0;for(const K of I)for(let ae=0;ae<K.circleArray.length/4;ae++){const me=4*ae,ge=K.circleArray[me+0],we=K.circleArray[me+1],Ce=K.circleArray[me+2],Te=K.circleArray[me+3];$.emplace(G++,ge,we,Ce,Te,0),$.emplace(G++,ge,we,Ce,Te,1),$.emplace(G++,ge,we,Ce,Te,2),$.emplace(G++,ge,we,Ce,Te,3)}(!jo||jo.length<2*P)&&(jo=function(K){const ae=2*K,me=new l.aX;me.resize(ae),me._trim();for(let ge=0;ge<ae;ge++){const we=6*ge;me.uint16[we+0]=4*ge+0,me.uint16[we+1]=4*ge+1,me.uint16[we+2]=4*ge+2,me.uint16[we+3]=4*ge+2,me.uint16[we+4]=4*ge+3,me.uint16[we+5]=4*ge+0}return me}(P));const U=w.createIndexBuffer(jo,!0),oe=w.createVertexBuffer($,l.aW.members,!0);for(const K of I){const ae={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(pe=p.transform).cameraToCenterDistance,u_viewport_size:[pe.width,pe.height]};q.draw(w,T.TRIANGLES,Tt.disabled,ei.disabled,p.colorModeForRenderPass(),Kt.disabled,ae,p.style.map.terrain&&p.style.map.terrain.getTerrainData(K.coord),o.id,oe,U,l.S.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,p.transform.zoom,null,null,null)}var pe;oe.destroy(),U.destroy()}Kt.disabled=new Kt(!1,1029,2305),Kt.backCCW=new Kt(!0,1029,2305);const iu=l.ao(new Float32Array(16));function Na(p,t,o,c,d,m){const{horizontalAlign:x,verticalAlign:w}=l.au(p);return new l.P((-(x-.5)*t/d+c[0])*m,(-(w-.5)*o/d+c[1])*m)}function Va(p,t,o,c,d,m,x,w,T,C,I){const P=p.text.placedSymbolArray,F=p.text.dynamicLayoutVertexArray,q=p.icon.dynamicLayoutVertexArray,$={};F.clear();for(let G=0;G<P.length;G++){const U=P.get(G),oe=U.hidden||!U.crossTileID||p.allowVerticalPlacement&&!U.placedOrientation?null:c[U.crossTileID];if(oe){const pe=new l.P(U.anchorX,U.anchorY),K=ni(pe,o?x:m,I),ae=xs(d.cameraToCenterDistance,K.signedDistanceFromCamera);let me=l.aj(p.textSizeData,T,U)*ae/l.ap;o&&(me*=p.tilePixelRatio/w);const{width:ge,height:we,anchor:Ce,textOffset:Te,textBoxScale:Ie}=oe,Xe=Na(Ce,ge,we,Te,Ie,me),xt=o?ni(pe.add(Xe),m,I).point:K.point.add(t?Xe.rotate(-d.angle):Xe),Ne=p.allowVerticalPlacement&&U.placedOrientation===l.ai.vertical?Math.PI/2:0;for(let at=0;at<U.numGlyphs;at++)l.ak(F,xt,Ne);C&&U.associatedIconIndex>=0&&($[U.associatedIconIndex]={shiftedAnchor:xt,angle:Ne})}else V(U.numGlyphs,F)}if(C){q.clear();const G=p.icon.placedSymbolArray;for(let U=0;U<G.length;U++){const oe=G.get(U);if(oe.hidden)V(oe.numGlyphs,q);else{const pe=$[U];if(pe)for(let K=0;K<oe.numGlyphs;K++)l.ak(q,pe.shiftedAnchor,pe.angle);else V(oe.numGlyphs,q)}}p.icon.dynamicLayoutVertexBuffer.updateData(q)}p.text.dynamicLayoutVertexBuffer.updateData(F)}function nu(p,t,o){return o.iconsInText&&t?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Ua(p,t,o,c,d,m,x,w,T,C,I,P){const F=p.context,q=F.gl,$=p.transform,G=w==="map",U=T==="map",oe=w!=="viewport"&&o.layout.get("symbol-placement")!=="point",pe=G&&!U&&!oe,K=!o.layout.get("symbol-sort-key").isConstant();let ae=!1;const me=p.depthModeForSublayer(0,Tt.ReadOnly),ge=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),we=[];for(const Ce of c){const Te=t.getTile(Ce),Ie=Te.getBucket(o);if(!Ie)continue;const Xe=d?Ie.text:Ie.icon;if(!Xe||!Xe.segments.get().length||!Xe.hasVisibleVertices)continue;const xt=Xe.programConfigurations.get(o.id),Ne=d||Ie.sdfIcons,at=d?Ie.textSizeData:Ie.iconSizeData,Ye=U||$.pitch!==0,Bt=p.useProgram(nu(Ne,d,Ie),xt),vt=l.ah(at,$.zoom),mt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ce);let wt,hi,Zt,Oi,ki=[0,0],gi=null;if(d)hi=Te.glyphAtlasTexture,Zt=q.LINEAR,wt=Te.glyphAtlasTexture.size,Ie.iconsInText&&(ki=Te.imageAtlasTexture.size,gi=Te.imageAtlasTexture,Oi=Ye||p.options.rotating||p.options.zooming||at.kind==="composite"||at.kind==="camera"?q.LINEAR:q.NEAREST);else{const di=o.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear;hi=Te.imageAtlasTexture,Zt=Ne||p.options.rotating||p.options.zooming||di||Ye?q.LINEAR:q.NEAREST,wt=Te.imageAtlasTexture.size}const zn=ne(Te,1,p.transform.zoom),Wt=Ae(Ce.posMatrix,U,G,p.transform,zn),_r=mr(Ce.posMatrix,U,G,p.transform,zn),vr=ge&&Ie.hasTextData(),us=o.layout.get("icon-text-fit")!=="none"&&vr&&Ie.hasIconData();if(oe){const di=p.style.map.terrain?(mn,pi)=>p.style.map.terrain.getElevation(Ce,mn,pi):null,Ci=o.layout.get("text-rotation-alignment")==="map";Re(Ie,Ce.posMatrix,p,d,Wt,_r,U,C,Ci,di)}const Ps=p.translatePosMatrix(Ce.posMatrix,Te,m,x),uo=oe||d&&ge||us?iu:Wt,Hi=p.translatePosMatrix(_r,Te,m,x,!0),Ni=Ne&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let nn;nn=Ne?Ie.iconsInText?bs(at.kind,vt,pe,U,p,Ps,uo,Hi,wt,ki):Zl(at.kind,vt,pe,U,p,Ps,uo,Hi,d,wt,!0):ql(at.kind,vt,pe,U,p,Ps,uo,Hi,d,wt);const Ms={program:Bt,buffers:Xe,uniformValues:nn,atlasTexture:hi,atlasTextureIcon:gi,atlasInterpolation:Zt,atlasInterpolationIcon:Oi,isSDF:Ne,hasHalo:Ni};if(K&&Ie.canOverlap){ae=!0;const di=Xe.segments.get();for(const Ci of di)we.push({segments:new l.S([Ci]),sortKey:Ci.sortKey,state:Ms,terrainData:mt})}else we.push({segments:Xe.segments,sortKey:0,state:Ms,terrainData:mt})}ae&&we.sort((Ce,Te)=>Ce.sortKey-Te.sortKey);for(const Ce of we){const Te=Ce.state;if(F.activeTexture.set(q.TEXTURE0),Te.atlasTexture.bind(Te.atlasInterpolation,q.CLAMP_TO_EDGE),Te.atlasTextureIcon&&(F.activeTexture.set(q.TEXTURE1),Te.atlasTextureIcon&&Te.atlasTextureIcon.bind(Te.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),Te.isSDF){const Ie=Te.uniformValues;Te.hasHalo&&(Ie.u_is_halo=1,ru(Te.buffers,Ce.segments,o,p,Te.program,me,I,P,Ie,Ce.terrainData)),Ie.u_is_halo=0}ru(Te.buffers,Ce.segments,o,p,Te.program,me,I,P,Te.uniformValues,Ce.terrainData)}}function ru(p,t,o,c,d,m,x,w,T,C){const I=c.context;d.draw(I,I.gl.TRIANGLES,m,x,w,Kt.disabled,T,C,o.id,p.layoutVertexBuffer,p.indexBuffer,t,o.paint,c.transform.zoom,p.programConfigurations.get(o.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function $o(p,t,o,c,d){if(!o||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let x=m[o.to.toString()],w=m[o.from.toString()];if(!x&&w&&(x=w),!w&&x&&(w=x),!x||!w){const T=d.getPaintProperty(t);x=m[T],w=m[T]}x&&w&&p.setConstantPatternPositions(x,w)}function qo(p,t,o,c,d,m,x){const w=p.context.gl,T="fill-pattern",C=o.paint.get(T),I=C&&C.constantOr(1),P=o.getCrossfadeParameters();let F,q,$,G,U;x?(q=I&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=w.LINES):(q=I?"fillPattern":"fill",F=w.TRIANGLES);const oe=C.constantOr(null);for(const pe of c){const K=t.getTile(pe);if(I&&!K.patternsLoaded())continue;const ae=K.getBucket(o);if(!ae)continue;const me=ae.programConfigurations.get(o.id),ge=p.useProgram(q,me),we=p.style.map.terrain&&p.style.map.terrain.getTerrainData(pe);I&&(p.context.activeTexture.set(w.TEXTURE0),K.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),me.updatePaintBuffers(P)),$o(me,T,oe,K,o);const Ce=we?pe:null,Te=p.translatePosMatrix(Ce?Ce.posMatrix:pe.posMatrix,K,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){G=ae.indexBuffer2,U=ae.segments2;const Ie=[w.drawingBufferWidth,w.drawingBufferHeight];$=q==="fillOutlinePattern"&&I?Ea(Te,p,P,K,Ie):Ca(Te,Ie)}else G=ae.indexBuffer,U=ae.segments,$=I?Vl(Te,p,P,K):Rc(Te);ge.draw(p.context,F,d,p.stencilModeForClipping(pe),m,Kt.disabled,$,we,o.id,ae.layoutVertexBuffer,G,U,o.paint,p.transform.zoom,me)}}function Zo(p,t,o,c,d,m,x){const w=p.context,T=w.gl,C="fill-extrusion-pattern",I=o.paint.get(C),P=I.constantOr(1),F=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),$=I.constantOr(null);for(const G of c){const U=t.getTile(G),oe=U.getBucket(o);if(!oe)continue;const pe=p.style.map.terrain&&p.style.map.terrain.getTerrainData(G),K=oe.programConfigurations.get(o.id),ae=p.useProgram(P?"fillExtrusionPattern":"fillExtrusion",K);P&&(p.context.activeTexture.set(T.TEXTURE0),U.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),K.updatePaintBuffers(F)),$o(K,C,$,U,o);const me=p.translatePosMatrix(G.posMatrix,U,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),ge=o.paint.get("fill-extrusion-vertical-gradient"),we=P?ns(me,p,ge,q,G,F,U):Nl(me,p,ge,q);ae.draw(w,w.gl.TRIANGLES,d,m,x,Kt.backCCW,we,pe,o.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,o.paint,p.transform.zoom,K,p.style.map.terrain&&oe.centroidVertexBuffer)}}function gp(p,t,o,c,d,m,x){const w=p.context,T=w.gl,C=o.fbo;if(!C)return;const I=p.useProgram("hillshade"),P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(t);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,C.colorAttachment.get()),I.draw(w,T.TRIANGLES,d,m,x,Kt.disabled,((F,q,$,G)=>{const U=$.paint.get("hillshade-shadow-color"),oe=$.paint.get("hillshade-highlight-color"),pe=$.paint.get("hillshade-accent-color");let K=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=F.transform.angle);const ae=!F.options.moving;return{u_matrix:G?G.posMatrix:F.transform.calculatePosMatrix(q.tileID.toUnwrapped(),ae),u_image:0,u_latrange:jl(0,q.tileID),u_light:[$.paint.get("hillshade-exaggeration"),K],u_shadow:U,u_highlight:oe,u_accent:pe}})(p,o,c,P?t:null),P,c.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function su(p,t,o,c,d,m){const x=p.context,w=x.gl,T=t.dem;if(T&&T.data){const C=T.dim,I=T.stride,P=T.getPixels();if(x.activeTexture.set(w.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||p.getTileTexture(I),t.demTexture){const q=t.demTexture;q.update(P,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else t.demTexture=new tt(x,P,w.RGBA,{premultiply:!1}),t.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);x.activeTexture.set(w.TEXTURE0);let F=t.fbo;if(!F){const q=new tt(x,{width:C,height:C,data:null},w.RGBA);q.bind(w.LINEAR,w.CLAMP_TO_EDGE),F=t.fbo=x.createFramebuffer(C,C,!0,!1),F.colorAttachment.set(q.texture)}x.bindFramebuffer.set(F.framebuffer),x.viewport.set([0,0,C,C]),p.useProgram("hillshadePrepare").draw(x,w.TRIANGLES,c,d,m,Kt.disabled,((q,$)=>{const G=$.stride,U=l.Z();return l.aS(U,0,l.N,-l.N,0,0,1),l.$(U,U,[0,-l.N,0]),{u_matrix:U,u_image:1,u_dimension:[G,G],u_zoom:q.overscaledZ,u_unpack:$.getUnpackVector()}})(t.tileID,T),null,o.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function yp(p,t,o,c,d,m){const x=c.paint.get("raster-fade-duration");if(!m&&x>0){const w=l.h.now(),T=(w-p.timeAdded)/x,C=t?(w-t.timeAdded)/x:-1,I=o.getSource(),P=d.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),F=!t||Math.abs(t.tileID.overscaledZ-P)>Math.abs(p.tileID.overscaledZ-P),q=F&&p.refreshedUponExpiration?1:l.ad(F?T:1-C,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),t?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}const Xc=new l.aT(1,0,0,1),ja=new l.aT(0,1,0,1),ou=new l.aT(0,0,1,1),Kc=new l.aT(1,0,1,1),Yc=new l.aT(0,1,1,1);function Go(p,t,o,c){qa(p,0,t+o/2,p.transform.width,o,c)}function $a(p,t,o,c){qa(p,t-o/2,0,o,p.transform.height,c)}function qa(p,t,o,c,d,m){const x=p.context,w=x.gl;w.enable(w.SCISSOR_TEST),w.scissor(t*p.pixelRatio,o*p.pixelRatio,c*p.pixelRatio,d*p.pixelRatio),x.clear({color:m}),w.disable(w.SCISSOR_TEST)}function Qc(p,t,o){const c=p.context,d=c.gl,m=o.posMatrix,x=p.useProgram("debug"),w=Tt.disabled,T=ei.disabled,C=p.colorModeForRenderPass(),I="$debug",P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(o);c.activeTexture.set(d.TEXTURE0);const F=t.getTileByID(o.key).latestRawTileData,q=Math.floor((F&&F.byteLength||0)/1024),$=t.getTile(o).tileSize,G=512/Math.min($,512)*(o.overscaledZ/p.transform.zoom)*.5;let U=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(U+=` => ${o.overscaledZ}`),function(oe,pe){oe.initDebugOverlayCanvas();const K=oe.debugOverlayCanvas,ae=oe.context.gl,me=oe.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,K.width,K.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(pe,5,5),me.strokeText(pe,5,5),oe.debugOverlayTexture.update(K),oe.debugOverlayTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}(p,`${U} ${q}kB`),x.draw(c,d.TRIANGLES,w,T,Jt.alphaBlended,Kt.disabled,Vo(m,l.aT.transparent,G),null,I,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),x.draw(c,d.LINE_STRIP,w,T,C,Kt.disabled,Vo(m,l.aT.red),P,I,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function si(p,t,o){const c=p.context,d=c.gl,m=p.colorModeForRenderPass(),x=new Tt(d.LEQUAL,Tt.ReadWrite,p.depthRangeFor3D),w=p.useProgram("terrain"),T=t.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,p.width,p.height]);for(const C of o){const I=p.renderToTexture.getTexture(C),P=t.getTerrainData(C.tileID);c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,I.texture);const F={u_matrix:p.transform.calculatePosMatrix(C.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(p.transform.zoom)};w.draw(c,d.TRIANGLES,x,ei.disabled,m,Kt.backCCW,F,P,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class ks{constructor(t,o){this.context=new mp(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.Z(),renderTime:0},this.setup(),this.numSublayers=dn.maxUnderzooming+dn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Sa}resize(t,o,c){if(this.width=Math.floor(t*c),this.height=Math.floor(o*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,o=new l.a_;o.emplaceBack(0,0),o.emplaceBack(l.N,0),o.emplaceBack(0,l.N),o.emplaceBack(l.N,l.N),this.tileExtentBuffer=t.createVertexBuffer(o,Ta.members),this.tileExtentSegments=l.S.simpleSegment(0,0,4,2);const c=new l.a_;c.emplaceBack(0,0),c.emplaceBack(l.N,0),c.emplaceBack(0,l.N),c.emplaceBack(l.N,l.N),this.debugBuffer=t.createVertexBuffer(c,Ta.members),this.debugSegments=l.S.simpleSegment(0,0,4,5);const d=new l.V;d.emplaceBack(0,0,0,0),d.emplaceBack(l.N,0,l.N,0),d.emplaceBack(0,l.N,0,l.N),d.emplaceBack(l.N,l.N,l.N,l.N),this.rasterBoundsBuffer=t.createVertexBuffer(d,nr.members),this.rasterBoundsSegments=l.S.simpleSegment(0,0,4,2);const m=new l.a_;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,Ta.members),this.viewportSegments=l.S.simpleSegment(0,0,4,2);const x=new l.a$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(x);const w=new l.b0;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new ei({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.Z();l.aS(c,0,this.width,this.height,0,0,1),l.a0(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,o.TRIANGLES,Tt.disabled,this.stencilClearMode,Jt.disabled,Kt.disabled,Fc(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source;const c=this.context,d=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(Jt.disabled),c.setDepthMode(Tt.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of o){const w=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);m.draw(c,d.TRIANGLES,Tt.disabled,new ei({func:d.ALWAYS,mask:0},w,255,d.KEEP,d.KEEP,d.REPLACE),Jt.disabled,Kt.disabled,Fc(x.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new ei({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new ei({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,c=t.sort((x,w)=>w.overscaledZ-x.overscaledZ),d=c[c.length-1].overscaledZ,m=c[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const x={};for(let w=0;w<m;w++)x[w+d]=new ei({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[x,c]}return[{[d]:ei.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Jt([t.CONSTANT_COLOR,t.ONE],new l.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jt.unblended:Jt.alphaBlended}depthModeForSublayer(t,o,c){if(!this.opaquePassEnabledForLayer())return Tt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Tt(c||this.context.gl.LEQUAL,o,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(l.h.now()),this.imageManager.beginFrame();const c=this.style._order,d=this.style.sourceCaches,m={},x={},w={};for(const T in d){const C=d[T];C.used&&C.prepare(this.context),m[T]=C.getVisibleCoordinates(),x[T]=m[T].slice().reverse(),w[T]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<c.length;T++)if(this.style._layers[c[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(l.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(C,I){const P=C.context,F=P.gl,q=Jt.unblended,$=new Tt(F.LEQUAL,Tt.ReadWrite,[0,1]),G=I.getTerrainMesh(),U=I.sourceCache.getRenderableTiles(),oe=C.useProgram("terrainDepth");P.bindFramebuffer.set(I.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),P.clear({color:l.aT.transparent,depth:1});for(const pe of U){const K=I.getTerrainData(pe.tileID),ae={u_matrix:C.transform.calculatePosMatrix(pe.tileID.toUnwrapped()),u_ele_delta:I.getMeshFrameDelta(C.transform.zoom)};oe.draw(P,F.TRIANGLES,$,ei.disabled,q,Kt.backCCW,ae,K,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain),function(C,I){const P=C.context,F=P.gl,q=Jt.unblended,$=new Tt(F.LEQUAL,Tt.ReadWrite,[0,1]),G=I.getTerrainMesh(),U=I.getCoordsTexture(),oe=I.sourceCache.getRenderableTiles(),pe=C.useProgram("terrainCoords");P.bindFramebuffer.set(I.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),P.clear({color:l.aT.transparent,depth:1}),I.coordsIndex=[];for(const K of oe){const ae=I.getTerrainData(K.tileID);P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,U.texture);const me={u_matrix:C.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_terrain_coords_id:(255-I.coordsIndex.length)/255,u_texture:0,u_ele_delta:I.getMeshFrameDelta(C.transform.zoom)};pe.draw(P,F.TRIANGLES,$,ei.disabled,q,Kt.backCCW,me,ae,"terrain",G.vertexBuffer,G.indexBuffer,G.segments),I.coordsIndex.push(K.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of c){const C=this.style._layers[T];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const I=x[C.source];(C.type==="custom"||I.length)&&this.renderLayer(this,d[C.source],C,I)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?l.aT.black:l.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[c[this.currentLayer]],C=d[T.source],I=m[T.source];this._renderTileClippingMasks(T,I),this.renderLayer(this,C,T,I)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const T=this.style._layers[c[this.currentLayer]],C=d[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const I=(T.type==="symbol"?w:x)[T.source];this._renderTileClippingMasks(T,m[T.source]),this.renderLayer(this,C,T,I)}if(this.options.showTileBoundaries){const T=function(C,I){let P=null;const F=Object.values(C._layers).flatMap(U=>U.source&&!U.isHidden(I)?[C.sourceCaches[U.source]]:[]),q=F.filter(U=>U.getSource().type==="vector"),$=F.filter(U=>U.getSource().type!=="vector"),G=U=>{(!P||P.getSource().maxzoom<U.getSource().maxzoom)&&(P=U)};return q.forEach(U=>G(U)),P||$.forEach(U=>G(U)),P}(this.style,this.transform.zoom);T&&function(C,I,P){for(let F=0;F<P.length;F++)Qc(C,I,P[F])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const C=T.transform.padding;Go(T,T.transform.height-(C.top||0),3,Xc),Go(T,C.bottom||0,3,ja),$a(T,C.left||0,3,ou),$a(T,T.transform.width-(C.right||0),3,Kc);const I=T.transform.centerPoint;(function(P,F,q,$){qa(P,F-1,q-10,2,20,$),qa(P,F-10,q-1,20,2,$)})(T,I.x,T.transform.height-I.y,Yc)}(this),this.context.setDefault()}renderLayer(t,o,c,d){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(d||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(m,x,w,T,C){if(m.renderPass!=="translucent")return;const I=ei.disabled,P=m.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,q,$,G,U,oe,pe){const K=q.transform,ae=U==="map",me=oe==="map";for(const ge of F){const we=G.getTile(ge),Ce=we.getBucket($);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const Te=l.ah(Ce.textSizeData,K.zoom),Ie=ne(we,1,q.transform.zoom),Xe=Ae(ge.posMatrix,me,ae,q.transform,Ie),xt=$.layout.get("icon-text-fit")!=="none"&&Ce.hasIconData();if(Te){const Ne=Math.pow(2,K.zoom-we.tileID.overscaledZ);Va(Ce,ae,me,pe,K,Xe,ge.posMatrix,Ne,Te,xt,q.style.map.terrain?(at,Ye)=>q.style.map.terrain.getElevation(ge,at,Ye):null)}}}(T,m,w,x,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),C),w.paint.get("icon-opacity").constantOr(1)!==0&&Ua(m,x,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),I,P),w.paint.get("text-opacity").constantOr(1)!==0&&Ua(m,x,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),I,P),x.map.showCollisionBoxes&&(Wc(m,x,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),Wc(m,x,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(t,o,c,d,this.style.placement.variableOffsets);break;case"circle":(function(m,x,w,T){if(m.renderPass!=="translucent")return;const C=w.paint.get("circle-opacity"),I=w.paint.get("circle-stroke-width"),P=w.paint.get("circle-stroke-opacity"),F=!w.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(I.constantOr(1)===0||P.constantOr(1)===0))return;const q=m.context,$=q.gl,G=m.depthModeForSublayer(0,Tt.ReadOnly),U=ei.disabled,oe=m.colorModeForRenderPass(),pe=[];for(let K=0;K<T.length;K++){const ae=T[K],me=x.getTile(ae),ge=me.getBucket(w);if(!ge)continue;const we=ge.programConfigurations.get(w.id),Ce=m.useProgram("circle",we),Te=ge.layoutVertexBuffer,Ie=ge.indexBuffer,Xe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae),xt={programConfiguration:we,program:Ce,layoutVertexBuffer:Te,indexBuffer:Ie,uniformValues:rs(m,ae,me,w),terrainData:Xe};if(F){const Ne=ge.segments.get();for(const at of Ne)pe.push({segments:new l.S([at]),sortKey:at.sortKey,state:xt})}else pe.push({segments:ge.segments,sortKey:0,state:xt})}F&&pe.sort((K,ae)=>K.sortKey-ae.sortKey);for(const K of pe){const{programConfiguration:ae,program:me,layoutVertexBuffer:ge,indexBuffer:we,uniformValues:Ce,terrainData:Te}=K.state;me.draw(q,$.TRIANGLES,G,U,oe,Kt.disabled,Ce,Te,w.id,ge,we,K.segments,w.paint,m.transform.zoom,ae)}})(t,o,c,d);break;case"heatmap":(function(m,x,w,T){if(w.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const C=m.context,I=C.gl,P=ei.disabled,F=new Jt([I.ONE,I.ONE],l.aT.transparent,[!0,!0,!0,!0]);(function(q,$,G){const U=q.gl;q.activeTexture.set(U.TEXTURE1),q.viewport.set([0,0,$.width/4,$.height/4]);let oe=G.heatmapFbo;if(oe)U.bindTexture(U.TEXTURE_2D,oe.colorAttachment.get()),q.bindFramebuffer.set(oe.framebuffer);else{const pe=U.createTexture();U.bindTexture(U.TEXTURE_2D,pe),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),oe=G.heatmapFbo=q.createFramebuffer($.width/4,$.height/4,!1,!1),function(K,ae,me,ge){var we,Ce;const Te=K.gl,Ie=(we=K.HALF_FLOAT)!==null&&we!==void 0?we:Te.UNSIGNED_BYTE,Xe=(Ce=K.RGBA16F)!==null&&Ce!==void 0?Ce:Te.RGBA;Te.texImage2D(Te.TEXTURE_2D,0,Xe,ae.width/4,ae.height/4,0,Te.RGBA,Ie,null),ge.colorAttachment.set(me)}(q,$,pe,oe)}})(C,m,w),C.clear({color:l.aT.transparent});for(let q=0;q<T.length;q++){const $=T[q];if(x.hasRenderableParent($))continue;const G=x.getTile($),U=G.getBucket(w);if(!U)continue;const oe=U.programConfigurations.get(w.id),pe=m.useProgram("heatmap",oe),{zoom:K}=m.transform;pe.draw(C,I.TRIANGLES,Tt.disabled,P,F,Kt.disabled,ap($.posMatrix,G,K,w.paint.get("heatmap-intensity")),null,w.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,w.paint,m.transform.zoom,oe)}C.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(C,I){const P=C.context,F=P.gl,q=I.heatmapFbo;if(!q)return;P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,q.colorAttachment.get()),P.activeTexture.set(F.TEXTURE1);let $=I.colorRampTexture;$||($=I.colorRampTexture=new tt(P,I.colorRamp,F.RGBA)),$.bind(F.LINEAR,F.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(P,F.TRIANGLES,Tt.disabled,ei.disabled,C.colorModeForRenderPass(),Kt.disabled,((G,U,oe,pe)=>{const K=l.Z();l.aS(K,0,G.width,G.height,0,0,1);const ae=G.context.gl;return{u_matrix:K,u_world:[ae.drawingBufferWidth,ae.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}})(C,I),null,I.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,I.paint,C.transform.zoom)}(m,w))})(t,o,c,d);break;case"line":(function(m,x,w,T){if(m.renderPass!=="translucent")return;const C=w.paint.get("line-opacity"),I=w.paint.get("line-width");if(C.constantOr(1)===0||I.constantOr(1)===0)return;const P=m.depthModeForSublayer(0,Tt.ReadOnly),F=m.colorModeForRenderPass(),q=w.paint.get("line-dasharray"),$=w.paint.get("line-pattern"),G=$.constantOr(1),U=w.paint.get("line-gradient"),oe=w.getCrossfadeParameters(),pe=G?"linePattern":q?"lineSDF":U?"lineGradient":"line",K=m.context,ae=K.gl;let me=!0;for(const ge of T){const we=x.getTile(ge);if(G&&!we.patternsLoaded())continue;const Ce=we.getBucket(w);if(!Ce)continue;const Te=Ce.programConfigurations.get(w.id),Ie=m.context.program.get(),Xe=m.useProgram(pe,Te),xt=me||Xe.program!==Ie,Ne=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge),at=$.constantOr(null);if(at&&we.imageAtlas){const vt=we.imageAtlas,mt=vt.patternPositions[at.to.toString()],wt=vt.patternPositions[at.from.toString()];mt&&wt&&Te.setConstantPatternPositions(mt,wt)}const Ye=Ne?ge:null,Bt=G?lp(m,we,w,oe,Ye):q?Oc(m,we,w,q,oe,Ye):U?Bc(m,we,w,Ce.lineClipsArray.length,Ye):$l(m,we,w,Ye);if(G)K.activeTexture.set(ae.TEXTURE0),we.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Te.updatePaintBuffers(oe);else if(q&&(xt||m.lineAtlas.dirty))K.activeTexture.set(ae.TEXTURE0),m.lineAtlas.bind(K);else if(U){const vt=Ce.gradients[w.id];let mt=vt.texture;if(w.gradientVersion!==vt.version){let wt=256;if(w.stepInterpolant){const hi=x.getSource().maxzoom,Zt=ge.canonical.z===hi?Math.ceil(1<<m.transform.maxZoom-ge.canonical.z):1;wt=l.ad(l.aY(Ce.maxLineLength/l.N*1024*Zt),256,K.maxTextureSize)}vt.gradient=l.aZ({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:vt.gradient||void 0,clips:Ce.lineClipsArray}),vt.texture?vt.texture.update(vt.gradient):vt.texture=new tt(K,vt.gradient,ae.RGBA),vt.version=w.gradientVersion,mt=vt.texture}K.activeTexture.set(ae.TEXTURE0),mt.bind(w.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}Xe.draw(K,ae.TRIANGLES,P,m.stencilModeForClipping(ge),F,Kt.disabled,Bt,Ne,w.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,w.paint,m.transform.zoom,Te,Ce.layoutVertexBuffer2),me=!1}})(t,o,c,d);break;case"fill":(function(m,x,w,T){const C=w.paint.get("fill-color"),I=w.paint.get("fill-opacity");if(I.constantOr(1)===0)return;const P=m.colorModeForRenderPass(),F=w.paint.get("fill-pattern"),q=m.opaquePassEnabledForLayer()&&!F.constantOr(1)&&C.constantOr(l.aT.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===q){const $=m.depthModeForSublayer(1,m.renderPass==="opaque"?Tt.ReadWrite:Tt.ReadOnly);qo(m,x,w,T,$,P,!1)}if(m.renderPass==="translucent"&&w.paint.get("fill-antialias")){const $=m.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Tt.ReadOnly);qo(m,x,w,T,$,P,!0)}})(t,o,c,d);break;case"fill-extrusion":(function(m,x,w,T){const C=w.paint.get("fill-extrusion-opacity");if(C!==0&&m.renderPass==="translucent"){const I=new Tt(m.context.gl.LEQUAL,Tt.ReadWrite,m.depthRangeFor3D);if(C!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Zo(m,x,w,T,I,ei.disabled,Jt.disabled),Zo(m,x,w,T,I,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const P=m.colorModeForRenderPass();Zo(m,x,w,T,I,ei.disabled,P)}}})(t,o,c,d);break;case"hillshade":(function(m,x,w,T){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const C=m.context,I=m.depthModeForSublayer(0,Tt.ReadOnly),P=m.colorModeForRenderPass(),[F,q]=m.renderPass==="translucent"?m.stencilConfigForOverlap(T):[{},T];for(const $ of q){const G=x.getTile($);G.needsHillshadePrepare!==void 0&&G.needsHillshadePrepare&&m.renderPass==="offscreen"?su(m,G,w,I,ei.disabled,P):m.renderPass==="translucent"&&gp(m,$,G,w,I,F[$.overscaledZ],P)}C.viewport.set([0,0,m.width,m.height])})(t,o,c,d);break;case"raster":(function(m,x,w,T){if(m.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const C=m.context,I=C.gl,P=x.getSource(),F=m.useProgram("raster"),q=m.colorModeForRenderPass(),[$,G]=P instanceof Vn?[{},T]:m.stencilConfigForOverlap(T),U=G[G.length-1].overscaledZ,oe=!m.options.moving;for(const pe of G){const K=m.depthModeForSublayer(pe.overscaledZ-U,w.paint.get("raster-opacity")===1?Tt.ReadWrite:Tt.ReadOnly,I.LESS),ae=x.getTile(pe);ae.registerFadeDuration(w.paint.get("raster-fade-duration"));const me=x.findLoadedParent(pe,0),ge=yp(ae,me,x,w,m.transform,m.style.map.terrain);let we,Ce;const Te=w.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;C.activeTexture.set(I.TEXTURE0),ae.texture.bind(Te,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(I.TEXTURE1),me?(me.texture.bind(Te,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,me.tileID.overscaledZ-ae.tileID.overscaledZ),Ce=[ae.tileID.canonical.x*we%1,ae.tileID.canonical.y*we%1]):ae.texture.bind(Te,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST);const Ie=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),Xe=Ie?pe:null,xt=Xe?Xe.posMatrix:m.transform.calculatePosMatrix(pe.toUnwrapped(),oe),Ne=Vc(xt,Ce||[0,0],we||1,ge,w);P instanceof Vn?F.draw(C,I.TRIANGLES,K,ei.disabled,q,Kt.disabled,Ne,Ie,w.id,P.boundsBuffer,m.quadTriangleIndexBuffer,P.boundsSegments):F.draw(C,I.TRIANGLES,K,$[pe.overscaledZ],q,Kt.disabled,Ne,Ie,w.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(t,o,c,d);break;case"background":(function(m,x,w,T){const C=w.paint.get("background-color"),I=w.paint.get("background-opacity");if(I===0)return;const P=m.context,F=P.gl,q=m.transform,$=q.tileSize,G=w.paint.get("background-pattern");if(m.isPatternMissing(G))return;const U=!G&&C.a===1&&I===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==U)return;const oe=ei.disabled,pe=m.depthModeForSublayer(0,U==="opaque"?Tt.ReadWrite:Tt.ReadOnly),K=m.colorModeForRenderPass(),ae=m.useProgram(G?"backgroundPattern":"background"),me=T||q.coveringTiles({tileSize:$,terrain:m.style.map.terrain});G&&(P.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context));const ge=w.getCrossfadeParameters();for(const we of me){const Ce=T?we.posMatrix:m.transform.calculatePosMatrix(we.toUnwrapped()),Te=G?Zn(Ce,I,m,G,{tileID:we,tileSize:$},ge):Pa(Ce,I,C),Ie=m.style.map.terrain&&m.style.map.terrain.getTerrainData(we);ae.draw(P,F.TRIANGLES,pe,oe,K,Kt.disabled,Te,Ie,w.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(t,0,c,d);break;case"custom":(function(m,x,w){const T=m.context,C=w.implementation;if(m.renderPass==="offscreen"){const I=C.prerender;I&&(m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),I.call(C,T.gl,m.transform.customLayerMatrix()),T.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),T.setColorMode(m.colorModeForRenderPass()),T.setStencilMode(ei.disabled);const I=C.renderingMode==="3d"?new Tt(m.context.gl.LEQUAL,Tt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Tt.ReadOnly);T.setDepthMode(I),C.render(T.gl,m.transform.customLayerMatrix()),T.setDirty(),m.setBaseState(),T.bindFramebuffer.set(null)}})(t,0,c)}}translatePosMatrix(t,o,c,d,m){if(!c[0]&&!c[1])return t;const x=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(x){const C=Math.sin(x),I=Math.cos(x);c=[c[0]*I-c[1]*C,c[0]*C+c[1]*I]}const w=[m?c[0]:ne(o,c[0],this.transform.zoom),m?c[1]:ne(o,c[1],this.transform.zoom),0],T=new Float32Array(16);return l.$(T,t,w),T}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!o||!c}useProgram(t,o){this.cache=this.cache||{};const c=t+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new ka(this.context,Qt[t],o,Ma[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new tt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}class pn{constructor(t,o){this.points=t,this.planes=o}static fromInvProjectionMatrix(t,o,c){const d=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=l.ag([],w,t))[3]/o*d;return l.b3(w,w,[T,T,1/w[3],T])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(F,q){var $=q[0],G=q[1],U=q[2],oe=$*$+G*G+U*U;return oe>0&&(oe=1/Math.sqrt(oe)),F[0]=q[0]*oe,F[1]=q[1]*oe,F[2]=q[2]*oe,F}([],function(F,q,$){var G=q[0],U=q[1],oe=q[2],pe=$[0],K=$[1],ae=$[2];return F[0]=U*ae-oe*K,F[1]=oe*pe-G*ae,F[2]=G*K-U*pe,F}([],Oe([],m[w[0]],m[w[1]]),Oe([],m[w[2]],m[w[1]]))),C=-((I=T)[0]*(P=m[w[1]])[0]+I[1]*P[1]+I[2]*P[2]);var I,P;return T.concat(C)});return new pn(m,x)}}class no{constructor(t,o){this.min=t,this.max=o,this.center=function(c,d,m){return c[0]=.5*d[0],c[1]=.5*d[1],c[2]=.5*d[2],c}([],function(c,d,m){return c[0]=d[0]+m[0],c[1]=d[1]+m[1],c[2]=d[2]+m[2],c}([],this.min,this.max))}quadrant(t){const o=[t%2==0,t<2],c=ve(this.min),d=ve(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],d[m]=o[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new no(c,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let d=0;d<t.planes.length;d++){const m=t.planes[d];let x=0;for(let w=0;w<o.length;w++)l.b4(m,o[w])>=0&&x++;if(x===0)return 0;x!==o.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let w=0;w<t.points.length;w++){const T=t.points[w][d]-this.min[d];m=Math.min(m,T),x=Math.max(x,T)}if(x<0||m>this.max[d]-this.min[d])return 0}return 1}}class Ho{constructor(t=0,o=0,c=0,d=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=c,this.right=d}interpolate(t,o,c){return o.top!=null&&t.top!=null&&(this.top=l.B.number(t.top,o.top,c)),o.bottom!=null&&t.bottom!=null&&(this.bottom=l.B.number(t.bottom,o.bottom,c)),o.left!=null&&t.left!=null&&(this.left=l.B.number(t.left,o.left,c)),o.right!=null&&t.right!=null&&(this.right=l.B.number(t.right,o.right,c)),this}getCenter(t,o){const c=l.ad((this.left+t-this.right)/2,0,t),d=l.ad((this.top+o-this.bottom)/2,0,o);return new l.P(c,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ho(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Za{constructor(t,o,c,d,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||!!m,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=c??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ho,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const t=new Za(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this._minEleveationForCurrentTile=t._minEleveationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const o=-l.b5(t,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var c=new l.A(4);return l.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,d,m){var x=d[0],w=d[1],T=d[2],C=d[3],I=Math.sin(m),P=Math.cos(m);c[0]=x*P+T*I,c[1]=w*P+C*I,c[2]=x*-I+T*P,c[3]=w*-I+C*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=l.ad(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,c){this._unmodified=!1,this._edgeInsets.interpolate(t,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new l.b6(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new l.P(0,0)),d=this.pointCoordinate(new l.P(this.width,0)),m=this.pointCoordinate(new l.P(this.width,this.height)),x=this.pointCoordinate(new l.P(0,this.height)),w=Math.floor(Math.min(c.x,d.x,m.x,x.x)),T=Math.floor(Math.max(c.x,d.x,m.x,x.x)),C=1;for(let I=w-C;I<=T+C;I++)I!==0&&o.push(new l.b6(I,t))}return o}coveringTiles(t){var o,c;let d=this.coveringZoomLevel(t);const m=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),w=l.U.fromLngLat(this.center),T=Math.pow(2,d),C=[T*x.x,T*x.y,0],I=[T*w.x,T*w.y,0],P=pn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let F=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=d);const q=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,$=K=>({aabb:new no([K*T,0,0],[(K+1)*T,T,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),G=[],U=[],oe=d,pe=t.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)G.push($(-K)),G.push($(K));for(G.push($(0));G.length>0;){const K=G.pop(),ae=K.x,me=K.y;let ge=K.fullyVisible;if(!ge){const Xe=K.aabb.intersects(P);if(Xe===0)continue;ge=Xe===2}const we=t.terrain?C:I,Ce=K.aabb.distanceX(we),Te=K.aabb.distanceY(we),Ie=Math.max(Math.abs(Ce),Math.abs(Te));if(K.zoom===oe||Ie>q+(1<<oe-K.zoom)-2&&K.zoom>=F){const Xe=oe-K.zoom,xt=C[0]-.5-(ae<<Xe),Ne=C[1]-.5-(me<<Xe);U.push({tileID:new l.O(K.zoom===oe?pe:K.zoom,K.wrap,K.zoom,ae,me),distanceSq:Ge([I[0]-.5-ae,I[1]-.5-me]),tileDistanceToCamera:Math.sqrt(xt*xt+Ne*Ne)})}else for(let Xe=0;Xe<4;Xe++){const xt=(ae<<1)+Xe%2,Ne=(me<<1)+(Xe>>1),at=K.zoom+1;let Ye=K.aabb.quadrant(Xe);if(t.terrain){const Bt=new l.O(at,K.wrap,at,xt,Ne),vt=t.terrain.getMinMaxElevation(Bt),mt=(o=vt.minElevation)!==null&&o!==void 0?o:this.elevation,wt=(c=vt.maxElevation)!==null&&c!==void 0?c:this.elevation;Ye=new no([Ye.min[0],Ye.min[1],mt],[Ye.max[0],Ye.max[1],wt])}G.push({aabb:Ye,zoom:at,x:xt,y:Ne,wrap:K.wrap,fullyVisible:ge})}}return U.sort((K,ae)=>K.distanceSq-ae.distanceSq).map(K=>K.tileID)}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=l.ad(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.P(l.G(t.lng)*this.worldSize,l.H(o)*this.worldSize)}unproject(t){return new l.U(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const o=this.pointLocation(this.centerPoint,t),c=t.getElevationForLngLatZoom(o,this.tileZoom);if(!(this.elevation-c))return;const d=this.getCameraPosition(),m=l.U.fromLngLat(d.lngLat,d.altitude),x=l.U.fromLngLat(o,c),w=m.x-x.x,T=m.y-x.y,C=m.z-x.z,I=Math.sqrt(w*w+T*T+C*C),P=this.scaleZoom(this.cameraToCenterDistance/I/this.tileSize);this._elevation=c,this._center=o,this.zoom=P}setLocationAtPoint(t,o){const c=this.pointCoordinate(o),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(t),x=new l.U(m.x-(c.x-d.x),m.y-(c.y-d.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,o){return o?this.coordinatePoint(this.locationCoordinate(t),o.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,o){return this.coordinateLocation(this.pointCoordinate(t,o))}locationCoordinate(t){return l.U.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,o){if(o){const F=o.pointCoordinate(t);if(F!=null)return F}const c=[t.x,t.y,0,1],d=[t.x,t.y,1,1];l.ag(c,c,this.pixelMatrixInverse),l.ag(d,d,this.pixelMatrixInverse);const m=c[3],x=d[3],w=c[1]/m,T=d[1]/x,C=c[2]/m,I=d[2]/x,P=C===I?0:(0-C)/(I-C);return new l.U(l.B.number(c[0]/m,d[0]/x,P)/this.worldSize,l.B.number(w,T,P)/this.worldSize)}coordinatePoint(t,o=0,c=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,o,1];return l.ag(d,d,c),new l.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Dt().extend(this.pointLocation(new l.P(0,t))).extend(this.pointLocation(new l.P(this.width,t))).extend(this.pointLocation(new l.P(this.width,this.height))).extend(this.pointLocation(new l.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Dt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,o=!1){const c=t.key,d=o?this._alignedPosMatrixCache:this._posMatrixCache;if(d[c])return d[c];const m=t.canonical,x=this.worldSize/this.zoomScale(m.z),w=m.x+Math.pow(2,m.z)*t.wrap,T=l.ao(new Float64Array(16));return l.$(T,T,[w*x,m.y*x,0]),l.a0(T,T,[x/l.N,x/l.N,1]),l.a1(T,o?this.alignedProjMatrix:this.projMatrix,T),d[c]=new Float32Array(T),d[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,o,c,d,m=-90,x=90,w=-180,T=180;const C=this.size,I=this._unmodified;if(this.latRange){const q=this.latRange;m=l.H(q[1])*this.worldSize,x=l.H(q[0])*this.worldSize,t=x-m<C.y?C.y/(x-m):0}if(this.lngRange){const q=this.lngRange;w=l.b5(l.G(q[0])*this.worldSize,0,this.worldSize),T=l.b5(l.G(q[1])*this.worldSize,0,this.worldSize),T<w&&(T+=this.worldSize),o=T-w<C.x?C.x/(T-w):0}const P=this.point,F=Math.max(o||0,t||0);if(F)return this.center=this.unproject(new l.P(o?(T+w)/2:P.x,t?(x+m)/2:P.y)),this.zoom+=this.scaleZoom(F),this._unmodified=I,void(this._constraining=!1);if(this.latRange){const q=P.y,$=C.y/2;q-$<m&&(d=m+$),q+$>x&&(d=x-$)}if(this.lngRange){const q=(w+T)/2,$=l.b5(P.x,q-this.worldSize/2,q+this.worldSize/2),G=C.x/2;$-G<w&&(c=w+G),$+G>T&&(c=T-G)}c===void 0&&d===void 0||(this.center=this.unproject(new l.P(c!==void 0?c:P.x,d!==void 0?d:P.y)).wrap()),this._unmodified=I,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,o=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.b7(1,this.center.lat)*this.worldSize;let d=l.ao(new Float64Array(16));l.a0(d,d,[this.width/2,-this.height/2,1]),l.$(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=l.ao(new Float64Array(16)),l.a0(d,d,[1,-1,1]),l.$(d,d,[-1,-1,0]),l.a0(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this._minEleveationForCurrentTile),w=m-x*this._pixelPerMeter/Math.cos(this._pitch),T=x<0?w:m,C=Math.PI/2+this._pitch,I=this._fov*(.5+t.y/this.height),P=Math.sin(I)*T/Math.sin(l.ad(Math.PI-C-I,.01,Math.PI-.01)),F=this.getHorizon(),q=2*Math.atan(F/this.cameraToCenterDistance)*(.5+t.y/(2*F)),$=Math.sin(q)*T/Math.sin(l.ad(Math.PI-C-q,.01,Math.PI-.01)),G=Math.min(P,$),U=1.01*(Math.cos(Math.PI/2-this._pitch)*G+T),oe=this.height/50;d=new Float64Array(16),l.b8(d,this._fov,this.width/this.height,oe,U),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,l.a0(d,d,[1,-1,1]),l.$(d,d,[0,0,-this.cameraToCenterDistance]),l.b9(d,d,this._pitch),l.ae(d,d,this.angle),l.$(d,d,[-o,-c,0]),this.mercatorMatrix=l.a0([],d,[this.worldSize,this.worldSize,this.worldSize]),l.a0(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.a1(new Float64Array(16),this.labelPlaneMatrix,d),l.$(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=l.as([],d),this.pixelMatrix3D=l.a1(new Float64Array(16),this.labelPlaneMatrix,d);const pe=this.width%2/2,K=this.height%2/2,ae=Math.cos(this.angle),me=Math.sin(this.angle),ge=o-Math.round(o)+ae*pe+me*K,we=c-Math.round(c)+ae*K+me*pe,Ce=new Float64Array(d);if(l.$(Ce,Ce,[ge>.5?ge-1:ge,we>.5?we-1:we,0]),this.alignedProjMatrix=Ce,d=l.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new l.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.ag(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(0,t))}getCameraQueryGeometry(t){const o=this.getCameraPoint();if(t.length===1)return[t[0],o];{let c=o.x,d=o.y,m=o.x,x=o.y;for(const w of t)c=Math.min(c,w.x),d=Math.min(d,w.y),m=Math.max(m,w.x),x=Math.max(x,w.y);return[new l.P(c,d),new l.P(m,d),new l.P(m,x),new l.P(c,x),new l.P(c,d)]}}}function Cs(p,t){let o,c=!1,d=null,m=null;const x=()=>{d=null,c&&(p.apply(m,o),d=setTimeout(x,t),c=!1)};return(...w)=>(c=!0,m=this,o=w,d||x(),d)}class Wo{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(c=d)}),(c&&c[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}},this._updateHash=Cs(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),x=Math.round(o.lng*m)/m,w=Math.round(o.lat*m)/m,T=this._map.getBearing(),C=this._map.getPitch();let I="";if(I+=t?`/${x}/${w}/${c}`:`${c}/${w}/${x}`,(T||C)&&(I+="/"+Math.round(10*T)/10),C&&(I+=`/${Math.round(C)}`),this._hashName){const P=this._hashName;let F=!1;const q=window.location.hash.slice(1).split("&").map($=>{const G=$.split("=")[0];return G===P?(F=!0,`${G}=${I}`):$}).filter($=>$);return F||q.push(`${P}=${I}`),`#${q.join("&")}`}return`#${I}`}}const ro={linearity:.3,easing:l.ba(0,0,.3,1)},Jc=l.e({deceleration:2500,maxSpeed:1400},ro),eh=l.e({deceleration:20,maxSpeed:1400},ro),th=l.e({deceleration:1e3,maxSpeed:360},ro),ih=l.e({deceleration:1e3,maxSpeed:90},ro);class nh{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.h.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=l.h.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(o.pan.mag()){const m=Xo(o.pan.mag(),c,l.e({},Jc,t||{}));d.offset=o.pan.mult(m.amount/o.pan.mag()),d.center=this._map.transform.center,yr(d,m)}if(o.zoom){const m=Xo(o.zoom,c,eh);d.zoom=this._map.transform.zoom+m.amount,yr(d,m)}if(o.bearing){const m=Xo(o.bearing,c,th);d.bearing=this._map.transform.bearing+l.ad(m.amount,-179,179),yr(d,m)}if(o.pitch){const m=Xo(o.pitch,c,ih);d.pitch=this._map.transform.pitch+m.amount,yr(d,m)}if(d.zoom||d.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),l.e(d,{noMoveStart:!0})}}function yr(p,t){(!p.duration||p.duration<t.duration)&&(p.duration=t.duration,p.easing=t.easing)}function Xo(p,t,o){const{maxSpeed:c,linearity:d,deceleration:m}=o,x=l.ad(p*d/(t/1e3),-c,c),w=Math.abs(x)/(m*d);return{easing:o.easing,duration:1e3*w,amount:x*(w/2)}}class Pn extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c,d={}){const m=R.mousePos(o.getCanvasContainer(),c),x=o.unproject(m);super(t,l.e({point:m,lngLat:x,originalEvent:c},d)),this._defaultPrevented=!1,this.target=o}}class Ko extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){const d=t==="touchend"?c.changedTouches:c.touches,m=R.touchPos(o.getCanvasContainer(),d),x=m.map(T=>o.unproject(T)),w=m.reduce((T,C,I,P)=>T.add(C.div(P.length)),new l.P(0,0));super(t,{points:m,point:w,lngLats:x,lngLat:o.unproject(w),originalEvent:c}),this._defaultPrevented=!1}}class rh extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class sh{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new rh(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Pn(t.type,this._map,t))}mouseup(t){this._map.fire(new Pn(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Pn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Pn(t.type,this._map,t))}mouseover(t){this._map.fire(new Pn(t.type,this._map,t))}mouseout(t){this._map.fire(new Pn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ko(t.type,this._map,t))}touchmove(t){this._map.fire(new Ko(t.type,this._map,t))}touchend(t){this._map.fire(new Ko(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ko(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oh{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Pn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Pn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(l.P.convert(t),this._map.terrain)}}class ah{constructor(t,o){this._map=t,this._tr=new Rr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(R.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=R.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(d.x,c.x),x=Math.max(d.x,c.x),w=Math.min(d.y,c.y),T=Math.max(d.y,c.y);R.setTransform(this._box,`translate(${m}px,${w}px)`),this._box.style.width=x-m+"px",this._box.style.height=T-w+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const c=this._startPos,d=o;if(this.reset(),R.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new l.k("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(R.remove(this._box),this._box=null),R.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new l.k(t,{originalEvent:o}))}}function Gn(p,t){if(p.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${t.length}`);const o={};for(let c=0;c<p.length;c++)o[p[c].identifier]=t[c];return o}class Fr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(d){const m=new l.P(0,0);for(const x of d)m._add(x);return m.div(d.length)}(o),this.touches=Gn(c,o)))}touchmove(t,o,c){if(this.aborted||!this.centroid)return;const d=Gn(c,o);for(const m in this.touches){const x=d[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(t,o,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Ga{constructor(t){this.singleTap=new Fr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,c){this.singleTap.touchstart(t,o,c)}touchmove(t,o,c){this.singleTap.touchmove(t,o,c)}touchend(t,o,c){const d=this.singleTap.touchend(t,o,c);if(d){const m=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(m&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Br{constructor(t){this._tr=new Rr(t),this._zoomIn=new Ga({numTouches:1,numTaps:2}),this._zoomOut=new Ga({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,c){this._zoomIn.touchstart(t,o,c),this._zoomOut.touchstart(t,o,c)}touchmove(t,o,c){this._zoomIn.touchmove(t,o,c),this._zoomOut.touchmove(t,o,c)}touchend(t,o,c){const d=this._zoomIn.touchend(t,o,c),m=this._zoomOut.touchend(t,o,c),x=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Or{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=o.length?o[0]:o;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&R.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const _p={0:1,2:2};class au{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=R.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(o,c){const d=_p[c];return o.buttons===void 0||(o.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return R.mouseButton(t)===this._eventButton}}class lh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Ha=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(t){t.preventDefault()}},so=({enable:p,clickTolerance:t,bearingDegreesPerPixelMoved:o=.8})=>{const c=new au({checkCorrectEvent:d=>R.mouseButton(d)===0&&d.ctrlKey||R.mouseButton(d)===2});return new Or({clickTolerance:t,move:(d,m)=>({bearingDelta:(m.x-d.x)*o}),moveStateManager:c,enable:p,assignEvents:Ha})},Nr=({enable:p,clickTolerance:t,pitchDegreesPerPixelMoved:o=-.5})=>{const c=new au({checkCorrectEvent:d=>R.mouseButton(d)===0&&d.ctrlKey||R.mouseButton(d)===2});return new Or({clickTolerance:t,move:(d,m)=>({pitchDelta:(m.y-d.y)*o}),moveStateManager:c,enable:p,assignEvents:Ha})};class qe{constructor(t,o){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,o,c){return this._calculateTransform(t,o,c)}touchmove(t,o,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,o,c)}touchend(t,o,c){this._calculateTransform(t,o,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,c){c.length>0&&(this._active=!0);const d=Gn(c,o),m=new l.P(0,0),x=new l.P(0,0);let w=0;for(const C in d){const I=d[C],P=this._touches[C];P&&(m._add(I),x._add(I.sub(P)),w++,d[C]=I)}if(this._touches=d,w<this._minTouches||!x.mag())return;const T=x.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,c){if(!this._firstTwoTouches)return;t.preventDefault();const[d,m]=this._firstTwoTouches,x=as(c,o,d),w=as(c,o,m);if(!x||!w)return;const T=this._aroundCenter?null:x.add(w).div(2);return this._move([x,w],T,t)}touchend(t,o,c){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,x=as(c,o,d),w=as(c,o,m);x&&w||(this._active&&R.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function as(p,t,o){for(let c=0;c<p.length;c++)if(p[c].identifier===o)return t[c]}function oo(p,t){return Math.log(p/t)/Math.LN2}class uh extends Wa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(oo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oo(this._distance,c),pinchAround:o}}}function je(p,t){return 180*p.angleWith(t)/Math.PI}class lu extends Wa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:je(this._vector,c),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,c=je(t,this._startVector);return Math.abs(c)<o}}function uu(p){return Math.abs(p.y)>Math.abs(p.x)}class vp extends Wa{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,c){super.touchstart(t,o,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,uu(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),m=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,c){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,m=o.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=t.y>0==o.y>0;return uu(t)&&uu(o)&&x}}const cu={panStep:100,bearingStep:15,pitchStep:10};class ch{constructor(t){this._tr=new Rr(t);const o=cu;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,c=0,d=0,m=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:hh,zoom:o?Math.round(T.zoom)+o*(t.shiftKey?2:1):T.zoom,bearing:T.bearing+c*this._bearingStep,pitch:T.pitch+d*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:T.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function hh(p){return p*(2-p)}const dh=4.000244140625;class xp{constructor(t,o){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Rr(t),this._el=t.getCanvasContainer(),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=l.h.now(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%dh==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=R.mousePos(this._el,t),c=this._tr;this._around=l.L.convert(this._aroundCenter?c.center:c.unproject(o)),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>dh?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const C=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(C*T))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,d=this._easing;let m,x=!1;if(this._type==="wheel"&&c&&d){const w=Math.min((l.h.now()-this._lastWheelEventTime)/200,1),T=d(w);m=l.B.number(c,o,T),w<1?this._frameId||(this._frameId=!0):x=!0}else m=o,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=l.bb;if(this._prevEase){const c=this._prevEase,d=(l.h.now()-c.start)/c.duration,m=c.easing(d+.01)-c.easing(d),x=.27/Math.sqrt(m*m+1e-4)*.01,w=Math.sqrt(.0729-x*x);o=l.ba(x,w,.25,1)}return this._prevEase={start:l.h.now(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class hu{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class du{constructor(t){this._tr=new Rr(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pu{constructor(){this._tap=new Ga({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,c){if(!this._swipePoint)if(this._tapTime){const d=o[0],m=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;m&&x?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,o,c)}touchmove(t,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=o[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,o,c)}touchend(t,o,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(t,o,c);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(t,o,c){this._el=t,this._mousePan=o,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fn{constructor(t,o,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ls{constructor(t,o,c,d){this._el=t,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Yo=p=>p.zoom||p.drag||p.pitch||p.rotate;class mu extends l.k{}function Qo(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class gu{constructor(t,o){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,w={needsRenderFrame:!1},T={},C={},I=d.touches,P=I?this._getMapTouches(I):void 0,F=P?R.touchPos(this._el,P):R.mousePos(this._el,d);for(const{handlerName:G,handler:U,allowed:oe}of this._handlers){if(!U.isEnabled())continue;let pe;this._blockedByActive(C,oe,G)?U.reset():U[m||d.type]&&(pe=U[m||d.type](d,F,P),this.mergeHandlerResult(w,T,pe,G,x),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||U.isActive())&&(C[G]=U)}const q={};for(const G in this._previousActiveHandlers)C[G]||(q[G]=x);this._previousActiveHandlers=C,(Object.keys(q).length||Qo(w))&&(this._changes.push([w,T,q]),this._triggerRenderFrame()),(Object.keys(C).length||Qo(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=w;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nh(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,x]of this._listeners)R.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,o,c]of this._listeners)R.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new sh(o,t));const d=o.boxZoom=new ah(o,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const m=new Br(o),x=new du(o);o.doubleClickZoom=new hu(x,m),this._add("tapZoom",m),this._add("clickZoom",x),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const w=new pu;this._add("tapDragZoom",w);const T=o.touchPitch=new vp(o);this._add("touchPitch",T),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const C=so(t),I=Nr(t);o.dragRotate=new fn(t,C,I),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",I,["mouseRotate"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const P=(({enable:oe,clickTolerance:pe})=>{const K=new au({checkCorrectEvent:ae=>R.mouseButton(ae)===0&&!ae.ctrlKey});return new Or({clickTolerance:pe,move:(ae,me)=>({around:me,panDelta:me.sub(ae)}),activateOnStart:!0,moveStateManager:K,enable:oe,assignEvents:Ha})})(t),F=new qe(t,o);o.dragPan=new fu(c,P,F),this._add("mousePan",P),this._add("touchPan",F,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const q=new lu,$=new uh;o.touchZoomRotate=new ls(c,$,q,w),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",$,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate);const G=o.scrollZoom=new xp(o,()=>this._triggerRenderFrame());this._add("scrollZoom",G,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const U=o.keyboard=new ch(o);this._add("keyboard",U),t.interactive&&t.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new oh(o))}_add(t,o,c){this._handlers.push({handlerName:t,handler:o,allowed:c}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Yo(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,c){for(const d in t)if(d!==c&&(!o||o.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const c of t)this._el.contains(c.target)&&o.push(c);return o}mergeHandlerResult(t,o,c,d,m){if(!c)return;l.e(t,c);const x={handlerName:d,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(o.zoom=x),c.panDelta!==void 0&&(o.drag=x),c.pitchDelta!==void 0&&(o.pitch=x),c.bearingDelta!==void 0&&(o.rotate=x)}_applyChanges(){const t={},o={},c={};for(const[d,m,x]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),l.e(o,m),l.e(c,x);this._updateMapTransform(t,o,c),this._changes=[]}_updateMapTransform(t,o,c){const d=this._map,m=d._getTransformForUpdate(),x=d.terrain;if(!(Qo(t)||x&&this._terrainMovement))return this._fireEvents(o,c,!0);let{panDelta:w,zoomDelta:T,bearingDelta:C,pitchDelta:I,around:P,pinchAround:F}=t;F!==void 0&&(P=F),d._stop(!0),P=P||d.transform.centerPoint;const q=m.pointLocation(w?P.sub(w):P);C&&(m.bearing+=C),I&&(m.pitch+=I),T&&(m.zoom+=T),x?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(w)):m.setLocationAtPoint(q,P):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(q,P),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,m.recalculateZoom(d.terrain)})):m.setLocationAtPoint(q,P),d._applyUpdatedTransform(m),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,c,!0)}_fireEvents(t,o,c){const d=Yo(this._eventsInProgress),m=Yo(t),x={};for(const I in t){const{originalEvent:P}=t[I];this._eventsInProgress[I]||(x[`${I}start`]=P),this._eventsInProgress[I]=t[I]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const I in x)this._fireEvent(I,x[I]);m&&this._fireEvent("move",m.originalEvent);for(const I in t){const{originalEvent:P}=t[I];this._fireEvent(I,P)}const w={};let T;for(const I in this._eventsInProgress){const{handlerName:P,originalEvent:F}=this._eventsInProgress[I];this._handlersById[P].isActive()||(delete this._eventsInProgress[I],T=o[P]||F,w[`${I}end`]=T)}for(const I in w)this._fireEvent(I,w[I]);const C=Yo(this._eventsInProgress);if(c&&(d||m)&&!C){this._updatingCamera=!0;const I=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!I||!I.essential&&l.h.prefersReducedMotion?(this._map.fire(new l.k("moveend",{originalEvent:T})),P(this._map.getBearing())&&this._map.resetNorth()):(P(I.bearing||this._map.getBearing())&&(I.bearing=0),I.freezeElevation=!0,this._map.easeTo(I,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new l.k(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new mu("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ph extends l.E{constructor(t,o){super(),this._renderFrameCallback=()=>{const c=Math.min((l.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.L(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,c){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},o),c)}panTo(t,o,c){return this.easeTo(l.e({center:t},o),c)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,c){return this.easeTo(l.e({zoom:t},o),c)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,c){return this.easeTo(l.e({bearing:t},o),c)}resetNorth(t,o){return this.rotateTo(0,l.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(l.e({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=Dt.convert(t);const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,o)}_cameraForBoxAndBearing(t,o,c,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=l.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const me=d.padding;d.padding={top:me,bottom:me,right:me,left:me}}d.padding=l.e(m,d.padding);const x=this.transform,w=x.padding,T=x.project(l.L.convert(t)),C=x.project(l.L.convert(o)),I=T.rotate(-c*Math.PI/180),P=C.rotate(-c*Math.PI/180),F=new l.P(Math.max(I.x,P.x),Math.max(I.y,P.y)),q=new l.P(Math.min(I.x,P.x),Math.min(I.y,P.y)),$=F.sub(q),G=(x.width-(w.left+w.right+d.padding.left+d.padding.right))/$.x,U=(x.height-(w.top+w.bottom+d.padding.top+d.padding.bottom))/$.y;if(U<0||G<0)return void l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const oe=Math.min(x.scaleZoom(x.scale*Math.min(G,U)),d.maxZoom),pe=l.P.convert(d.offset),K=new l.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c*Math.PI/180),ae=pe.add(K).mult(x.scale/x.zoomScale(oe));return{center:x.unproject(T.add(C).div(2).sub(ae)),zoom:oe,bearing:c}}fitBounds(t,o,c){return this._fitInternal(this.cameraForBounds(t,o),o,c)}fitScreenCoordinates(t,o,c,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.P.convert(t)),this.transform.pointLocation(l.P.convert(o)),c,d),d,m)}_fitInternal(t,o,c){return t?(delete(o=l.e(t,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(t,o){this.stop();const c=this._getTransformForUpdate();let d=!1,m=!1,x=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(d=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=l.L.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(m=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(x=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this._applyUpdatedTransform(c),this.fire(new l.k("movestart",o)).fire(new l.k("move",o)),d&&this.fire(new l.k("zoomstart",o)).fire(new l.k("zoom",o)).fire(new l.k("zoomend",o)),m&&this.fire(new l.k("rotatestart",o)).fire(new l.k("rotate",o)).fire(new l.k("rotateend",o)),x&&this.fire(new l.k("pitchstart",o)).fire(new l.k("pitch",o)).fire(new l.k("pitchend",o)),this.fire(new l.k("moveend",o))}calculateCameraOptionsFromTo(t,o,c,d=0){const m=l.U.fromLngLat(t,o),x=l.U.fromLngLat(c,d),w=x.x-m.x,T=x.y-m.y,C=x.z-m.z,I=Math.hypot(w,T,C);if(I===0)throw new Error("Can't calculate camera options with same From and To");const P=Math.hypot(w,T),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/I/this.transform.tileSize),q=180*Math.atan2(w,-T)/Math.PI;let $=180*Math.acos(P/I)/Math.PI;return $=C<0?90-$:90+$,{center:x.toLngLat(),zoom:F,pitch:$,bearing:q}}easeTo(t,o){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.bb},t)).animate===!1||!t.essential&&l.h.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in t?+t.zoom:d,C="bearing"in t?this._normalizeBearing(t.bearing,m):m,I="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,F=l.P.convert(t.offset);let q=c.centerPoint.add(F);const $=c.pointLocation(q),G=l.L.convert(t.center||$);this._normalizeCenter(G);const U=c.project($),oe=c.project(G).sub(U),pe=c.zoomScale(T-d);let K,ae;t.around&&(K=l.L.convert(t.around),ae=c.locationPoint(K));const me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==d,this._rotating=this._rotating||m!==C,this._pitching=this._pitching||I!==x,this._padding=!c.isPaddingEqual(P),this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,me),this.terrain&&this._prepareElevation(G),this._ease(ge=>{if(this._zooming&&(c.zoom=l.B.number(d,T,ge)),this._rotating&&(c.bearing=l.B.number(m,C,ge)),this._pitching&&(c.pitch=l.B.number(x,I,ge)),this._padding&&(c.interpolatePadding(w,P,ge),q=c.centerPoint.add(F)),this.terrain&&!t.freezeElevation&&this._updateElevation(ge),K)c.setLocationAtPoint(K,ae);else{const we=c.zoomScale(c.zoom-d),Ce=T>d?Math.min(2,pe):Math.max(.5,pe),Te=Math.pow(Ce,1-ge),Ie=c.unproject(U.add(oe.mult(ge*Te)).mult(we));c.setLocationAtPoint(c.renderWorldCopies?Ie.wrap():Ie,q)}this._applyUpdatedTransform(c),this._fireMoveEvents(o)},ge=>{this.terrain&&this._finalizeElevation(),this._afterEase(o,ge)},t),this}_prepareEase(t,o,c={}){this._moving=!0,o||c.moving||this.fire(new l.k("movestart",t)),this._zooming&&!c.zooming&&this.fire(new l.k("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new l.k("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new l.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(o-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.elevation=l.B.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const o=t.clone(),{center:c,zoom:d,pitch:m,bearing:x,elevation:w}=this.transformCameraUpdate(o);c&&(o.center=c),d!==void 0&&(o.zoom=d),m!==void 0&&(o.pitch=m),x!==void 0&&(o.bearing=x),w!==void 0&&(o.elevation=w),this.transform.apply(o)}_fireMoveEvents(t){this.fire(new l.k("move",t)),this._zooming&&this.fire(new l.k("zoom",t)),this._rotating&&this.fire(new l.k("rotate",t)),this._pitching&&this.fire(new l.k("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const c=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new l.k("zoomend",t)),d&&this.fire(new l.k("rotateend",t)),m&&this.fire(new l.k("pitchend",t)),this.fire(new l.k("moveend",t))}flyTo(t,o){if(!t.essential&&l.h.prefersReducedMotion){const Ye=l.F(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,o)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.bb},t);const c=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in t?l.ad(+t.zoom,c.minZoom,c.maxZoom):d,C="bearing"in t?this._normalizeBearing(t.bearing,m):m,I="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,F=c.zoomScale(T-d),q=l.P.convert(t.offset);let $=c.centerPoint.add(q);const G=c.pointLocation($),U=l.L.convert(t.center||G);this._normalizeCenter(U);const oe=c.project(G),pe=c.project(U).sub(oe);let K=t.curve;const ae=Math.max(c.width,c.height),me=ae/F,ge=pe.mag();if("minZoom"in t){const Ye=l.ad(Math.min(t.minZoom,d,T),c.minZoom,c.maxZoom),Bt=ae/c.zoomScale(Ye-d);K=Math.sqrt(Bt/ge*2)}const we=K*K;function Ce(Ye){const Bt=(me*me-ae*ae+(Ye?-1:1)*we*we*ge*ge)/(2*(Ye?me:ae)*we*ge);return Math.log(Math.sqrt(Bt*Bt+1)-Bt)}function Te(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function Ie(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const Xe=Ce(!1);let xt=function(Ye){return Ie(Xe)/Ie(Xe+K*Ye)},Ne=function(Ye){return ae*((Ie(Xe)*(Te(Bt=Xe+K*Ye)/Ie(Bt))-Te(Xe))/we)/ge;var Bt},at=(Ce(!0)-Xe)/K;if(Math.abs(ge)<1e-6||!isFinite(at)){if(Math.abs(ae-me)<1e-6)return this.easeTo(t,o);const Ye=me<ae?-1:1;at=Math.abs(Math.log(me/ae))/K,Ne=function(){return 0},xt=function(Bt){return Math.exp(Ye*K*Bt)}}return t.duration="duration"in t?+t.duration:1e3*at/("screenSpeed"in t?+t.screenSpeed/K:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=m!==C,this._pitching=I!==x,this._padding=!c.isPaddingEqual(P),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(U),this._ease(Ye=>{const Bt=Ye*at,vt=1/xt(Bt);c.zoom=Ye===1?T:d+c.scaleZoom(vt),this._rotating&&(c.bearing=l.B.number(m,C,Ye)),this._pitching&&(c.pitch=l.B.number(x,I,Ye)),this._padding&&(c.interpolatePadding(w,P,Ye),$=c.centerPoint.add(q)),this.terrain&&!t.freezeElevation&&this._updateElevation(Ye);const mt=Ye===1?U:c.unproject(oe.add(pe.mult(Ne(Bt))).mult(vt));c.setLocationAtPoint(c.renderWorldCopies?mt.wrap():mt,$),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(o)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,o)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,o,c){c.animate===!1||c.duration===0?(t(1),o()):(this._easeStart=l.h.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=l.b5(t,-180,180);const c=Math.abs(t-o);return Math.abs(t-360-o)<c&&(t-=360),Math.abs(t+360-o)<c&&(t+=360),t}_normalizeCenter(t){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const c=t.lng-o.center.lng;t.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.L.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}class Mn{constructor(t={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=R.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=R.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=R.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){R.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const c=this._map._getUIString(`AttributionControl.${o}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const o=this._map.style.sourceCaches;for(const d in o){const m=o[d];if(m.used||m.usedForTerrain){const x=m.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,m)=>d.length-m.length),t=t.filter((d,m)=>{for(let x=m+1;x<t.length;x++)if(t[x].indexOf(d)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ht{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=R.create("div","maplibregl-ctrl");const o=R.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){R.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Xa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const d of c)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const yu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var fh=l.Q([{name:"a_pos3d",type:"Int16",components:3}]);class mh extends l.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,o){this.sourceCache.update(t,o),this._renderableTilesKeys=[];const c={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),l.aS(d.posMatrix,0,l.N,0,l.N,0,1),this._tiles[d.key]=new ts(d,this.tileSize));for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(t){for(const o in this._tiles){const c=this._tiles[o];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const o={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID;if(d.canonical.equals(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16),l.aS(m.posMatrix,0,l.N,0,l.N,0,1),o[c]=m}else if(d.canonical.isChildOf(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const x=d.canonical.z-t.canonical.z,w=d.canonical.x-(d.canonical.x>>x<<x),T=d.canonical.y-(d.canonical.y>>x<<x),C=l.N>>x;l.aS(m.posMatrix,0,C,0,C,0,1),l.$(m.posMatrix,m.posMatrix,[-w*C,-T*C,0]),o[c]=m}else if(t.canonical.isChildOf(d.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const x=t.canonical.z-d.canonical.z,w=t.canonical.x-(t.canonical.x>>x<<x),T=t.canonical.y-(t.canonical.y>>x<<x),C=l.N>>x;l.aS(m.posMatrix,0,l.N,0,l.N,0,1),l.$(m.posMatrix,m.posMatrix,[w*C,T*C,0]),l.a0(m.posMatrix,m.posMatrix,[1/2**x,1/2**x,0]),o[c]=m}}return o}getSourceTile(t,o){const c=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!m||!m.dem)&&o)for(;d>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(t.scaledTo(d--).key);return m}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=t)}}class gh{constructor(t,o,c){this.painter=t,this.sourceCache=new mh(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,c,d=l.N){var m;if(!(o>=0&&o<d&&c>=0&&c<d))return 0;const x=this.getTerrainData(t),w=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!w)return 0;const T=function($,G,U){var oe=G[0],pe=G[1];return $[0]=U[0]*oe+U[4]*pe+U[12],$[1]=U[1]*oe+U[5]*pe+U[13],$}([],[o/d*l.N,c/d*l.N],x.u_terrain_matrix),C=[T[0]*w.dim,T[1]*w.dim],I=Math.floor(C[0]),P=Math.floor(C[1]),F=C[0]-I,q=C[1]-P;return w.get(I,P)*(1-F)*(1-q)+w.get(I+1,P)*F*(1-q)+w.get(I,P+1)*(1-F)*q+w.get(I+1,P+1)*F*q}getElevationForLngLatZoom(t,o){const{tileID:c,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(c,d%l.N,m%l.N,l.N)}getElevation(t,o,c,d=l.N){return this.getDEMElevation(t,o,c,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,m=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new tt(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new tt(d,new l.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ao([])}const o=this.sourceCache.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const d=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new tt(d,o.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),o.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?m=t.canonical.z-d:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>m<<m),w=t.canonical.y-(t.canonical.y>>m<<m),T=l.bc(new Float64Array(16),[1/(l.N<<m),1/(l.N<<m),0]);l.$(T,T,[x*l.N,w*l.N,0]),this._demMatrixCache[t.key]={matrix:T,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,c=o.width/devicePixelRatio,d=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new tt(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new tt(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let w=0;w<this._coordsTextureSize;w++,x+=4)o[x+0]=255&w,o[x+1]=255&m,o[x+2]=w>>8<<4|m>>8,o[x+3]=0;const c=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),d=new tt(t,c,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){const o=new Uint8Array(4),c=this.painter.context,d=c.gl;c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null);const m=o[0]+(o[2]>>4<<8),x=o[1]+((15&o[2])<<8),w=this.coordsIndex[255-o[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const C=this._coordsTextureSize,I=(1<<T.tileID.canonical.z)*C;return new l.U(this._allowMercatorOverflow(t,(T.tileID.canonical.x*C+m)/I),(T.tileID.canonical.y*C+x)/I,this.getElevation(T.tileID,m,x,C))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,o=new l.bd,c=new l.b0,d=this.meshSize,m=l.N/d,x=d*d;for(let P=0;P<=d;P++)for(let F=0;F<=d;F++)o.emplaceBack(F*m,P*m,0);for(let P=0;P<x;P+=d+1)for(let F=0;F<d;F++)c.emplaceBack(F+P,d+F+P+1,d+F+P+2),c.emplaceBack(F+P,d+F+P+2,F+P+1);const w=o.length,T=w+2*(d+1);for(const P of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(F*m,P*l.N,q);for(let P=0;P<2*d;P+=2)c.emplaceBack(T+P,T+P+1,T+P+3),c.emplaceBack(T+P,T+P+3,T+P+2),c.emplaceBack(w+P,w+P+3,w+P+1),c.emplaceBack(w+P,w+P+2,w+P+3);const C=o.length,I=C+2*(d+1);for(const P of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(P*l.N,F*m,q);for(let P=0;P<2*d;P+=2)c.emplaceBack(C+P,C+P+1,C+P+3),c.emplaceBack(C+P,C+P+3,C+P+2),c.emplaceBack(I+P,I+P+3,I+P+1),c.emplaceBack(I+P,I+P+2,I+P+3);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(o,fh.members),segments:l.S.simpleSegment(0,0,o.length,c.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*l.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,o){var c;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=o.dem.min*this.exaggeration,c.maxElevation=o.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,o){const c=l.U.fromLngLat(t.wrap()),d=(1<<o)*l.N,m=c.x*d,x=c.y*d,w=Math.floor(m/l.N),T=Math.floor(x/l.N);return{tileID:new l.O(o,0,o,w,T),mercatorX:m,mercatorY:x}}_allowMercatorOverflow(t,o){const c=t.x<this.painter.width/2;let d=l.bf(o);const m=this.painter.transform.center.lng;return c&&Math.sign(d)>0&&Math.sign(m)<0||!c&&Math.sign(d)<0&&Math.sign(m)>0?(d=360*Math.sign(m)+d,l.G(d)):o}}class wp{constructor(t,o,c){this._context=t,this._size=o,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new tt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(c.texture),{id:t,fbo:o,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>t.id!==o),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const tn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ka{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new wp(t.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(o)),this._coordsDescendingInv={};for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const d=t.sourceCaches[c].getVisibleCoordinates();for(const m of d){const x=this.terrain.sourceCache.getTerrainCoords(m);for(const w in x)this._coordsDescendingInv[c][w]||(this._coordsDescendingInv[c][w]=[]),this._coordsDescendingInv[c][w].push(x[w])}}this._coordsDescendingInvStr={};for(const c of t._order){const d=t._layers[c],m=d.source;if(tn[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const x in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][x]=this._coordsDescendingInv[m][x].map(w=>w.key).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][c.tileID.key];m&&m!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const o=t.type,c=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(tn[o]&&(this._prevType&&tn[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(tn[this._prevType]||tn[o]&&d){this._prevType=o;const m=this._stacks.length-1,x=this._stacks[m]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(si(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[m]){const C=this.pool.getObjectForId(w.rtt[m].id);if(C.stamp===w.rtt[m].stamp){this.pool.useObject(C);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[m]={id:T.id,stamp:T.stamp},c.context.bindFramebuffer.set(T.fbo.framebuffer),c.context.clear({color:l.aT.transparent,stencil:0}),c.currentStencilSource=void 0;for(let C=0;C<x.length;C++){const I=c.style._layers[x[C]],P=I.source?this._coordsDescendingInv[I.source][w.tileID.key]:[w.tileID];c.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),c._renderTileClippingMasks(I,P),c.renderLayer(c,c.style.sourceCaches[I.source],I,P),I.source&&(w.rttCoords[I.source]=this._coordsDescendingInvStr[I.source][w.tileID.key])}}return si(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),tn[o]}return!1}}const Je=N,ot={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Jo=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},_u={showCompass:!0,showZoom:!0,visualizePitch:!1};class vu{constructor(t,o,c=!1){this.mousedown=x=>{this.startMouse(l.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),R.mousePos(this.element,x)),R.addEventListener(window,"mousemove",this.mousemove),R.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,R.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=R.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),R.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=R.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),m=t.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=so({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const C=new lh;return new Or({clickTolerance:w,move:(I,P)=>({bearingDelta:(P.x-I.x)*T}),moveStateManager:C,enable:x,assignEvents:Jo})})({clickTolerance:d,enable:!0}),this.map=t,c&&(this.mousePitch=Nr({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const C=new lh;return new Or({clickTolerance:w,move:(I,P)=>({pitchDelta:(P.y-I.y)*T}),moveStateManager:C,enable:x,assignEvents:Jo})})({clickTolerance:m,enable:!0})),R.addEventListener(o,"mousedown",this.mousedown),R.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),R.addEventListener(o,"touchcancel",this.reset)}startMouse(t,o){this.mouseRotate.dragStart(t,o),this.mousePitch&&this.mousePitch.dragStart(t,o),R.disableDrag()}startTouch(t,o){this.touchRotate.dragStart(t,o),this.touchPitch&&this.touchPitch.dragStart(t,o),R.disableDrag()}moveMouse(t,o){const c=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}moveTouch(t,o){const c=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}off(){const t=this.element;R.removeEventListener(t,"mousedown",this.mousedown),R.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),R.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.removeEventListener(window,"touchend",this.touchend),R.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){R.enableDrag(),R.removeEventListener(window,"mousemove",this.mousemove),R.removeEventListener(window,"mouseup",this.mouseup),R.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),R.removeEventListener(window,"touchend",this.touchend)}}let mi;function xu(p,t,o){if(p=new l.L(p.lng,p.lat),t){const c=new l.L(p.lng-360,p.lat),d=new l.L(p.lng+360,p.lat),m=o.locationPoint(p).distSqr(t);o.locationPoint(c).distSqr(t)<m?p=c:o.locationPoint(d).distSqr(t)<m&&(p=d)}for(;Math.abs(p.lng-o.center.lng)>180;){const c=o.locationPoint(p);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;p.lng>o.center.lng?p.lng-=360:p.lng+=360}return p}const Hn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yh(p,t,o){const c=p.classList;for(const d in Hn)c.remove(`maplibregl-${o}-anchor-${d}`);c.add(`maplibregl-${o}-anchor-${t}`)}class Es extends l.E{constructor(t){if(super(),this._onKeyPress=o=>{const c=o.code,d=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=o=>{const c=o.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!c)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=xu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),R.setTransform(this._element,`${Hn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const x=this._map.unproject(this._pos),w=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=x.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=o=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.k("dragstart"))),this.fire(new l.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=R.create("div"),this._element.setAttribute("aria-label","Map marker");const o=R.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${c}px`),o.setAttributeNS(null,"width",`${d}px`),o.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const m=R.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const x=R.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const w=R.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of T){const pe=R.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",oe.rx),pe.setAttributeNS(null,"ry",oe.ry),w.appendChild(pe)}const C=R.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const I=R.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(I);const P=R.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"opacity","0.25"),P.setAttributeNS(null,"fill","#000000");const F=R.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),P.appendChild(F);const q=R.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const $=R.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");const G=R.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#000000"),G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962");const U=R.createNS("http://www.w3.org/2000/svg","circle");U.setAttributeNS(null,"fill","#FFFFFF"),U.setAttributeNS(null,"cx","5.5"),U.setAttributeNS(null,"cy","5.5"),U.setAttributeNS(null,"r","5.4999962"),$.appendChild(G),$.appendChild(U),x.appendChild(w),x.appendChild(C),x.appendChild(P),x.appendChild(q),x.appendChild($),o.appendChild(x),o.setAttributeNS(null,"height",c*this._scale+"px"),o.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(o),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),yh(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),R.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.L.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const oi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ti=0,ao=!1;const ea={maxWidth:100,unit:"metric"};function ta(p,t,o){const c=o&&o.maxWidth||100,d=p._container.clientHeight/2,m=p.unproject([0,d]),x=p.unproject([c,d]),w=m.distanceTo(x);if(o&&o.unit==="imperial"){const T=3.2808*w;T>5280?Is(t,c,T/5280,p._getUIString("ScaleControl.Miles")):Is(t,c,T,p._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Is(t,c,w/1852,p._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Is(t,c,w/1e3,p._getUIString("ScaleControl.Kilometers")):Is(t,c,w,p._getUIString("ScaleControl.Meters"))}function Is(p,t,o,c){const d=function(m){const x=Math.pow(10,`${Math.floor(m)}`.length-1);let w=m/x;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const C=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*C)/C}(w),x*w}(o);p.style.width=t*(d/o)+"px",p.innerHTML=`${d}&nbsp;${c}`}const wu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},bu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lo(p){if(p){if(typeof p=="number"){const t=Math.round(Math.abs(p)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,p),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-p),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(p,0),right:new l.P(-p,0)}}if(p instanceof l.P||Array.isArray(p)){const t=l.P.convert(p);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(p.center||[0,0]),top:l.P.convert(p.top||[0,0]),"top-left":l.P.convert(p["top-left"]||[0,0]),"top-right":l.P.convert(p["top-right"]||[0,0]),bottom:l.P.convert(p.bottom||[0,0]),"bottom-left":l.P.convert(p["bottom-left"]||[0,0]),"bottom-right":l.P.convert(p["bottom-right"]||[0,0]),left:l.P.convert(p.left||[0,0]),right:l.P.convert(p.right||[0,0])}}return lo(new l.P(0,0))}const Su={extend:(p,...t)=>l.e(p,...t),run(p){p()},logToElement(p,t=!1,o="log"){const c=window.document.getElementById(o);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${p}`)}},Tu=N;class At{static get version(){return Tu}static get workerCount(){return fr.workerCount}static set workerCount(t){fr.workerCount=t}static get maxParallelImageRequests(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(t){l.c.MAX_PARALLEL_IMAGE_REQUESTS=t}static get workerUrl(){return l.c.WORKER_URL}static set workerUrl(t){l.c.WORKER_URL=t}static addProtocol(t,o){l.c.REGISTERED_PROTOCOLS[t]=o}static removeProtocol(t){delete l.c.REGISTERED_PROTOCOLS[t]}}return At.Map=class extends ph{constructor(p){if(l.bg.mark(l.bh.create),(p=l.e({},ot,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Za(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._cooperativeGesturesOnWheel=t=>{this._onCooperativeGesture(t,t[this._metaKey],1)},this._contextLost=t=>{t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._cooperativeGestures=p.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new Xa,this._controls=[],this._mapId=l.a2(),this._locale=l.e({},yu,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=ut.addThrottleControl(()=>this.isMoving()),this._requestManager=new Y(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let t=!1;const o=Cs(c=>{this._trackResize&&!this._removed&&this.resize(c)._update()},50);this._resizeObserver=new ResizeObserver(c=>{t?o(c):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new gu(this,p),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=p.hash&&new Wo(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.e({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Mn({customAttribution:p.customAttribution})),p.maplibreLogo&&this.addControl(new Ht,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new l.k(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new l.k(`${t.dataType}dataloading`,t))}),this.on("dataabort",t=>{this.fire(new l.k("sourcedataabort",t))})}_getMapId(){return this._mapId}addControl(p,t){if(t===void 0&&(t=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new l.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=p.onAdd(this);this._controls.push(p);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new l.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(p);return t>-1&&this._controls.splice(t,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,t,o,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,t,o,c)}resize(p){var t;const o=this._containerDimensions(),c=o[0],d=o[1],m=this._getClampedPixelRatio(c,d);if(this._resizeCanvas(c,d,m),this.painter.resize(c,d,m),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(c,d);this._resizeCanvas(c,d,T),this.painter.resize(c,d,T)}this.transform.resize(c,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,d);const x=!this._moving;return x&&(this.stop(),this.fire(new l.k("movestart",p)).fire(new l.k("move",p))),this.fire(new l.k("resize",p)),x&&this.fire(new l.k("moveend",p)),this}_getClampedPixelRatio(p,t){const{0:o,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),m=p*d,x=t*d;return Math.min(m>o?o/m:1,x>c?c/x:1)*d}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Dt.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(p){return this.transform.locationPoint(l.L.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(l.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,t,o){if(p==="mouseenter"||p==="mouseover"){let c=!1;return{layer:t,listener:o,delegates:{mousemove:m=>{const x=this.getLayer(t)?this.queryRenderedFeatures(m.point,{layers:[t]}):[];x.length?c||(c=!0,o.call(this,new Pn(p,this,m.originalEvent,{features:x}))):c=!1},mouseout:()=>{c=!1}}}}if(p==="mouseleave"||p==="mouseout"){let c=!1;return{layer:t,listener:o,delegates:{mousemove:x=>{(this.getLayer(t)?this.queryRenderedFeatures(x.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,o.call(this,new Pn(p,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,o.call(this,new Pn(p,this,x.originalEvent)))}}}}{const c=d=>{const m=this.getLayer(t)?this.queryRenderedFeatures(d.point,{layers:[t]}):[];m.length&&(d.features=m,o.call(this,d),delete d.features)};return{layer:t,listener:o,delegates:{[p]:c}}}}on(p,t,o){if(o===void 0)return super.on(p,t);const c=this._createDelegatedListener(p,t,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(c);for(const d in c.delegates)this.on(d,c.delegates[d]);return this}once(p,t,o){if(o===void 0)return super.once(p,t);const c=this._createDelegatedListener(p,t,o);for(const d in c.delegates)this.once(d,c.delegates[d]);return this}off(p,t,o){return o===void 0?super.off(p,t):(this._delegatedListeners&&this._delegatedListeners[p]&&(c=>{const d=this._delegatedListeners[p];for(let m=0;m<d.length;m++){const x=d[m];if(x.layer===t&&x.listener===o){for(const w in x.delegates)this.off(w,x.delegates[w]);return d.splice(m,1),this}}})(),this)}queryRenderedFeatures(p,t){if(!this.style)return[];let o;const c=p instanceof l.P||Array.isArray(p),d=c?p:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:p)||{},d instanceof l.P||typeof d[0]=="number")o=[l.P.convert(d)];else{const m=l.P.convert(d[0]),x=l.P.convert(d[1]);o=[m,new l.P(x.x,m.y),x,new l.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(p,t){return this.style.querySourceFeatures(p,t)}setStyle(p,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(p,t))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const t=this._locale[p];if(t==null)throw new Error(`Missing UI string '${p}'`);return t}_updateStyle(p,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,t));const o=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Bi(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,t,o):this.style.loadJSON(p,t,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Bi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,t){if(typeof p=="string"){const o=this._requestManager.transformRequest(p,ee.Style);l.f(o,(c,d)=>{c?this.fire(new l.j(c)):d&&this._updateDiff(d,t)})}else typeof p=="object"&&this._updateDiff(p,t)}_updateDiff(p,t){try{this.style.setState(p,t)&&this._update(!0)}catch(o){l.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(p,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(p,t){return this._lazyInitEmptyStyle(),this.style.addSource(p,t),this._update(!0)}isSourceLoaded(p){const t=this.style&&this.style.sourceCaches[p];if(t!==void 0)return t.loaded();this.fire(new l.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const t=this.style.sourceCaches[p.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);for(const o in this.style._layers){const c=this.style._layers[o];c.type==="hillshade"&&c.source===p.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new gh(this.painter,t,p),this.painter.renderToTexture=new Ka(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==p.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.k("terrain",{terrain:p})),this}getTerrain(){var p,t;return(t=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const t in p){const o=p[t]._tiles;for(const c in o){const d=o[c];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}addSourceType(p,t,o){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,t,o)}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,t,o={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:m,stretchY:x,content:w}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.a(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:C,data:I}=t,P=t;return this.style.addImage(p,{data:new l.R({width:T,height:C},new Uint8Array(I)),pixelRatio:c,stretchX:m,stretchY:x,content:w,sdf:d,version:0,userImage:P}),P.onAdd&&P.onAdd(this,p),this}}{const{width:T,height:C,data:I}=l.h.getImageData(t);this.style.addImage(p,{data:new l.R({width:T,height:C},I),pixelRatio:c,stretchX:m,stretchY:x,content:w,sdf:d,version:0})}}updateImage(p,t){const o=this.style.getImage(p);if(!o)return this.fire(new l.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||l.a(t)?l.h.getImageData(t):t,{width:d,height:m,data:x}=c;if(d===void 0||m===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==o.data.width||m!==o.data.height)return this.fire(new l.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(t instanceof HTMLImageElement||l.a(t));return o.data.replace(x,w),this.style.updateImage(p,o),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new l.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,t){ut.getImage(this._requestManager.transformRequest(p,ee.Image),t)}listImages(){return this.style.listImages()}addLayer(p,t){return this._lazyInitEmptyStyle(),this.style.addLayer(p,t),this._update(!0)}moveLayer(p,t){return this.style.moveLayer(p,t),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,t,o){return this.style.setLayerZoomRange(p,t,o),this._update(!0)}setFilter(p,t,o={}){return this.style.setFilter(p,t,o),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,t,o,c={}){return this.style.setPaintProperty(p,t,o,c),this._update(!0)}getPaintProperty(p,t){return this.style.getPaintProperty(p,t)}setLayoutProperty(p,t,o,c={}){return this.style.setLayoutProperty(p,t,o,c),this._update(!0)}getLayoutProperty(p,t){return this.style.getLayoutProperty(p,t)}setGlyphs(p,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,t,o,c=>{c||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,t,o=>{o||this._update(!0)}),this}setLight(p,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,t){return this.style.setFeatureState(p,t),this._update()}removeFeatureState(p,t){return this.style.removeFeatureState(p,t),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,t=0;return this._container&&(p=this._container.clientWidth||400,t=this._container.clientHeight||300),[p,t]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const t=this._canvasContainer=R.create("div","maplibregl-canvas-container",p);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=R.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),c=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],c);const d=this._controlContainer=R.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{m[x]=R.create("div",`maplibregl-ctrl-${x} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=R.create("div","maplibregl-cooperative-gesture-screen",this._container);let p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){R.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(p,t,o){this._canvas.width=Math.floor(o*p),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:p},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});const o=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!o){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new ks(o,this.transform),re.testSupport(o)}_onCooperativeGesture(p,t,o){return!t&&o<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=l.h.now();this.style.zoomHistory.update(d,m);const x=new l.a8(d,{now:m,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=x.crossFadingFactor();w===1&&w===this._crossFadingFactor||(o=!0,this._crossFadingFactor=w),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new l.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.bg.mark(l.bh.load),this.fire(new l.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,l.bg.mark(l.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ut.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),R.remove(this._canvasContainer),R.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.bg.clearMetrics(),this._removed=!0,this.fire(new l.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.h.frame(p=>{l.bg.frame(p),this._frame=null,this._render(p)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Je}getCameraTargetElevation(){return this.transform.elevation}},At.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,o)=>{const c=this._map._getUIString(`NavigationControl.${o}`);t.title=c,t.setAttribute("aria-label",c)},this.options=l.e({},_u,p),this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),R.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),R.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=R.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){R.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,t){const o=R.create("button",p,this._container);return o.type="button",o.addEventListener("click",t),o}},At.GeolocateControl=class extends l.E{constructor(p){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new l.L(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,d=this._map.getBearing(),m=l.e({bearing:d},this.options.fitBoundsOptions),x=Dt.fromLngLat(o,c);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new l.L(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&ao)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=R.create("button","maplibregl-ctrl-geolocate",this._container),R.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Es({element:this._dotElement}),this._circleElement=R.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Es({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.k("trackuserlocationend")))})}},this.options=l.e({},oi,p)}onAdd(p){return this._map=p,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,o=!1){mi===void 0||o?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{mi=c.state!=="denied",t(mi)}).catch(()=>{mi=!!window.navigator.geolocation,t(mi)}):(mi=!!window.navigator.geolocation,t(mi)):t(mi)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),R.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ti=0,ao=!1}_isOutOfMapMaxBounds(p){const t=this._map.getMaxBounds(),o=p.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),t=p.getSouthEast(),o=p.getNorthEast(),c=t.distanceTo(o),d=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ti--,ao=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ti++,ti>1?(p={maximumAge:6e5,timeout:0},ao=!0):(p=this.options.positionOptions,ao=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},At.AttributionControl=Mn,At.LogoControl=Ht,At.ScaleControl=class{constructor(p){this._onMove=()=>{ta(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,ta(this._map,this._container,this.options)},this.options=l.e({},ea,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){R.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},At.FullscreenControl=class extends l.E{constructor(p={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){R.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=R.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);R.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},At.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=p}onAdd(p){return this._map=p,this._container=R.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=R.create("button","maplibregl-ctrl-terrain",this._container),R.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){R.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},At.Popup=class extends l.E{constructor(p){super(),this.remove=()=>(this._content&&R.remove(this._content),this._container&&(R.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.k("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=R.create("div","maplibregl-popup",this._map.getContainer()),this._tip=R.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xu(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const o=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let c=this.options.anchor;const d=lo(this.options.offset);if(!c){const x=this._container.offsetWidth,w=this._container.offsetHeight;let T;T=o.y+d.bottom.y<w?["top"]:o.y>this._map.transform.height-w?["bottom"]:[],o.x<x/2?T.push("left"):o.x>this._map.transform.width-x/2&&T.push("right"),c=T.length===0?"bottom":T.join("-")}const m=o.add(d[c]).round();R.setTransform(this._container,`${Hn[c]} translate(${m.x}px,${m.y}px)`),yh(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(wu),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=l.L.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const t=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=p;c=o.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=R.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}_createCloseButton(){this.options.closeButton&&(this._closeButton=R.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(bu);p&&p.focus()}},At.Marker=Es,At.Style=Bi,At.LngLat=l.L,At.LngLatBounds=Dt,At.Point=l.P,At.MercatorCoordinate=l.U,At.Evented=l.E,At.AJAXError=l.bi,At.config=l.c,At.CanvasSource=Jr,At.GeoJSONSource=Qr,At.ImageSource=Vn,At.RasterDEMTileSource=ir,At.RasterTileSource=hn,At.VectorTileSource=tr,At.VideoSource=Oo,At.setRTLTextPlugin=l.bj,At.getRTLTextPluginStatus=l.bk,At.prewarm=function(){ba().acquire(It)},At.clearPrewarmedResources=function(){const p=Ar;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(It),Ar=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Su.extend(At,{isSafari:l.ac,getPerformanceMetrics:l.bg.getPerformanceMetrics}),At});var M=_;return M})})(e1);var JS=e1.exports;const eT=Ud(JS),Zf=({longitude:i,latitude:s,zoom:u,style:y="https://tile.openstreetmap.jp/styles/osm-bright/style.json"})=>st.jsx(Lg,{mapLib:eT,initialViewState:{longitude:i,latitude:s,zoom:u},cursor:"default",doubleClickZoom:!1,dragRotate:!1,dragPan:!1,keyboard:!1,scrollZoom:!1,touchPitch:!1,touchZoomRotate:!1,style:{position:"absolute",top:0,display:"block",width:"100%",height:"100%"},mapStyle:y,children:st.jsx(YS,{position:"bottom-right"})}),tT=({src:i})=>st.jsxs("div",{className:"section-background",children:[st.jsx("div",{className:"section-background-overlay"}),st.jsx("img",{src:i})]});function Fv(i){const s=Object.assign({section:"section",h2:"h2",p:"p",code:"code",blockquote:"blockquote",a:"a"},i.components);return st.jsxs(st.Fragment,{children:[st.jsxs(s.section,{children:[st.jsx(s.h2,{id:"what-is-this",children:"What is this?"}),st.jsx(s.p,{children:"OpenStoryMaps is a software designed to tell a story along with Maps."}),st.jsx(s.p,{children:`Really many people want to tell their story, with Maps.
They also need to tell their story with Data visualization.`}),st.jsx(s.p,{children:"OpenStoryMaps allows you to tell a story with Maps and Data by simply writing Markdown."}),st.jsx(s.p,{children:`This web page demonstrates what is possible with OpenStoryMaps.
Let's scroll down.`})]}),`
`,st.jsxs(s.section,{children:[st.jsx(s.h2,{id:"usage",children:"Usage"}),st.jsx(tT,{src:"./UNHQ_NYC.jpg"}),st.jsxs(s.p,{children:["OpenStoryMaps create sections by the ",st.jsx(s.code,{children:"h2"})," level heading in markdown."]}),st.jsx(s.p,{children:"You can use background image like this section."}),st.jsx(s.p,{children:"You can use blockquote syntax like below:"}),st.jsxs(s.blockquote,{children:[`
`,st.jsx(s.p,{children:`The United Nations is headquartered in Midtown Manhattan, New York City, United
States, and the complex has served as the official headquarters of the United Nations
since its completion in 1951. It is in the Turtle Bay neighborhood of Manhattan,
on 17 to 18 acres (6.9 to 7.3 ha) of grounds overlooking the East River. Its borders
are First Avenue on the west, East 42nd Street to the south, East 48th Street on
the north, and the East River to the east.`}),`
`]}),st.jsx(s.p,{children:st.jsx(s.a,{href:"https://en.wikipedia.org/wiki/Headquarters_of_the_United_Nations",children:"https://en.wikipedia.org/wiki/Headquarters_of_the_United_Nations"})}),st.jsx(s.p,{children:"OpenStoryMaps is GitHub Flavored Markdown, so URL is automatically linked like the above."})]}),`
`,st.jsxs(s.section,{children:[st.jsx(s.h2,{id:"unhq-ny-usa",children:"UNHQ, NY, USA"}),st.jsx(s.p,{children:"Of course, you can set the Maps to the background of the section."}),st.jsx(Zf,{longitude:-73.968056,latitude:40.749444,zoom:15})]}),`
`,st.jsxs(s.section,{children:[st.jsx(s.h2,{id:"ungsc-brindisi-italy",children:"UNGSC, Brindisi, Italy"}),st.jsx(Zf,{longitude:17.9466719,latitude:40.6494882,zoom:17}),st.jsxs(s.blockquote,{children:[`
`,st.jsx(s.p,{children:`The United Nations Global Service Centre (UNGSC) is United Nations Peacekeeping office
based in Brindisi, Italy, as well as Valencia, Spain that provides logistics, geospatial
intelligence, IT services and training to peacekeeping and special political missions
around the world.`}),`
`]}),st.jsx(s.p,{children:st.jsx(s.a,{href:"https://en.wikipedia.org/wiki/United_Nations_Global_Service_Centre",children:"https://en.wikipedia.org/wiki/United_Nations_Global_Service_Centre"})})]}),`
`,st.jsxs(s.section,{children:[st.jsx(s.h2,{id:"geospatial-information-authority-of-japan",children:"Geospatial Information Authority of Japan"}),st.jsx(Zf,{style:"./gsi_ort.json",longitude:140.084583,latitude:36.104583,zoom:16}),st.jsxs(s.blockquote,{children:[`
`,st.jsx(s.p,{children:`The Geospatial Information Authority of Japan (, Kokudo Chiri-in), or GSI, is
the national institution responsible for surveying and mapping the national land of Japan.
The former name of the organization from 1949 until March 2010 was Geographical Survey Institute;
despite the rename, it retains the same initials.`}),`
`]}),st.jsx(s.p,{children:st.jsx(s.a,{href:"https://en.wikipedia.org/wiki/Geospatial_Information_Authority_of_Japan",children:"https://en.wikipedia.org/wiki/Geospatial_Information_Authority_of_Japan"})})]})]})}function iT(i={}){const{wrapper:s}=i.components||{};return s?st.jsx(s,Object.assign({},i,{children:st.jsx(Fv,i)})):Fv(i)}const nT=()=>(pt.useEffect(()=>(Ev.init({tocSelector:"#toc",contentSelector:"#root",headingSelector:"h2"}),()=>Ev.destroy()),[]),st.jsxs(st.Fragment,{children:[st.jsxs("section",{id:"hero",children:[st.jsx("div",{id:"hero-background",children:st.jsx("img",{src:void 0})}),st.jsx("div",{id:"hero-overlay"}),st.jsxs("div",{id:"hero-content",children:[st.jsx("h1",{children:void 0}),st.jsx("div",{children:void 0}),st.jsx("div",{children:void 0}),st.jsx("div",{children:void 0})]})]}),st.jsx("div",{id:"toc"}),st.jsx(iT,{})]}));wS.render(st.jsx(hb.StrictMode,{children:st.jsx(nT,{})}),document.getElementById("root"));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}